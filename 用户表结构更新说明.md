# 用户表结构更新说明

## 更新内容

根据您提供的表结构图片，我已经将用户表更新为包含更多字段的完整结构。

## 字段对比

### 新增字段

| 字段名 | 类型 | 约束 | 默认值 | 说明 |
|--------|------|------|--------|------|
| `user_id` | VARCHAR(50) | UNIQUE | NULL | 用户ID |
| `user_wallet` | VARCHAR(255) | UNIQUE | NULL | 用户钱包地址 |
| `email_verified` | TINYINT(1) | - | 0 | 邮箱验证状态 |
| `is_active` | TINYINT(1) | - | 1 | 账户激活状态 |

### 字段重命名

| 原字段名 | 新字段名 | 说明 |
|----------|----------|------|
| `username` | `user_name` | 用户姓名 |
| `email` | `user_email` | 用户邮箱 |
| `password` | `user_password` | 用户密码 |
| `phone` | `user_phone` | 用户手机号 |

### 保持不变

| 字段名 | 类型 | 约束 | 说明 |
|--------|------|------|------|
| `id` | INT | PRIMARY KEY, AUTO_INCREMENT | 主键ID |
| `created_at` | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP | 创建时间 |
| `updated_at` | TIMESTAMP | DEFAULT CURRENT_TIMESTAMP ON UPDATE | 更新时间 |

## 完整的用户表结构

```sql
CREATE TABLE IF NOT EXISTS user (
  id INT AUTO_INCREMENT PRIMARY KEY,
  user_id VARCHAR(50) UNIQUE COMMENT '用户ID',
  user_wallet VARCHAR(255) UNIQUE COMMENT '用户钱包地址',
  user_name VARCHAR(100) COMMENT '用户姓名',
  user_email VARCHAR(100) NOT NULL UNIQUE COMMENT '用户邮箱',
  user_password VARCHAR(255) NOT NULL COMMENT '用户密码',
  user_phone VARCHAR(20) COMMENT '用户手机号',
  email_verified TINYINT(1) DEFAULT 0 COMMENT '邮箱验证状态',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  is_active TINYINT(1) DEFAULT 1 COMMENT '账户激活状态'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='用户表';
```

## 测试数据

已更新测试用户数据以匹配新的表结构：

```sql
INSERT IGNORE INTO user (user_id, user_wallet, user_name, user_email, user_password, user_phone, email_verified, is_active) VALUES 
('USR001', '0x1234567890abcdef1234567890abcdef12345678', '管理员', 'admin@rwa.com', '123456', '13800138000', 1, 1),
('USR002', '0xabcdef1234567890abcdef1234567890abcdef12', '测试用户', 'test@rwa.com', '123456', '13800138001', 0, 1);
```

## 字段说明

### 用户标识
- **id**: 自增主键，系统内部使用
- **user_id**: 用户业务ID，用于对外标识用户
- **user_wallet**: 用户钱包地址，用于区块链交互

### 用户信息
- **user_name**: 用户真实姓名
- **user_email**: 用户邮箱地址（登录账号）
- **user_password**: 用户密码（建议加密存储）
- **user_phone**: 用户手机号码

### 状态字段
- **email_verified**: 邮箱验证状态（0=未验证，1=已验证）
- **is_active**: 账户激活状态（0=禁用，1=激活）

### 时间字段
- **created_at**: 账户创建时间
- **updated_at**: 最后更新时间（自动更新）

## 使用建议

1. **钱包地址验证**: 在插入用户数据时，应验证钱包地址格式
2. **密码加密**: 存储密码前应进行哈希加密
3. **邮箱验证**: 实现邮箱验证流程，更新 `email_verified` 字段
4. **账户管理**: 通过 `is_active` 字段实现账户启用/禁用功能

## 注意事项

- `user_id` 和 `user_wallet` 都是唯一字段，不能重复
- `user_email` 是必填字段且唯一，用作登录账号
- `user_password` 是必填字段，建议使用强密码策略
- 时间字段会自动维护，无需手动设置
