(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();/**
* @vue/shared v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Dc(t){const e=Object.create(null);for(const s of t.split(","))e[s]=1;return s=>s in e}const rt={},Yr=[],nn=()=>{},zf=()=>!1,Pa=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),xc=t=>t.startsWith("onUpdate:"),$t=Object.assign,Nc=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},Kg=Object.prototype.hasOwnProperty,qe=(t,e)=>Kg.call(t,e),Ee=Array.isArray,Gr=t=>ho(t)==="[object Map]",pi=t=>ho(t)==="[object Set]",Pu=t=>ho(t)==="[object Date]",Ie=t=>typeof t=="function",kt=t=>typeof t=="string",on=t=>typeof t=="symbol",it=t=>t!==null&&typeof t=="object",Qf=t=>(it(t)||Ie(t))&&Ie(t.then)&&Ie(t.catch),Jf=Object.prototype.toString,ho=t=>Jf.call(t),zg=t=>ho(t).slice(8,-1),qf=t=>ho(t)==="[object Object]",Lc=t=>kt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,xi=Dc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ka=t=>{const e=Object.create(null);return(s=>e[s]||(e[s]=t(s)))},Qg=/-\w/g,Us=ka(t=>t.replace(Qg,e=>e.slice(1).toUpperCase())),Jg=/\B([A-Z])/g,Cr=ka(t=>t.replace(Jg,"-$1").toLowerCase()),Sa=ka(t=>t.charAt(0).toUpperCase()+t.slice(1)),al=ka(t=>t?`on${Sa(t)}`:""),Gn=(t,e)=>!Object.is(t,e),Ho=(t,...e)=>{for(let s=0;s<t.length;s++)t[s](...e)},Zf=(t,e,s,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:s})},qo=t=>{const e=parseFloat(t);return isNaN(e)?t:e},qg=t=>{const e=kt(t)?Number(t):NaN;return isNaN(e)?t:e};let ku;const Ca=()=>ku||(ku=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function xt(t){if(Ee(t)){const e={};for(let s=0;s<t.length;s++){const n=t[s],r=kt(n)?ty(n):xt(n);if(r)for(const i in r)e[i]=r[i]}return e}else if(kt(t)||it(t))return t}const Zg=/;(?![^(]*\))/g,Xg=/:([^]+)/,ey=/\/\*[^]*?\*\//g;function ty(t){const e={};return t.replace(ey,"").split(Zg).forEach(s=>{if(s){const n=s.split(Xg);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function be(t){let e="";if(kt(t))e=t;else if(Ee(t))for(let s=0;s<t.length;s++){const n=be(t[s]);n&&(e+=n+" ")}else if(it(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}const sy="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",ny=Dc(sy);function Xf(t){return!!t||t===""}function ry(t,e){if(t.length!==e.length)return!1;let s=!0;for(let n=0;s&&n<t.length;n++)s=po(t[n],e[n]);return s}function po(t,e){if(t===e)return!0;let s=Pu(t),n=Pu(e);if(s||n)return s&&n?t.getTime()===e.getTime():!1;if(s=on(t),n=on(e),s||n)return t===e;if(s=Ee(t),n=Ee(e),s||n)return s&&n?ry(t,e):!1;if(s=it(t),n=it(e),s||n){if(!s||!n)return!1;const r=Object.keys(t).length,i=Object.keys(e).length;if(r!==i)return!1;for(const o in t){const l=t.hasOwnProperty(o),c=e.hasOwnProperty(o);if(l&&!c||!l&&c||!po(t[o],e[o]))return!1}}return String(t)===String(e)}function Oc(t,e){return t.findIndex(s=>po(s,e))}const eh=t=>!!(t&&t.__v_isRef===!0),p=t=>kt(t)?t:t==null?"":Ee(t)||it(t)&&(t.toString===Jf||!Ie(t.toString))?eh(t)?p(t.value):JSON.stringify(t,th,2):String(t),th=(t,e)=>eh(e)?th(t,e.value):Gr(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[n,r],i)=>(s[ll(n,i)+" =>"]=r,s),{})}:pi(e)?{[`Set(${e.size})`]:[...e.values()].map(s=>ll(s))}:on(e)?ll(e):it(e)&&!Ee(e)&&!qf(e)?String(e):e,ll=(t,e="")=>{var s;return on(t)?`Symbol(${(s=t.description)!=null?s:e})`:t};/**
* @vue/reactivity v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let gs;class iy{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=gs,!e&&gs&&(this.index=(gs.scopes||(gs.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].pause();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,s;if(this.scopes)for(e=0,s=this.scopes.length;e<s;e++)this.scopes[e].resume();for(e=0,s=this.effects.length;e<s;e++)this.effects[e].resume()}}run(e){if(this._active){const s=gs;try{return gs=this,e()}finally{gs=s}}}on(){++this._on===1&&(this.prevScope=gs,gs=this)}off(){this._on>0&&--this._on===0&&(gs=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let s,n;for(s=0,n=this.effects.length;s<n;s++)this.effects[s].stop();for(this.effects.length=0,s=0,n=this.cleanups.length;s<n;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,n=this.scopes.length;s<n;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0}}}function oy(){return gs}let at;const cl=new WeakSet;class sh{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,gs&&gs.active&&gs.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,cl.has(this)&&(cl.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||rh(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Su(this),ih(this);const e=at,s=Ys;at=this,Ys=!0;try{return this.fn()}finally{oh(this),at=e,Ys=s,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Mc(e);this.deps=this.depsTail=void 0,Su(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?cl.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){jl(this)&&this.run()}get dirty(){return jl(this)}}let nh=0,Ni,Li;function rh(t,e=!1){if(t.flags|=8,e){t.next=Li,Li=t;return}t.next=Ni,Ni=t}function Uc(){nh++}function Bc(){if(--nh>0)return;if(Li){let e=Li;for(Li=void 0;e;){const s=e.next;e.next=void 0,e.flags&=-9,e=s}}let t;for(;Ni;){let e=Ni;for(Ni=void 0;e;){const s=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=s}}if(t)throw t}function ih(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function oh(t){let e,s=t.depsTail,n=s;for(;n;){const r=n.prevDep;n.version===-1?(n===s&&(s=r),Mc(n),ay(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=r}t.deps=e,t.depsTail=s}function jl(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(ah(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function ah(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Gi)||(t.globalVersion=Gi,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!jl(t))))return;t.flags|=2;const e=t.dep,s=at,n=Ys;at=t,Ys=!0;try{ih(t);const r=t.fn(t._value);(e.version===0||Gn(r,t._value))&&(t.flags|=128,t._value=r,e.version++)}catch(r){throw e.version++,r}finally{at=s,Ys=n,oh(t),t.flags&=-3}}function Mc(t,e=!1){const{dep:s,prevSub:n,nextSub:r}=t;if(n&&(n.nextSub=r,t.prevSub=void 0),r&&(r.prevSub=n,t.nextSub=void 0),s.subs===t&&(s.subs=n,!n&&s.computed)){s.computed.flags&=-5;for(let i=s.computed.deps;i;i=i.nextDep)Mc(i,!0)}!e&&!--s.sc&&s.map&&s.map.delete(s.key)}function ay(t){const{prevDep:e,nextDep:s}=t;e&&(e.nextDep=s,t.prevDep=void 0),s&&(s.prevDep=e,t.nextDep=void 0)}let Ys=!0;const lh=[];function Pn(){lh.push(Ys),Ys=!1}function kn(){const t=lh.pop();Ys=t===void 0?!0:t}function Su(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const s=at;at=void 0;try{e()}finally{at=s}}}let Gi=0;class ly{constructor(e,s){this.sub=e,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Fc{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!at||!Ys||at===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==at)s=this.activeLink=new ly(at,this),at.deps?(s.prevDep=at.depsTail,at.depsTail.nextDep=s,at.depsTail=s):at.deps=at.depsTail=s,ch(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const n=s.nextDep;n.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=n),s.prevDep=at.depsTail,s.nextDep=void 0,at.depsTail.nextDep=s,at.depsTail=s,at.deps===s&&(at.deps=n)}return s}trigger(e){this.version++,Gi++,this.notify(e)}notify(e){Uc();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{Bc()}}}function ch(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)ch(n)}const s=t.dep.subs;s!==t&&(t.prevSub=s,s&&(s.nextSub=t)),t.dep.subs=t}}const Hl=new WeakMap,Ar=Symbol(""),Wl=Symbol(""),Ki=Symbol("");function Qt(t,e,s){if(Ys&&at){let n=Hl.get(t);n||Hl.set(t,n=new Map);let r=n.get(s);r||(n.set(s,r=new Fc),r.map=n,r.key=s),r.track()}}function gn(t,e,s,n,r,i){const o=Hl.get(t);if(!o){Gi++;return}const l=c=>{c&&c.trigger()};if(Uc(),e==="clear")o.forEach(l);else{const c=Ee(t),u=c&&Lc(s);if(c&&s==="length"){const d=Number(n);o.forEach((f,h)=>{(h==="length"||h===Ki||!on(h)&&h>=d)&&l(f)})}else switch((s!==void 0||o.has(void 0))&&l(o.get(s)),u&&l(o.get(Ki)),e){case"add":c?u&&l(o.get("length")):(l(o.get(Ar)),Gr(t)&&l(o.get(Wl)));break;case"delete":c||(l(o.get(Ar)),Gr(t)&&l(o.get(Wl)));break;case"set":Gr(t)&&l(o.get(Ar));break}}Bc()}function Or(t){const e=ze(t);return e===t?e:(Qt(e,"iterate",Ki),Os(t)?e:e.map(Ht))}function Ia(t){return Qt(t=ze(t),"iterate",Ki),t}const cy={__proto__:null,[Symbol.iterator](){return ul(this,Symbol.iterator,Ht)},concat(...t){return Or(this).concat(...t.map(e=>Ee(e)?Or(e):e))},entries(){return ul(this,"entries",t=>(t[1]=Ht(t[1]),t))},every(t,e){return ln(this,"every",t,e,void 0,arguments)},filter(t,e){return ln(this,"filter",t,e,s=>s.map(Ht),arguments)},find(t,e){return ln(this,"find",t,e,Ht,arguments)},findIndex(t,e){return ln(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return ln(this,"findLast",t,e,Ht,arguments)},findLastIndex(t,e){return ln(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return ln(this,"forEach",t,e,void 0,arguments)},includes(...t){return dl(this,"includes",t)},indexOf(...t){return dl(this,"indexOf",t)},join(t){return Or(this).join(t)},lastIndexOf(...t){return dl(this,"lastIndexOf",t)},map(t,e){return ln(this,"map",t,e,void 0,arguments)},pop(){return Ai(this,"pop")},push(...t){return Ai(this,"push",t)},reduce(t,...e){return Cu(this,"reduce",t,e)},reduceRight(t,...e){return Cu(this,"reduceRight",t,e)},shift(){return Ai(this,"shift")},some(t,e){return ln(this,"some",t,e,void 0,arguments)},splice(...t){return Ai(this,"splice",t)},toReversed(){return Or(this).toReversed()},toSorted(t){return Or(this).toSorted(t)},toSpliced(...t){return Or(this).toSpliced(...t)},unshift(...t){return Ai(this,"unshift",t)},values(){return ul(this,"values",Ht)}};function ul(t,e,s){const n=Ia(t),r=n[e]();return n!==t&&!Os(t)&&(r._next=r.next,r.next=()=>{const i=r._next();return i.value&&(i.value=s(i.value)),i}),r}const uy=Array.prototype;function ln(t,e,s,n,r,i){const o=Ia(t),l=o!==t&&!Os(t),c=o[e];if(c!==uy[e]){const f=c.apply(t,i);return l?Ht(f):f}let u=s;o!==t&&(l?u=function(f,h){return s.call(this,Ht(f),h,t)}:s.length>2&&(u=function(f,h){return s.call(this,f,h,t)}));const d=c.call(o,u,n);return l&&r?r(d):d}function Cu(t,e,s,n){const r=Ia(t);let i=s;return r!==t&&(Os(t)?s.length>3&&(i=function(o,l,c){return s.call(this,o,l,c,t)}):i=function(o,l,c){return s.call(this,o,Ht(l),c,t)}),r[e](i,...n)}function dl(t,e,s){const n=ze(t);Qt(n,"iterate",Ki);const r=n[e](...s);return(r===-1||r===!1)&&jc(s[0])?(s[0]=ze(s[0]),n[e](...s)):r}function Ai(t,e,s=[]){Pn(),Uc();const n=ze(t)[e].apply(t,s);return Bc(),kn(),n}const dy=Dc("__proto__,__v_isRef,__isVue"),uh=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(on));function fy(t){on(t)||(t=String(t));const e=ze(this);return Qt(e,"has",t),e.hasOwnProperty(t)}class dh{constructor(e=!1,s=!1){this._isReadonly=e,this._isShallow=s}get(e,s,n){if(s==="__v_skip")return e.__v_skip;const r=this._isReadonly,i=this._isShallow;if(s==="__v_isReactive")return!r;if(s==="__v_isReadonly")return r;if(s==="__v_isShallow")return i;if(s==="__v_raw")return n===(r?i?Ey:mh:i?ph:hh).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=Ee(e);if(!r){let c;if(o&&(c=cy[s]))return c;if(s==="hasOwnProperty")return fy}const l=Reflect.get(e,s,Zt(e)?e:n);return(on(s)?uh.has(s):dy(s))||(r||Qt(e,"get",s),i)?l:Zt(l)?o&&Lc(s)?l:l.value:it(l)?r?yh(l):mo(l):l}}class fh extends dh{constructor(e=!1){super(!1,e)}set(e,s,n,r){let i=e[s];if(!this._isShallow){const c=zn(i);if(!Os(n)&&!zn(n)&&(i=ze(i),n=ze(n)),!Ee(e)&&Zt(i)&&!Zt(n))return c||(i.value=n),!0}const o=Ee(e)&&Lc(s)?Number(s)<e.length:qe(e,s),l=Reflect.set(e,s,n,Zt(e)?e:r);return e===ze(r)&&(o?Gn(n,i)&&gn(e,"set",s,n):gn(e,"add",s,n)),l}deleteProperty(e,s){const n=qe(e,s);e[s];const r=Reflect.deleteProperty(e,s);return r&&n&&gn(e,"delete",s,void 0),r}has(e,s){const n=Reflect.has(e,s);return(!on(s)||!uh.has(s))&&Qt(e,"has",s),n}ownKeys(e){return Qt(e,"iterate",Ee(e)?"length":Ar),Reflect.ownKeys(e)}}class hy extends dh{constructor(e=!1){super(!0,e)}set(e,s){return!0}deleteProperty(e,s){return!0}}const py=new fh,my=new hy,gy=new fh(!0);const Yl=t=>t,Io=t=>Reflect.getPrototypeOf(t);function yy(t,e,s){return function(...n){const r=this.__v_raw,i=ze(r),o=Gr(i),l=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,u=r[t](...n),d=s?Yl:e?Zo:Ht;return!e&&Qt(i,"iterate",c?Wl:Ar),{next(){const{value:f,done:h}=u.next();return h?{value:f,done:h}:{value:l?[d(f[0]),d(f[1])]:d(f),done:h}},[Symbol.iterator](){return this}}}}function Ro(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function vy(t,e){const s={get(r){const i=this.__v_raw,o=ze(i),l=ze(r);t||(Gn(r,l)&&Qt(o,"get",r),Qt(o,"get",l));const{has:c}=Io(o),u=e?Yl:t?Zo:Ht;if(c.call(o,r))return u(i.get(r));if(c.call(o,l))return u(i.get(l));i!==o&&i.get(r)},get size(){const r=this.__v_raw;return!t&&Qt(ze(r),"iterate",Ar),r.size},has(r){const i=this.__v_raw,o=ze(i),l=ze(r);return t||(Gn(r,l)&&Qt(o,"has",r),Qt(o,"has",l)),r===l?i.has(r):i.has(r)||i.has(l)},forEach(r,i){const o=this,l=o.__v_raw,c=ze(l),u=e?Yl:t?Zo:Ht;return!t&&Qt(c,"iterate",Ar),l.forEach((d,f)=>r.call(i,u(d),u(f),o))}};return $t(s,t?{add:Ro("add"),set:Ro("set"),delete:Ro("delete"),clear:Ro("clear")}:{add(r){!e&&!Os(r)&&!zn(r)&&(r=ze(r));const i=ze(this);return Io(i).has.call(i,r)||(i.add(r),gn(i,"add",r,r)),this},set(r,i){!e&&!Os(i)&&!zn(i)&&(i=ze(i));const o=ze(this),{has:l,get:c}=Io(o);let u=l.call(o,r);u||(r=ze(r),u=l.call(o,r));const d=c.call(o,r);return o.set(r,i),u?Gn(i,d)&&gn(o,"set",r,i):gn(o,"add",r,i),this},delete(r){const i=ze(this),{has:o,get:l}=Io(i);let c=o.call(i,r);c||(r=ze(r),c=o.call(i,r)),l&&l.call(i,r);const u=i.delete(r);return c&&gn(i,"delete",r,void 0),u},clear(){const r=ze(this),i=r.size!==0,o=r.clear();return i&&gn(r,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(r=>{s[r]=yy(r,t,e)}),s}function Vc(t,e){const s=vy(t,e);return(n,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?n:Reflect.get(qe(s,r)&&r in n?s:n,r,i)}const by={get:Vc(!1,!1)},wy={get:Vc(!1,!0)},Ay={get:Vc(!0,!1)};const hh=new WeakMap,ph=new WeakMap,mh=new WeakMap,Ey=new WeakMap;function _y(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ty(t){return t.__v_skip||!Object.isExtensible(t)?0:_y(zg(t))}function mo(t){return zn(t)?t:$c(t,!1,py,by,hh)}function gh(t){return $c(t,!1,gy,wy,ph)}function yh(t){return $c(t,!0,my,Ay,mh)}function $c(t,e,s,n,r){if(!it(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=Ty(t);if(i===0)return t;const o=r.get(t);if(o)return o;const l=new Proxy(t,i===2?n:s);return r.set(t,l),l}function Kr(t){return zn(t)?Kr(t.__v_raw):!!(t&&t.__v_isReactive)}function zn(t){return!!(t&&t.__v_isReadonly)}function Os(t){return!!(t&&t.__v_isShallow)}function jc(t){return t?!!t.__v_raw:!1}function ze(t){const e=t&&t.__v_raw;return e?ze(e):t}function Py(t){return!qe(t,"__v_skip")&&Object.isExtensible(t)&&Zf(t,"__v_skip",!0),t}const Ht=t=>it(t)?mo(t):t,Zo=t=>it(t)?yh(t):t;function Zt(t){return t?t.__v_isRef===!0:!1}function fe(t){return vh(t,!1)}function ky(t){return vh(t,!0)}function vh(t,e){return Zt(t)?t:new Sy(t,e)}class Sy{constructor(e,s){this.dep=new Fc,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?e:ze(e),this._value=s?e:Ht(e),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(e){const s=this._rawValue,n=this.__v_isShallow||Os(e)||zn(e);e=n?e:ze(e),Gn(e,s)&&(this._rawValue=e,this._value=n?e:Ht(e),this.dep.trigger())}}function Ke(t){return Zt(t)?t.value:t}const Cy={get:(t,e,s)=>e==="__v_raw"?t:Ke(Reflect.get(t,e,s)),set:(t,e,s,n)=>{const r=t[e];return Zt(r)&&!Zt(s)?(r.value=s,!0):Reflect.set(t,e,s,n)}};function bh(t){return Kr(t)?t:new Proxy(t,Cy)}class Iy{constructor(e,s,n){this.fn=e,this.setter=s,this._value=void 0,this.dep=new Fc(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Gi-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&at!==this)return rh(this,!0),!0}get value(){const e=this.dep.track();return ah(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Ry(t,e,s=!1){let n,r;return Ie(t)?n=t:(n=t.get,r=t.set),new Iy(n,r,s)}const Do={},Xo=new WeakMap;let cr;function Dy(t,e=!1,s=cr){if(s){let n=Xo.get(s);n||Xo.set(s,n=[]),n.push(t)}}function xy(t,e,s=rt){const{immediate:n,deep:r,once:i,scheduler:o,augmentJob:l,call:c}=s,u=D=>r?D:Os(D)||r===!1||r===0?yn(D,1):yn(D);let d,f,h,y,T=!1,w=!1;if(Zt(t)?(f=()=>t.value,T=Os(t)):Kr(t)?(f=()=>u(t),T=!0):Ee(t)?(w=!0,T=t.some(D=>Kr(D)||Os(D)),f=()=>t.map(D=>{if(Zt(D))return D.value;if(Kr(D))return u(D);if(Ie(D))return c?c(D,2):D()})):Ie(t)?e?f=c?()=>c(t,2):t:f=()=>{if(h){Pn();try{h()}finally{kn()}}const D=cr;cr=d;try{return c?c(t,3,[y]):t(y)}finally{cr=D}}:f=nn,e&&r){const D=f,Y=r===!0?1/0:r;f=()=>yn(D(),Y)}const k=oy(),C=()=>{d.stop(),k&&k.active&&Nc(k.effects,d)};if(i&&e){const D=e;e=(...Y)=>{D(...Y),C()}}let N=w?new Array(t.length).fill(Do):Do;const L=D=>{if(!(!(d.flags&1)||!d.dirty&&!D))if(e){const Y=d.run();if(r||T||(w?Y.some((W,$)=>Gn(W,N[$])):Gn(Y,N))){h&&h();const W=cr;cr=d;try{const $=[Y,N===Do?void 0:w&&N[0]===Do?[]:N,y];N=Y,c?c(e,3,$):e(...$)}finally{cr=W}}}else d.run()};return l&&l(L),d=new sh(f),d.scheduler=o?()=>o(L,!1):L,y=D=>Dy(D,!1,d),h=d.onStop=()=>{const D=Xo.get(d);if(D){if(c)c(D,4);else for(const Y of D)Y();Xo.delete(d)}},e?n?L(!0):N=d.run():o?o(L.bind(null,!0),!0):d.run(),C.pause=d.pause.bind(d),C.resume=d.resume.bind(d),C.stop=C,C}function yn(t,e=1/0,s){if(e<=0||!it(t)||t.__v_skip||(s=s||new Map,(s.get(t)||0)>=e))return t;if(s.set(t,e),e--,Zt(t))yn(t.value,e,s);else if(Ee(t))for(let n=0;n<t.length;n++)yn(t[n],e,s);else if(pi(t)||Gr(t))t.forEach(n=>{yn(n,e,s)});else if(qf(t)){for(const n in t)yn(t[n],e,s);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&yn(t[n],e,s)}return t}/**
* @vue/runtime-core v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function go(t,e,s,n){try{return n?t(...n):t()}catch(r){Ra(r,e,s)}}function Gs(t,e,s,n){if(Ie(t)){const r=go(t,e,s,n);return r&&Qf(r)&&r.catch(i=>{Ra(i,e,s)}),r}if(Ee(t)){const r=[];for(let i=0;i<t.length;i++)r.push(Gs(t[i],e,s,n));return r}}function Ra(t,e,s,n=!0){const r=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||rt;if(e){let l=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${s}`;for(;l;){const d=l.ec;if(d){for(let f=0;f<d.length;f++)if(d[f](t,c,u)===!1)return}l=l.parent}if(i){Pn(),go(i,null,10,[t,c,u]),kn();return}}Ny(t,s,r,n,o)}function Ny(t,e,s,n=!0,r=!1){if(r)throw t;console.error(t)}const is=[];let Zs=-1;const zr=[];let Vn=null,Fr=0;const wh=Promise.resolve();let ea=null;function zi(t){const e=ea||wh;return t?e.then(this?t.bind(this):t):e}function Ly(t){let e=Zs+1,s=is.length;for(;e<s;){const n=e+s>>>1,r=is[n],i=Qi(r);i<t||i===t&&r.flags&2?e=n+1:s=n}return e}function Hc(t){if(!(t.flags&1)){const e=Qi(t),s=is[is.length-1];!s||!(t.flags&2)&&e>=Qi(s)?is.push(t):is.splice(Ly(e),0,t),t.flags|=1,Ah()}}function Ah(){ea||(ea=wh.then(_h))}function Oy(t){Ee(t)?zr.push(...t):Vn&&t.id===-1?Vn.splice(Fr+1,0,t):t.flags&1||(zr.push(t),t.flags|=1),Ah()}function Iu(t,e,s=Zs+1){for(;s<is.length;s++){const n=is[s];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;is.splice(s,1),s--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Eh(t){if(zr.length){const e=[...new Set(zr)].sort((s,n)=>Qi(s)-Qi(n));if(zr.length=0,Vn){Vn.push(...e);return}for(Vn=e,Fr=0;Fr<Vn.length;Fr++){const s=Vn[Fr];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}Vn=null,Fr=0}}const Qi=t=>t.id==null?t.flags&2?-1:1/0:t.id;function _h(t){try{for(Zs=0;Zs<is.length;Zs++){const e=is[Zs];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),go(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Zs<is.length;Zs++){const e=is[Zs];e&&(e.flags&=-2)}Zs=-1,is.length=0,Eh(),ea=null,(is.length||zr.length)&&_h()}}let Ps=null,Th=null;function ta(t){const e=Ps;return Ps=t,Th=t&&t.type.__scopeId||null,e}function ot(t,e=Ps,s){if(!e||t._n)return t;const n=(...r)=>{n._d&&ra(-1);const i=ta(e);let o;try{o=t(...r)}finally{ta(i),n._d&&ra(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function Pe(t,e){if(Ps===null)return t;const s=Ua(Ps),n=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[i,o,l,c=rt]=e[r];i&&(Ie(i)&&(i={mounted:i,updated:i}),i.deep&&yn(o),n.push({dir:i,instance:s,value:o,oldValue:void 0,arg:l,modifiers:c}))}return t}function nr(t,e,s,n){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const l=r[o];i&&(l.oldValue=i[o].value);let c=l.dir[n];c&&(Pn(),Gs(c,s,8,[t.el,l,t,e]),kn())}}const Uy=Symbol("_vte"),Ph=t=>t.__isTeleport,hn=Symbol("_leaveCb"),xo=Symbol("_enterCb");function By(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return mi(()=>{t.isMounted=!0}),Na(()=>{t.isUnmounting=!0}),t}const Rs=[Function,Array],kh={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Rs,onEnter:Rs,onAfterEnter:Rs,onEnterCancelled:Rs,onBeforeLeave:Rs,onLeave:Rs,onAfterLeave:Rs,onLeaveCancelled:Rs,onBeforeAppear:Rs,onAppear:Rs,onAfterAppear:Rs,onAppearCancelled:Rs},Sh=t=>{const e=t.subTree;return e.component?Sh(e.component):e},My={name:"BaseTransition",props:kh,setup(t,{slots:e}){const s=tp(),n=By();return()=>{const r=e.default&&Rh(e.default(),!0);if(!r||!r.length)return;const i=Ch(r),o=ze(t),{mode:l}=o;if(n.isLeaving)return fl(i);const c=Ru(i);if(!c)return fl(i);let u=Gl(c,o,n,s,f=>u=f);c.type!==as&&Ji(c,u);let d=s.subTree&&Ru(s.subTree);if(d&&d.type!==as&&!dr(d,c)&&Sh(s).type!==as){let f=Gl(d,o,n,s);if(Ji(d,f),l==="out-in"&&c.type!==as)return n.isLeaving=!0,f.afterLeave=()=>{n.isLeaving=!1,s.job.flags&8||s.update(),delete f.afterLeave,d=void 0},fl(i);l==="in-out"&&c.type!==as?f.delayLeave=(h,y,T)=>{const w=Ih(n,d);w[String(d.key)]=d,h[hn]=()=>{y(),h[hn]=void 0,delete u.delayedLeave,d=void 0},u.delayedLeave=()=>{T(),delete u.delayedLeave,d=void 0}}:d=void 0}else d&&(d=void 0);return i}}};function Ch(t){let e=t[0];if(t.length>1){for(const s of t)if(s.type!==as){e=s;break}}return e}const Fy=My;function Ih(t,e){const{leavingVNodes:s}=t;let n=s.get(e.type);return n||(n=Object.create(null),s.set(e.type,n)),n}function Gl(t,e,s,n,r){const{appear:i,mode:o,persisted:l=!1,onBeforeEnter:c,onEnter:u,onAfterEnter:d,onEnterCancelled:f,onBeforeLeave:h,onLeave:y,onAfterLeave:T,onLeaveCancelled:w,onBeforeAppear:k,onAppear:C,onAfterAppear:N,onAppearCancelled:L}=e,D=String(t.key),Y=Ih(s,t),W=(J,re)=>{J&&Gs(J,n,9,re)},$=(J,re)=>{const ce=re[1];W(J,re),Ee(J)?J.every(H=>H.length<=1)&&ce():J.length<=1&&ce()},Q={mode:o,persisted:l,beforeEnter(J){let re=c;if(!s.isMounted)if(i)re=k||c;else return;J[hn]&&J[hn](!0);const ce=Y[D];ce&&dr(t,ce)&&ce.el[hn]&&ce.el[hn](),W(re,[J])},enter(J){let re=u,ce=d,H=f;if(!s.isMounted)if(i)re=C||u,ce=N||d,H=L||f;else return;let we=!1;const Ce=J[xo]=K=>{we||(we=!0,K?W(H,[J]):W(ce,[J]),Q.delayedLeave&&Q.delayedLeave(),J[xo]=void 0)};re?$(re,[J,Ce]):Ce()},leave(J,re){const ce=String(t.key);if(J[xo]&&J[xo](!0),s.isUnmounting)return re();W(h,[J]);let H=!1;const we=J[hn]=Ce=>{H||(H=!0,re(),Ce?W(w,[J]):W(T,[J]),J[hn]=void 0,Y[ce]===t&&delete Y[ce])};Y[ce]=t,y?$(y,[J,we]):we()},clone(J){const re=Gl(J,e,s,n,r);return r&&r(re),re}};return Q}function fl(t){if(Da(t))return t=Qn(t),t.children=null,t}function Ru(t){if(!Da(t))return Ph(t.type)&&t.children?Ch(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:s}=t;if(s){if(e&16)return s[0];if(e&32&&Ie(s.default))return s.default()}}function Ji(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Ji(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Rh(t,e=!1,s){let n=[],r=0;for(let i=0;i<t.length;i++){let o=t[i];const l=s==null?o.key:String(s)+String(o.key!=null?o.key:i);o.type===me?(o.patchFlag&128&&r++,n=n.concat(Rh(o.children,e,l))):(e||o.type!==as)&&n.push(l!=null?Qn(o,{key:l}):o)}if(r>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}function Dh(t,e){return Ie(t)?$t({name:t.name},e,{setup:t}):t}function xh(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}const sa=new WeakMap;function Oi(t,e,s,n,r=!1){if(Ee(t)){t.forEach((T,w)=>Oi(T,e&&(Ee(e)?e[w]:e),s,n,r));return}if(Ui(n)&&!r){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&Oi(t,e,s,n.component.subTree);return}const i=n.shapeFlag&4?Ua(n.component):n.el,o=r?null:i,{i:l,r:c}=t,u=e&&e.r,d=l.refs===rt?l.refs={}:l.refs,f=l.setupState,h=ze(f),y=f===rt?zf:T=>qe(h,T);if(u!=null&&u!==c){if(Du(e),kt(u))d[u]=null,y(u)&&(f[u]=null);else if(Zt(u)){u.value=null;const T=e;T.k&&(d[T.k]=null)}}if(Ie(c))go(c,l,12,[o,d]);else{const T=kt(c),w=Zt(c);if(T||w){const k=()=>{if(t.f){const C=T?y(c)?f[c]:d[c]:c.value;if(r)Ee(C)&&Nc(C,i);else if(Ee(C))C.includes(i)||C.push(i);else if(T)d[c]=[i],y(c)&&(f[c]=d[c]);else{const N=[i];c.value=N,t.k&&(d[t.k]=N)}}else T?(d[c]=o,y(c)&&(f[c]=o)):w&&(c.value=o,t.k&&(d[t.k]=o))};if(o){const C=()=>{k(),sa.delete(t)};C.id=-1,sa.set(t,C),Es(C,s)}else Du(t),k()}}}function Du(t){const e=sa.get(t);e&&(e.flags|=8,sa.delete(t))}Ca().requestIdleCallback;Ca().cancelIdleCallback;const Ui=t=>!!t.type.__asyncLoader,Da=t=>t.type.__isKeepAlive;function Vy(t,e){Nh(t,"a",e)}function $y(t,e){Nh(t,"da",e)}function Nh(t,e,s=qt){const n=t.__wdc||(t.__wdc=()=>{let r=s;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(xa(e,n,s),s){let r=s.parent;for(;r&&r.parent;)Da(r.parent.vnode)&&jy(n,e,s,r),r=r.parent}}function jy(t,e,s,n){const r=xa(e,t,n,!0);Wc(()=>{Nc(n[e],r)},s)}function xa(t,e,s=qt,n=!1){if(s){const r=s[t]||(s[t]=[]),i=e.__weh||(e.__weh=(...o)=>{Pn();const l=yo(s),c=Gs(e,s,t,o);return l(),kn(),c});return n?r.unshift(i):r.push(i),i}}const Rn=t=>(e,s=qt)=>{(!Zi||t==="sp")&&xa(t,(...n)=>e(...n),s)},Hy=Rn("bm"),mi=Rn("m"),Wy=Rn("bu"),Yy=Rn("u"),Na=Rn("bum"),Wc=Rn("um"),Gy=Rn("sp"),Ky=Rn("rtg"),zy=Rn("rtc");function Qy(t,e=qt){xa("ec",t,e)}const Lh="components",Jy="directives";function Bi(t,e){return Oh(Lh,t,!0,e)||t}const qy=Symbol.for("v-ndc");function Zy(t){return Oh(Jy,t)}function Oh(t,e,s=!0,n=!1){const r=Ps||qt;if(r){const i=r.type;if(t===Lh){const l=F0(i,!1);if(l&&(l===e||l===Us(e)||l===Sa(Us(e))))return i}const o=xu(r[t]||i[t],e)||xu(r.appContext[t],e);return!o&&n?i:o}}function xu(t,e){return t&&(t[e]||t[Us(e)]||t[Sa(Us(e))])}function dt(t,e,s,n){let r;const i=s,o=Ee(t);if(o||kt(t)){const l=o&&Kr(t);let c=!1,u=!1;l&&(c=!Os(t),u=zn(t),t=Ia(t)),r=new Array(t.length);for(let d=0,f=t.length;d<f;d++)r[d]=e(c?u?Zo(Ht(t[d])):Ht(t[d]):t[d],d,void 0,i)}else if(typeof t=="number"){r=new Array(t);for(let l=0;l<t;l++)r[l]=e(l+1,l,void 0,i)}else if(it(t))if(t[Symbol.iterator])r=Array.from(t,(l,c)=>e(l,c,void 0,i));else{const l=Object.keys(t);r=new Array(l.length);for(let c=0,u=l.length;c<u;c++){const d=l[c];r[c]=e(t[d],d,c,i)}}else r=[];return r}const Kl=t=>t?sp(t)?Ua(t):Kl(t.parent):null,Mi=$t(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Kl(t.parent),$root:t=>Kl(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Bh(t),$forceUpdate:t=>t.f||(t.f=()=>{Hc(t.update)}),$nextTick:t=>t.n||(t.n=zi.bind(t.proxy)),$watch:t=>b0.bind(t)}),hl=(t,e)=>t!==rt&&!t.__isScriptSetup&&qe(t,e),Xy={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:s,setupState:n,data:r,props:i,accessCache:o,type:l,appContext:c}=t;let u;if(e[0]!=="$"){const y=o[e];if(y!==void 0)switch(y){case 1:return n[e];case 2:return r[e];case 4:return s[e];case 3:return i[e]}else{if(hl(n,e))return o[e]=1,n[e];if(r!==rt&&qe(r,e))return o[e]=2,r[e];if((u=t.propsOptions[0])&&qe(u,e))return o[e]=3,i[e];if(s!==rt&&qe(s,e))return o[e]=4,s[e];zl&&(o[e]=0)}}const d=Mi[e];let f,h;if(d)return e==="$attrs"&&Qt(t.attrs,"get",""),d(t);if((f=l.__cssModules)&&(f=f[e]))return f;if(s!==rt&&qe(s,e))return o[e]=4,s[e];if(h=c.config.globalProperties,qe(h,e))return h[e]},set({_:t},e,s){const{data:n,setupState:r,ctx:i}=t;return hl(r,e)?(r[e]=s,!0):n!==rt&&qe(n,e)?(n[e]=s,!0):qe(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:n,appContext:r,propsOptions:i,type:o}},l){let c,u;return!!(s[l]||t!==rt&&l[0]!=="$"&&qe(t,l)||hl(e,l)||(c=i[0])&&qe(c,l)||qe(n,l)||qe(Mi,l)||qe(r.config.globalProperties,l)||(u=o.__cssModules)&&u[l])},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:qe(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};function Nu(t){return Ee(t)?t.reduce((e,s)=>(e[s]=null,e),{}):t}let zl=!0;function e0(t){const e=Bh(t),s=t.proxy,n=t.ctx;zl=!1,e.beforeCreate&&Lu(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:l,provide:c,inject:u,created:d,beforeMount:f,mounted:h,beforeUpdate:y,updated:T,activated:w,deactivated:k,beforeDestroy:C,beforeUnmount:N,destroyed:L,unmounted:D,render:Y,renderTracked:W,renderTriggered:$,errorCaptured:Q,serverPrefetch:J,expose:re,inheritAttrs:ce,components:H,directives:we,filters:Ce}=e;if(u&&t0(u,n,null),o)for(const ae in o){const ge=o[ae];Ie(ge)&&(n[ae]=ge.bind(s))}if(r){const ae=r.call(s,s);it(ae)&&(t.data=mo(ae))}if(zl=!0,i)for(const ae in i){const ge=i[ae],Re=Ie(ge)?ge.bind(s,s):Ie(ge.get)?ge.get.bind(s,s):nn,Ye=!Ie(ge)&&Ie(ge.set)?ge.set.bind(s):nn,je=Ae({get:Re,set:Ye});Object.defineProperty(n,ae,{enumerable:!0,configurable:!0,get:()=>je.value,set:He=>je.value=He})}if(l)for(const ae in l)Uh(l[ae],n,s,ae);if(c){const ae=Ie(c)?c.call(s):c;Reflect.ownKeys(ae).forEach(ge=>{Wo(ge,ae[ge])})}d&&Lu(d,t,"c");function ee(ae,ge){Ee(ge)?ge.forEach(Re=>ae(Re.bind(s))):ge&&ae(ge.bind(s))}if(ee(Hy,f),ee(mi,h),ee(Wy,y),ee(Yy,T),ee(Vy,w),ee($y,k),ee(Qy,Q),ee(zy,W),ee(Ky,$),ee(Na,N),ee(Wc,D),ee(Gy,J),Ee(re))if(re.length){const ae=t.exposed||(t.exposed={});re.forEach(ge=>{Object.defineProperty(ae,ge,{get:()=>s[ge],set:Re=>s[ge]=Re,enumerable:!0})})}else t.exposed||(t.exposed={});Y&&t.render===nn&&(t.render=Y),ce!=null&&(t.inheritAttrs=ce),H&&(t.components=H),we&&(t.directives=we),J&&xh(t)}function t0(t,e,s=nn){Ee(t)&&(t=Ql(t));for(const n in t){const r=t[n];let i;it(r)?"default"in r?i=rn(r.from||n,r.default,!0):i=rn(r.from||n):i=rn(r),Zt(i)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[n]=i}}function Lu(t,e,s){Gs(Ee(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,s)}function Uh(t,e,s,n){let r=n.includes(".")?Jh(s,n):()=>s[n];if(kt(t)){const i=e[t];Ie(i)&&en(r,i)}else if(Ie(t))en(r,t.bind(s));else if(it(t))if(Ee(t))t.forEach(i=>Uh(i,e,s,n));else{const i=Ie(t.handler)?t.handler.bind(s):e[t.handler];Ie(i)&&en(r,i,t)}}function Bh(t){const e=t.type,{mixins:s,extends:n}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,l=i.get(e);let c;return l?c=l:!r.length&&!s&&!n?c=e:(c={},r.length&&r.forEach(u=>na(c,u,o,!0)),na(c,e,o)),it(e)&&i.set(e,c),c}function na(t,e,s,n=!1){const{mixins:r,extends:i}=e;i&&na(t,i,s,!0),r&&r.forEach(o=>na(t,o,s,!0));for(const o in e)if(!(n&&o==="expose")){const l=s0[o]||s&&s[o];t[o]=l?l(t[o],e[o]):e[o]}return t}const s0={data:Ou,props:Uu,emits:Uu,methods:Ii,computed:Ii,beforeCreate:ss,created:ss,beforeMount:ss,mounted:ss,beforeUpdate:ss,updated:ss,beforeDestroy:ss,beforeUnmount:ss,destroyed:ss,unmounted:ss,activated:ss,deactivated:ss,errorCaptured:ss,serverPrefetch:ss,components:Ii,directives:Ii,watch:r0,provide:Ou,inject:n0};function Ou(t,e){return e?t?function(){return $t(Ie(t)?t.call(this,this):t,Ie(e)?e.call(this,this):e)}:e:t}function n0(t,e){return Ii(Ql(t),Ql(e))}function Ql(t){if(Ee(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function ss(t,e){return t?[...new Set([].concat(t,e))]:e}function Ii(t,e){return t?$t(Object.create(null),t,e):e}function Uu(t,e){return t?Ee(t)&&Ee(e)?[...new Set([...t,...e])]:$t(Object.create(null),Nu(t),Nu(e??{})):e}function r0(t,e){if(!t)return e;if(!e)return t;const s=$t(Object.create(null),t);for(const n in e)s[n]=ss(t[n],e[n]);return s}function Mh(){return{app:null,config:{isNativeTag:zf,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let i0=0;function o0(t,e){return function(n,r=null){Ie(n)||(n=$t({},n)),r!=null&&!it(r)&&(r=null);const i=Mh(),o=new WeakSet,l=[];let c=!1;const u=i.app={_uid:i0++,_component:n,_props:r,_container:null,_context:i,_instance:null,version:$0,get config(){return i.config},set config(d){},use(d,...f){return o.has(d)||(d&&Ie(d.install)?(o.add(d),d.install(u,...f)):Ie(d)&&(o.add(d),d(u,...f))),u},mixin(d){return i.mixins.includes(d)||i.mixins.push(d),u},component(d,f){return f?(i.components[d]=f,u):i.components[d]},directive(d,f){return f?(i.directives[d]=f,u):i.directives[d]},mount(d,f,h){if(!c){const y=u._ceVNode||Me(n,r);return y.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),t(y,d,h),c=!0,u._container=d,d.__vue_app__=u,Ua(y.component)}},onUnmount(d){l.push(d)},unmount(){c&&(Gs(l,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(d,f){return i.provides[d]=f,u},runWithContext(d){const f=Qr;Qr=u;try{return d()}finally{Qr=f}}};return u}}let Qr=null;function Wo(t,e){if(qt){let s=qt.provides;const n=qt.parent&&qt.parent.provides;n===s&&(s=qt.provides=Object.create(n)),s[t]=e}}function rn(t,e,s=!1){const n=tp();if(n||Qr){let r=Qr?Qr._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(r&&t in r)return r[t];if(arguments.length>1)return s&&Ie(e)?e.call(n&&n.proxy):e}}const Fh={},Vh=()=>Object.create(Fh),$h=t=>Object.getPrototypeOf(t)===Fh;function a0(t,e,s,n=!1){const r={},i=Vh();t.propsDefaults=Object.create(null),jh(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);s?t.props=n?r:gh(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function l0(t,e,s,n){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,l=ze(r),[c]=t.propsOptions;let u=!1;if((n||o>0)&&!(o&16)){if(o&8){const d=t.vnode.dynamicProps;for(let f=0;f<d.length;f++){let h=d[f];if(La(t.emitsOptions,h))continue;const y=e[h];if(c)if(qe(i,h))y!==i[h]&&(i[h]=y,u=!0);else{const T=Us(h);r[T]=Jl(c,l,T,y,t,!1)}else y!==i[h]&&(i[h]=y,u=!0)}}}else{jh(t,e,r,i)&&(u=!0);let d;for(const f in l)(!e||!qe(e,f)&&((d=Cr(f))===f||!qe(e,d)))&&(c?s&&(s[f]!==void 0||s[d]!==void 0)&&(r[f]=Jl(c,l,f,void 0,t,!0)):delete r[f]);if(i!==l)for(const f in i)(!e||!qe(e,f))&&(delete i[f],u=!0)}u&&gn(t.attrs,"set","")}function jh(t,e,s,n){const[r,i]=t.propsOptions;let o=!1,l;if(e)for(let c in e){if(xi(c))continue;const u=e[c];let d;r&&qe(r,d=Us(c))?!i||!i.includes(d)?s[d]=u:(l||(l={}))[d]=u:La(t.emitsOptions,c)||(!(c in n)||u!==n[c])&&(n[c]=u,o=!0)}if(i){const c=ze(s),u=l||rt;for(let d=0;d<i.length;d++){const f=i[d];s[f]=Jl(r,c,f,u[f],t,!qe(u,f))}}return o}function Jl(t,e,s,n,r,i){const o=t[s];if(o!=null){const l=qe(o,"default");if(l&&n===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&Ie(c)){const{propsDefaults:u}=r;if(s in u)n=u[s];else{const d=yo(r);n=u[s]=c.call(null,e),d()}}else n=c;r.ce&&r.ce._setProp(s,n)}o[0]&&(i&&!l?n=!1:o[1]&&(n===""||n===Cr(s))&&(n=!0))}return n}const c0=new WeakMap;function Hh(t,e,s=!1){const n=s?c0:e.propsCache,r=n.get(t);if(r)return r;const i=t.props,o={},l=[];let c=!1;if(!Ie(t)){const d=f=>{c=!0;const[h,y]=Hh(f,e,!0);$t(o,h),y&&l.push(...y)};!s&&e.mixins.length&&e.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}if(!i&&!c)return it(t)&&n.set(t,Yr),Yr;if(Ee(i))for(let d=0;d<i.length;d++){const f=Us(i[d]);Bu(f)&&(o[f]=rt)}else if(i)for(const d in i){const f=Us(d);if(Bu(f)){const h=i[d],y=o[f]=Ee(h)||Ie(h)?{type:h}:$t({},h),T=y.type;let w=!1,k=!0;if(Ee(T))for(let C=0;C<T.length;++C){const N=T[C],L=Ie(N)&&N.name;if(L==="Boolean"){w=!0;break}else L==="String"&&(k=!1)}else w=Ie(T)&&T.name==="Boolean";y[0]=w,y[1]=k,(w||qe(y,"default"))&&l.push(f)}}const u=[o,l];return it(t)&&n.set(t,u),u}function Bu(t){return t[0]!=="$"&&!xi(t)}const Yc=t=>t==="_"||t==="_ctx"||t==="$stable",Gc=t=>Ee(t)?t.map(Xs):[Xs(t)],u0=(t,e,s)=>{if(e._n)return e;const n=ot((...r)=>Gc(e(...r)),s);return n._c=!1,n},Wh=(t,e,s)=>{const n=t._ctx;for(const r in t){if(Yc(r))continue;const i=t[r];if(Ie(i))e[r]=u0(r,i,n);else if(i!=null){const o=Gc(i);e[r]=()=>o}}},Yh=(t,e)=>{const s=Gc(e);t.slots.default=()=>s},Gh=(t,e,s)=>{for(const n in e)(s||!Yc(n))&&(t[n]=e[n])},d0=(t,e,s)=>{const n=t.slots=Vh();if(t.vnode.shapeFlag&32){const r=e._;r?(Gh(n,e,s),s&&Zf(n,"_",r,!0)):Wh(e,n)}else e&&Yh(t,e)},f0=(t,e,s)=>{const{vnode:n,slots:r}=t;let i=!0,o=rt;if(n.shapeFlag&32){const l=e._;l?s&&l===1?i=!1:Gh(r,e,s):(i=!e.$stable,Wh(e,r)),o=e}else e&&(Yh(t,e),o={default:1});if(i)for(const l in r)!Yc(l)&&o[l]==null&&delete r[l]},Es=S0;function h0(t){return p0(t)}function p0(t,e){const s=Ca();s.__VUE__=!0;const{insert:n,remove:r,patchProp:i,createElement:o,createText:l,createComment:c,setText:u,setElementText:d,parentNode:f,nextSibling:h,setScopeId:y=nn,insertStaticContent:T}=t,w=(v,_,I,U=null,V=null,M=null,se=void 0,X=null,z=!!_.dynamicChildren)=>{if(v===_)return;v&&!dr(v,_)&&(U=O(v),He(v,V,M,!0),v=null),_.patchFlag===-2&&(z=!1,_.dynamicChildren=null);const{type:G,ref:ye,shapeFlag:ie}=_;switch(G){case Oa:k(v,_,I,U);break;case as:C(v,_,I,U);break;case Yo:v==null&&N(_,I,U,se);break;case me:H(v,_,I,U,V,M,se,X,z);break;default:ie&1?Y(v,_,I,U,V,M,se,X,z):ie&6?we(v,_,I,U,V,M,se,X,z):(ie&64||ie&128)&&G.process(v,_,I,U,V,M,se,X,z,le)}ye!=null&&V?Oi(ye,v&&v.ref,M,_||v,!_):ye==null&&v&&v.ref!=null&&Oi(v.ref,null,M,v,!0)},k=(v,_,I,U)=>{if(v==null)n(_.el=l(_.children),I,U);else{const V=_.el=v.el;_.children!==v.children&&u(V,_.children)}},C=(v,_,I,U)=>{v==null?n(_.el=c(_.children||""),I,U):_.el=v.el},N=(v,_,I,U)=>{[v.el,v.anchor]=T(v.children,_,I,U,v.el,v.anchor)},L=({el:v,anchor:_},I,U)=>{let V;for(;v&&v!==_;)V=h(v),n(v,I,U),v=V;n(_,I,U)},D=({el:v,anchor:_})=>{let I;for(;v&&v!==_;)I=h(v),r(v),v=I;r(_)},Y=(v,_,I,U,V,M,se,X,z)=>{_.type==="svg"?se="svg":_.type==="math"&&(se="mathml"),v==null?W(_,I,U,V,M,se,X,z):J(v,_,V,M,se,X,z)},W=(v,_,I,U,V,M,se,X)=>{let z,G;const{props:ye,shapeFlag:ie,transition:ve,dirs:Te}=v;if(z=v.el=o(v.type,M,ye&&ye.is,ye),ie&8?d(z,v.children):ie&16&&Q(v.children,z,null,U,V,pl(v,M),se,X),Te&&nr(v,null,U,"created"),$(z,v,v.scopeId,se,U),ye){for(const Ge in ye)Ge!=="value"&&!xi(Ge)&&i(z,Ge,null,ye[Ge],M,U);"value"in ye&&i(z,"value",null,ye.value,M),(G=ye.onVnodeBeforeMount)&&Js(G,U,v)}Te&&nr(v,null,U,"beforeMount");const Ue=m0(V,ve);Ue&&ve.beforeEnter(z),n(z,_,I),((G=ye&&ye.onVnodeMounted)||Ue||Te)&&Es(()=>{G&&Js(G,U,v),Ue&&ve.enter(z),Te&&nr(v,null,U,"mounted")},V)},$=(v,_,I,U,V)=>{if(I&&y(v,I),U)for(let M=0;M<U.length;M++)y(v,U[M]);if(V){let M=V.subTree;if(_===M||Zh(M.type)&&(M.ssContent===_||M.ssFallback===_)){const se=V.vnode;$(v,se,se.scopeId,se.slotScopeIds,V.parent)}}},Q=(v,_,I,U,V,M,se,X,z=0)=>{for(let G=z;G<v.length;G++){const ye=v[G]=X?$n(v[G]):Xs(v[G]);w(null,ye,_,I,U,V,M,se,X)}},J=(v,_,I,U,V,M,se)=>{const X=_.el=v.el;let{patchFlag:z,dynamicChildren:G,dirs:ye}=_;z|=v.patchFlag&16;const ie=v.props||rt,ve=_.props||rt;let Te;if(I&&rr(I,!1),(Te=ve.onVnodeBeforeUpdate)&&Js(Te,I,_,v),ye&&nr(_,v,I,"beforeUpdate"),I&&rr(I,!0),(ie.innerHTML&&ve.innerHTML==null||ie.textContent&&ve.textContent==null)&&d(X,""),G?re(v.dynamicChildren,G,X,I,U,pl(_,V),M):se||ge(v,_,X,null,I,U,pl(_,V),M,!1),z>0){if(z&16)ce(X,ie,ve,I,V);else if(z&2&&ie.class!==ve.class&&i(X,"class",null,ve.class,V),z&4&&i(X,"style",ie.style,ve.style,V),z&8){const Ue=_.dynamicProps;for(let Ge=0;Ge<Ue.length;Ge++){const Be=Ue[Ge],Rt=ie[Be],Ot=ve[Be];(Ot!==Rt||Be==="value")&&i(X,Be,Rt,Ot,V,I)}}z&1&&v.children!==_.children&&d(X,_.children)}else!se&&G==null&&ce(X,ie,ve,I,V);((Te=ve.onVnodeUpdated)||ye)&&Es(()=>{Te&&Js(Te,I,_,v),ye&&nr(_,v,I,"updated")},U)},re=(v,_,I,U,V,M,se)=>{for(let X=0;X<_.length;X++){const z=v[X],G=_[X],ye=z.el&&(z.type===me||!dr(z,G)||z.shapeFlag&198)?f(z.el):I;w(z,G,ye,null,U,V,M,se,!0)}},ce=(v,_,I,U,V)=>{if(_!==I){if(_!==rt)for(const M in _)!xi(M)&&!(M in I)&&i(v,M,_[M],null,V,U);for(const M in I){if(xi(M))continue;const se=I[M],X=_[M];se!==X&&M!=="value"&&i(v,M,X,se,V,U)}"value"in I&&i(v,"value",_.value,I.value,V)}},H=(v,_,I,U,V,M,se,X,z)=>{const G=_.el=v?v.el:l(""),ye=_.anchor=v?v.anchor:l("");let{patchFlag:ie,dynamicChildren:ve,slotScopeIds:Te}=_;Te&&(X=X?X.concat(Te):Te),v==null?(n(G,I,U),n(ye,I,U),Q(_.children||[],I,ye,V,M,se,X,z)):ie>0&&ie&64&&ve&&v.dynamicChildren?(re(v.dynamicChildren,ve,I,V,M,se,X),(_.key!=null||V&&_===V.subTree)&&Kh(v,_,!0)):ge(v,_,I,ye,V,M,se,X,z)},we=(v,_,I,U,V,M,se,X,z)=>{_.slotScopeIds=X,v==null?_.shapeFlag&512?V.ctx.activate(_,I,U,se,z):Ce(_,I,U,V,M,se,z):K(v,_,z)},Ce=(v,_,I,U,V,M,se)=>{const X=v.component=L0(v,U,V);if(Da(v)&&(X.ctx.renderer=le),O0(X,!1,se),X.asyncDep){if(V&&V.registerDep(X,ee,se),!v.el){const z=X.subTree=Me(as);C(null,z,_,I),v.placeholder=z.el}}else ee(X,v,_,I,V,M,se)},K=(v,_,I)=>{const U=_.component=v.component;if(P0(v,_,I))if(U.asyncDep&&!U.asyncResolved){ae(U,_,I);return}else U.next=_,U.update();else _.el=v.el,U.vnode=_},ee=(v,_,I,U,V,M,se)=>{const X=()=>{if(v.isMounted){let{next:ie,bu:ve,u:Te,parent:Ue,vnode:Ge}=v;{const es=zh(v);if(es){ie&&(ie.el=Ge.el,ae(v,ie,se)),es.asyncDep.then(()=>{v.isUnmounted||X()});return}}let Be=ie,Rt;rr(v,!1),ie?(ie.el=Ge.el,ae(v,ie,se)):ie=Ge,ve&&Ho(ve),(Rt=ie.props&&ie.props.onVnodeBeforeUpdate)&&Js(Rt,Ue,ie,Ge),rr(v,!0);const Ot=Fu(v),hs=v.subTree;v.subTree=Ot,w(hs,Ot,f(hs.el),O(hs),v,V,M),ie.el=Ot.el,Be===null&&k0(v,Ot.el),Te&&Es(Te,V),(Rt=ie.props&&ie.props.onVnodeUpdated)&&Es(()=>Js(Rt,Ue,ie,Ge),V)}else{let ie;const{el:ve,props:Te}=_,{bm:Ue,m:Ge,parent:Be,root:Rt,type:Ot}=v,hs=Ui(_);rr(v,!1),Ue&&Ho(Ue),!hs&&(ie=Te&&Te.onVnodeBeforeMount)&&Js(ie,Be,_),rr(v,!0);{Rt.ce&&Rt.ce._def.shadowRoot!==!1&&Rt.ce._injectChildStyle(Ot);const es=v.subTree=Fu(v);w(null,es,I,U,v,V,M),_.el=es.el}if(Ge&&Es(Ge,V),!hs&&(ie=Te&&Te.onVnodeMounted)){const es=_;Es(()=>Js(ie,Be,es),V)}(_.shapeFlag&256||Be&&Ui(Be.vnode)&&Be.vnode.shapeFlag&256)&&v.a&&Es(v.a,V),v.isMounted=!0,_=I=U=null}};v.scope.on();const z=v.effect=new sh(X);v.scope.off();const G=v.update=z.run.bind(z),ye=v.job=z.runIfDirty.bind(z);ye.i=v,ye.id=v.uid,z.scheduler=()=>Hc(ye),rr(v,!0),G()},ae=(v,_,I)=>{_.component=v;const U=v.vnode.props;v.vnode=_,v.next=null,l0(v,_.props,U,I),f0(v,_.children,I),Pn(),Iu(v),kn()},ge=(v,_,I,U,V,M,se,X,z=!1)=>{const G=v&&v.children,ye=v?v.shapeFlag:0,ie=_.children,{patchFlag:ve,shapeFlag:Te}=_;if(ve>0){if(ve&128){Ye(G,ie,I,U,V,M,se,X,z);return}else if(ve&256){Re(G,ie,I,U,V,M,se,X,z);return}}Te&8?(ye&16&&st(G,V,M),ie!==G&&d(I,ie)):ye&16?Te&16?Ye(G,ie,I,U,V,M,se,X,z):st(G,V,M,!0):(ye&8&&d(I,""),Te&16&&Q(ie,I,U,V,M,se,X,z))},Re=(v,_,I,U,V,M,se,X,z)=>{v=v||Yr,_=_||Yr;const G=v.length,ye=_.length,ie=Math.min(G,ye);let ve;for(ve=0;ve<ie;ve++){const Te=_[ve]=z?$n(_[ve]):Xs(_[ve]);w(v[ve],Te,I,null,V,M,se,X,z)}G>ye?st(v,V,M,!0,!1,ie):Q(_,I,U,V,M,se,X,z,ie)},Ye=(v,_,I,U,V,M,se,X,z)=>{let G=0;const ye=_.length;let ie=v.length-1,ve=ye-1;for(;G<=ie&&G<=ve;){const Te=v[G],Ue=_[G]=z?$n(_[G]):Xs(_[G]);if(dr(Te,Ue))w(Te,Ue,I,null,V,M,se,X,z);else break;G++}for(;G<=ie&&G<=ve;){const Te=v[ie],Ue=_[ve]=z?$n(_[ve]):Xs(_[ve]);if(dr(Te,Ue))w(Te,Ue,I,null,V,M,se,X,z);else break;ie--,ve--}if(G>ie){if(G<=ve){const Te=ve+1,Ue=Te<ye?_[Te].el:U;for(;G<=ve;)w(null,_[G]=z?$n(_[G]):Xs(_[G]),I,Ue,V,M,se,X,z),G++}}else if(G>ve)for(;G<=ie;)He(v[G],V,M,!0),G++;else{const Te=G,Ue=G,Ge=new Map;for(G=Ue;G<=ve;G++){const Ut=_[G]=z?$n(_[G]):Xs(_[G]);Ut.key!=null&&Ge.set(Ut.key,G)}let Be,Rt=0;const Ot=ve-Ue+1;let hs=!1,es=0;const ps=new Array(Ot);for(G=0;G<Ot;G++)ps[G]=0;for(G=Te;G<=ie;G++){const Ut=v[G];if(Rt>=Ot){He(Ut,V,M,!0);continue}let ms;if(Ut.key!=null)ms=Ge.get(Ut.key);else for(Be=Ue;Be<=ve;Be++)if(ps[Be-Ue]===0&&dr(Ut,_[Be])){ms=Be;break}ms===void 0?He(Ut,V,M,!0):(ps[ms-Ue]=G+1,ms>=es?es=ms:hs=!0,w(Ut,_[ms],I,null,V,M,se,X,z),Rt++)}const er=hs?g0(ps):Yr;for(Be=er.length-1,G=Ot-1;G>=0;G--){const Ut=Ue+G,ms=_[Ut],xr=_[Ut+1],As=Ut+1<ye?xr.el||xr.placeholder:U;ps[G]===0?w(null,ms,I,As,V,M,se,X,z):hs&&(Be<0||G!==er[Be]?je(ms,I,As,2):Be--)}}},je=(v,_,I,U,V=null)=>{const{el:M,type:se,transition:X,children:z,shapeFlag:G}=v;if(G&6){je(v.component.subTree,_,I,U);return}if(G&128){v.suspense.move(_,I,U);return}if(G&64){se.move(v,_,I,le);return}if(se===me){n(M,_,I);for(let ie=0;ie<z.length;ie++)je(z[ie],_,I,U);n(v.anchor,_,I);return}if(se===Yo){L(v,_,I);return}if(U!==2&&G&1&&X)if(U===0)X.beforeEnter(M),n(M,_,I),Es(()=>X.enter(M),V);else{const{leave:ie,delayLeave:ve,afterLeave:Te}=X,Ue=()=>{v.ctx.isUnmounted?r(M):n(M,_,I)},Ge=()=>{M._isLeaving&&M[hn](!0),ie(M,()=>{Ue(),Te&&Te()})};ve?ve(M,Ue,Ge):Ge()}else n(M,_,I)},He=(v,_,I,U=!1,V=!1)=>{const{type:M,props:se,ref:X,children:z,dynamicChildren:G,shapeFlag:ye,patchFlag:ie,dirs:ve,cacheIndex:Te}=v;if(ie===-2&&(V=!1),X!=null&&(Pn(),Oi(X,null,I,v,!0),kn()),Te!=null&&(_.renderCache[Te]=void 0),ye&256){_.ctx.deactivate(v);return}const Ue=ye&1&&ve,Ge=!Ui(v);let Be;if(Ge&&(Be=se&&se.onVnodeBeforeUnmount)&&Js(Be,_,v),ye&6)Et(v.component,I,U);else{if(ye&128){v.suspense.unmount(I,U);return}Ue&&nr(v,null,_,"beforeUnmount"),ye&64?v.type.remove(v,_,I,le,U):G&&!G.hasOnce&&(M!==me||ie>0&&ie&64)?st(G,_,I,!1,!0):(M===me&&ie&384||!V&&ye&16)&&st(z,_,I),U&&St(v)}(Ge&&(Be=se&&se.onVnodeUnmounted)||Ue)&&Es(()=>{Be&&Js(Be,_,v),Ue&&nr(v,null,_,"unmounted")},I)},St=v=>{const{type:_,el:I,anchor:U,transition:V}=v;if(_===me){Xe(I,U);return}if(_===Yo){D(v);return}const M=()=>{r(I),V&&!V.persisted&&V.afterLeave&&V.afterLeave()};if(v.shapeFlag&1&&V&&!V.persisted){const{leave:se,delayLeave:X}=V,z=()=>se(I,M);X?X(v.el,M,z):z()}else M()},Xe=(v,_)=>{let I;for(;v!==_;)I=h(v),r(v),v=I;r(_)},Et=(v,_,I)=>{const{bum:U,scope:V,job:M,subTree:se,um:X,m:z,a:G}=v;Mu(z),Mu(G),U&&Ho(U),V.stop(),M&&(M.flags|=8,He(se,v,_,I)),X&&Es(X,_),Es(()=>{v.isUnmounted=!0},_)},st=(v,_,I,U=!1,V=!1,M=0)=>{for(let se=M;se<v.length;se++)He(v[se],_,I,U,V)},O=v=>{if(v.shapeFlag&6)return O(v.component.subTree);if(v.shapeFlag&128)return v.suspense.next();const _=h(v.anchor||v.el),I=_&&_[Uy];return I?h(I):_};let te=!1;const Z=(v,_,I)=>{v==null?_._vnode&&He(_._vnode,null,null,!0):w(_._vnode||null,v,_,null,null,null,I),_._vnode=v,te||(te=!0,Iu(),Eh(),te=!1)},le={p:w,um:He,m:je,r:St,mt:Ce,mc:Q,pc:ge,pbc:re,n:O,o:t};return{render:Z,hydrate:void 0,createApp:o0(Z)}}function pl({type:t,props:e},s){return s==="svg"&&t==="foreignObject"||s==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:s}function rr({effect:t,job:e},s){s?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function m0(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Kh(t,e,s=!1){const n=t.children,r=e.children;if(Ee(n)&&Ee(r))for(let i=0;i<n.length;i++){const o=n[i];let l=r[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=r[i]=$n(r[i]),l.el=o.el),!s&&l.patchFlag!==-2&&Kh(o,l)),l.type===Oa&&l.patchFlag!==-1&&(l.el=o.el),l.type===as&&!l.el&&(l.el=o.el)}}function g0(t){const e=t.slice(),s=[0];let n,r,i,o,l;const c=t.length;for(n=0;n<c;n++){const u=t[n];if(u!==0){if(r=s[s.length-1],t[r]<u){e[n]=r,s.push(n);continue}for(i=0,o=s.length-1;i<o;)l=i+o>>1,t[s[l]]<u?i=l+1:o=l;u<t[s[i]]&&(i>0&&(e[n]=s[i-1]),s[i]=n)}}for(i=s.length,o=s[i-1];i-- >0;)s[i]=o,o=e[o];return s}function zh(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:zh(e)}function Mu(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const y0=Symbol.for("v-scx"),v0=()=>rn(y0);function en(t,e,s){return Qh(t,e,s)}function Qh(t,e,s=rt){const{immediate:n,deep:r,flush:i,once:o}=s,l=$t({},s),c=e&&n||!e&&i!=="post";let u;if(Zi){if(i==="sync"){const y=v0();u=y.__watcherHandles||(y.__watcherHandles=[])}else if(!c){const y=()=>{};return y.stop=nn,y.resume=nn,y.pause=nn,y}}const d=qt;l.call=(y,T,w)=>Gs(y,d,T,w);let f=!1;i==="post"?l.scheduler=y=>{Es(y,d&&d.suspense)}:i!=="sync"&&(f=!0,l.scheduler=(y,T)=>{T?y():Hc(y)}),l.augmentJob=y=>{e&&(y.flags|=4),f&&(y.flags|=2,d&&(y.id=d.uid,y.i=d))};const h=xy(t,e,l);return Zi&&(u?u.push(h):c&&h()),h}function b0(t,e,s){const n=this.proxy,r=kt(t)?t.includes(".")?Jh(n,t):()=>n[t]:t.bind(n,n);let i;Ie(e)?i=e:(i=e.handler,s=e);const o=yo(this),l=Qh(r,i.bind(n),s);return o(),l}function Jh(t,e){const s=e.split(".");return()=>{let n=t;for(let r=0;r<s.length&&n;r++)n=n[s[r]];return n}}const w0=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Us(e)}Modifiers`]||t[`${Cr(e)}Modifiers`];function A0(t,e,...s){if(t.isUnmounted)return;const n=t.vnode.props||rt;let r=s;const i=e.startsWith("update:"),o=i&&w0(n,e.slice(7));o&&(o.trim&&(r=s.map(d=>kt(d)?d.trim():d)),o.number&&(r=s.map(qo)));let l,c=n[l=al(e)]||n[l=al(Us(e))];!c&&i&&(c=n[l=al(Cr(e))]),c&&Gs(c,t,6,r);const u=n[l+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[l])return;t.emitted[l]=!0,Gs(u,t,6,r)}}const E0=new WeakMap;function qh(t,e,s=!1){const n=s?E0:e.emitsCache,r=n.get(t);if(r!==void 0)return r;const i=t.emits;let o={},l=!1;if(!Ie(t)){const c=u=>{const d=qh(u,e,!0);d&&(l=!0,$t(o,d))};!s&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!l?(it(t)&&n.set(t,null),null):(Ee(i)?i.forEach(c=>o[c]=null):$t(o,i),it(t)&&n.set(t,o),o)}function La(t,e){return!t||!Pa(e)?!1:(e=e.slice(2).replace(/Once$/,""),qe(t,e[0].toLowerCase()+e.slice(1))||qe(t,Cr(e))||qe(t,e))}function Fu(t){const{type:e,vnode:s,proxy:n,withProxy:r,propsOptions:[i],slots:o,attrs:l,emit:c,render:u,renderCache:d,props:f,data:h,setupState:y,ctx:T,inheritAttrs:w}=t,k=ta(t);let C,N;try{if(s.shapeFlag&4){const D=r||n,Y=D;C=Xs(u.call(Y,D,d,f,y,h,T)),N=l}else{const D=e;C=Xs(D.length>1?D(f,{attrs:l,slots:o,emit:c}):D(f,null)),N=e.props?l:_0(l)}}catch(D){Fi.length=0,Ra(D,t,1),C=Me(as)}let L=C;if(N&&w!==!1){const D=Object.keys(N),{shapeFlag:Y}=L;D.length&&Y&7&&(i&&D.some(xc)&&(N=T0(N,i)),L=Qn(L,N,!1,!0))}return s.dirs&&(L=Qn(L,null,!1,!0),L.dirs=L.dirs?L.dirs.concat(s.dirs):s.dirs),s.transition&&Ji(L,s.transition),C=L,ta(k),C}const _0=t=>{let e;for(const s in t)(s==="class"||s==="style"||Pa(s))&&((e||(e={}))[s]=t[s]);return e},T0=(t,e)=>{const s={};for(const n in t)(!xc(n)||!(n.slice(9)in e))&&(s[n]=t[n]);return s};function P0(t,e,s){const{props:n,children:r,component:i}=t,{props:o,children:l,patchFlag:c}=e,u=i.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&c>=0){if(c&1024)return!0;if(c&16)return n?Vu(n,o,u):!!o;if(c&8){const d=e.dynamicProps;for(let f=0;f<d.length;f++){const h=d[f];if(o[h]!==n[h]&&!La(u,h))return!0}}}else return(r||l)&&(!l||!l.$stable)?!0:n===o?!1:n?o?Vu(n,o,u):!0:!!o;return!1}function Vu(t,e,s){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let r=0;r<n.length;r++){const i=n[r];if(e[i]!==t[i]&&!La(s,i))return!0}return!1}function k0({vnode:t,parent:e},s){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=s,e=e.parent;else break}}const Zh=t=>t.__isSuspense;function S0(t,e){e&&e.pendingBranch?Ee(t)?e.effects.push(...t):e.effects.push(t):Oy(t)}const me=Symbol.for("v-fgt"),Oa=Symbol.for("v-txt"),as=Symbol.for("v-cmt"),Yo=Symbol.for("v-stc"),Fi=[];let ks=null;function m(t=!1){Fi.push(ks=t?null:[])}function C0(){Fi.pop(),ks=Fi[Fi.length-1]||null}let qi=1;function ra(t,e=!1){qi+=t,t<0&&ks&&e&&(ks.hasOnce=!0)}function Xh(t){return t.dynamicChildren=qi>0?ks||Yr:null,C0(),qi>0&&ks&&ks.push(t),t}function g(t,e,s,n,r,i){return Xh(a(t,e,s,n,r,i,!0))}function ia(t,e,s,n,r){return Xh(Me(t,e,s,n,r,!0))}function oa(t){return t?t.__v_isVNode===!0:!1}function dr(t,e){return t.type===e.type&&t.key===e.key}const ep=({key:t})=>t??null,Go=({ref:t,ref_key:e,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?kt(t)||Zt(t)||Ie(t)?{i:Ps,r:t,k:e,f:!!s}:t:null);function a(t,e=null,s=null,n=0,r=null,i=t===me?0:1,o=!1,l=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&ep(e),ref:e&&Go(e),scopeId:Th,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:Ps};return l?(Kc(c,s),i&128&&t.normalize(c)):s&&(c.shapeFlag|=kt(s)?8:16),qi>0&&!o&&ks&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&ks.push(c),c}const Me=I0;function I0(t,e=null,s=null,n=0,r=null,i=!1){if((!t||t===qy)&&(t=as),oa(t)){const l=Qn(t,e,!0);return s&&Kc(l,s),qi>0&&!i&&ks&&(l.shapeFlag&6?ks[ks.indexOf(t)]=l:ks.push(l)),l.patchFlag=-2,l}if(V0(t)&&(t=t.__vccOpts),e){e=R0(e);let{class:l,style:c}=e;l&&!kt(l)&&(e.class=be(l)),it(c)&&(jc(c)&&!Ee(c)&&(c=$t({},c)),e.style=xt(c))}const o=kt(t)?1:Zh(t)?128:Ph(t)?64:it(t)?4:Ie(t)?2:0;return a(t,e,s,n,r,o,i,!0)}function R0(t){return t?jc(t)||$h(t)?$t({},t):t:null}function Qn(t,e,s=!1,n=!1){const{props:r,ref:i,patchFlag:o,children:l,transition:c}=t,u=e?D0(r||{},e):r,d={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&ep(u),ref:e&&e.ref?s&&i?Ee(i)?i.concat(Go(e)):[i,Go(e)]:Go(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==me?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Qn(t.ssContent),ssFallback:t.ssFallback&&Qn(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&n&&Ji(d,c.clone(d)),d}function ne(t=" ",e=0){return Me(Oa,null,t,e)}function Nt(t,e){const s=Me(Yo,null,t);return s.staticCount=e,s}function B(t="",e=!1){return e?(m(),ia(as,null,t)):Me(as,null,t)}function Xs(t){return t==null||typeof t=="boolean"?Me(as):Ee(t)?Me(me,null,t.slice()):oa(t)?$n(t):Me(Oa,null,String(t))}function $n(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Qn(t)}function Kc(t,e){let s=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(Ee(e))s=16;else if(typeof e=="object")if(n&65){const r=e.default;r&&(r._c&&(r._d=!1),Kc(t,r()),r._c&&(r._d=!0));return}else{s=32;const r=e._;!r&&!$h(e)?e._ctx=Ps:r===3&&Ps&&(Ps.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Ie(e)?(e={default:e,_ctx:Ps},s=32):(e=String(e),n&64?(s=16,e=[ne(e)]):s=8);t.children=e,t.shapeFlag|=s}function D0(...t){const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const r in n)if(r==="class")e.class!==n.class&&(e.class=be([e.class,n.class]));else if(r==="style")e.style=xt([e.style,n.style]);else if(Pa(r)){const i=e[r],o=n[r];o&&i!==o&&!(Ee(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=n[r])}return e}function Js(t,e,s,n=null){Gs(t,e,7,[s,n])}const x0=Mh();let N0=0;function L0(t,e,s){const n=t.type,r=(e?e.appContext:t.appContext)||x0,i={uid:N0++,vnode:t,type:n,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new iy(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Hh(n,r),emitsOptions:qh(n,r),emit:null,emitted:null,propsDefaults:rt,inheritAttrs:n.inheritAttrs,ctx:rt,data:rt,props:rt,attrs:rt,slots:rt,refs:rt,setupState:rt,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=A0.bind(null,i),t.ce&&t.ce(i),i}let qt=null;const tp=()=>qt||Ps;let aa,ql;{const t=Ca(),e=(s,n)=>{let r;return(r=t[s])||(r=t[s]=[]),r.push(n),i=>{r.length>1?r.forEach(o=>o(i)):r[0](i)}};aa=e("__VUE_INSTANCE_SETTERS__",s=>qt=s),ql=e("__VUE_SSR_SETTERS__",s=>Zi=s)}const yo=t=>{const e=qt;return aa(t),t.scope.on(),()=>{t.scope.off(),aa(e)}},$u=()=>{qt&&qt.scope.off(),aa(null)};function sp(t){return t.vnode.shapeFlag&4}let Zi=!1;function O0(t,e=!1,s=!1){e&&ql(e);const{props:n,children:r}=t.vnode,i=sp(t);a0(t,n,i,e),d0(t,r,s||e);const o=i?U0(t,e):void 0;return e&&ql(!1),o}function U0(t,e){const s=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Xy);const{setup:n}=s;if(n){Pn();const r=t.setupContext=n.length>1?M0(t):null,i=yo(t),o=go(n,t,0,[t.props,r]),l=Qf(o);if(kn(),i(),(l||t.sp)&&!Ui(t)&&xh(t),l){if(o.then($u,$u),e)return o.then(c=>{ju(t,c)}).catch(c=>{Ra(c,t,0)});t.asyncDep=o}else ju(t,o)}else np(t)}function ju(t,e,s){Ie(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:it(e)&&(t.setupState=bh(e)),np(t)}function np(t,e,s){const n=t.type;t.render||(t.render=n.render||nn);{const r=yo(t);Pn();try{e0(t)}finally{kn(),r()}}}const B0={get(t,e){return Qt(t,"get",""),t[e]}};function M0(t){const e=s=>{t.exposed=s||{}};return{attrs:new Proxy(t.attrs,B0),slots:t.slots,emit:t.emit,expose:e}}function Ua(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(bh(Py(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in Mi)return Mi[s](t)},has(e,s){return s in e||s in Mi}})):t.proxy}function F0(t,e=!0){return Ie(t)?t.displayName||t.name:t.name||e&&t.__name}function V0(t){return Ie(t)&&"__vccOpts"in t}const Ae=(t,e)=>Ry(t,e,Zi);function zc(t,e,s){const n=(i,o,l)=>{ra(-1);try{return Me(i,o,l)}finally{ra(1)}},r=arguments.length;return r===2?it(e)&&!Ee(e)?oa(e)?n(t,null,[e]):n(t,e):n(t,null,e):(r>3?s=Array.prototype.slice.call(arguments,2):r===3&&oa(s)&&(s=[s]),n(t,e,s))}const $0="3.5.21";/**
* @vue/runtime-dom v3.5.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Zl;const Hu=typeof window<"u"&&window.trustedTypes;if(Hu)try{Zl=Hu.createPolicy("vue",{createHTML:t=>t})}catch{}const rp=Zl?t=>Zl.createHTML(t):t=>t,j0="http://www.w3.org/2000/svg",H0="http://www.w3.org/1998/Math/MathML",dn=typeof document<"u"?document:null,Wu=dn&&dn.createElement("template"),W0={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,n)=>{const r=e==="svg"?dn.createElementNS(j0,t):e==="mathml"?dn.createElementNS(H0,t):s?dn.createElement(t,{is:s}):dn.createElement(t);return t==="select"&&n&&n.multiple!=null&&r.setAttribute("multiple",n.multiple),r},createText:t=>dn.createTextNode(t),createComment:t=>dn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>dn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,s,n,r,i){const o=s?s.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),s),!(r===i||!(r=r.nextSibling)););else{Wu.innerHTML=rp(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const l=Wu.content;if(n==="svg"||n==="mathml"){const c=l.firstChild;for(;c.firstChild;)l.appendChild(c.firstChild);l.removeChild(c)}e.insertBefore(l,s)}return[o?o.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},Nn="transition",Ei="animation",Xi=Symbol("_vtc"),ip={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Y0=$t({},kh,ip),G0=t=>(t.displayName="Transition",t.props=Y0,t),K0=G0((t,{slots:e})=>zc(Fy,z0(t),e)),ir=(t,e=[])=>{Ee(t)?t.forEach(s=>s(...e)):t&&t(...e)},Yu=t=>t?Ee(t)?t.some(e=>e.length>1):t.length>1:!1;function z0(t){const e={};for(const H in t)H in ip||(e[H]=t[H]);if(t.css===!1)return e;const{name:s="v",type:n,duration:r,enterFromClass:i=`${s}-enter-from`,enterActiveClass:o=`${s}-enter-active`,enterToClass:l=`${s}-enter-to`,appearFromClass:c=i,appearActiveClass:u=o,appearToClass:d=l,leaveFromClass:f=`${s}-leave-from`,leaveActiveClass:h=`${s}-leave-active`,leaveToClass:y=`${s}-leave-to`}=t,T=Q0(r),w=T&&T[0],k=T&&T[1],{onBeforeEnter:C,onEnter:N,onEnterCancelled:L,onLeave:D,onLeaveCancelled:Y,onBeforeAppear:W=C,onAppear:$=N,onAppearCancelled:Q=L}=e,J=(H,we,Ce,K)=>{H._enterCancelled=K,or(H,we?d:l),or(H,we?u:o),Ce&&Ce()},re=(H,we)=>{H._isLeaving=!1,or(H,f),or(H,y),or(H,h),we&&we()},ce=H=>(we,Ce)=>{const K=H?$:N,ee=()=>J(we,H,Ce);ir(K,[we,ee]),Gu(()=>{or(we,H?c:i),cn(we,H?d:l),Yu(K)||Ku(we,n,w,ee)})};return $t(e,{onBeforeEnter(H){ir(C,[H]),cn(H,i),cn(H,o)},onBeforeAppear(H){ir(W,[H]),cn(H,c),cn(H,u)},onEnter:ce(!1),onAppear:ce(!0),onLeave(H,we){H._isLeaving=!0;const Ce=()=>re(H,we);cn(H,f),H._enterCancelled?(cn(H,h),Ju()):(Ju(),cn(H,h)),Gu(()=>{H._isLeaving&&(or(H,f),cn(H,y),Yu(D)||Ku(H,n,k,Ce))}),ir(D,[H,Ce])},onEnterCancelled(H){J(H,!1,void 0,!0),ir(L,[H])},onAppearCancelled(H){J(H,!0,void 0,!0),ir(Q,[H])},onLeaveCancelled(H){re(H),ir(Y,[H])}})}function Q0(t){if(t==null)return null;if(it(t))return[ml(t.enter),ml(t.leave)];{const e=ml(t);return[e,e]}}function ml(t){return qg(t)}function cn(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.add(s)),(t[Xi]||(t[Xi]=new Set)).add(e)}function or(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const s=t[Xi];s&&(s.delete(e),s.size||(t[Xi]=void 0))}function Gu(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let J0=0;function Ku(t,e,s,n){const r=t._endId=++J0,i=()=>{r===t._endId&&n()};if(s!=null)return setTimeout(i,s);const{type:o,timeout:l,propCount:c}=q0(t,e);if(!o)return n();const u=o+"end";let d=0;const f=()=>{t.removeEventListener(u,h),i()},h=y=>{y.target===t&&++d>=c&&f()};setTimeout(()=>{d<c&&f()},l+1),t.addEventListener(u,h)}function q0(t,e){const s=window.getComputedStyle(t),n=T=>(s[T]||"").split(", "),r=n(`${Nn}Delay`),i=n(`${Nn}Duration`),o=zu(r,i),l=n(`${Ei}Delay`),c=n(`${Ei}Duration`),u=zu(l,c);let d=null,f=0,h=0;e===Nn?o>0&&(d=Nn,f=o,h=i.length):e===Ei?u>0&&(d=Ei,f=u,h=c.length):(f=Math.max(o,u),d=f>0?o>u?Nn:Ei:null,h=d?d===Nn?i.length:c.length:0);const y=d===Nn&&/\b(?:transform|all)(?:,|$)/.test(n(`${Nn}Property`).toString());return{type:d,timeout:f,propCount:h,hasTransform:y}}function zu(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((s,n)=>Qu(s)+Qu(t[n])))}function Qu(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function Ju(){return document.body.offsetHeight}function Z0(t,e,s){const n=t[Xi];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}const la=Symbol("_vod"),op=Symbol("_vsh"),X0={name:"show",beforeMount(t,{value:e},{transition:s}){t[la]=t.style.display==="none"?"":t.style.display,s&&e?s.beforeEnter(t):_i(t,e)},mounted(t,{value:e},{transition:s}){s&&e&&s.enter(t)},updated(t,{value:e,oldValue:s},{transition:n}){!e!=!s&&(n?e?(n.beforeEnter(t),_i(t,!0),n.enter(t)):n.leave(t,()=>{_i(t,!1)}):_i(t,e))},beforeUnmount(t,{value:e}){_i(t,e)}};function _i(t,e){t.style.display=e?t[la]:"none",t[op]=!e}const ev=Symbol(""),tv=/(?:^|;)\s*display\s*:/;function sv(t,e,s){const n=t.style,r=kt(s);let i=!1;if(s&&!r){if(e)if(kt(e))for(const o of e.split(";")){const l=o.slice(0,o.indexOf(":")).trim();s[l]==null&&Ko(n,l,"")}else for(const o in e)s[o]==null&&Ko(n,o,"");for(const o in s)o==="display"&&(i=!0),Ko(n,o,s[o])}else if(r){if(e!==s){const o=n[ev];o&&(s+=";"+o),n.cssText=s,i=tv.test(s)}}else e&&t.removeAttribute("style");la in t&&(t[la]=i?n.display:"",t[op]&&(n.display="none"))}const qu=/\s*!important$/;function Ko(t,e,s){if(Ee(s))s.forEach(n=>Ko(t,e,n));else if(s==null&&(s=""),e.startsWith("--"))t.setProperty(e,s);else{const n=nv(t,e);qu.test(s)?t.setProperty(Cr(n),s.replace(qu,""),"important"):t[n]=s}}const Zu=["Webkit","Moz","ms"],gl={};function nv(t,e){const s=gl[e];if(s)return s;let n=Us(e);if(n!=="filter"&&n in t)return gl[e]=n;n=Sa(n);for(let r=0;r<Zu.length;r++){const i=Zu[r]+n;if(i in t)return gl[e]=i}return e}const Xu="http://www.w3.org/1999/xlink";function ed(t,e,s,n,r,i=ny(e)){n&&e.startsWith("xlink:")?s==null?t.removeAttributeNS(Xu,e.slice(6,e.length)):t.setAttributeNS(Xu,e,s):s==null||i&&!Xf(s)?t.removeAttribute(e):t.setAttribute(e,i?"":on(s)?String(s):s)}function td(t,e,s,n,r){if(e==="innerHTML"||e==="textContent"){s!=null&&(t[e]=e==="innerHTML"?rp(s):s);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const l=i==="OPTION"?t.getAttribute("value")||"":t.value,c=s==null?t.type==="checkbox"?"on":"":String(s);(l!==c||!("_value"in t))&&(t.value=c),s==null&&t.removeAttribute(e),t._value=s;return}let o=!1;if(s===""||s==null){const l=typeof t[e];l==="boolean"?s=Xf(s):s==null&&l==="string"?(s="",o=!0):l==="number"&&(s=0,o=!0)}try{t[e]=s}catch{}o&&t.removeAttribute(r||e)}function Hn(t,e,s,n){t.addEventListener(e,s,n)}function rv(t,e,s,n){t.removeEventListener(e,s,n)}const sd=Symbol("_vei");function iv(t,e,s,n,r=null){const i=t[sd]||(t[sd]={}),o=i[e];if(n&&o)o.value=n;else{const[l,c]=ov(e);if(n){const u=i[e]=cv(n,r);Hn(t,l,u,c)}else o&&(rv(t,l,o,c),i[e]=void 0)}}const nd=/(?:Once|Passive|Capture)$/;function ov(t){let e;if(nd.test(t)){e={};let n;for(;n=t.match(nd);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Cr(t.slice(2)),e]}let yl=0;const av=Promise.resolve(),lv=()=>yl||(av.then(()=>yl=0),yl=Date.now());function cv(t,e){const s=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=s.attached)return;Gs(uv(n,s.value),e,5,[n])};return s.value=t,s.attached=lv(),s}function uv(t,e){if(Ee(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(n=>r=>!r._stopped&&n&&n(r))}else return e}const rd=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,dv=(t,e,s,n,r,i)=>{const o=r==="svg";e==="class"?Z0(t,n,o):e==="style"?sv(t,s,n):Pa(e)?xc(e)||iv(t,e,s,n,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):fv(t,e,n,o))?(td(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&ed(t,e,n,o,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!kt(n))?td(t,Us(e),n,i,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),ed(t,e,n,o))};function fv(t,e,s,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&rd(e)&&Ie(s));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return rd(e)&&kt(s)?!1:e in t}const ti=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Ee(e)?s=>Ho(e,s):e};function hv(t){t.target.composing=!0}function id(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const En=Symbol("_assign"),Ze={created(t,{modifiers:{lazy:e,trim:s,number:n}},r){t[En]=ti(r);const i=n||r.props&&r.props.type==="number";Hn(t,e?"change":"input",o=>{if(o.target.composing)return;let l=t.value;s&&(l=l.trim()),i&&(l=qo(l)),t[En](l)}),s&&Hn(t,"change",()=>{t.value=t.value.trim()}),e||(Hn(t,"compositionstart",hv),Hn(t,"compositionend",id),Hn(t,"change",id))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:s,modifiers:{lazy:n,trim:r,number:i}},o){if(t[En]=ti(o),t.composing)return;const l=(i||t.type==="number")&&!/^0\d/.test(t.value)?qo(t.value):t.value,c=e??"";l!==c&&(document.activeElement===t&&t.type!=="range"&&(n&&e===s||r&&t.value.trim()===c)||(t.value=c))}},Xl={deep:!0,created(t,e,s){t[En]=ti(s),Hn(t,"change",()=>{const n=t._modelValue,r=eo(t),i=t.checked,o=t[En];if(Ee(n)){const l=Oc(n,r),c=l!==-1;if(i&&!c)o(n.concat(r));else if(!i&&c){const u=[...n];u.splice(l,1),o(u)}}else if(pi(n)){const l=new Set(n);i?l.add(r):l.delete(r),o(l)}else o(ap(t,i))})},mounted:od,beforeUpdate(t,e,s){t[En]=ti(s),od(t,e,s)}};function od(t,{value:e,oldValue:s},n){t._modelValue=e;let r;if(Ee(e))r=Oc(e,n.props.value)>-1;else if(pi(e))r=e.has(n.props.value);else{if(e===s)return;r=po(e,ap(t,!0))}t.checked!==r&&(t.checked=r)}const bs={deep:!0,created(t,{value:e,modifiers:{number:s}},n){const r=pi(e);Hn(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>s?qo(eo(o)):eo(o));t[En](t.multiple?r?new Set(i):i:i[0]),t._assigning=!0,zi(()=>{t._assigning=!1})}),t[En]=ti(n)},mounted(t,{value:e}){ad(t,e)},beforeUpdate(t,e,s){t[En]=ti(s)},updated(t,{value:e}){t._assigning||ad(t,e)}};function ad(t,e){const s=t.multiple,n=Ee(e);if(!(s&&!n&&!pi(e))){for(let r=0,i=t.options.length;r<i;r++){const o=t.options[r],l=eo(o);if(s)if(n){const c=typeof l;c==="string"||c==="number"?o.selected=e.some(u=>String(u)===String(l)):o.selected=Oc(e,l)>-1}else o.selected=e.has(l);else if(po(eo(o),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!s&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function eo(t){return"_value"in t?t._value:t.value}function ap(t,e){const s=e?"_trueValue":"_falseValue";return s in t?t[s]:e}const pv=["ctrl","shift","alt","meta"],mv={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>pv.some(s=>t[`${s}Key`]&&!e.includes(s))},ue=(t,e)=>{const s=t._withMods||(t._withMods={}),n=e.join(".");return s[n]||(s[n]=((r,...i)=>{for(let o=0;o<e.length;o++){const l=mv[e[o]];if(l&&l(r,e))return}return t(r,...i)}))},gv=$t({patchProp:dv},W0);let ld;function yv(){return ld||(ld=h0(gv))}const vv=((...t)=>{const e=yv().createApp(...t),{mount:s}=e;return e.mount=n=>{const r=wv(n);if(!r)return;const i=e._component;!Ie(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.nodeType===1&&(r.textContent="");const o=s(r,!1,bv(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e});function bv(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function wv(t){return kt(t)?document.querySelector(t):t}const lp="auth-changed";function Av(){localStorage.removeItem("token"),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("remember_email"),window.dispatchEvent(new Event(lp))}function mr(){return localStorage.getItem("isLoggedIn")==="true"}const cd=lp,Ev="6.15.0";function _v(t,e,s){const n=e.split("|").map(i=>i.trim());for(let i=0;i<n.length;i++)switch(e){case"any":return;case"bigint":case"boolean":case"number":case"string":if(typeof t===e)return}const r=new Error(`invalid value for type ${e}`);throw r.code="INVALID_ARGUMENT",r.argument=`value.${s}`,r.value=t,r}async function rs(t){const e=Object.keys(t);return(await Promise.all(e.map(n=>Promise.resolve(t[n])))).reduce((n,r,i)=>(n[e[i]]=r,n),{})}function _e(t,e,s){for(let n in e){let r=e[n];const i=s?s[n]:null;i&&_v(r,i,n),Object.defineProperty(t,n,{enumerable:!0,value:r,writable:!1})}}function jr(t,e){if(t==null)return"null";if(e==null&&(e=new Set),typeof t=="object"){if(e.has(t))return"[Circular]";e.add(t)}if(Array.isArray(t))return"[ "+t.map(s=>jr(s,e)).join(", ")+" ]";if(t instanceof Uint8Array){const s="0123456789abcdef";let n="0x";for(let r=0;r<t.length;r++)n+=s[t[r]>>4],n+=s[t[r]&15];return n}if(typeof t=="object"&&typeof t.toJSON=="function")return jr(t.toJSON(),e);switch(typeof t){case"boolean":case"number":case"symbol":return t.toString();case"bigint":return BigInt(t).toString();case"string":return JSON.stringify(t);case"object":{const s=Object.keys(t);return s.sort(),"{ "+s.map(n=>`${jr(n,e)}: ${jr(t[n],e)}`).join(", ")+" }"}}return"[ COULD NOT SERIALIZE ]"}function Gt(t,e){return t&&t.code===e}function Qc(t){return Gt(t,"CALL_EXCEPTION")}function ht(t,e,s){let n=t;{const i=[];if(s){if("message"in s||"code"in s||"name"in s)throw new Error(`value will overwrite populated values: ${jr(s)}`);for(const o in s){if(o==="shortMessage")continue;const l=s[o];i.push(o+"="+jr(l))}}i.push(`code=${e}`),i.push(`version=${Ev}`),i.length&&(t+=" ("+i.join(", ")+")")}let r;switch(e){case"INVALID_ARGUMENT":r=new TypeError(t);break;case"NUMERIC_FAULT":case"BUFFER_OVERRUN":r=new RangeError(t);break;default:r=new Error(t)}return _e(r,{code:e}),s&&Object.assign(r,s),r.shortMessage==null&&_e(r,{shortMessage:n}),r}function j(t,e,s,n){if(!t)throw ht(e,s,n)}function P(t,e,s,n){j(t,e,"INVALID_ARGUMENT",{argument:s,value:n})}function cp(t,e,s){s==null&&(s=""),s&&(s=": "+s),j(t>=e,"missing argument"+s,"MISSING_ARGUMENT",{count:t,expectedCount:e}),j(t<=e,"too many arguments"+s,"UNEXPECTED_ARGUMENT",{count:t,expectedCount:e})}["NFD","NFC","NFKD","NFKC"].reduce((t,e)=>{try{if("test".normalize(e)!=="test")throw new Error("bad");if(e==="NFD"&&"é".normalize("NFD")!=="é")throw new Error("broken");t.push(e)}catch{}return t},[]);function vo(t,e,s){if(s==null&&(s=""),t!==e){let n=s,r="new";s&&(n+=".",r+=" "+s),j(!1,`private constructor; use ${n}from* methods`,"UNSUPPORTED_OPERATION",{operation:r})}}function up(t,e,s){if(t instanceof Uint8Array)return s?new Uint8Array(t):t;if(typeof t=="string"&&t.match(/^0x(?:[0-9a-f][0-9a-f])*$/i)){const n=new Uint8Array((t.length-2)/2);let r=2;for(let i=0;i<n.length;i++)n[i]=parseInt(t.substring(r,r+2),16),r+=2;return n}P(!1,"invalid BytesLike value",e||"value",t)}function Oe(t,e){return up(t,e,!1)}function ls(t,e){return up(t,e,!0)}function ct(t,e){return!(typeof t!="string"||!t.match(/^0x[0-9A-Fa-f]*$/)||typeof e=="number"&&t.length!==2+2*e||e===!0&&t.length%2!==0)}function Jc(t){return ct(t,!0)||t instanceof Uint8Array}const ud="0123456789abcdef";function oe(t){const e=Oe(t);let s="0x";for(let n=0;n<e.length;n++){const r=e[n];s+=ud[(r&240)>>4]+ud[r&15]}return s}function At(t){return"0x"+t.map(e=>oe(e).substring(2)).join("")}function Jr(t){return ct(t,!0)?(t.length-2)/2:Oe(t).length}function yt(t,e,s){const n=Oe(t);return s!=null&&s>n.length&&j(!1,"cannot slice beyond data bounds","BUFFER_OVERRUN",{buffer:n,length:n.length,offset:s}),oe(n.slice(e??0,s??n.length))}function dp(t,e,s){const n=Oe(t);j(e>=n.length,"padding exceeds data length","BUFFER_OVERRUN",{buffer:new Uint8Array(n),length:e,offset:e+1});const r=new Uint8Array(e);return r.fill(0),s?r.set(n,e-n.length):r.set(n,0),oe(r)}function Sn(t,e){return dp(t,e,!0)}function Tv(t,e){return dp(t,e,!1)}const Ba=BigInt(0),Ws=BigInt(1),Hr=9007199254740991;function ca(t,e){const s=Ma(t,"value"),n=BigInt(Ne(e,"width"));if(j(s>>n===Ba,"overflow","NUMERIC_FAULT",{operation:"fromTwos",fault:"overflow",value:t}),s>>n-Ws){const r=(Ws<<n)-Ws;return-((~s&r)+Ws)}return s}function fp(t,e){let s=he(t,"value");const n=BigInt(Ne(e,"width")),r=Ws<<n-Ws;if(s<Ba){s=-s,j(s<=r,"too low","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});const i=(Ws<<n)-Ws;return(~s&i)+Ws}else j(s<r,"too high","NUMERIC_FAULT",{operation:"toTwos",fault:"overflow",value:t});return s}function gr(t,e){const s=Ma(t,"value"),n=BigInt(Ne(e,"bits"));return s&(Ws<<n)-Ws}function he(t,e){switch(typeof t){case"bigint":return t;case"number":return P(Number.isInteger(t),"underflow",e||"value",t),P(t>=-Hr&&t<=Hr,"overflow",e||"value",t),BigInt(t);case"string":try{if(t==="")throw new Error("empty string");return t[0]==="-"&&t[1]!=="-"?-BigInt(t.substring(1)):BigInt(t)}catch(s){P(!1,`invalid BigNumberish string: ${s.message}`,e||"value",t)}}P(!1,"invalid BigNumberish value",e||"value",t)}function Ma(t,e){const s=he(t,e);return j(s>=Ba,"unsigned value cannot be negative","NUMERIC_FAULT",{fault:"overflow",operation:"getUint",value:t}),s}const dd="0123456789abcdef";function Fa(t){if(t instanceof Uint8Array){let e="0x0";for(const s of t)e+=dd[s>>4],e+=dd[s&15];return BigInt(e)}return he(t)}function Ne(t,e){switch(typeof t){case"bigint":return P(t>=-Hr&&t<=Hr,"overflow",e||"value",t),Number(t);case"number":return P(Number.isInteger(t),"underflow",e||"value",t),P(t>=-Hr&&t<=Hr,"overflow",e||"value",t),t;case"string":try{if(t==="")throw new Error("empty string");return Ne(BigInt(t),e)}catch(s){P(!1,`invalid numeric string: ${s.message}`,e||"value",t)}}P(!1,"invalid numeric value",e||"value",t)}function Pv(t){return Ne(Fa(t))}function Jn(t,e){let n=Ma(t,"value").toString(16);if(e==null)n.length%2&&(n="0"+n);else{const r=Ne(e,"width");for(j(r*2>=n.length,`value exceeds width (${r} bytes)`,"NUMERIC_FAULT",{operation:"toBeHex",fault:"overflow",value:t});n.length<r*2;)n="0"+n}return"0x"+n}function Lt(t){const e=Ma(t,"value");if(e===Ba)return new Uint8Array([]);let s=e.toString(16);s.length%2&&(s="0"+s);const n=new Uint8Array(s.length/2);for(let r=0;r<n.length;r++){const i=r*2;n[r]=parseInt(s.substring(i,i+2),16)}return n}function Hs(t){let e=oe(Jc(t)?t:Lt(t)).substring(2);for(;e.startsWith("0");)e=e.substring(1);return e===""&&(e="0"),"0x"+e}const fd="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";BigInt(0);const hd=BigInt(58);function kv(t){const e=Oe(t);let s=Fa(e),n="";for(;s;)n=fd[Number(s%hd)]+n,s/=hd;for(let r=0;r<e.length&&!e[r];r++)n=fd[0]+n;return n}function Sv(t){t=atob(t);const e=new Uint8Array(t.length);for(let s=0;s<t.length;s++)e[s]=t.charCodeAt(s);return Oe(e)}function Cv(t){const e=Oe(t);let s="";for(let n=0;n<e.length;n++)s+=String.fromCharCode(e[n]);return btoa(s)}class hp{filter;emitter;#e;constructor(e,s,n){this.#e=s,_e(this,{emitter:e,filter:n})}async removeListener(){this.#e!=null&&await this.emitter.off(this.filter,this.#e)}}function Iv(t,e,s,n,r){P(!1,`invalid codepoint at offset ${e}; ${t}`,"bytes",s)}function pp(t,e,s,n,r){if(t==="BAD_PREFIX"||t==="UNEXPECTED_CONTINUE"){let i=0;for(let o=e+1;o<s.length&&s[o]>>6===2;o++)i++;return i}return t==="OVERRUN"?s.length-e-1:0}function Rv(t,e,s,n,r){return t==="OVERLONG"?(P(typeof r=="number","invalid bad code point for replacement","badCodepoint",r),n.push(r),0):(n.push(65533),pp(t,e,s))}const Dv=Object.freeze({error:Iv,ignore:pp,replace:Rv});function xv(t,e){e==null&&(e=Dv.error);const s=Oe(t,"bytes"),n=[];let r=0;for(;r<s.length;){const i=s[r++];if(i>>7===0){n.push(i);continue}let o=null,l=null;if((i&224)===192)o=1,l=127;else if((i&240)===224)o=2,l=2047;else if((i&248)===240)o=3,l=65535;else{(i&192)===128?r+=e("UNEXPECTED_CONTINUE",r-1,s,n):r+=e("BAD_PREFIX",r-1,s,n);continue}if(r-1+o>=s.length){r+=e("OVERRUN",r-1,s,n);continue}let c=i&(1<<8-o-1)-1;for(let u=0;u<o;u++){let d=s[r];if((d&192)!=128){r+=e("MISSING_CONTINUE",r,s,n),c=null;break}c=c<<6|d&63,r++}if(c!==null){if(c>1114111){r+=e("OUT_OF_RANGE",r-1-o,s,n,c);continue}if(c>=55296&&c<=57343){r+=e("UTF16_SURROGATE",r-1-o,s,n,c);continue}if(c<=l){r+=e("OVERLONG",r-1-o,s,n,c);continue}n.push(c)}}return n}function _n(t,e){P(typeof t=="string","invalid string value","str",t);let s=[];for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);if(r<128)s.push(r);else if(r<2048)s.push(r>>6|192),s.push(r&63|128);else if((r&64512)==55296){n++;const i=t.charCodeAt(n);P(n<t.length&&(i&64512)===56320,"invalid surrogate pair","str",t);const o=65536+((r&1023)<<10)+(i&1023);s.push(o>>18|240),s.push(o>>12&63|128),s.push(o>>6&63|128),s.push(o&63|128)}else s.push(r>>12|224),s.push(r>>6&63|128),s.push(r&63|128)}return new Uint8Array(s)}function Nv(t){return t.map(e=>e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10&1023)+55296,(e&1023)+56320))).join("")}function ua(t,e){return Nv(xv(t,e))}function mp(t){async function e(s,n){j(n==null||!n.cancelled,"request cancelled before sending","CANCELLED");const r=s.url.split(":")[0].toLowerCase();j(r==="http"||r==="https",`unsupported protocol ${r}`,"UNSUPPORTED_OPERATION",{info:{protocol:r},operation:"request"}),j(r==="https"||!s.credentials||s.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let i=null;const o=new AbortController,l=setTimeout(()=>{i=ht("request timeout","TIMEOUT"),o.abort()},s.timeout);n&&n.addListener(()=>{i=ht("request cancelled","CANCELLED"),o.abort()});const c=Object.assign({},t,{method:s.method,headers:new Headers(Array.from(s)),body:s.body||void 0,signal:o.signal});let u;try{u=await fetch(s.url,c)}catch(y){throw clearTimeout(l),i||y}clearTimeout(l);const d={};u.headers.forEach((y,T)=>{d[T.toLowerCase()]=y});const f=await u.arrayBuffer(),h=f==null?null:new Uint8Array(f);return{statusCode:u.status,statusMessage:u.statusText,headers:d,body:h}}return e}const Lv=12,Ov=250;let pd=mp();const Uv=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),Bv=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let vl=!1;async function gp(t,e){try{const s=t.match(Uv);if(!s)throw new Error("invalid data");return new Kn(200,"OK",{"content-type":s[1]||"text/plain"},s[2]?Sv(s[3]):Fv(s[3]))}catch{return new Kn(599,"BAD REQUEST (invalid data: URI)",{},null,new Cn(t))}}function yp(t){async function e(s,n){try{const r=s.match(Bv);if(!r)throw new Error("invalid link");return new Cn(`${t}${r[2]}`)}catch{return new Kn(599,"BAD REQUEST (invalid IPFS URI)",{},null,new Cn(s))}}return e}const No={data:gp,ipfs:yp("https://gateway.ipfs.io/ipfs/")},vp=new WeakMap;class Mv{#e;#t;constructor(e){this.#e=[],this.#t=!1,vp.set(e,()=>{if(!this.#t){this.#t=!0;for(const s of this.#e)setTimeout(()=>{s()},0);this.#e=[]}})}addListener(e){j(!this.#t,"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),this.#e.push(e)}get cancelled(){return this.#t}checkSignal(){j(!this.cancelled,"cancelled","CANCELLED",{})}}function Lo(t){if(t==null)throw new Error("missing signal; should not happen");return t.checkSignal(),t}class Cn{#e;#t;#s;#n;#r;#o;#i;#a;#d;#c;#p;#m;#l;#u;#f;get url(){return this.#o}set url(e){this.#o=String(e)}get body(){return this.#i==null?null:new Uint8Array(this.#i)}set body(e){if(e==null)this.#i=void 0,this.#a=void 0;else if(typeof e=="string")this.#i=_n(e),this.#a="text/plain";else if(e instanceof Uint8Array)this.#i=e,this.#a="application/octet-stream";else if(typeof e=="object")this.#i=_n(JSON.stringify(e)),this.#a="application/json";else throw new Error("invalid body")}hasBody(){return this.#i!=null}get method(){return this.#n?this.#n:this.hasBody()?"POST":"GET"}set method(e){e==null&&(e=""),this.#n=String(e).toUpperCase()}get headers(){const e=Object.assign({},this.#s);return this.#d&&(e.authorization=`Basic ${Cv(_n(this.#d))}`),this.allowGzip&&(e["accept-encoding"]="gzip"),e["content-type"]==null&&this.#a&&(e["content-type"]=this.#a),this.body&&(e["content-length"]=String(this.body.length)),e}getHeader(e){return this.headers[e.toLowerCase()]}setHeader(e,s){this.#s[String(e).toLowerCase()]=String(s)}clearHeaders(){this.#s={}}[Symbol.iterator](){const e=this.headers,s=Object.keys(e);let n=0;return{next:()=>{if(n<s.length){const r=s[n++];return{value:[r,e[r]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return this.#d||null}setCredentials(e,s){P(!e.match(/:/),"invalid basic authentication username","username","[REDACTED]"),this.#d=`${e}:${s}`}get allowGzip(){return this.#t}set allowGzip(e){this.#t=!!e}get allowInsecureAuthentication(){return!!this.#e}set allowInsecureAuthentication(e){this.#e=!!e}get timeout(){return this.#r}set timeout(e){P(e>=0,"timeout must be non-zero","timeout",e),this.#r=e}get preflightFunc(){return this.#c||null}set preflightFunc(e){this.#c=e}get processFunc(){return this.#p||null}set processFunc(e){this.#p=e}get retryFunc(){return this.#m||null}set retryFunc(e){this.#m=e}get getUrlFunc(){return this.#f||pd}set getUrlFunc(e){this.#f=e}constructor(e){this.#o=String(e),this.#e=!1,this.#t=!0,this.#s={},this.#n="",this.#r=3e5,this.#u={slotInterval:Ov,maxAttempts:Lv},this.#f=null}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${this.#i?oe(this.#i):"null"}>`}setThrottleParams(e){e.slotInterval!=null&&(this.#u.slotInterval=e.slotInterval),e.maxAttempts!=null&&(this.#u.maxAttempts=e.maxAttempts)}async#h(e,s,n,r,i){if(e>=this.#u.maxAttempts)return i.makeServerError("exceeded maximum retry limit");j(md()<=s,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:r}),n>0&&await Vv(n);let o=this.clone();const l=(o.url.split(":")[0]||"").toLowerCase();if(l in No){const d=await No[l](o.url,Lo(r.#l));if(d instanceof Kn){let f=d;if(this.processFunc){Lo(r.#l);try{f=await this.processFunc(o,f)}catch(h){(h.throttle==null||typeof h.stall!="number")&&f.makeServerError("error in post-processing function",h).assertOk()}}return f}o=d}this.preflightFunc&&(o=await this.preflightFunc(o));const c=await this.getUrlFunc(o,Lo(r.#l));let u=new Kn(c.statusCode,c.statusMessage,c.headers,c.body,r);if(u.statusCode===301||u.statusCode===302){try{const d=u.headers.location||"";return o.redirect(d).#h(e+1,s,0,r,u)}catch{}return u}else if(u.statusCode===429&&(this.retryFunc==null||await this.retryFunc(o,u,e))){const d=u.headers["retry-after"];let f=this.#u.slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return typeof d=="string"&&d.match(/^[1-9][0-9]*$/)&&(f=parseInt(d)),o.clone().#h(e+1,s,f,r,u)}if(this.processFunc){Lo(r.#l);try{u=await this.processFunc(o,u)}catch(d){(d.throttle==null||typeof d.stall!="number")&&u.makeServerError("error in post-processing function",d).assertOk();let f=this.#u.slotInterval*Math.trunc(Math.random()*Math.pow(2,e));return d.stall>=0&&(f=d.stall),o.clone().#h(e+1,s,f,r,u)}}return u}send(){return j(this.#l==null,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),this.#l=new Mv(this),this.#h(0,md()+this.timeout,0,this,new Kn(0,"",{},null,this))}cancel(){j(this.#l!=null,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const e=vp.get(this);if(!e)throw new Error("missing signal; should not happen");e()}redirect(e){const s=this.url.split(":")[0].toLowerCase(),n=e.split(":")[0].toLowerCase();j(this.method==="GET"&&(s!=="https"||n!=="http")&&e.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(e)})`});const r=new Cn(e);return r.method="GET",r.allowGzip=this.allowGzip,r.timeout=this.timeout,r.#s=Object.assign({},this.#s),this.#i&&(r.#i=new Uint8Array(this.#i)),r.#a=this.#a,r}clone(){const e=new Cn(this.url);return e.#n=this.#n,this.#i&&(e.#i=this.#i),e.#a=this.#a,e.#s=Object.assign({},this.#s),e.#d=this.#d,this.allowGzip&&(e.allowGzip=!0),e.timeout=this.timeout,this.allowInsecureAuthentication&&(e.allowInsecureAuthentication=!0),e.#c=this.#c,e.#p=this.#p,e.#m=this.#m,e.#u=Object.assign({},this.#u),e.#f=this.#f,e}static lockConfig(){vl=!0}static getGateway(e){return No[e.toLowerCase()]||null}static registerGateway(e,s){if(e=e.toLowerCase(),e==="http"||e==="https")throw new Error(`cannot intercept ${e}; use registerGetUrl`);if(vl)throw new Error("gateways locked");No[e]=s}static registerGetUrl(e){if(vl)throw new Error("gateways locked");pd=e}static createGetUrlFunc(e){return mp(e)}static createDataGateway(){return gp}static createIpfsGatewayFunc(e){return yp(e)}}class Kn{#e;#t;#s;#n;#r;#o;toString(){return`<FetchResponse status=${this.statusCode} body=${this.#n?oe(this.#n):"null"}>`}get statusCode(){return this.#e}get statusMessage(){return this.#t}get headers(){return Object.assign({},this.#s)}get body(){return this.#n==null?null:new Uint8Array(this.#n)}get bodyText(){try{return this.#n==null?"":ua(this.#n)}catch{j(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch{j(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const e=this.headers,s=Object.keys(e);let n=0;return{next:()=>{if(n<s.length){const r=s[n++];return{value:[r,e[r]],done:!1}}return{value:void 0,done:!0}}}}constructor(e,s,n,r,i){this.#e=e,this.#t=s,this.#s=Object.keys(n).reduce((o,l)=>(o[l.toLowerCase()]=String(n[l]),o),{}),this.#n=r==null?null:new Uint8Array(r),this.#r=i||null,this.#o={message:""}}makeServerError(e,s){let n;e?n=`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${e})`:(e=`${this.statusCode} ${this.statusMessage}`,n=`CLIENT ESCALATED SERVER ERROR (${e})`);const r=new Kn(599,n,this.headers,this.body,this.#r||void 0);return r.#o={message:e,error:s},r}throwThrottleError(e,s){s==null?s=-1:P(Number.isInteger(s)&&s>=0,"invalid stall timeout","stall",s);const n=new Error(e||"throttling requests");throw _e(n,{stall:s,throttle:!0}),n}getHeader(e){return this.headers[e.toLowerCase()]}hasBody(){return this.#n!=null}get request(){return this.#r}ok(){return this.#o.message===""&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:e,error:s}=this.#o;e===""&&(e=`server response ${this.statusCode} ${this.statusMessage}`);let n=null;this.request&&(n=this.request.url);let r=null;try{this.#n&&(r=ua(this.#n))}catch{}j(!1,e,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:s,info:{requestUrl:n,responseBody:r,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}}function md(){return new Date().getTime()}function Fv(t){return _n(t.replace(/%([0-9a-f][0-9a-f])/gi,(e,s)=>String.fromCharCode(parseInt(s,16))))}function Vv(t){return new Promise(e=>setTimeout(e,t))}const $v=BigInt(-1),Fs=BigInt(0),Wr=BigInt(1),jv=BigInt(5),Ur={};let qr="0000";for(;qr.length<80;)qr+=qr;function ar(t){let e=qr;for(;e.length<t;)e+=e;return BigInt("1"+e.substring(0,t))}function Ti(t,e,s){const n=BigInt(e.width);if(e.signed){const r=Wr<<n-Wr;j(s==null||t>=-r&&t<r,"overflow","NUMERIC_FAULT",{operation:s,fault:"overflow",value:t}),t>Fs?t=ca(gr(t,n),n):t=-ca(gr(-t,n),n)}else{const r=Wr<<n;j(s==null||t>=0&&t<r,"overflow","NUMERIC_FAULT",{operation:s,fault:"overflow",value:t}),t=(t%r+r)%r&r-Wr}return t}function bl(t){typeof t=="number"&&(t=`fixed128x${t}`);let e=!0,s=128,n=18;if(typeof t=="string"){if(t!=="fixed")if(t==="ufixed")e=!1;else{const i=t.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);P(i,"invalid fixed format","format",t),e=i[1]!=="u",s=parseInt(i[2]),n=parseInt(i[3])}}else if(t){const i=t,o=(l,c,u)=>i[l]==null?u:(P(typeof i[l]===c,"invalid fixed format ("+l+" not "+c+")","format."+l,i[l]),i[l]);e=o("signed","boolean",e),s=o("width","number",s),n=o("decimals","number",n)}P(s%8===0,"invalid FixedNumber width (not byte aligned)","format.width",s),P(n<=80,"invalid FixedNumber decimals (too large)","format.decimals",n);const r=(e?"":"u")+"fixed"+String(s)+"x"+String(n);return{signed:e,width:s,decimals:n,name:r}}function Hv(t,e){let s="";t<Fs&&(s="-",t*=$v);let n=t.toString();if(e===0)return s+n;for(;n.length<=e;)n=qr+n;const r=n.length-e;for(n=n.substring(0,r)+"."+n.substring(r);n[0]==="0"&&n[1]!==".";)n=n.substring(1);for(;n[n.length-1]==="0"&&n[n.length-2]!==".";)n=n.substring(0,n.length-1);return s+n}class pn{format;#e;#t;#s;_value;constructor(e,s,n){vo(e,Ur,"FixedNumber"),this.#t=s,this.#e=n;const r=Hv(s,n.decimals);_e(this,{format:n.name,_value:r}),this.#s=ar(n.decimals)}get signed(){return this.#e.signed}get width(){return this.#e.width}get decimals(){return this.#e.decimals}get value(){return this.#t}#n(e){P(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)}#r(e,s){return e=Ti(e,this.#e,s),new pn(Ur,e,this.#e)}#o(e,s){return this.#n(e),this.#r(this.#t+e.#t,s)}addUnsafe(e){return this.#o(e)}add(e){return this.#o(e,"add")}#i(e,s){return this.#n(e),this.#r(this.#t-e.#t,s)}subUnsafe(e){return this.#i(e)}sub(e){return this.#i(e,"sub")}#a(e,s){return this.#n(e),this.#r(this.#t*e.#t/this.#s,s)}mulUnsafe(e){return this.#a(e)}mul(e){return this.#a(e,"mul")}mulSignal(e){this.#n(e);const s=this.#t*e.#t;return j(s%this.#s===Fs,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),this.#r(s/this.#s,"mulSignal")}#d(e,s){return j(e.#t!==Fs,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#n(e),this.#r(this.#t*this.#s/e.#t,s)}divUnsafe(e){return this.#d(e)}div(e){return this.#d(e,"div")}divSignal(e){j(e.#t!==Fs,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#n(e);const s=this.#t*this.#s;return j(s%e.#t===Fs,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),this.#r(s/e.#t,"divSignal")}cmp(e){let s=this.value,n=e.value;const r=this.decimals-e.decimals;return r>0?n*=ar(r):r<0&&(s*=ar(-r)),s<n?-1:s>n?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=this.#t;return this.#t<Fs&&(e-=this.#s-Wr),e=this.#t/this.#s*this.#s,this.#r(e,"floor")}ceiling(){let e=this.#t;return this.#t>Fs&&(e+=this.#s-Wr),e=this.#t/this.#s*this.#s,this.#r(e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const s=this.decimals-e,n=jv*ar(s-1);let r=this.value+n;const i=ar(s);return r=r/i*i,Ti(r,this.#e,"round"),new pn(Ur,r,this.#e)}isZero(){return this.#t===Fs}isNegative(){return this.#t<Fs}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return pn.fromString(this.toString(),e)}static fromValue(e,s,n){const r=s==null?0:Ne(s),i=bl(n);let o=he(e,"value");const l=r-i.decimals;if(l>0){const c=ar(l);j(o%c===Fs,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),o/=c}else l<0&&(o*=ar(-l));return Ti(o,i,"fromValue"),new pn(Ur,o,i)}static fromString(e,s){const n=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);P(n&&n[2].length+n[3].length>0,"invalid FixedNumber string value","value",e);const r=bl(s);let i=n[2]||"0",o=n[3]||"";for(;o.length<r.decimals;)o+=qr;j(o.substring(r.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),o=o.substring(0,r.decimals);const l=BigInt(n[1]+i+o);return Ti(l,r,"fromString"),new pn(Ur,l,r)}static fromBytes(e,s){let n=Fa(Oe(e,"value"));const r=bl(s);return r.signed&&(n=ca(n,r.width)),Ti(n,r,"fromBytes"),new pn(Ur,n,r)}}function Wv(t){let e=t.toString(16);for(;e.length<2;)e="0"+e;return"0x"+e}function gd(t,e,s){let n=0;for(let r=0;r<s;r++)n=n*256+t[e+r];return n}function yd(t,e,s,n){const r=[];for(;s<e+1+n;){const i=bp(t,s);r.push(i.result),s+=i.consumed,j(s<=e+1+n,"child data too short","BUFFER_OVERRUN",{buffer:t,length:n,offset:e})}return{consumed:1+n,result:r}}function bp(t,e){j(t.length!==0,"data too short","BUFFER_OVERRUN",{buffer:t,length:0,offset:1});const s=n=>{j(n<=t.length,"data short segment too short","BUFFER_OVERRUN",{buffer:t,length:t.length,offset:n})};if(t[e]>=248){const n=t[e]-247;s(e+1+n);const r=gd(t,e+1,n);return s(e+1+n+r),yd(t,e,e+1+n,n+r)}else if(t[e]>=192){const n=t[e]-192;return s(e+1+n),yd(t,e,e+1,n)}else if(t[e]>=184){const n=t[e]-183;s(e+1+n);const r=gd(t,e+1,n);s(e+1+n+r);const i=oe(t.slice(e+1+n,e+1+n+r));return{consumed:1+n+r,result:i}}else if(t[e]>=128){const n=t[e]-128;s(e+1+n);const r=oe(t.slice(e+1,e+1+n));return{consumed:1+n,result:r}}return{consumed:1,result:Wv(t[e])}}function bo(t){const e=Oe(t,"data"),s=bp(e,0);return P(s.consumed===e.length,"unexpected junk after rlp payload","data",t),s.result}function vd(t){const e=[];for(;t;)e.unshift(t&255),t>>=8;return e}function wp(t){if(Array.isArray(t)){let n=[];if(t.forEach(function(i){n=n.concat(wp(i))}),n.length<=55)return n.unshift(192+n.length),n;const r=vd(n.length);return r.unshift(247+r.length),r.concat(n)}const e=Array.prototype.slice.call(Oe(t,"object"));if(e.length===1&&e[0]<=127)return e;if(e.length<=55)return e.unshift(128+e.length),e;const s=vd(e.length);return s.unshift(183+s.length),s.concat(e)}const bd="0123456789abcdef";function qn(t){let e="0x";for(const s of wp(t))e+=bd[s>>4],e+=bd[s&15];return e}const Yv=["wei","kwei","mwei","gwei","szabo","finney","ether"];function to(t,e){let s=18;if(typeof e=="string"){const n=Yv.indexOf(e);P(n>=0,"invalid unit","unit",e),s=3*n}else e!=null&&(s=Ne(e,"unit"));return pn.fromValue(t,s,{decimals:s,width:512}).toString()}function Gv(t,e){P(typeof t=="string","value must be a string","value",t);let s=18;return s=Ne(e,"unit"),pn.fromString(t,{decimals:s,width:512}).value}function _t(t){return to(t,18)}function si(t){return Gv(t,18)}const us=32,ec=new Uint8Array(us),Kv=["then"],Oo={},Ap=new WeakMap;function fr(t){return Ap.get(t)}function wd(t,e){Ap.set(t,e)}function Pi(t,e){const s=new Error(`deferred error during ABI decoding triggered accessing ${t}`);throw s.error=e,s}function tc(t,e,s){return t.indexOf(null)>=0?e.map((n,r)=>n instanceof wn?tc(fr(n),n,s):n):t.reduce((n,r,i)=>{let o=e.getValue(r);return r in n||(s&&o instanceof wn&&(o=tc(fr(o),o,s)),n[r]=o),n},{})}class wn extends Array{#e;constructor(...e){const s=e[0];let n=e[1],r=(e[2]||[]).slice(),i=!0;s!==Oo&&(n=e,r=[],i=!1),super(n.length),n.forEach((c,u)=>{this[u]=c});const o=r.reduce((c,u)=>(typeof u=="string"&&c.set(u,(c.get(u)||0)+1),c),new Map);if(wd(this,Object.freeze(n.map((c,u)=>{const d=r[u];return d!=null&&o.get(d)===1?d:null}))),this.#e=[],this.#e==null&&this.#e,!i)return;Object.freeze(this);const l=new Proxy(this,{get:(c,u,d)=>{if(typeof u=="string"){if(u.match(/^[0-9]+$/)){const h=Ne(u,"%index");if(h<0||h>=this.length)throw new RangeError("out of result range");const y=c[h];return y instanceof Error&&Pi(`index ${h}`,y),y}if(Kv.indexOf(u)>=0)return Reflect.get(c,u,d);const f=c[u];if(f instanceof Function)return function(...h){return f.apply(this===d?c:this,h)};if(!(u in c))return c.getValue.apply(this===d?c:this,[u])}return Reflect.get(c,u,d)}});return wd(l,fr(this)),l}toArray(e){const s=[];return this.forEach((n,r)=>{n instanceof Error&&Pi(`index ${r}`,n),e&&n instanceof wn&&(n=n.toArray(e)),s.push(n)}),s}toObject(e){const s=fr(this);return s.reduce((n,r,i)=>(j(r!=null,`value at index ${i} unnamed`,"UNSUPPORTED_OPERATION",{operation:"toObject()"}),tc(s,this,e)),{})}slice(e,s){e==null&&(e=0),e<0&&(e+=this.length,e<0&&(e=0)),s==null&&(s=this.length),s<0&&(s+=this.length,s<0&&(s=0)),s>this.length&&(s=this.length);const n=fr(this),r=[],i=[];for(let o=e;o<s;o++)r.push(this[o]),i.push(n[o]);return new wn(Oo,r,i)}filter(e,s){const n=fr(this),r=[],i=[];for(let o=0;o<this.length;o++){const l=this[o];l instanceof Error&&Pi(`index ${o}`,l),e.call(s,l,o,this)&&(r.push(l),i.push(n[o]))}return new wn(Oo,r,i)}map(e,s){const n=[];for(let r=0;r<this.length;r++){const i=this[r];i instanceof Error&&Pi(`index ${r}`,i),n.push(e.call(s,i,r,this))}return n}getValue(e){const s=fr(this).indexOf(e);if(s===-1)return;const n=this[s];return n instanceof Error&&Pi(`property ${JSON.stringify(e)}`,n.error),n}static fromItems(e,s){return new wn(Oo,e,s)}}function Ad(t){let e=Lt(t);return j(e.length<=us,"value out-of-bounds","BUFFER_OVERRUN",{buffer:e,length:us,offset:e.length}),e.length!==us&&(e=ls(At([ec.slice(e.length%us),e]))),e}class Dn{name;type;localName;dynamic;constructor(e,s,n,r){_e(this,{name:e,type:s,localName:n,dynamic:r},{name:"string",type:"string",localName:"string",dynamic:"boolean"})}_throwError(e,s){P(!1,e,this.localName,s)}}class sc{#e;#t;constructor(){this.#e=[],this.#t=0}get data(){return At(this.#e)}get length(){return this.#t}#s(e){return this.#e.push(e),this.#t+=e.length,e.length}appendWriter(e){return this.#s(ls(e.data))}writeBytes(e){let s=ls(e);const n=s.length%us;return n&&(s=ls(At([s,ec.slice(n)]))),this.#s(s)}writeValue(e){return this.#s(Ad(e))}writeUpdatableValue(){const e=this.#e.length;return this.#e.push(ec),this.#t+=us,s=>{this.#e[e]=Ad(s)}}}class qc{allowLoose;#e;#t;#s;#n;#r;constructor(e,s,n){_e(this,{allowLoose:!!s}),this.#e=ls(e),this.#s=0,this.#n=null,this.#r=n??1024,this.#t=0}get data(){return oe(this.#e)}get dataLength(){return this.#e.length}get consumed(){return this.#t}get bytes(){return new Uint8Array(this.#e)}#o(e){if(this.#n)return this.#n.#o(e);this.#s+=e,j(this.#r<1||this.#s<=this.#r*this.dataLength,`compressed ABI data exceeds inflation ratio of ${this.#r} ( see: https://github.com/ethers-io/ethers.js/issues/4537 )`,"BUFFER_OVERRUN",{buffer:ls(this.#e),offset:this.#t,length:e,info:{bytesRead:this.#s,dataLength:this.dataLength}})}#i(e,s,n){let r=Math.ceil(s/us)*us;return this.#t+r>this.#e.length&&(this.allowLoose&&n&&this.#t+s<=this.#e.length?r=s:j(!1,"data out-of-bounds","BUFFER_OVERRUN",{buffer:ls(this.#e),length:this.#e.length,offset:this.#t+r})),this.#e.slice(this.#t,this.#t+r)}subReader(e){const s=new qc(this.#e.slice(this.#t+e),this.allowLoose,this.#r);return s.#n=this,s}readBytes(e,s){let n=this.#i(0,e,!!s);return this.#o(e),this.#t+=n.length,n.slice(0,e)}readValue(){return Fa(this.readBytes(us))}readIndex(){return Pv(this.readBytes(us))}}function da(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Zc(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function zv(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");da(t.outputLen),da(t.blockLen)}function ni(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ep(t,e){Zc(t);const s=e.outputLen;if(t.length<s)throw new Error(`digestInto() expects output buffer of length at least ${s}`)}const wl=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _p=t=>t instanceof Uint8Array,Qv=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Al=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),qs=(t,e)=>t<<32-e|t>>>e,Jv=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Jv)throw new Error("Non little-endian hardware is not supported");function qv(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Va(t){if(typeof t=="string"&&(t=qv(t)),!_p(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function Zv(...t){const e=new Uint8Array(t.reduce((n,r)=>n+r.length,0));let s=0;return t.forEach(n=>{if(!_p(n))throw new Error("Uint8Array expected");e.set(n,s),s+=n.length}),e}class Xc{clone(){return this._cloneInto()}}function eu(t){const e=n=>t().update(Va(n)).digest(),s=t();return e.outputLen=s.outputLen,e.blockLen=s.blockLen,e.create=()=>t(),e}function Xv(t=32){if(wl&&typeof wl.getRandomValues=="function")return wl.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class Tp extends Xc{constructor(e,s){super(),this.finished=!1,this.destroyed=!1,zv(e);const n=Va(s);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return ni(this),this.iHash.update(e),this}digestInto(e){ni(this),Zc(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:s,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:l}=this;return e=e,e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=l,e.oHash=s._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Pp=(t,e,s)=>new Tp(t,e).update(s).digest();Pp.create=(t,e)=>new Tp(t,e);function eb(t,e,s,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,s,n);const r=BigInt(32),i=BigInt(4294967295),o=Number(s>>r&i),l=Number(s&i),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,l,n)}class kp extends Xc{constructor(e,s,n,r){super(),this.blockLen=e,this.outputLen=s,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Al(this.buffer)}update(e){ni(this);const{view:s,buffer:n,blockLen:r}=this;e=Va(e);const i=e.length;for(let o=0;o<i;){const l=Math.min(r-this.pos,i-o);if(l===r){const c=Al(e);for(;r<=i-o;o+=r)this.process(c,o);continue}n.set(e.subarray(o,o+l),this.pos),this.pos+=l,o+=l,this.pos===r&&(this.process(s,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ni(this),Ep(e,this),this.finished=!0;const{buffer:s,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;s[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>r-o&&(this.process(n,0),o=0);for(let f=o;f<r;f++)s[f]=0;eb(n,r-8,BigInt(this.length*8),i),this.process(n,0);const l=Al(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,d=this.get();if(u>d.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)l.setUint32(4*f,d[f],i)}digest(){const{buffer:e,outputLen:s}=this;this.digestInto(e);const n=e.slice(0,s);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:s,buffer:n,length:r,finished:i,destroyed:o,pos:l}=this;return e.length=r,e.pos=l,e.finished=i,e.destroyed=o,r%s&&e.buffer.set(n),e}}const tb=(t,e,s)=>t&e^~t&s,sb=(t,e,s)=>t&e^t&s^e&s,nb=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ln=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),On=new Uint32Array(64);class rb extends kp{constructor(){super(64,32,8,!1),this.A=Ln[0]|0,this.B=Ln[1]|0,this.C=Ln[2]|0,this.D=Ln[3]|0,this.E=Ln[4]|0,this.F=Ln[5]|0,this.G=Ln[6]|0,this.H=Ln[7]|0}get(){const{A:e,B:s,C:n,D:r,E:i,F:o,G:l,H:c}=this;return[e,s,n,r,i,o,l,c]}set(e,s,n,r,i,o,l,c){this.A=e|0,this.B=s|0,this.C=n|0,this.D=r|0,this.E=i|0,this.F=o|0,this.G=l|0,this.H=c|0}process(e,s){for(let f=0;f<16;f++,s+=4)On[f]=e.getUint32(s,!1);for(let f=16;f<64;f++){const h=On[f-15],y=On[f-2],T=qs(h,7)^qs(h,18)^h>>>3,w=qs(y,17)^qs(y,19)^y>>>10;On[f]=w+On[f-7]+T+On[f-16]|0}let{A:n,B:r,C:i,D:o,E:l,F:c,G:u,H:d}=this;for(let f=0;f<64;f++){const h=qs(l,6)^qs(l,11)^qs(l,25),y=d+h+tb(l,c,u)+nb[f]+On[f]|0,w=(qs(n,2)^qs(n,13)^qs(n,22))+sb(n,r,i)|0;d=u,u=c,c=l,l=o+y|0,o=i,i=r,r=n,n=y+w|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,l=l+this.E|0,c=c+this.F|0,u=u+this.G|0,d=d+this.H|0,this.set(n,r,i,o,l,c,u,d)}roundClean(){On.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Sp=eu(()=>new rb),Uo=BigInt(2**32-1),nc=BigInt(32);function Cp(t,e=!1){return e?{h:Number(t&Uo),l:Number(t>>nc&Uo)}:{h:Number(t>>nc&Uo)|0,l:Number(t&Uo)|0}}function Ip(t,e=!1){let s=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let r=0;r<t.length;r++){const{h:i,l:o}=Cp(t[r],e);[s[r],n[r]]=[i,o]}return[s,n]}const ib=(t,e)=>BigInt(t>>>0)<<nc|BigInt(e>>>0),ob=(t,e,s)=>t>>>s,ab=(t,e,s)=>t<<32-s|e>>>s,lb=(t,e,s)=>t>>>s|e<<32-s,cb=(t,e,s)=>t<<32-s|e>>>s,ub=(t,e,s)=>t<<64-s|e>>>s-32,db=(t,e,s)=>t>>>s-32|e<<64-s,fb=(t,e)=>e,hb=(t,e)=>t,Rp=(t,e,s)=>t<<s|e>>>32-s,Dp=(t,e,s)=>e<<s|t>>>32-s,xp=(t,e,s)=>e<<s-32|t>>>64-s,Np=(t,e,s)=>t<<s-32|e>>>64-s;function pb(t,e,s,n){const r=(e>>>0)+(n>>>0);return{h:t+s+(r/2**32|0)|0,l:r|0}}const mb=(t,e,s)=>(t>>>0)+(e>>>0)+(s>>>0),gb=(t,e,s,n)=>e+s+n+(t/2**32|0)|0,yb=(t,e,s,n)=>(t>>>0)+(e>>>0)+(s>>>0)+(n>>>0),vb=(t,e,s,n,r)=>e+s+n+r+(t/2**32|0)|0,bb=(t,e,s,n,r)=>(t>>>0)+(e>>>0)+(s>>>0)+(n>>>0)+(r>>>0),wb=(t,e,s,n,r,i)=>e+s+n+r+i+(t/2**32|0)|0,Le={fromBig:Cp,split:Ip,toBig:ib,shrSH:ob,shrSL:ab,rotrSH:lb,rotrSL:cb,rotrBH:ub,rotrBL:db,rotr32H:fb,rotr32L:hb,rotlSH:Rp,rotlSL:Dp,rotlBH:xp,rotlBL:Np,add:pb,add3L:mb,add3H:gb,add4L:yb,add4H:vb,add5H:wb,add5L:bb},[Ab,Eb]=Le.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Un=new Uint32Array(80),Bn=new Uint32Array(80);class _b extends kp{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:s,Bh:n,Bl:r,Ch:i,Cl:o,Dh:l,Dl:c,Eh:u,El:d,Fh:f,Fl:h,Gh:y,Gl:T,Hh:w,Hl:k}=this;return[e,s,n,r,i,o,l,c,u,d,f,h,y,T,w,k]}set(e,s,n,r,i,o,l,c,u,d,f,h,y,T,w,k){this.Ah=e|0,this.Al=s|0,this.Bh=n|0,this.Bl=r|0,this.Ch=i|0,this.Cl=o|0,this.Dh=l|0,this.Dl=c|0,this.Eh=u|0,this.El=d|0,this.Fh=f|0,this.Fl=h|0,this.Gh=y|0,this.Gl=T|0,this.Hh=w|0,this.Hl=k|0}process(e,s){for(let L=0;L<16;L++,s+=4)Un[L]=e.getUint32(s),Bn[L]=e.getUint32(s+=4);for(let L=16;L<80;L++){const D=Un[L-15]|0,Y=Bn[L-15]|0,W=Le.rotrSH(D,Y,1)^Le.rotrSH(D,Y,8)^Le.shrSH(D,Y,7),$=Le.rotrSL(D,Y,1)^Le.rotrSL(D,Y,8)^Le.shrSL(D,Y,7),Q=Un[L-2]|0,J=Bn[L-2]|0,re=Le.rotrSH(Q,J,19)^Le.rotrBH(Q,J,61)^Le.shrSH(Q,J,6),ce=Le.rotrSL(Q,J,19)^Le.rotrBL(Q,J,61)^Le.shrSL(Q,J,6),H=Le.add4L($,ce,Bn[L-7],Bn[L-16]),we=Le.add4H(H,W,re,Un[L-7],Un[L-16]);Un[L]=we|0,Bn[L]=H|0}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:l,Cl:c,Dh:u,Dl:d,Eh:f,El:h,Fh:y,Fl:T,Gh:w,Gl:k,Hh:C,Hl:N}=this;for(let L=0;L<80;L++){const D=Le.rotrSH(f,h,14)^Le.rotrSH(f,h,18)^Le.rotrBH(f,h,41),Y=Le.rotrSL(f,h,14)^Le.rotrSL(f,h,18)^Le.rotrBL(f,h,41),W=f&y^~f&w,$=h&T^~h&k,Q=Le.add5L(N,Y,$,Eb[L],Bn[L]),J=Le.add5H(Q,C,D,W,Ab[L],Un[L]),re=Q|0,ce=Le.rotrSH(n,r,28)^Le.rotrBH(n,r,34)^Le.rotrBH(n,r,39),H=Le.rotrSL(n,r,28)^Le.rotrBL(n,r,34)^Le.rotrBL(n,r,39),we=n&i^n&l^i&l,Ce=r&o^r&c^o&c;C=w|0,N=k|0,w=y|0,k=T|0,y=f|0,T=h|0,{h:f,l:h}=Le.add(u|0,d|0,J|0,re|0),u=l|0,d=c|0,l=i|0,c=o|0,i=n|0,o=r|0;const K=Le.add3L(re,H,Ce);n=Le.add3H(K,J,ce,we),r=K|0}({h:n,l:r}=Le.add(this.Ah|0,this.Al|0,n|0,r|0)),{h:i,l:o}=Le.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:l,l:c}=Le.add(this.Ch|0,this.Cl|0,l|0,c|0),{h:u,l:d}=Le.add(this.Dh|0,this.Dl|0,u|0,d|0),{h:f,l:h}=Le.add(this.Eh|0,this.El|0,f|0,h|0),{h:y,l:T}=Le.add(this.Fh|0,this.Fl|0,y|0,T|0),{h:w,l:k}=Le.add(this.Gh|0,this.Gl|0,w|0,k|0),{h:C,l:N}=Le.add(this.Hh|0,this.Hl|0,C|0,N|0),this.set(n,r,i,o,l,c,u,d,f,h,y,T,w,k,C,N)}roundClean(){Un.fill(0),Bn.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Tb=eu(()=>new _b);function Pb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const Ed=Pb();Ed.crypto||Ed.msCrypto;function kb(t){switch(t){case"sha256":return Sp.create();case"sha512":return Tb.create()}P(!1,"invalid hashing algorithm name","algorithm",t)}const[Lp,Op,Up]=[[],[],[]],Sb=BigInt(0),ki=BigInt(1),Cb=BigInt(2),Ib=BigInt(7),Rb=BigInt(256),Db=BigInt(113);for(let t=0,e=ki,s=1,n=0;t<24;t++){[s,n]=[n,(2*s+3*n)%5],Lp.push(2*(5*n+s)),Op.push((t+1)*(t+2)/2%64);let r=Sb;for(let i=0;i<7;i++)e=(e<<ki^(e>>Ib)*Db)%Rb,e&Cb&&(r^=ki<<(ki<<BigInt(i))-ki);Up.push(r)}const[xb,Nb]=Ip(Up,!0),_d=(t,e,s)=>s>32?xp(t,e,s):Rp(t,e,s),Td=(t,e,s)=>s>32?Np(t,e,s):Dp(t,e,s);function Lb(t,e=24){const s=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)s[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const l=(o+8)%10,c=(o+2)%10,u=s[c],d=s[c+1],f=_d(u,d,1)^s[l],h=Td(u,d,1)^s[l+1];for(let y=0;y<50;y+=10)t[o+y]^=f,t[o+y+1]^=h}let r=t[2],i=t[3];for(let o=0;o<24;o++){const l=Op[o],c=_d(r,i,l),u=Td(r,i,l),d=Lp[o];r=t[d],i=t[d+1],t[d]=c,t[d+1]=u}for(let o=0;o<50;o+=10){for(let l=0;l<10;l++)s[l]=t[o+l];for(let l=0;l<10;l++)t[o+l]^=~s[(l+2)%10]&s[(l+4)%10]}t[0]^=xb[n],t[1]^=Nb[n]}s.fill(0)}class tu extends Xc{constructor(e,s,n,r=!1,i=24){if(super(),this.blockLen=e,this.suffix=s,this.outputLen=n,this.enableXOF=r,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,da(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=Qv(this.state)}keccak(){Lb(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){ni(this);const{blockLen:s,state:n}=this;e=Va(e);const r=e.length;for(let i=0;i<r;){const o=Math.min(s-this.pos,r-i);for(let l=0;l<o;l++)n[this.pos++]^=e[i++];this.pos===s&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:s,pos:n,blockLen:r}=this;e[n]^=s,(s&128)!==0&&n===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}writeInto(e){ni(this,!1),Zc(e),this.finish();const s=this.state,{blockLen:n}=this;for(let r=0,i=e.length;r<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-r);e.set(s.subarray(this.posOut,this.posOut+o),r),this.posOut+=o,r+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return da(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Ep(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:s,suffix:n,outputLen:r,rounds:i,enableXOF:o}=this;return e||(e=new tu(s,n,r,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=r,e.enableXOF=o,e.destroyed=this.destroyed,e}}const Ob=(t,e,s)=>eu(()=>new tu(e,t,s)),Ub=Ob(1,136,256/8);let Bp=!1;const Mp=function(t){return Ub(t)};let Fp=Mp;function wt(t){const e=Oe(t,"data");return oe(Fp(e))}wt._=Mp;wt.lock=function(){Bp=!0};wt.register=function(t){if(Bp)throw new TypeError("keccak256 is locked");Fp=t};Object.freeze(wt);const Vp=function(t){return kb("sha256").update(t).digest()};let $p=Vp,jp=!1;function gi(t){const e=Oe(t,"data");return oe($p(e))}gi._=Vp;gi.lock=function(){jp=!0};gi.register=function(t){if(jp)throw new Error("sha256 is locked");$p=t};Object.freeze(gi);Object.freeze(gi);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Hp=BigInt(0),$a=BigInt(1),Bb=BigInt(2),ja=t=>t instanceof Uint8Array,Mb=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ri(t){if(!ja(t))throw new Error("Uint8Array expected");let e="";for(let s=0;s<t.length;s++)e+=Mb[t[s]];return e}function Wp(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function su(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function ii(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const s=new Uint8Array(e/2);for(let n=0;n<s.length;n++){const r=n*2,i=t.slice(r,r+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");s[n]=o}return s}function Er(t){return su(ri(t))}function nu(t){if(!ja(t))throw new Error("Uint8Array expected");return su(ri(Uint8Array.from(t).reverse()))}function oi(t,e){return ii(t.toString(16).padStart(e*2,"0"))}function ru(t,e){return oi(t,e).reverse()}function Fb(t){return ii(Wp(t))}function Vs(t,e,s){let n;if(typeof e=="string")try{n=ii(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(ja(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const r=n.length;if(typeof s=="number"&&r!==s)throw new Error(`${t} expected ${s} bytes, got ${r}`);return n}function so(...t){const e=new Uint8Array(t.reduce((n,r)=>n+r.length,0));let s=0;return t.forEach(n=>{if(!ja(n))throw new Error("Uint8Array expected");e.set(n,s),s+=n.length}),e}function Vb(t,e){if(t.length!==e.length)return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0}function $b(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function jb(t){let e;for(e=0;t>Hp;t>>=$a,e+=1);return e}function Hb(t,e){return t>>BigInt(e)&$a}const Wb=(t,e,s)=>t|(s?$a:Hp)<<BigInt(e),iu=t=>(Bb<<BigInt(t-1))-$a,El=t=>new Uint8Array(t),Pd=t=>Uint8Array.from(t);function Yp(t,e,s){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof s!="function")throw new Error("hmacFn must be a function");let n=El(t),r=El(t),i=0;const o=()=>{n.fill(1),r.fill(0),i=0},l=(...f)=>s(r,n,...f),c=(f=El())=>{r=l(Pd([0]),f),n=l(),f.length!==0&&(r=l(Pd([1]),f),n=l())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let f=0;const h=[];for(;f<e;){n=l();const y=n.slice();h.push(y),f+=n.length}return so(...h)};return(f,h)=>{o(),c(f);let y;for(;!(y=h(u()));)c();return o(),y}}const Yb={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function wo(t,e,s={}){const n=(r,i,o)=>{const l=Yb[i];if(typeof l!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=t[r];if(!(o&&c===void 0)&&!l(c,t))throw new Error(`Invalid param ${String(r)}=${c} (${typeof c}), expected ${i}`)};for(const[r,i]of Object.entries(e))n(r,i,!1);for(const[r,i]of Object.entries(s))n(r,i,!0);return t}const Gb=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Hb,bitLen:jb,bitMask:iu,bitSet:Wb,bytesToHex:ri,bytesToNumberBE:Er,bytesToNumberLE:nu,concatBytes:so,createHmacDrbg:Yp,ensureBytes:Vs,equalBytes:Vb,hexToBytes:ii,hexToNumber:su,numberToBytesBE:oi,numberToBytesLE:ru,numberToHexUnpadded:Wp,numberToVarBytesBE:Fb,utf8ToBytes:$b,validateObject:wo},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Vt=BigInt(0),Pt=BigInt(1),hr=BigInt(2),Kb=BigInt(3),rc=BigInt(4),kd=BigInt(5),Sd=BigInt(8);BigInt(9);BigInt(16);function ys(t,e){const s=t%e;return s>=Vt?s:e+s}function zb(t,e,s){if(s<=Vt||e<Vt)throw new Error("Expected power/modulo > 0");if(s===Pt)return Vt;let n=Pt;for(;e>Vt;)e&Pt&&(n=n*t%s),t=t*t%s,e>>=Pt;return n}function Ds(t,e,s){let n=t;for(;e-- >Vt;)n*=n,n%=s;return n}function ic(t,e){if(t===Vt||e<=Vt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let s=ys(t,e),n=e,r=Vt,i=Pt;for(;s!==Vt;){const l=n/s,c=n%s,u=r-i*l;n=s,s=c,r=i,i=u}if(n!==Pt)throw new Error("invert: does not exist");return ys(r,e)}function Qb(t){const e=(t-Pt)/hr;let s,n,r;for(s=t-Pt,n=0;s%hr===Vt;s/=hr,n++);for(r=hr;r<t&&zb(r,e,t)!==t-Pt;r++);if(n===1){const o=(t+Pt)/rc;return function(c,u){const d=c.pow(u,o);if(!c.eql(c.sqr(d),u))throw new Error("Cannot find square root");return d}}const i=(s+Pt)/hr;return function(l,c){if(l.pow(c,e)===l.neg(l.ONE))throw new Error("Cannot find square root");let u=n,d=l.pow(l.mul(l.ONE,r),s),f=l.pow(c,i),h=l.pow(c,s);for(;!l.eql(h,l.ONE);){if(l.eql(h,l.ZERO))return l.ZERO;let y=1;for(let w=l.sqr(h);y<u&&!l.eql(w,l.ONE);y++)w=l.sqr(w);const T=l.pow(d,Pt<<BigInt(u-y-1));d=l.sqr(T),f=l.mul(f,T),h=l.mul(h,d),u=y}return f}}function Jb(t){if(t%rc===Kb){const e=(t+Pt)/rc;return function(n,r){const i=n.pow(r,e);if(!n.eql(n.sqr(i),r))throw new Error("Cannot find square root");return i}}if(t%Sd===kd){const e=(t-kd)/Sd;return function(n,r){const i=n.mul(r,hr),o=n.pow(i,e),l=n.mul(r,o),c=n.mul(n.mul(l,hr),o),u=n.mul(l,n.sub(c,n.ONE));if(!n.eql(n.sqr(u),r))throw new Error("Cannot find square root");return u}}return Qb(t)}const qb=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Zb(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},s=qb.reduce((n,r)=>(n[r]="function",n),e);return wo(t,s)}function Xb(t,e,s){if(s<Vt)throw new Error("Expected power > 0");if(s===Vt)return t.ONE;if(s===Pt)return e;let n=t.ONE,r=e;for(;s>Vt;)s&Pt&&(n=t.mul(n,r)),r=t.sqr(r),s>>=Pt;return n}function ew(t,e){const s=new Array(e.length),n=e.reduce((i,o,l)=>t.is0(o)?i:(s[l]=i,t.mul(i,o)),t.ONE),r=t.inv(n);return e.reduceRight((i,o,l)=>t.is0(o)?i:(s[l]=t.mul(i,s[l]),t.mul(i,o)),r),s}function Gp(t,e){const s=e!==void 0?e:t.toString(2).length,n=Math.ceil(s/8);return{nBitLength:s,nByteLength:n}}function tw(t,e,s=!1,n={}){if(t<=Vt)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:r,nByteLength:i}=Gp(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=Jb(t),l=Object.freeze({ORDER:t,BITS:r,BYTES:i,MASK:iu(r),ZERO:Vt,ONE:Pt,create:c=>ys(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Vt<=c&&c<t},is0:c=>c===Vt,isOdd:c=>(c&Pt)===Pt,neg:c=>ys(-c,t),eql:(c,u)=>c===u,sqr:c=>ys(c*c,t),add:(c,u)=>ys(c+u,t),sub:(c,u)=>ys(c-u,t),mul:(c,u)=>ys(c*u,t),pow:(c,u)=>Xb(l,c,u),div:(c,u)=>ys(c*ic(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>ic(c,t),sqrt:n.sqrt||(c=>o(l,c)),invertBatch:c=>ew(l,c),cmov:(c,u,d)=>d?u:c,toBytes:c=>s?ru(c,i):oi(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return s?nu(c):Er(c)}});return Object.freeze(l)}function Kp(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function zp(t){const e=Kp(t);return e+Math.ceil(e/2)}function sw(t,e,s=!1){const n=t.length,r=Kp(e),i=zp(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=s?Er(t):nu(t),l=ys(o,e-Pt)+Pt;return s?ru(l,r):oi(l,r)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const nw=BigInt(0),_l=BigInt(1);function rw(t,e){const s=(r,i)=>{const o=i.negate();return r?o:i},n=r=>{const i=Math.ceil(e/r)+1,o=2**(r-1);return{windows:i,windowSize:o}};return{constTimeNegate:s,unsafeLadder(r,i){let o=t.ZERO,l=r;for(;i>nw;)i&_l&&(o=o.add(l)),l=l.double(),i>>=_l;return o},precomputeWindow(r,i){const{windows:o,windowSize:l}=n(i),c=[];let u=r,d=u;for(let f=0;f<o;f++){d=u,c.push(d);for(let h=1;h<l;h++)d=d.add(u),c.push(d);u=d.double()}return c},wNAF(r,i,o){const{windows:l,windowSize:c}=n(r);let u=t.ZERO,d=t.BASE;const f=BigInt(2**r-1),h=2**r,y=BigInt(r);for(let T=0;T<l;T++){const w=T*c;let k=Number(o&f);o>>=y,k>c&&(k-=h,o+=_l);const C=w,N=w+Math.abs(k)-1,L=T%2!==0,D=k<0;k===0?d=d.add(s(L,i[C])):u=u.add(s(D,i[N]))}return{p:u,f:d}},wNAFCached(r,i,o,l){const c=r._WINDOW_SIZE||1;let u=i.get(r);return u||(u=this.precomputeWindow(r,c),c!==1&&i.set(r,l(u))),this.wNAF(c,u,o)}}}function Qp(t){return Zb(t.Fp),wo(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Gp(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function iw(t){const e=Qp(t);wo(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:s,Fp:n,a:r}=e;if(s){if(!n.eql(r,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof s!="object"||typeof s.beta!="bigint"||typeof s.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:ow,hexToBytes:aw}=Gb,yr={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=yr;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const s=t[1],n=t.subarray(2,s+2);if(!s||n.length!==s)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:ow(n),l:t.subarray(s+2)}},toSig(t){const{Err:e}=yr,s=typeof t=="string"?aw(t):t;if(!(s instanceof Uint8Array))throw new Error("ui8a expected");let n=s.length;if(n<2||s[0]!=48)throw new e("Invalid signature tag");if(s[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:r,l:i}=yr._parseInt(s.subarray(2)),{d:o,l}=yr._parseInt(i);if(l.length)throw new e("Invalid signature: left bytes after parsing");return{r,s:o}},hexFromSig(t){const e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,s=u=>{const d=u.toString(16);return d.length&1?`0${d}`:d},n=e(s(t.s)),r=e(s(t.r)),i=n.length/2,o=r.length/2,l=s(i),c=s(o);return`30${s(o+i+4)}02${c}${r}02${l}${n}`}},vn=BigInt(0),xs=BigInt(1);BigInt(2);const Cd=BigInt(3);BigInt(4);function lw(t){const e=iw(t),{Fp:s}=e,n=e.toBytes||((T,w,k)=>{const C=w.toAffine();return so(Uint8Array.from([4]),s.toBytes(C.x),s.toBytes(C.y))}),r=e.fromBytes||(T=>{const w=T.subarray(1),k=s.fromBytes(w.subarray(0,s.BYTES)),C=s.fromBytes(w.subarray(s.BYTES,2*s.BYTES));return{x:k,y:C}});function i(T){const{a:w,b:k}=e,C=s.sqr(T),N=s.mul(C,T);return s.add(s.add(N,s.mul(T,w)),k)}if(!s.eql(s.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(T){return typeof T=="bigint"&&vn<T&&T<e.n}function l(T){if(!o(T))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(T){const{allowedPrivateKeyLengths:w,nByteLength:k,wrapPrivateKey:C,n:N}=e;if(w&&typeof T!="bigint"){if(T instanceof Uint8Array&&(T=ri(T)),typeof T!="string"||!w.includes(T.length))throw new Error("Invalid key");T=T.padStart(k*2,"0")}let L;try{L=typeof T=="bigint"?T:Er(Vs("private key",T,k))}catch{throw new Error(`private key must be ${k} bytes, hex or bigint, not ${typeof T}`)}return C&&(L=ys(L,N)),l(L),L}const u=new Map;function d(T){if(!(T instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(w,k,C){if(this.px=w,this.py=k,this.pz=C,w==null||!s.isValid(w))throw new Error("x required");if(k==null||!s.isValid(k))throw new Error("y required");if(C==null||!s.isValid(C))throw new Error("z required")}static fromAffine(w){const{x:k,y:C}=w||{};if(!w||!s.isValid(k)||!s.isValid(C))throw new Error("invalid affine point");if(w instanceof f)throw new Error("projective point not allowed");const N=L=>s.eql(L,s.ZERO);return N(k)&&N(C)?f.ZERO:new f(k,C,s.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(w){const k=s.invertBatch(w.map(C=>C.pz));return w.map((C,N)=>C.toAffine(k[N])).map(f.fromAffine)}static fromHex(w){const k=f.fromAffine(r(Vs("pointHex",w)));return k.assertValidity(),k}static fromPrivateKey(w){return f.BASE.multiply(c(w))}_setWindowSize(w){this._WINDOW_SIZE=w,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!s.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:w,y:k}=this.toAffine();if(!s.isValid(w)||!s.isValid(k))throw new Error("bad point: x or y not FE");const C=s.sqr(k),N=i(w);if(!s.eql(C,N))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:w}=this.toAffine();if(s.isOdd)return!s.isOdd(w);throw new Error("Field doesn't support isOdd")}equals(w){d(w);const{px:k,py:C,pz:N}=this,{px:L,py:D,pz:Y}=w,W=s.eql(s.mul(k,Y),s.mul(L,N)),$=s.eql(s.mul(C,Y),s.mul(D,N));return W&&$}negate(){return new f(this.px,s.neg(this.py),this.pz)}double(){const{a:w,b:k}=e,C=s.mul(k,Cd),{px:N,py:L,pz:D}=this;let Y=s.ZERO,W=s.ZERO,$=s.ZERO,Q=s.mul(N,N),J=s.mul(L,L),re=s.mul(D,D),ce=s.mul(N,L);return ce=s.add(ce,ce),$=s.mul(N,D),$=s.add($,$),Y=s.mul(w,$),W=s.mul(C,re),W=s.add(Y,W),Y=s.sub(J,W),W=s.add(J,W),W=s.mul(Y,W),Y=s.mul(ce,Y),$=s.mul(C,$),re=s.mul(w,re),ce=s.sub(Q,re),ce=s.mul(w,ce),ce=s.add(ce,$),$=s.add(Q,Q),Q=s.add($,Q),Q=s.add(Q,re),Q=s.mul(Q,ce),W=s.add(W,Q),re=s.mul(L,D),re=s.add(re,re),Q=s.mul(re,ce),Y=s.sub(Y,Q),$=s.mul(re,J),$=s.add($,$),$=s.add($,$),new f(Y,W,$)}add(w){d(w);const{px:k,py:C,pz:N}=this,{px:L,py:D,pz:Y}=w;let W=s.ZERO,$=s.ZERO,Q=s.ZERO;const J=e.a,re=s.mul(e.b,Cd);let ce=s.mul(k,L),H=s.mul(C,D),we=s.mul(N,Y),Ce=s.add(k,C),K=s.add(L,D);Ce=s.mul(Ce,K),K=s.add(ce,H),Ce=s.sub(Ce,K),K=s.add(k,N);let ee=s.add(L,Y);return K=s.mul(K,ee),ee=s.add(ce,we),K=s.sub(K,ee),ee=s.add(C,N),W=s.add(D,Y),ee=s.mul(ee,W),W=s.add(H,we),ee=s.sub(ee,W),Q=s.mul(J,K),W=s.mul(re,we),Q=s.add(W,Q),W=s.sub(H,Q),Q=s.add(H,Q),$=s.mul(W,Q),H=s.add(ce,ce),H=s.add(H,ce),we=s.mul(J,we),K=s.mul(re,K),H=s.add(H,we),we=s.sub(ce,we),we=s.mul(J,we),K=s.add(K,we),ce=s.mul(H,K),$=s.add($,ce),ce=s.mul(ee,K),W=s.mul(Ce,W),W=s.sub(W,ce),ce=s.mul(Ce,H),Q=s.mul(ee,Q),Q=s.add(Q,ce),new f(W,$,Q)}subtract(w){return this.add(w.negate())}is0(){return this.equals(f.ZERO)}wNAF(w){return y.wNAFCached(this,u,w,k=>{const C=s.invertBatch(k.map(N=>N.pz));return k.map((N,L)=>N.toAffine(C[L])).map(f.fromAffine)})}multiplyUnsafe(w){const k=f.ZERO;if(w===vn)return k;if(l(w),w===xs)return this;const{endo:C}=e;if(!C)return y.unsafeLadder(this,w);let{k1neg:N,k1:L,k2neg:D,k2:Y}=C.splitScalar(w),W=k,$=k,Q=this;for(;L>vn||Y>vn;)L&xs&&(W=W.add(Q)),Y&xs&&($=$.add(Q)),Q=Q.double(),L>>=xs,Y>>=xs;return N&&(W=W.negate()),D&&($=$.negate()),$=new f(s.mul($.px,C.beta),$.py,$.pz),W.add($)}multiply(w){l(w);let k=w,C,N;const{endo:L}=e;if(L){const{k1neg:D,k1:Y,k2neg:W,k2:$}=L.splitScalar(k);let{p:Q,f:J}=this.wNAF(Y),{p:re,f:ce}=this.wNAF($);Q=y.constTimeNegate(D,Q),re=y.constTimeNegate(W,re),re=new f(s.mul(re.px,L.beta),re.py,re.pz),C=Q.add(re),N=J.add(ce)}else{const{p:D,f:Y}=this.wNAF(k);C=D,N=Y}return f.normalizeZ([C,N])[0]}multiplyAndAddUnsafe(w,k,C){const N=f.BASE,L=(Y,W)=>W===vn||W===xs||!Y.equals(N)?Y.multiplyUnsafe(W):Y.multiply(W),D=L(this,k).add(L(w,C));return D.is0()?void 0:D}toAffine(w){const{px:k,py:C,pz:N}=this,L=this.is0();w==null&&(w=L?s.ONE:s.inv(N));const D=s.mul(k,w),Y=s.mul(C,w),W=s.mul(N,w);if(L)return{x:s.ZERO,y:s.ZERO};if(!s.eql(W,s.ONE))throw new Error("invZ was invalid");return{x:D,y:Y}}isTorsionFree(){const{h:w,isTorsionFree:k}=e;if(w===xs)return!0;if(k)return k(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:w,clearCofactor:k}=e;return w===xs?this:k?k(f,this):this.multiplyUnsafe(e.h)}toRawBytes(w=!0){return this.assertValidity(),n(f,this,w)}toHex(w=!0){return ri(this.toRawBytes(w))}}f.BASE=new f(e.Gx,e.Gy,s.ONE),f.ZERO=new f(s.ZERO,s.ONE,s.ZERO);const h=e.nBitLength,y=rw(f,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function cw(t){const e=Qp(t);return wo(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function uw(t){const e=cw(t),{Fp:s,n}=e,r=s.BYTES+1,i=2*s.BYTES+1;function o(K){return vn<K&&K<s.ORDER}function l(K){return ys(K,n)}function c(K){return ic(K,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:f,isWithinCurveOrder:h}=lw({...e,toBytes(K,ee,ae){const ge=ee.toAffine(),Re=s.toBytes(ge.x),Ye=so;return ae?Ye(Uint8Array.from([ee.hasEvenY()?2:3]),Re):Ye(Uint8Array.from([4]),Re,s.toBytes(ge.y))},fromBytes(K){const ee=K.length,ae=K[0],ge=K.subarray(1);if(ee===r&&(ae===2||ae===3)){const Re=Er(ge);if(!o(Re))throw new Error("Point is not on curve");const Ye=f(Re);let je=s.sqrt(Ye);const He=(je&xs)===xs;return(ae&1)===1!==He&&(je=s.neg(je)),{x:Re,y:je}}else if(ee===i&&ae===4){const Re=s.fromBytes(ge.subarray(0,s.BYTES)),Ye=s.fromBytes(ge.subarray(s.BYTES,2*s.BYTES));return{x:Re,y:Ye}}else throw new Error(`Point of length ${ee} was invalid. Expected ${r} compressed bytes or ${i} uncompressed bytes`)}}),y=K=>ri(oi(K,e.nByteLength));function T(K){const ee=n>>xs;return K>ee}function w(K){return T(K)?l(-K):K}const k=(K,ee,ae)=>Er(K.slice(ee,ae));class C{constructor(ee,ae,ge){this.r=ee,this.s=ae,this.recovery=ge,this.assertValidity()}static fromCompact(ee){const ae=e.nByteLength;return ee=Vs("compactSignature",ee,ae*2),new C(k(ee,0,ae),k(ee,ae,2*ae))}static fromDER(ee){const{r:ae,s:ge}=yr.toSig(Vs("DER",ee));return new C(ae,ge)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(ee){return new C(this.r,this.s,ee)}recoverPublicKey(ee){const{r:ae,s:ge,recovery:Re}=this,Ye=$(Vs("msgHash",ee));if(Re==null||![0,1,2,3].includes(Re))throw new Error("recovery id invalid");const je=Re===2||Re===3?ae+e.n:ae;if(je>=s.ORDER)throw new Error("recovery id 2 or 3 invalid");const He=(Re&1)===0?"02":"03",St=u.fromHex(He+y(je)),Xe=c(je),Et=l(-Ye*Xe),st=l(ge*Xe),O=u.BASE.multiplyAndAddUnsafe(St,Et,st);if(!O)throw new Error("point at infinify");return O.assertValidity(),O}hasHighS(){return T(this.s)}normalizeS(){return this.hasHighS()?new C(this.r,l(-this.s),this.recovery):this}toDERRawBytes(){return ii(this.toDERHex())}toDERHex(){return yr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ii(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}const N={isValidPrivateKey(K){try{return d(K),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const K=zp(e.n);return sw(e.randomBytes(K),e.n)},precompute(K=8,ee=u.BASE){return ee._setWindowSize(K),ee.multiply(BigInt(3)),ee}};function L(K,ee=!0){return u.fromPrivateKey(K).toRawBytes(ee)}function D(K){const ee=K instanceof Uint8Array,ae=typeof K=="string",ge=(ee||ae)&&K.length;return ee?ge===r||ge===i:ae?ge===2*r||ge===2*i:K instanceof u}function Y(K,ee,ae=!0){if(D(K))throw new Error("first arg must be private key");if(!D(ee))throw new Error("second arg must be public key");return u.fromHex(ee).multiply(d(K)).toRawBytes(ae)}const W=e.bits2int||function(K){const ee=Er(K),ae=K.length*8-e.nBitLength;return ae>0?ee>>BigInt(ae):ee},$=e.bits2int_modN||function(K){return l(W(K))},Q=iu(e.nBitLength);function J(K){if(typeof K!="bigint")throw new Error("bigint expected");if(!(vn<=K&&K<Q))throw new Error(`bigint expected < 2^${e.nBitLength}`);return oi(K,e.nByteLength)}function re(K,ee,ae=ce){if(["recovered","canonical"].some(Z=>Z in ae))throw new Error("sign() legacy options not supported");const{hash:ge,randomBytes:Re}=e;let{lowS:Ye,prehash:je,extraEntropy:He}=ae;Ye==null&&(Ye=!0),K=Vs("msgHash",K),je&&(K=Vs("prehashed msgHash",ge(K)));const St=$(K),Xe=d(ee),Et=[J(Xe),J(St)];if(He!=null){const Z=He===!0?Re(s.BYTES):He;Et.push(Vs("extraEntropy",Z))}const st=so(...Et),O=St;function te(Z){const le=W(Z);if(!h(le))return;const De=c(le),v=u.BASE.multiply(le).toAffine(),_=l(v.x);if(_===vn)return;const I=l(De*l(O+_*Xe));if(I===vn)return;let U=(v.x===_?0:2)|Number(v.y&xs),V=I;return Ye&&T(I)&&(V=w(I),U^=1),new C(_,V,U)}return{seed:st,k2sig:te}}const ce={lowS:e.lowS,prehash:!1},H={lowS:e.lowS,prehash:!1};function we(K,ee,ae=ce){const{seed:ge,k2sig:Re}=re(K,ee,ae),Ye=e;return Yp(Ye.hash.outputLen,Ye.nByteLength,Ye.hmac)(ge,Re)}u.BASE._setWindowSize(8);function Ce(K,ee,ae,ge=H){const Re=K;if(ee=Vs("msgHash",ee),ae=Vs("publicKey",ae),"strict"in ge)throw new Error("options.strict was renamed to lowS");const{lowS:Ye,prehash:je}=ge;let He,St;try{if(typeof Re=="string"||Re instanceof Uint8Array)try{He=C.fromDER(Re)}catch(v){if(!(v instanceof yr.Err))throw v;He=C.fromCompact(Re)}else if(typeof Re=="object"&&typeof Re.r=="bigint"&&typeof Re.s=="bigint"){const{r:v,s:_}=Re;He=new C(v,_)}else throw new Error("PARSE");St=u.fromHex(ae)}catch(v){if(v.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(Ye&&He.hasHighS())return!1;je&&(ee=e.hash(ee));const{r:Xe,s:Et}=He,st=$(ee),O=c(Et),te=l(st*O),Z=l(Xe*O),le=u.BASE.multiplyAndAddUnsafe(St,te,Z)?.toAffine();return le?l(le.x)===Xe:!1}return{CURVE:e,getPublicKey:L,getSharedSecret:Y,sign:we,verify:Ce,ProjectivePoint:u,Signature:C,utils:N}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function dw(t){return{hash:t,hmac:(e,...s)=>Pp(t,e,Zv(...s)),randomBytes:Xv}}function fw(t,e){const s=n=>uw({...t,...dw(n)});return Object.freeze({...s(e),create:s})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Jp=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Id=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),hw=BigInt(1),oc=BigInt(2),Rd=(t,e)=>(t+e/oc)/e;function pw(t){const e=Jp,s=BigInt(3),n=BigInt(6),r=BigInt(11),i=BigInt(22),o=BigInt(23),l=BigInt(44),c=BigInt(88),u=t*t*t%e,d=u*u*t%e,f=Ds(d,s,e)*d%e,h=Ds(f,s,e)*d%e,y=Ds(h,oc,e)*u%e,T=Ds(y,r,e)*y%e,w=Ds(T,i,e)*T%e,k=Ds(w,l,e)*w%e,C=Ds(k,c,e)*k%e,N=Ds(C,l,e)*w%e,L=Ds(N,s,e)*d%e,D=Ds(L,o,e)*T%e,Y=Ds(D,n,e)*u%e,W=Ds(Y,oc,e);if(!ac.eql(ac.sqr(W),t))throw new Error("Cannot find square root");return W}const ac=tw(Jp,void 0,void 0,{sqrt:pw}),Fn=fw({a:BigInt(0),b:BigInt(7),Fp:ac,n:Id,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Id,s=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-hw*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),r=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=s,o=BigInt("0x100000000000000000000000000000000"),l=Rd(i*t,e),c=Rd(-n*t,e);let u=ys(t-l*s-c*r,e),d=ys(-l*n-c*i,e);const f=u>o,h=d>o;if(f&&(u=e-u),h&&(d=e-d),u>o||d>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:f,k1:u,k2neg:h,k2:d}}}},Sp);BigInt(0);Fn.ProjectivePoint;const no="0x0000000000000000000000000000000000000000",Dd="0x0000000000000000000000000000000000000000000000000000000000000000",xd=BigInt(0),Nd=BigInt(1),Ld=BigInt(2),Od=BigInt(27),Ud=BigInt(28),Bo=BigInt(35),Br={};function Bd(t){return Sn(Lt(t),32)}class vt{#e;#t;#s;#n;get r(){return this.#e}set r(e){P(Jr(e)===32,"invalid r","value",e),this.#e=oe(e)}get s(){return P(parseInt(this.#t.substring(0,3))<8,"non-canonical s; use ._s","s",this.#t),this.#t}set s(e){P(Jr(e)===32,"invalid s","value",e),this.#t=oe(e)}get _s(){return this.#t}isValid(){return parseInt(this.#t.substring(0,3))<8}get v(){return this.#s}set v(e){const s=Ne(e,"value");P(s===27||s===28,"invalid v","v",e),this.#s=s}get networkV(){return this.#n}get legacyChainId(){const e=this.networkV;return e==null?null:vt.getChainId(e)}get yParity(){return this.v===27?0:1}get yParityAndS(){const e=Oe(this.s);return this.yParity&&(e[0]|=128),oe(e)}get compactSerialized(){return At([this.r,this.yParityAndS])}get serialized(){return At([this.r,this.s,this.yParity?"0x1c":"0x1b"])}constructor(e,s,n,r){vo(e,Br,"Signature"),this.#e=s,this.#t=n,this.#s=r,this.#n=null}[Symbol.for("nodejs.util.inspect.custom")](){return`Signature { r: "${this.r}", s: "${this._s}"${this.isValid()?"":', valid: "false"'}, yParity: ${this.yParity}, networkV: ${this.networkV} }`}clone(){const e=new vt(Br,this.r,this._s,this.v);return this.networkV&&(e.#n=this.networkV),e}toJSON(){const e=this.networkV;return{_type:"signature",networkV:e!=null?e.toString():null,r:this.r,s:this._s,v:this.v}}static getChainId(e){const s=he(e,"v");return s==Od||s==Ud?xd:(P(s>=Bo,"invalid EIP-155 v","v",e),(s-Bo)/Ld)}static getChainIdV(e,s){return he(e)*Ld+BigInt(35+s-27)}static getNormalizedV(e){const s=he(e);return s===xd||s===Od?27:s===Nd||s===Ud?28:(P(s>=Bo,"invalid v","v",e),s&Nd?27:28)}static from(e){function s(u,d){P(u,d,"signature",e)}if(e==null)return new vt(Br,Dd,Dd,27);if(typeof e=="string"){const u=Oe(e,"signature");if(u.length===64){const d=oe(u.slice(0,32)),f=u.slice(32,64),h=f[0]&128?28:27;return f[0]&=127,new vt(Br,d,oe(f),h)}if(u.length===65){const d=oe(u.slice(0,32)),f=oe(u.slice(32,64)),h=vt.getNormalizedV(u[64]);return new vt(Br,d,f,h)}s(!1,"invalid raw signature length")}if(e instanceof vt)return e.clone();const n=e.r;s(n!=null,"missing r");const r=Bd(n),i=(function(u,d){if(u!=null)return Bd(u);if(d!=null){s(ct(d,32),"invalid yParityAndS");const f=Oe(d);return f[0]&=127,oe(f)}s(!1,"missing s")})(e.s,e.yParityAndS),{networkV:o,v:l}=(function(u,d,f){if(u!=null){const h=he(u);return{networkV:h>=Bo?h:void 0,v:vt.getNormalizedV(h)}}if(d!=null)return s(ct(d,32),"invalid yParityAndS"),{v:Oe(d)[0]&128?28:27};if(f!=null){switch(Ne(f,"sig.yParity")){case 0:return{v:27};case 1:return{v:28}}s(!1,"invalid yParity")}s(!1,"missing v")})(e.v,e.yParityAndS,e.yParity),c=new vt(Br,r,i,l);return o&&(c.#n=o),s(e.yParity==null||Ne(e.yParity,"sig.yParity")===c.yParity,"yParity mismatch"),s(e.yParityAndS==null||e.yParityAndS===c.yParityAndS,"yParityAndS mismatch"),c}}class bn{#e;constructor(e){P(Jr(e)===32,"invalid private key","privateKey","[REDACTED]"),this.#e=oe(e)}get privateKey(){return this.#e}get publicKey(){return bn.computePublicKey(this.#e)}get compressedPublicKey(){return bn.computePublicKey(this.#e,!0)}sign(e){P(Jr(e)===32,"invalid digest length","digest",e);const s=Fn.sign(ls(e),ls(this.#e),{lowS:!0});return vt.from({r:Jn(s.r,32),s:Jn(s.s,32),v:s.recovery?28:27})}computeSharedSecret(e){const s=bn.computePublicKey(e);return oe(Fn.getSharedSecret(ls(this.#e),Oe(s),!1))}static computePublicKey(e,s){let n=Oe(e,"key");if(n.length===32){const i=Fn.getPublicKey(n,!!s);return oe(i)}if(n.length===64){const i=new Uint8Array(65);i[0]=4,i.set(n,1),n=i}const r=Fn.ProjectivePoint.fromHex(n);return oe(r.toRawBytes(s))}static recoverPublicKey(e,s){P(Jr(e)===32,"invalid digest length","digest",e);const n=vt.from(s);let r=Fn.Signature.fromCompact(ls(At([n.r,n.s])));r=r.addRecoveryBit(n.yParity);const i=r.recoverPublicKey(ls(e));return P(i!=null,"invalid signature for digest","signature",s),"0x"+i.toHex(!1)}static addPoints(e,s,n){const r=Fn.ProjectivePoint.fromHex(bn.computePublicKey(e).substring(2)),i=Fn.ProjectivePoint.fromHex(bn.computePublicKey(s).substring(2));return"0x"+r.add(i).toHex(!!n)}}const mw=BigInt(0),gw=BigInt(36);function Md(t){t=t.toLowerCase();const e=t.substring(2).split(""),s=new Uint8Array(40);for(let r=0;r<40;r++)s[r]=e[r].charCodeAt(0);const n=Oe(wt(s));for(let r=0;r<40;r+=2)n[r>>1]>>4>=8&&(e[r]=e[r].toUpperCase()),(n[r>>1]&15)>=8&&(e[r+1]=e[r+1].toUpperCase());return"0x"+e.join("")}const ou={};for(let t=0;t<10;t++)ou[String(t)]=String(t);for(let t=0;t<26;t++)ou[String.fromCharCode(65+t)]=String(10+t);const Fd=15;function yw(t){t=t.toUpperCase(),t=t.substring(4)+t.substring(0,2)+"00";let e=t.split("").map(n=>ou[n]).join("");for(;e.length>=Fd;){let n=e.substring(0,Fd);e=parseInt(n,10)%97+e.substring(n.length)}let s=String(98-parseInt(e,10)%97);for(;s.length<2;)s="0"+s;return s}const vw=(function(){const t={};for(let e=0;e<36;e++){const s="0123456789abcdefghijklmnopqrstuvwxyz"[e];t[s]=BigInt(e)}return t})();function bw(t){t=t.toLowerCase();let e=mw;for(let s=0;s<t.length;s++)e=e*gw+vw[t[s]];return e}function Qe(t){if(P(typeof t=="string","invalid address","address",t),t.match(/^(0x)?[0-9a-fA-F]{40}$/)){t.startsWith("0x")||(t="0x"+t);const e=Md(t);return P(!t.match(/([A-F].*[a-f])|([a-f].*[A-F])/)||e===t,"bad address checksum","address",t),e}if(t.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){P(t.substring(2,4)===yw(t),"bad icap checksum","address",t);let e=bw(t.substring(4)).toString(16);for(;e.length<40;)e="0"+e;return Md("0x"+e)}P(!1,"invalid address","address",t)}function ww(t){const e=Qe(t.from);let n=he(t.nonce,"tx.nonce").toString(16);return n==="0"?n="0x":n.length%2?n="0x0"+n:n="0x"+n,Qe(yt(wt(qn([e,n])),12))}function qp(t){return t&&typeof t.getAddress=="function"}function fa(t){try{return Qe(t),!0}catch{}return!1}async function Tl(t,e){const s=await e;return(s==null||s==="0x0000000000000000000000000000000000000000")&&(j(typeof t!="string","unconfigured name","UNCONFIGURED_NAME",{value:t}),P(!1,"invalid AddressLike value; did not resolve to a value address","target",t)),Qe(s)}function ds(t,e){if(typeof t=="string")return t.match(/^0x[0-9a-f]{40}$/i)?Qe(t):(j(e!=null,"ENS resolution requires a provider","UNSUPPORTED_OPERATION",{operation:"resolveName"}),Tl(t,e.resolveName(t)));if(qp(t))return Tl(t,t.getAddress());if(t&&typeof t.then=="function")return Tl(t,t);P(!1,"unsupported addressable value","target",t)}const fn={};function de(t,e){let s=!1;return e<0&&(s=!0,e*=-1),new bt(fn,`${s?"":"u"}int${e}`,t,{signed:s,width:e})}function We(t,e){return new bt(fn,`bytes${e||""}`,t,{size:e})}const Vd=Symbol.for("_ethers_typed");class bt{type;value;#e;_typedSymbol;constructor(e,s,n,r){r==null&&(r=null),vo(fn,e,"Typed"),_e(this,{_typedSymbol:Vd,type:s,value:n}),this.#e=r,this.format()}format(){if(this.type==="array")throw new Error("");if(this.type==="dynamicArray")throw new Error("");return this.type==="tuple"?`tuple(${this.value.map(e=>e.format()).join(",")})`:this.type}defaultValue(){return 0}minValue(){return 0}maxValue(){return 0}isBigInt(){return!!this.type.match(/^u?int[0-9]+$/)}isData(){return this.type.startsWith("bytes")}isString(){return this.type==="string"}get tupleName(){if(this.type!=="tuple")throw TypeError("not a tuple");return this.#e}get arrayLength(){if(this.type!=="array")throw TypeError("not an array");return this.#e===!0?-1:this.#e===!1?this.value.length:null}static from(e,s){return new bt(fn,e,s)}static uint8(e){return de(e,8)}static uint16(e){return de(e,16)}static uint24(e){return de(e,24)}static uint32(e){return de(e,32)}static uint40(e){return de(e,40)}static uint48(e){return de(e,48)}static uint56(e){return de(e,56)}static uint64(e){return de(e,64)}static uint72(e){return de(e,72)}static uint80(e){return de(e,80)}static uint88(e){return de(e,88)}static uint96(e){return de(e,96)}static uint104(e){return de(e,104)}static uint112(e){return de(e,112)}static uint120(e){return de(e,120)}static uint128(e){return de(e,128)}static uint136(e){return de(e,136)}static uint144(e){return de(e,144)}static uint152(e){return de(e,152)}static uint160(e){return de(e,160)}static uint168(e){return de(e,168)}static uint176(e){return de(e,176)}static uint184(e){return de(e,184)}static uint192(e){return de(e,192)}static uint200(e){return de(e,200)}static uint208(e){return de(e,208)}static uint216(e){return de(e,216)}static uint224(e){return de(e,224)}static uint232(e){return de(e,232)}static uint240(e){return de(e,240)}static uint248(e){return de(e,248)}static uint256(e){return de(e,256)}static uint(e){return de(e,256)}static int8(e){return de(e,-8)}static int16(e){return de(e,-16)}static int24(e){return de(e,-24)}static int32(e){return de(e,-32)}static int40(e){return de(e,-40)}static int48(e){return de(e,-48)}static int56(e){return de(e,-56)}static int64(e){return de(e,-64)}static int72(e){return de(e,-72)}static int80(e){return de(e,-80)}static int88(e){return de(e,-88)}static int96(e){return de(e,-96)}static int104(e){return de(e,-104)}static int112(e){return de(e,-112)}static int120(e){return de(e,-120)}static int128(e){return de(e,-128)}static int136(e){return de(e,-136)}static int144(e){return de(e,-144)}static int152(e){return de(e,-152)}static int160(e){return de(e,-160)}static int168(e){return de(e,-168)}static int176(e){return de(e,-176)}static int184(e){return de(e,-184)}static int192(e){return de(e,-192)}static int200(e){return de(e,-200)}static int208(e){return de(e,-208)}static int216(e){return de(e,-216)}static int224(e){return de(e,-224)}static int232(e){return de(e,-232)}static int240(e){return de(e,-240)}static int248(e){return de(e,-248)}static int256(e){return de(e,-256)}static int(e){return de(e,-256)}static bytes1(e){return We(e,1)}static bytes2(e){return We(e,2)}static bytes3(e){return We(e,3)}static bytes4(e){return We(e,4)}static bytes5(e){return We(e,5)}static bytes6(e){return We(e,6)}static bytes7(e){return We(e,7)}static bytes8(e){return We(e,8)}static bytes9(e){return We(e,9)}static bytes10(e){return We(e,10)}static bytes11(e){return We(e,11)}static bytes12(e){return We(e,12)}static bytes13(e){return We(e,13)}static bytes14(e){return We(e,14)}static bytes15(e){return We(e,15)}static bytes16(e){return We(e,16)}static bytes17(e){return We(e,17)}static bytes18(e){return We(e,18)}static bytes19(e){return We(e,19)}static bytes20(e){return We(e,20)}static bytes21(e){return We(e,21)}static bytes22(e){return We(e,22)}static bytes23(e){return We(e,23)}static bytes24(e){return We(e,24)}static bytes25(e){return We(e,25)}static bytes26(e){return We(e,26)}static bytes27(e){return We(e,27)}static bytes28(e){return We(e,28)}static bytes29(e){return We(e,29)}static bytes30(e){return We(e,30)}static bytes31(e){return We(e,31)}static bytes32(e){return We(e,32)}static address(e){return new bt(fn,"address",e)}static bool(e){return new bt(fn,"bool",!!e)}static bytes(e){return new bt(fn,"bytes",e)}static string(e){return new bt(fn,"string",e)}static array(e,s){throw new Error("not implemented yet")}static tuple(e,s){throw new Error("not implemented yet")}static overrides(e){return new bt(fn,"overrides",Object.assign({},e))}static isTyped(e){return e&&typeof e=="object"&&"_typedSymbol"in e&&e._typedSymbol===Vd}static dereference(e,s){if(bt.isTyped(e)){if(e.type!==s)throw new Error(`invalid type: expecetd ${s}, got ${e.type}`);return e.value}return e}}class Aw extends Dn{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,s){let n=bt.dereference(s,"string");try{n=Qe(n)}catch(r){return this._throwError(r.message,s)}return e.writeValue(n)}decode(e){return Qe(Jn(e.readValue(),20))}}class Ew extends Dn{coder;constructor(e){super(e.name,e.type,"_",e.dynamic),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,s){return this.coder.encode(e,s)}decode(e){return this.coder.decode(e)}}function Zp(t,e,s){let n=[];if(Array.isArray(s))n=s;else if(s&&typeof s=="object"){let c={};n=e.map(u=>{const d=u.localName;return j(d,"cannot encode object for signature with missing names","INVALID_ARGUMENT",{argument:"values",info:{coder:u},value:s}),j(!c[d],"cannot encode object for signature with duplicate names","INVALID_ARGUMENT",{argument:"values",info:{coder:u},value:s}),c[d]=!0,s[d]})}else P(!1,"invalid tuple value","tuple",s);P(e.length===n.length,"types/value length mismatch","tuple",s);let r=new sc,i=new sc,o=[];e.forEach((c,u)=>{let d=n[u];if(c.dynamic){let f=i.length;c.encode(i,d);let h=r.writeUpdatableValue();o.push(y=>{h(y+f)})}else c.encode(r,d)}),o.forEach(c=>{c(r.length)});let l=t.appendWriter(r);return l+=t.appendWriter(i),l}function Xp(t,e){let s=[],n=[],r=t.subReader(0);return e.forEach(i=>{let o=null;if(i.dynamic){let l=t.readIndex(),c=r.subReader(l);try{o=i.decode(c)}catch(u){if(Gt(u,"BUFFER_OVERRUN"))throw u;o=u,o.baseType=i.name,o.name=i.localName,o.type=i.type}}else try{o=i.decode(t)}catch(l){if(Gt(l,"BUFFER_OVERRUN"))throw l;o=l,o.baseType=i.name,o.name=i.localName,o.type=i.type}if(o==null)throw new Error("investigate");s.push(o),n.push(i.localName||null)}),wn.fromItems(s,n)}class _w extends Dn{coder;length;constructor(e,s,n){const r=e.type+"["+(s>=0?s:"")+"]",i=s===-1||e.dynamic;super("array",r,n,i),_e(this,{coder:e,length:s})}defaultValue(){const e=this.coder.defaultValue(),s=[];for(let n=0;n<this.length;n++)s.push(e);return s}encode(e,s){const n=bt.dereference(s,"array");Array.isArray(n)||this._throwError("expected array value",n);let r=this.length;r===-1&&(r=n.length,e.writeValue(n.length)),cp(n.length,r,"coder array"+(this.localName?" "+this.localName:""));let i=[];for(let o=0;o<n.length;o++)i.push(this.coder);return Zp(e,i,n)}decode(e){let s=this.length;s===-1&&(s=e.readIndex(),j(s*us<=e.dataLength,"insufficient data length","BUFFER_OVERRUN",{buffer:e.bytes,offset:s*us,length:e.dataLength}));let n=[];for(let r=0;r<s;r++)n.push(new Ew(this.coder));return Xp(e,n)}}class Tw extends Dn{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,s){const n=bt.dereference(s,"bool");return e.writeValue(n?1:0)}decode(e){return!!e.readValue()}}class em extends Dn{constructor(e,s){super(e,e,s,!0)}defaultValue(){return"0x"}encode(e,s){s=ls(s);let n=e.writeValue(s.length);return n+=e.writeBytes(s),n}decode(e){return e.readBytes(e.readIndex(),!0)}}class Pw extends em{constructor(e){super("bytes",e)}decode(e){return oe(super.decode(e))}}class kw extends Dn{size;constructor(e,s){let n="bytes"+String(e);super(n,n,s,!1),_e(this,{size:e},{size:"number"})}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(e,s){let n=ls(bt.dereference(s,this.type));return n.length!==this.size&&this._throwError("incorrect data length",s),e.writeBytes(n)}decode(e){return oe(e.readBytes(this.size))}}const Sw=new Uint8Array([]);class Cw extends Dn{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,s){return s!=null&&this._throwError("not null",s),e.writeBytes(Sw)}decode(e){return e.readBytes(0),null}}const Iw=BigInt(0),Rw=BigInt(1),Dw=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");class xw extends Dn{size;signed;constructor(e,s,n){const r=(s?"int":"uint")+e*8;super(r,r,n,!1),_e(this,{size:e,signed:s},{size:"number",signed:"boolean"})}defaultValue(){return 0}encode(e,s){let n=he(bt.dereference(s,this.type)),r=gr(Dw,us*8);if(this.signed){let i=gr(r,this.size*8-1);(n>i||n<-(i+Rw))&&this._throwError("value out-of-bounds",s),n=fp(n,8*us)}else(n<Iw||n>gr(r,this.size*8))&&this._throwError("value out-of-bounds",s);return e.writeValue(n)}decode(e){let s=gr(e.readValue(),this.size*8);return this.signed&&(s=ca(s,this.size*8)),s}}class Nw extends em{constructor(e){super("string",e)}defaultValue(){return""}encode(e,s){return super.encode(e,_n(bt.dereference(s,"string")))}decode(e){return ua(super.decode(e))}}class Mo extends Dn{coders;constructor(e,s){let n=!1;const r=[];e.forEach(o=>{o.dynamic&&(n=!0),r.push(o.type)});const i="tuple("+r.join(",")+")";super("tuple",i,s,n),_e(this,{coders:Object.freeze(e.slice())})}defaultValue(){const e=[];this.coders.forEach(n=>{e.push(n.defaultValue())});const s=this.coders.reduce((n,r)=>{const i=r.localName;return i&&(n[i]||(n[i]=0),n[i]++),n},{});return this.coders.forEach((n,r)=>{let i=n.localName;!i||s[i]!==1||(i==="length"&&(i="_length"),e[i]==null&&(e[i]=e[r]))}),Object.freeze(e)}encode(e,s){const n=bt.dereference(s,"tuple");return Zp(e,this.coders,n)}decode(e){return Xp(e,this.coders)}}function Pl(t,e){return{address:Qe(t),storageKeys:e.map((s,n)=>(P(ct(s,32),"invalid slot",`storageKeys[${n}]`,s),s.toLowerCase()))}}function Ir(t){if(Array.isArray(t))return t.map((s,n)=>Array.isArray(s)?(P(s.length===2,"invalid slot set",`value[${n}]`,s),Pl(s[0],s[1])):(P(s!=null&&typeof s=="object","invalid address-slot set","value",t),Pl(s.address,s.storageKeys)));P(t!=null&&typeof t=="object","invalid access list","value",t);const e=Object.keys(t).map(s=>{const n=t[s].reduce((r,i)=>(r[i]=!0,r),{});return Pl(s,Object.keys(n).sort())});return e.sort((s,n)=>s.address.localeCompare(n.address)),e}function tm(t){return{address:Qe(t.address),nonce:he(t.nonce!=null?t.nonce:0),chainId:he(t.chainId!=null?t.chainId:0),signature:vt.from(t.signature)}}function Lw(t){let e;return typeof t=="string"?e=bn.computePublicKey(t,!1):e=t.publicKey,Qe(wt("0x"+e.substring(4)).substring(26))}function Ow(t,e){return Lw(bn.recoverPublicKey(t,e))}const Ft=BigInt(0),Uw=BigInt(2),Bw=BigInt(27),Mw=BigInt(28),Fw=BigInt(35),Vw=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),kl=4096*32;function $w(t){return{blobToKzgCommitment:n=>{if("computeBlobProof"in t){if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return Oe(t.blobToKzgCommitment(oe(n)))}else if("blobToKzgCommitment"in t&&typeof t.blobToKzgCommitment=="function")return Oe(t.blobToKzgCommitment(n));if("blobToKZGCommitment"in t&&typeof t.blobToKZGCommitment=="function")return Oe(t.blobToKZGCommitment(oe(n)));P(!1,"unsupported KZG library","kzg",t)},computeBlobKzgProof:(n,r)=>{if("computeBlobProof"in t&&typeof t.computeBlobProof=="function")return Oe(t.computeBlobProof(oe(n),oe(r)));if("computeBlobKzgProof"in t&&typeof t.computeBlobKzgProof=="function")return t.computeBlobKzgProof(n,r);if("computeBlobKZGProof"in t&&typeof t.computeBlobKZGProof=="function")return Oe(t.computeBlobKZGProof(oe(n),oe(r)));P(!1,"unsupported KZG library","kzg",t)}}}function $d(t,e){let s=t.toString(16);for(;s.length<2;)s="0"+s;return s+=gi(e).substring(4),"0x"+s}function yi(t){return t==="0x"?null:Qe(t)}function Ha(t,e){try{return Ir(t)}catch(s){P(!1,s.message,e,t)}}function jw(t,e){try{if(!Array.isArray(t))throw new Error("authorizationList: invalid array");const s=[];for(let n=0;n<t.length;n++){const r=t[n];if(!Array.isArray(r))throw new Error(`authorization[${n}]: invalid array`);if(r.length!==6)throw new Error(`authorization[${n}]: wrong length`);if(!r[1])throw new Error(`authorization[${n}]: null address`);s.push({address:yi(r[1]),nonce:tt(r[2],"nonce"),chainId:tt(r[0],"chainId"),signature:vt.from({yParity:Rr(r[3],"yParity"),r:Sn(r[4],32),s:Sn(r[5],32)})})}return s}catch(s){P(!1,s.message,e,t)}}function Rr(t,e){return t==="0x"?0:Ne(t,e)}function tt(t,e){if(t==="0x")return Ft;const s=he(t,e);return P(s<=Vw,"value exceeds uint size",e,s),s}function $e(t,e){const s=he(t,"value"),n=Lt(s);return P(n.length<=32,"value too large",`tx.${e}`,s),n}function Wa(t){return Ir(t).map(e=>[e.address,e.storageKeys])}function Hw(t){return t.map(e=>[$e(e.chainId,"chainId"),e.address,$e(e.nonce,"nonce"),$e(e.signature.yParity,"yParity"),Lt(e.signature.r),Lt(e.signature.s)])}function Ww(t,e){P(Array.isArray(t),`invalid ${e}`,"value",t);for(let s=0;s<t.length;s++)P(ct(t[s],32),"invalid ${ param } hash",`value[${s}]`,t[s]);return t}function Yw(t){const e=bo(t);P(Array.isArray(e)&&(e.length===9||e.length===6),"invalid field count for legacy transaction","data",t);const s={type:0,nonce:Rr(e[0],"nonce"),gasPrice:tt(e[1],"gasPrice"),gasLimit:tt(e[2],"gasLimit"),to:yi(e[3]),value:tt(e[4],"value"),data:oe(e[5]),chainId:Ft};if(e.length===6)return s;const n=tt(e[6],"v"),r=tt(e[7],"r"),i=tt(e[8],"s");if(r===Ft&&i===Ft)s.chainId=n;else{let o=(n-Fw)/Uw;o<Ft&&(o=Ft),s.chainId=o,P(o!==Ft||n===Bw||n===Mw,"non-canonical legacy v","v",e[6]),s.signature=vt.from({r:Sn(e[7],32),s:Sn(e[8],32),v:n})}return s}function Gw(t,e){const s=[$e(t.nonce,"nonce"),$e(t.gasPrice||0,"gasPrice"),$e(t.gasLimit,"gasLimit"),t.to||"0x",$e(t.value,"value"),t.data];let n=Ft;if(t.chainId!=Ft)n=he(t.chainId,"tx.chainId"),P(!e||e.networkV==null||e.legacyChainId===n,"tx.chainId/sig.v mismatch","sig",e);else if(t.signature){const i=t.signature.legacyChainId;i!=null&&(n=i)}if(!e)return n!==Ft&&(s.push(Lt(n)),s.push("0x"),s.push("0x")),qn(s);let r=BigInt(27+e.yParity);return n!==Ft?r=vt.getChainIdV(n,e.v):BigInt(e.v)!==r&&P(!1,"tx.chainId/sig.v mismatch","sig",e),s.push(Lt(r)),s.push(Lt(e.r)),s.push(Lt(e.s)),qn(s)}function Ya(t,e){let s;try{if(s=Rr(e[0],"yParity"),s!==0&&s!==1)throw new Error("bad yParity")}catch{P(!1,"invalid yParity","yParity",e[0])}const n=Sn(e[1],32),r=Sn(e[2],32),i=vt.from({r:n,s:r,yParity:s});t.signature=i}function Kw(t){const e=bo(Oe(t).slice(1));P(Array.isArray(e)&&(e.length===9||e.length===12),"invalid field count for transaction type: 2","data",oe(t));const s={type:2,chainId:tt(e[0],"chainId"),nonce:Rr(e[1],"nonce"),maxPriorityFeePerGas:tt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:tt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:tt(e[4],"gasLimit"),to:yi(e[5]),value:tt(e[6],"value"),data:oe(e[7]),accessList:Ha(e[8],"accessList")};return e.length===9||Ya(s,e.slice(9)),s}function zw(t,e){const s=[$e(t.chainId,"chainId"),$e(t.nonce,"nonce"),$e(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),$e(t.maxFeePerGas||0,"maxFeePerGas"),$e(t.gasLimit,"gasLimit"),t.to||"0x",$e(t.value,"value"),t.data,Wa(t.accessList||[])];return e&&(s.push($e(e.yParity,"yParity")),s.push(Lt(e.r)),s.push(Lt(e.s))),At(["0x02",qn(s)])}function Qw(t){const e=bo(Oe(t).slice(1));P(Array.isArray(e)&&(e.length===8||e.length===11),"invalid field count for transaction type: 1","data",oe(t));const s={type:1,chainId:tt(e[0],"chainId"),nonce:Rr(e[1],"nonce"),gasPrice:tt(e[2],"gasPrice"),gasLimit:tt(e[3],"gasLimit"),to:yi(e[4]),value:tt(e[5],"value"),data:oe(e[6]),accessList:Ha(e[7],"accessList")};return e.length===8||Ya(s,e.slice(8)),s}function Jw(t,e){const s=[$e(t.chainId,"chainId"),$e(t.nonce,"nonce"),$e(t.gasPrice||0,"gasPrice"),$e(t.gasLimit,"gasLimit"),t.to||"0x",$e(t.value,"value"),t.data,Wa(t.accessList||[])];return e&&(s.push($e(e.yParity,"recoveryParam")),s.push(Lt(e.r)),s.push(Lt(e.s))),At(["0x01",qn(s)])}function qw(t){let e=bo(Oe(t).slice(1)),s="3",n=null;if(e.length===4&&Array.isArray(e[0])){s="3 (network format)";const i=e[1],o=e[2],l=e[3];P(Array.isArray(i),"invalid network format: blobs not an array","fields[1]",i),P(Array.isArray(o),"invalid network format: commitments not an array","fields[2]",o),P(Array.isArray(l),"invalid network format: proofs not an array","fields[3]",l),P(i.length===o.length,"invalid network format: blobs/commitments length mismatch","fields",e),P(i.length===l.length,"invalid network format: blobs/proofs length mismatch","fields",e),n=[];for(let c=0;c<e[1].length;c++)n.push({data:i[c],commitment:o[c],proof:l[c]});e=e[0]}P(Array.isArray(e)&&(e.length===11||e.length===14),`invalid field count for transaction type: ${s}`,"data",oe(t));const r={type:3,chainId:tt(e[0],"chainId"),nonce:Rr(e[1],"nonce"),maxPriorityFeePerGas:tt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:tt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:tt(e[4],"gasLimit"),to:yi(e[5]),value:tt(e[6],"value"),data:oe(e[7]),accessList:Ha(e[8],"accessList"),maxFeePerBlobGas:tt(e[9],"maxFeePerBlobGas"),blobVersionedHashes:e[10]};n&&(r.blobs=n),P(r.to!=null,`invalid address for transaction type: ${s}`,"data",t),P(Array.isArray(r.blobVersionedHashes),"invalid blobVersionedHashes: must be an array","data",t);for(let i=0;i<r.blobVersionedHashes.length;i++)P(ct(r.blobVersionedHashes[i],32),`invalid blobVersionedHash at index ${i}: must be length 32`,"data",t);return e.length===11||Ya(r,e.slice(11)),r}function Zw(t,e,s){const n=[$e(t.chainId,"chainId"),$e(t.nonce,"nonce"),$e(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),$e(t.maxFeePerGas||0,"maxFeePerGas"),$e(t.gasLimit,"gasLimit"),t.to||no,$e(t.value,"value"),t.data,Wa(t.accessList||[]),$e(t.maxFeePerBlobGas||0,"maxFeePerBlobGas"),Ww(t.blobVersionedHashes||[],"blobVersionedHashes")];return e&&(n.push($e(e.yParity,"yParity")),n.push(Lt(e.r)),n.push(Lt(e.s)),s)?At(["0x03",qn([n,s.map(r=>r.data),s.map(r=>r.commitment),s.map(r=>r.proof)])]):At(["0x03",qn(n)])}function Xw(t){const e=bo(Oe(t).slice(1));P(Array.isArray(e)&&(e.length===10||e.length===13),"invalid field count for transaction type: 4","data",oe(t));const s={type:4,chainId:tt(e[0],"chainId"),nonce:Rr(e[1],"nonce"),maxPriorityFeePerGas:tt(e[2],"maxPriorityFeePerGas"),maxFeePerGas:tt(e[3],"maxFeePerGas"),gasPrice:null,gasLimit:tt(e[4],"gasLimit"),to:yi(e[5]),value:tt(e[6],"value"),data:oe(e[7]),accessList:Ha(e[8],"accessList"),authorizationList:jw(e[9],"authorizationList")};return e.length===10||Ya(s,e.slice(10)),s}function e1(t,e){const s=[$e(t.chainId,"chainId"),$e(t.nonce,"nonce"),$e(t.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),$e(t.maxFeePerGas||0,"maxFeePerGas"),$e(t.gasLimit,"gasLimit"),t.to||"0x",$e(t.value,"value"),t.data,Wa(t.accessList||[]),Hw(t.authorizationList||[])];return e&&(s.push($e(e.yParity,"yParity")),s.push(Lt(e.r)),s.push(Lt(e.s))),At(["0x04",qn(s)])}class $s{#e;#t;#s;#n;#r;#o;#i;#a;#d;#c;#p;#m;#l;#u;#f;#h;#y;get type(){return this.#e}set type(e){switch(e){case null:this.#e=null;break;case 0:case"legacy":this.#e=0;break;case 1:case"berlin":case"eip-2930":this.#e=1;break;case 2:case"london":case"eip-1559":this.#e=2;break;case 3:case"cancun":case"eip-4844":this.#e=3;break;case 4:case"pectra":case"eip-7702":this.#e=4;break;default:P(!1,"unsupported transaction type","type",e)}}get typeName(){switch(this.type){case 0:return"legacy";case 1:return"eip-2930";case 2:return"eip-1559";case 3:return"eip-4844";case 4:return"eip-7702"}return null}get to(){const e=this.#t;return e==null&&this.type===3?no:e}set to(e){this.#t=e==null?null:Qe(e)}get nonce(){return this.#n}set nonce(e){this.#n=Ne(e,"value")}get gasLimit(){return this.#r}set gasLimit(e){this.#r=he(e)}get gasPrice(){const e=this.#o;return e==null&&(this.type===0||this.type===1)?Ft:e}set gasPrice(e){this.#o=e==null?null:he(e,"gasPrice")}get maxPriorityFeePerGas(){const e=this.#i;return e??(this.type===2||this.type===3?Ft:null)}set maxPriorityFeePerGas(e){this.#i=e==null?null:he(e,"maxPriorityFeePerGas")}get maxFeePerGas(){const e=this.#a;return e??(this.type===2||this.type===3?Ft:null)}set maxFeePerGas(e){this.#a=e==null?null:he(e,"maxFeePerGas")}get data(){return this.#s}set data(e){this.#s=oe(e)}get value(){return this.#d}set value(e){this.#d=he(e,"value")}get chainId(){return this.#c}set chainId(e){this.#c=he(e)}get signature(){return this.#p||null}set signature(e){this.#p=e==null?null:vt.from(e)}get accessList(){const e=this.#m||null;return e??(this.type===1||this.type===2||this.type===3?[]:null)}set accessList(e){this.#m=e==null?null:Ir(e)}get authorizationList(){const e=this.#y||null;return e==null&&this.type===4?[]:e}set authorizationList(e){this.#y=e==null?null:e.map(s=>tm(s))}get maxFeePerBlobGas(){const e=this.#l;return e==null&&this.type===3?Ft:e}set maxFeePerBlobGas(e){this.#l=e==null?null:he(e,"maxFeePerBlobGas")}get blobVersionedHashes(){let e=this.#u;return e==null&&this.type===3?[]:e}set blobVersionedHashes(e){if(e!=null){P(Array.isArray(e),"blobVersionedHashes must be an Array","value",e),e=e.slice();for(let s=0;s<e.length;s++)P(ct(e[s],32),"invalid blobVersionedHash",`value[${s}]`,e[s])}this.#u=e}get blobs(){return this.#h==null?null:this.#h.map(e=>Object.assign({},e))}set blobs(e){if(e==null){this.#h=null;return}const s=[],n=[];for(let r=0;r<e.length;r++){const i=e[r];if(Jc(i)){j(this.#f,"adding a raw blob requires a KZG library","UNSUPPORTED_OPERATION",{operation:"set blobs()"});let o=Oe(i);if(P(o.length<=kl,"blob is too large",`blobs[${r}]`,i),o.length!==kl){const u=new Uint8Array(kl);u.set(o),o=u}const l=this.#f.blobToKzgCommitment(o),c=oe(this.#f.computeBlobKzgProof(o,l));s.push({data:oe(o),commitment:oe(l),proof:c}),n.push($d(1,l))}else{const o=oe(i.commitment);s.push({data:oe(i.data),commitment:o,proof:oe(i.proof)}),n.push($d(1,o))}}this.#h=s,this.#u=n}get kzg(){return this.#f}set kzg(e){e==null?this.#f=null:this.#f=$w(e)}constructor(){this.#e=null,this.#t=null,this.#n=0,this.#r=Ft,this.#o=null,this.#i=null,this.#a=null,this.#s="0x",this.#d=Ft,this.#c=Ft,this.#p=null,this.#m=null,this.#l=null,this.#u=null,this.#f=null,this.#h=null,this.#y=null}get hash(){return this.signature==null?null:wt(this.#g(!0,!1))}get unsignedHash(){return wt(this.unsignedSerialized)}get from(){return this.signature==null?null:Ow(this.unsignedHash,this.signature)}get fromPublicKey(){return this.signature==null?null:bn.recoverPublicKey(this.unsignedHash,this.signature)}isSigned(){return this.signature!=null}#g(e,s){j(!e||this.signature!=null,"cannot serialize unsigned transaction; maybe you meant .unsignedSerialized","UNSUPPORTED_OPERATION",{operation:".serialized"});const n=e?this.signature:null;switch(this.inferType()){case 0:return Gw(this,n);case 1:return Jw(this,n);case 2:return zw(this,n);case 3:return Zw(this,n,s?this.blobs:null);case 4:return e1(this,n)}j(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:".serialized"})}get serialized(){return this.#g(!0,!0)}get unsignedSerialized(){return this.#g(!1,!1)}inferType(){const e=this.inferTypes();return e.indexOf(2)>=0?2:e.pop()}inferTypes(){const e=this.gasPrice!=null,s=this.maxFeePerGas!=null||this.maxPriorityFeePerGas!=null,n=this.accessList!=null,r=this.#l!=null||this.#u;this.maxFeePerGas!=null&&this.maxPriorityFeePerGas!=null&&j(this.maxFeePerGas>=this.maxPriorityFeePerGas,"priorityFee cannot be more than maxFee","BAD_DATA",{value:this}),j(!s||this.type!==0&&this.type!==1,"transaction type cannot have maxFeePerGas or maxPriorityFeePerGas","BAD_DATA",{value:this}),j(this.type!==0||!n,"legacy transaction cannot have accessList","BAD_DATA",{value:this});const i=[];return this.type!=null?i.push(this.type):this.authorizationList&&this.authorizationList.length?i.push(4):s?i.push(2):e?(i.push(1),n||i.push(0)):n?(i.push(1),i.push(2)):(r&&this.to||(i.push(0),i.push(1),i.push(2)),i.push(3)),i.sort(),i}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}clone(){return $s.from(this)}toJSON(){const e=s=>s==null?null:s.toString();return{type:this.type,to:this.to,data:this.data,nonce:this.nonce,gasLimit:e(this.gasLimit),gasPrice:e(this.gasPrice),maxPriorityFeePerGas:e(this.maxPriorityFeePerGas),maxFeePerGas:e(this.maxFeePerGas),value:e(this.value),chainId:e(this.chainId),sig:this.signature?this.signature.toJSON():null,accessList:this.accessList}}static from(e){if(e==null)return new $s;if(typeof e=="string"){const n=Oe(e);if(n[0]>=127)return $s.from(Yw(n));switch(n[0]){case 1:return $s.from(Qw(n));case 2:return $s.from(Kw(n));case 3:return $s.from(qw(n));case 4:return $s.from(Xw(n))}j(!1,"unsupported transaction type","UNSUPPORTED_OPERATION",{operation:"from"})}const s=new $s;return e.type!=null&&(s.type=e.type),e.to!=null&&(s.to=e.to),e.nonce!=null&&(s.nonce=e.nonce),e.gasLimit!=null&&(s.gasLimit=e.gasLimit),e.gasPrice!=null&&(s.gasPrice=e.gasPrice),e.maxPriorityFeePerGas!=null&&(s.maxPriorityFeePerGas=e.maxPriorityFeePerGas),e.maxFeePerGas!=null&&(s.maxFeePerGas=e.maxFeePerGas),e.maxFeePerBlobGas!=null&&(s.maxFeePerBlobGas=e.maxFeePerBlobGas),e.data!=null&&(s.data=e.data),e.value!=null&&(s.value=e.value),e.chainId!=null&&(s.chainId=e.chainId),e.signature!=null&&(s.signature=vt.from(e.signature)),e.accessList!=null&&(s.accessList=e.accessList),e.authorizationList!=null&&(s.authorizationList=e.authorizationList),e.blobVersionedHashes!=null&&(s.blobVersionedHashes=e.blobVersionedHashes),e.kzg!=null&&(s.kzg=e.kzg),e.blobs!=null&&(s.blobs=e.blobs),e.hash!=null&&(P(s.isSigned(),"unsigned transaction cannot define '.hash'","tx",e),P(s.hash===e.hash,"hash mismatch","tx",e)),e.from!=null&&(P(s.isSigned(),"unsigned transaction cannot define '.from'","tx",e),P(s.from.toLowerCase()===(e.from||"").toLowerCase(),"from mismatch","tx",e)),s}}function Tr(t){return wt(_n(t))}var t1="AEEUdwmgDS8BxQKKAP4BOgDjATAAngDUAIMAoABoAOAAagCOAEQAhABMAHIAOwA9ACsANgAmAGIAHgAuACgAJwAXAC0AGgAjAB8ALwAUACkAEgAeAAkAGwARABkAFgA5ACgALQArADcAFQApABAAHgAiABAAGgAeABMAGAUhBe8BFxREN8sF2wC5AK5HAW8ArQkDzQCuhzc3NzcBP68NEfMABQdHBuw5BV8FYAA9MzkI9r4ZBg7QyQAWA9CeOwLNCjcCjqkChuA/lm+RAsXTAoP6ASfnEQDytQFJAjWVCkeXAOsA6godAB/cwdAUE0WlBCN/AQUCQRjFD/MRBjHxDQSJbw0jBzUAswBxme+tnIcAYwabAysG8QAjAEMMmxcDqgPKQyDXCMMxA7kUQwD3NXOrAKmFIAAfBC0D3x4BJQDBGdUFAhEgVD8JnwmQJiNWYUzrg0oAGwAUAB0AFnNcACkAFgBP9h3gPfsDOWDKneY2ChglX1UDYD30ABsAFAAdABZzIGRAnwDD8wAjAEEMzRbDqgMB2sAFYwXqAtCnAsS4AwpUJKRtFHsadUz9AMMVbwLpABM1NJEX0ZkCgYMBEyMAxRVvAukAEzUBUFAtmUwSAy4DBTER33EftQHfSwB5MxJ/AjkWKQLzL8E/cwBB6QH9LQDPDtO9ASNriQC5DQANAwCK21EFI91zHwCoL9kBqQcHBwcHKzUDowBvAQohPvU3fAQgHwCyAc8CKQMA5zMSezr7ULgFmDp/LzVQBgEGAi8FYQVgt8AFcTtlQhpCWEmfe5tmZ6IAExsDzQ8t+X8rBKtTAltbAn0jsy8Bl6utPWMDTR8Ei2kRANkDBrNHNysDBzECQWUAcwFpJ3kAiyUhAJ0BUb8AL3EfAbfNAz81KUsFWwF3YQZtAm0A+VEfAzEJDQBRSQCzAQBlAHsAM70GD/v3IZWHBwARKQAxALsjTwHZAeMPEzmXgIHwABIAGQA8AEUAQDt3gdvIEGcQZAkGTRFMdEIVEwK0D64L7REdDNkq09PgADSxB/MDWwfzA1sDWwfzB/MDWwfzA1sDWwNbA1scEvAi28gQZw9QBHUFlgWTBN4IiyZREYkHMAjaVBV0JhxPA00BBCMtSSQ7mzMTJUpMFE0LCAQ2SmyvfUADTzGzVP2QqgPTMlc5dAkGHnkSqAAyD3skNb1OhnpPcagKU0+2tYdJak5vAsY6sEAACikJm2/Dd1YGRRAfJ6kQ+ww3AbkBPw3xS9wE9QY/BM0fgRkdD9GVoAipLeEM8SbnLqWAXiP5KocF8Uv4POELUVFsD10LaQnnOmeBUgMlAREijwrhDT0IcRD3Cs1vDekRSQc9A9lJngCpBwULFR05FbkmFGKwCw05ewb/GvoLkyazEy17AAXXGiUGUQEtGwMA0y7rhbRaNVwgT2MGBwspI8sUrFAkDSlAu3hMGh8HGSWtApVDdEqLUToelyH6PEENai4XUYAH+TwJGVMLhTyiRq9FEhHWPpE9TCJNTDAEOYMsMyePCdMPiQy9fHYBXQklCbUMdRM1ERs3yQg9Bx0xlygnGQglRplgngT7owP3E9UDDwVDCUUHFwO5HDETMhUtBRGBKNsC9zbZLrcCk1aEARsFzw8pH+MQVEfkDu0InwJpA4cl7wAxFSUAGyKfCEdnAGOP3FMJLs8Iy2pwI3gDaxTrZRF3B5UOWwerHDcVwxzlcMxeD4YMKKezCV8BeQmdAWME5wgNNV+MpCBFZ1eLXBifIGVBQ14AAjUMaRWjRMGHfAKPD28SHwE5AXcHPQ0FAnsR8RFvEJkI74YINbkz/DopBFMhhyAVCisDU2zSCysm/Qz8bQGnEmYDEDRBd/Jnr2C6KBgBBx0yyUFkIfULlk/RDKAaxRhGVDIZ6AfDA/ca9yfuQVsGAwOnBxc6UTPyBMELbQiPCUMATQ6nGwfbGG4KdYzUATWPAbudA1uVhwJzkwY7Bw8Aaw+LBX3pACECqwinAAkA0wNbAD0CsQehAB0AiUUBQQMrMwEl6QKTA5cINc8BmTMB9y0EH8cMGQD7O25OAsO1AoBuZqYF4VwCkgJNOQFRKQQJUktVA7N15QDfAE8GF+NLARmvTs8e50cB43MvAMsA/wAJOQcJRQHRAfdxALsBYws1Caa3uQFR7S0AhwAZbwHbAo0A4QA5AIP1AVcAUQVd/QXXAlNNARU1HC9bZQG/AyMBNwERAH0Gz5GpzQsjBHEH1wIQHxXlAu8yB7kFAyLjE9FCyQK94lkAMhoKPAqrCqpgX2Q3CjV2PVQAEh+sPss/UgVVO1c7XDtXO1w7VztcO1c7XDtXO1wDm8Pmw+YKcF9JYe8Mqg3YRMw6TRPfYFVgNhPMLbsUxRXSJVoZQRrAJwkl6FUNDwgt12Y0CDA0eRfAAEMpbINFY4oeNApPHOtTlVT8LR8AtUumM7MNsBsZREQFS3XxYi4WEgomAmSFAmJGX1GzAV83JAKh+wJonAJmDQKfiDgfDwJmPwJmKgRyBIMDfxcDfpY5Cjl7GzmGOicnAmwhAjI6OA4CbcsCbbLzjgM3a0kvAWsA4gDlAE4JB5wMkQECD8YAEbkCdzMCdqZDAnlPRwJ4viFg30WyRvcCfEMCeswCfQ0CfPRIBEiBZygALxlJXEpfGRtK0ALRBQLQ0EsrA4hTA4fqRMmRNgLypV0HAwOyS9JMMSkH001QTbMCi0MCitzFHwshR2sJuwKOOwKOYESbhQKO3QKOYHxRuFM5AQ5S2FSJApP/ApMQAO0AIFUiVbNV1AosHymZijLleGpFPz0Cl6MC77ZYJawAXSkClpMCloCgAK1ZsFoNhVEAPwKWuQKWUlxIXNUCmc8CmWhczl0LHQKcnznGOqECnBoCn58CnryOACETNS4TAp31Ap6WALlBYThh8wKe1wKgcgGtAp6jIwKeUqljzGQrKS8CJ7MCJoICoP8CoFDbAqYzAqXSAqgDAIECp/ZogGi1AAdNaiBq1QKs5wKssgKtawKtBgJXIQJV4AKx5dsDH1JsmwKywRECsuwbbORtZ21MYwMl0QK2YD9DbpQDKUkCuGICuUsZArkue3A6cOUCvR0DLbYDMhUCvoxyBgMzdQK+HnMmc1MCw88CwwhzhnRPOUl05AM8qwEDPJ4DPcMCxYACxksCxhSNAshtVQLISALJUwLJMgJkoQLd1nh9ZXiyeSlL1AMYp2cGAmH4GfeVKHsPXpZevxUCz28Cz3AzT1fW9xejAMqxAs93AS3uA04Wfk8JAtwrAtuOAtJTA1JgA1NjAQUDVZCAjUMEzxrxZEl5A4LSg5EC2ssC2eKEFIRNp0ADhqkAMwNkEoZ1Xf0AWQLfaQLevHd7AuIz7RgB8zQrAfSfAfLWiwLr9wLpdH0DAur9AuroAP1LAb0C7o0C66CWrpcHAu5DA4XkmH1w5HGlAvMHAG0DjhqZlwL3FwORcgOSiwL3nAL53QL4apogmq+/O5siA52HAv7+AR8APZ8gAZ+3AwWRA6ZuA6bdANXJAwZuoYyiCQ0DDE0BEwEjB3EGZb1rCQC/BG/DFY8etxEAG3k9ACcDNxJRA42DAWcrJQCM8wAlAOanC6OVCLsGI6fJBgCvBRnDBvElRUYFFoAFcD9GSDNCKUK8X3kZX8QAls0FOgCQVCGbwTsuYDoZutcONxjOGJHJ/gVfBWAFXwVgBWsFYAVfBWAFXwVgBV8FYAVfBWBOHQjfjW8KCgoKbF7xMwTRA7kGN8PDAMMEr8MA70gxFroFTj5xPnhCR0K+X30/X/AAWBkzswCNBsxzzASm70aCRS4rDDMeLz49fnXfcsH5GcoscQFz13Y4HwVnBXLJycnACNdRYwgICAqEXoWTxgA7P4kACxbZBu21Kw0AjMsTAwkVAOVtJUUsJ1JCuULESUArXy9gPi9AKwnJRQYKTD9LPoA+iT54PnkCkULEUUpDX9NWV3JVEjQAc1w3A3IBE3YnX+g7QiMJb6MKaiszRCUuQrNCxDPMCcwEX9EWJzYREBEEBwIHKn6l33JCNVIfybPJtAltydPUCmhBZw/tEKsZAJOVJU1CLRuxbUHOQAo7P0s+eEJHHA8SJVRPdGM0NVrpvBoKhfUlM0JHHGUQUhEWO1xLSj8MO0ucNAqJIzVCRxv9EFsqKyA4OQgNj2nwZgp5ZNFgE2A1K3YHS2AhQQojJmC7DgpzGG1WYFUZCQYHZO9gHWCdYIVgu2BTYJlwFh8GvRbcXbG8YgtDHrMBwzPVyQonHQgkCyYBgQJ0Ajc4nVqIAwGSCsBPIgDsK3SWEtIVBa5N8gGjAo+kVwVIZwD/AEUSCDweX4ITrRQsJ8K3TwBXFDwEAB0TvzVcAtoTS20RIwDgVgZ9BBImYgA5AL4Coi8LFnezOkCnIQFjAY4KBAPh9RcGsgZSBsEAJctdsWIRu2kTkQstRw7DAcMBKgpPBGIGMDAwKCYnKTQaLg4AKRSVAFwCdl+YUZ0JdicFD3lPAdt1F9ZZKCGxuE3yBxkFVGcA/wBFEgiCBwAOLHQSjxOtQDg1z7deFRMAZ8QTAGtKb1ApIiPHADkAvgKiLy1DFtYCmBiDAlDDWNB0eo7fpaMO/aEVRRv0ATEQZBIODyMEAc8JQhCbDRgzFD4TAEMAu9YBCgCsAOkAm5I3ABwAYxvONnR+MhXJAxgKQyxL2+kkJhMbhQKDBMkSsvF0AD9BNQ6uQC7WqSQHwxEAEEIu1hkhAH2z4iQPwyJPHNWpdyYBRSpnJALzoBAEVPPsH20MxA0CCEQKRgAFyAtFAlMNwwjEDUQJRArELtapMg7DDZgJIw+TGukEIwvDFkMAqAtDEMMMBhioe+QAO3MMRAACrgnEBSPY9Q0FDnbSBoMAB8MSYxkSxAEJAPIJAAB8FWMOFtMc/HcXwxhDAC7DAvOowwAewwJdKDKHAAHDAALrFUQVwwAbwyvzpWMWv8wA/ABpAy++bcYDUKPD0KhDCwKmJ1MAAmMA5+UZwxAagwipBRL/eADfw6fDGOMCGsOjk3l6BwOpo4sAEsMOGxMAA5sAbcMOAAvDp0MJGkMDwgipnNIPAwfIqUMGAOGDAAPzABXDAAcDAAnDAGmTABrDAA7DChjDjnEWAwABYwAOcwAuUyYABsMAF8MIKQANUgC6wy4AA8MADqMq8wCyYgAcIwAB8wqpAAXOCx0V4wAHowBCwwEKAGnDAAuDAB3DAAjDCakABdIAbqcZ3QCZCCkABdIAAAFDAAfjAB2jCCkABqIACYMAGzMAbSMA5sOIAAhjAAhDABTDBAkpAAbSAOOTAAlDC6kOzPtnAAdDAG6kQFAATwAKwwwAA0MACbUDPwAHIwAZgwACE6cDAAojAApDAAoDp/MGwwAJIwADEwAQQwgAFEMAEXMAD5MADfMADcMAGRMOFiMAFUMAbqMWuwHDAMIAE0MLAGkzEgDhUwACQwAEWgAXgwUjAAbYABjDBSYBgzBaAEFNALcQBxUMegAwMngBrA0IZgJ0KxQHBREPd1N0ZzKRJwaIHAZqNT4DqQq8BwngAB4DAwt2AX56T1ocKQNXAh1GATQGC3tOxYNagkgAMQA5CQADAQEAWxLjAIOYNAEzAH7tFRk6TglSAF8NAAlYAQ+S1ACAQwQorQBiAN4dAJ1wPyeTANVzuQDX3AIeEMp9eyMgXiUAEdkBkJizKltbVVAaRMqRAAEAhyQ/SDEz6BmfVwB6ATEsOClKIRcDOF0E/832AFNt5AByAnkCRxGCOs94NjXdAwINGBonDBwPALW2AwICAgAAAAAAAAYDBQMDARrUAwAtAAAAAgEGBgYGBgYFBQUFBQUEBQYHCAkEBQUFBQQAAAICAAAAIgCNAJAAlT0A6gC7ANwApEQAwgCyAK0AqADuAKYA2gCjAOcBCAEDAMcAgQBiANIA1AEDAN4A8gCQAKkBMQDqAN8A3AsBCQ8yO9ra2tq8xuLT1tRJOB0BUgFcNU0BWgFpAWgBWwFMUUlLbhMBUxsNEAs6PhMOACcUKy0vMj5AQENDQ0RFFEYGJFdXV1dZWVhZL1pbXVxcI2NnZ2ZoZypsbnZ1eHh4eHh4enp6enp6enp6enp8fH18e2IARPIASQCaAHgAMgBm+ACOAFcAVwA3AnbvAIsABfj4AGQAk/IAnwBPAGIAZP//sACFAIUAaQBWALEAJAC2AIMCQAJDAPwA5wD+AP4A6AD/AOkA6QDoAOYALwJ7AVEBQAE+AVQBPgE+AT4BOQE4ATgBOAEcAVgXADEQCAEAUx8SHgsdHhYAjgCWAKYAUQBqIAIxAHYAbwCXAxUDJzIDIUlGTzEAkQJPAMcCVwKkAMAClgKWApYClgKWApYCiwKWApYClgKWApYClgKVApUCmAKgApcClgKWApQClAKUApQCkgKVAnUB1AKXAp8ClgKWApUeAIETBQD+DQOfAmECOh8BVBg9AuIZEjMbAU4/G1WZAXusRAFpYQEFA0FPAQYAmTEeIJdyADFoAHEANgCRA5zMk/C2jGINwjMWygIZCaXdfDILBCs5dAE7YnQBugDlhoiHhoiGiYqKhouOjIaNkI6Ij4qQipGGkoaThpSSlYaWhpeKmIaZhpqGm4aci52QnoqfhuIC4XTpAt90AIp0LHSoAIsAdHQEQwRABEIERQRDBEkERgRBBEcESQRIBEQERgRJAJ5udACrA490ALxuAQ10ANFZdHQA13QCFHQA/mJ0AP4BIQD+APwA/AD9APwDhGZ03ASMK23HAP4A/AD8AP0A/CR0dACRYnQA/gCRASEA/gCRAvQA/gCRA4RmdNwEjCttxyR0AP9idAEhAP4A/gD8APwA/QD8AP8A/AD8AP0A/AOEZnTcBIwrbcckdHQAkWJ0ASEA/gCRAP4AkQL0AP4AkQOEZnTcBIwrbcckdAJLAT50AlIBQXQCU8l0dAJfdHQDpgL0A6YDpgOnA6cDpwOnA4RmdNwEjCttxyR0dACRYnQBIQOmAJEDpgCRAvQDpgCRA4RmdNwEjCttxyR0BDh0AJEEOQCRDpU5dSgCADR03gV2CwArdAEFAM5iCnR0AF1iAAYcOgp0dACRCnQAXAEIwWZ0CnRmdHQAkWZ0CnRmdEXgAFF03gp0dEY0tlT2u3SOAQTwscwhjZZKrhYcBSfFp9XNbKiVDOD2b+cpe4/Z17mQnbtzzhaeQtE2GGj0IDNTjRUSyTxxw/RPHW/+vS7d1NfRt9z9QPZg4X7QFfhCnkvgNPIItOsC2eV6hPannZNHlZ9xrwZXIMOlu3jSoQSq78WEjwLjw1ELSlF1aBvfzwk5ZX7AUvQzjPQKbDuQ+sm4wNOp4A6AdVuRS0t1y/DZpg4R6m7FNjM9HgvW7Bi88zaMjOo6lM8wtBBdj8LP4ylv3zCXPhebMKJc066o9sF71oFW/8JXu86HJbwDID5lzw5GWLR/LhT0Qqnp2JQxNZNfcbLIzPy+YypqRm/lBmGmex+82+PisxUumSeJkALIT6rJezxMH+CTJmQtt5uwTVbL3ptmjDUQzlSIvWi8Tl7ng1NpuRn1Ng4n14Qc+3Iil7OwkvNWogLSPkn3pihIFytyIGmMhOe3n1tWsuMy9BdKyqF4Z3v2SgggTL9KVvMXPnCbRe+oOuFFP3HejBG/w9gvmfNYvg6JuWia2lcSSN1uIjBktzoIazOHPJZ7kKHPz8mRWVdW3lA8WGF9dQF6Bm673boov3BUWDU2JNcahR23GtfHKLOz/viZ+rYnZFaIznXO67CYEJ1fXuTRpZhYZkKe54xeoagkNGLs+NTZHE0rX45/XvQ2RGADX6vcAvdxIUBV27wxGm2zjZo4X3ILgAlrOFheuZ6wtsvaIj4yLY7qqawlliaIcrz2G+c3vscAnCkCuMzMmZvMfu9lLwTvfX+3cVSyPdN9ZwgDZhfjRgNJcLiJ67b9xx8JHswprbiE3v9UphotAPIgnXVIN5KmMc0piXhc6cChPnN+MRhG9adtdttQTTwSIpl8I4/j//d3sz1326qTBTpPRM/Hgh3kzqEXs8ZAk4ErQhNO8hzrQ0DLkWMA/N+91tn2MdOJnWC2FCZehkQrwzwbKOjhvZsbM95QoeL9skYyMf4srVPVJSgg7pOLUtr/n9eT99oe9nLtFRpjA9okV2Kj8h9k5HaC0oivRD8VyXkJ81tcd4fHNXPCfloIQasxsuO18/46dR2jgul/UIet2G0kRvnyONMKhHs6J26FEoqSqd+rfYjeEGwHWVDpX1fh1jBBcKGMqRepju9Y00mDVHC+Xdij/j44rKfvfjGinNs1jO/0F3jB83XCDINN/HB84axlP+3E/klktRo+vl3U/aiyMJbIodE1XSsDn6UAzIoMtUObY2+k/4gY/l+AkZJ5Sj2vQrkyLm3FoxjhDX+31UXBFf9XrAH31fFqoBmDEZvhvvpnZ87N+oZEu7U9O/nnk+QWj3x8uyoRbEnf+O5UMr9i0nHP38IF5AvzrBW8YWBUR0mIAzIvndQq9N3v/Jto3aPjPXUPl8ASdPPyAp7jENf8bk7VMM9ol9XGmlBmeDMuGqt+WzuL6CXAxXjIhCPM5vACchgMJ/8XBGLO/D1isVvGhwwHHr1DLaI5mn2Jr/b1pUD90uciDaS8cXNDzCWvNmT/PhQe5e8nTnnnkt8Ds/SIjibcum/fqDhKopxAY8AkSrPn+IGDEKOO+U3XOP6djFs2H5N9+orhOahiQk5KnEUWa+CzkVzhp8bMHRbg81qhjjXuIKbHjSLSIBKWqockGtKinY+z4/RdBUF6pcc3JmnlxVcNgrI4SEzKUZSwcD2QCyxzKve+gAmg6ZuSRkpPFa6mfThu7LJNu3H5K42uCpNvPAsoedolKV/LHe/eJ+BbaG5MG0NaSGVPRUmNFMFFSSpXEcXwbVh7UETOZZtoVNRGOIbbkig3McEtR68cG0RZAoJevWYo7Dg/lZ1CQzblWeUvVHmr8fY4Nqd9JJiH/zEX24mJviH60fAyFr0A3c4bC1j3yZU60VgJxXn8JgJXLUIsiBnmKmMYz+7yBQFBvqb2eYnuW59joZBf56/wXvWIR4R8wTmV80i1mZy+S4+BUES+hzjk0uXpC///z/IlqHZ1monzlXp8aCfhGKMti73FI1KbL1q6IKO4fuBuZ59gagjn5xU79muMpHXg6S+e+gDM/U9BKLHbl9l6o8czQKl4RUkJJiqftQG2i3BMg/TQlUYFkJDYBOOvAugYuzYSDnZbDDd/aSd9x0Oe6F+bJcHfl9+gp6L5/TgA+BdFFovbfCrQ40s5vMPw8866pNX8zyFGeFWdxIpPVp9Rg1UPOVFbFZrvaFq/YAzHQgqMWpahMYfqHpmwXfHL1/kpYmGuHFwT55mQu0dylfNuq2Oq0hTMCPwqfxnuBIPLXfci4Y1ANy+1CUipQxld/izVh16WyG2Q0CQQ9NqtAnx1HCHwDj7sYxOSB0wopZSnOzxQOcExmxrVTF2BkOthVpGfuhaGECfCJpJKpjnihY+xOT2QJxN61+9K6QSqtv2Shr82I3jgJrqBg0wELFZPjvHpvzTtaJnLK6Vb97Yn933koO/saN7fsjwNKzp4l2lJVx2orjCGzC/4ZL4zCver6aQYtC5sdoychuFE6ufOiog+VWi5UDkbmvmtah/3aArEBIi39s5ILUnlFLgilcGuz9CQshEY7fw2ouoILAYPVT/gyAIq3TFAIwVsl+ktkRz/qGfnCDGrm5gsl/l9QdvCWGsjPz3dU7XuqKfdUrr/6XIgjp4rey6AJBmCmUJMjITHVdFb5m1p+dLMCL8t55zD42cmftmLEJC0Da04YiRCVUBLLa8D071/N5UBNBXDh0LFsmhV/5B5ExOB4j3WVG/S3lfK5o+V6ELHvy6RR9n4ac+VsK4VE4yphPvV+kG9FegTBH4ZRXL2HytUHCduJazB/KykjfetYxOXTLws267aGOd+I+JhKP//+VnXmS90OD/jvLcVu0asyqcuYN1mSb6XTlCkqv1vigZPIYwNF/zpWcT1GR/6aEIRjkh0yhg4LXJfaGobYJTY4JI58KiAKgmmgAKWdl5nYCeLqavRJGQNuYuZtZFGx+IkI4w4NS2xwbetNMunOjBu/hmKCI/w7tfiiyUd//4rbTeWt4izBY8YvGIN6vyKYmP/8X8wHKCeN+WRcKM70+tXKNGyevU9H2Dg5BsljnTf8YbsJ1TmMs74Ce2XlHisleguhyeg44rQOHZuw/6HTkhnnurK2d62q6yS7210SsAIaR+jXMQA+svkrLpsUY+F30Uw89uOdGAR6vo4FIME0EfVVeHTu6eKicfhSqOeXJhbftcd08sWEnNUL1C9fnprTgd83IMut8onVUF0hvqzZfHduPjbjwEXIcoYmy+P6tcJZHmeOv6VrvEdkHDJecjHuHeWANe79VG662qTjA/HCvumVv3qL+LrOcpqGps2ZGwQdFJ7PU4iuyRlBrwfO+xnPyr47s2cXVbWzAyznDiBGjCM3ksxjjqM62GE9C8f5U38kB3VjtabKp/nRdvMESPGDG90bWRLAt1Qk5DyLuazRR1YzdC1c+hZXvAWV8xA72S4A8B67vjVhbba3MMop293FeEXpe7zItMWrJG/LOH9ByOXmYnNJfjmfuX9KbrpgLOba4nZ+fl8Gbdv/ihv+6wFGKHCYrVwmhFC0J3V2bn2tIB1wCc1CST3d3X2OyxhguXcs4sm679UngzofuSeBewMFJboIQHbUh/m2JhW2hG9DIvG2t7yZIzKBTz9wBtnNC+2pCRYhSIuQ1j8xsz5VvqnyUIthvuoyyu7fNIrg/KQUVmGQaqkqZk/Vx5b33/gsEs8yX7SC1J+NV4icz6bvIE7C5G6McBaI8rVg56q5QBJWxn/87Q1sPK4+sQa8fLU5gXo4paaq4cOcQ4wR0VBHPGjKh+UlPCbA1nLXyEUX45qZ8J7/Ln4FPJE2TdzD0Z8MLSNQiykMMmSyOCiFfy84Rq60emYB2vD09KjYwsoIpeDcBDTElBbXxND72yhd9pC/1CMid/5HUMvAL27OtcIJDzNKpRPNqPOpyt2aPGz9QWIs9hQ9LiX5s8m9hjTUu/f7MyIatjjd+tSfQ3ufZxPpmJhTaBtZtKLUcfOCUqADuO+QoH8B9v6U+P0HV1GLQmtoNFTb3s74ivZgjES0qfK+8RdGgBbcCMSy8eBvh98+et1KIFqSe1KQPyXULBMTsIYnysIwiZBJYdI20vseV+wuJkcqGemehKjaAb9L57xZm3g2zX0bZ2xk/fU+bCo7TlnbW7JuF1YdURo/2Gw7VclDG1W7LOtas2LX4upifZ/23rzpsnY/ALfRgrcWP5hYmV9VxVOQA1fZvp9F2UNU+7d7xRyVm5wiLp3/0dlV7vdw1PMiZrbDAYzIVqEjRY2YU03sJhPnlwIPcZUG5ltL6S8XCxU1eYS5cjr34veBmXAvy7yN4ZjArIG0dfD/5UpBNlX1ZPoxJOwyqRi3wQWtOzd4oNKh0LkoTm8cwqgIfKhqqGOhwo71I+zXnMemTv2B2AUzABWyFztGgGULjDDzWYwJUVBTjKCn5K2QGMK1CQT7SzziOjo+BhAmqBjzuc3xYym2eedGeOIRJVyTwDw37iCMe4g5Vbnsb5ZBdxOAnMT7HU4DHpxWGuQ7GeiY30Cpbvzss55+5Km1YsbD5ea3NI9QNYIXol5apgSu9dZ8f8xS5dtHpido5BclDuLWY4lhik0tbJa07yJhH0BOyEut/GRbYTS6RfiTYWGMCkNpfSHi7HvdiTglEVHKZXaVhezH4kkXiIvKopYAlPusftpE4a5IZwvw1x/eLvoDIh/zpo9FiQInsTb2SAkKHV42XYBjpJDg4374XiVb3ws4qM0s9eSQ5HzsMU4OZJKuopFjBM+dAZEl8RUMx5uU2N486Kr141tVsGQfGjORYMCJAMsxELeNT4RmWjRcpdTGBwcx6XN9drWqPmJzcrGrH4+DRc7+n1w3kPZwu0BkNr6hQrqgo7JTB9A5kdJ/H7P4cWBMwsmuixAzJB3yrQpnGIq90lxAXLzDCdn1LPibsRt7rHNjgQBklRgPZ8vTbjXdgXrTWQsK5MdrXXQVPp0Rinq3frzZKJ0qD6Qhc40VzAraUXlob1gvkhK3vpmHgI6FRlQZNx6eRqkp0zy4AQlX813fAPtL3jMRaitGFFjo0zmErloC+h+YYdVQ6k4F/epxAoF0BmqEoKNTt6j4vQZNQ2BoqF9Vj53TOIoNmDiu9Xp15RkIgQIGcoLpfoIbenzpGUAtqFJp5W+LLnx38jHeECTJ/navKY1NWfN0sY1T8/pB8kIH3DU3DX+u6W3YwpypBMYOhbSxGjq84RZ84fWJow8pyHqn4S/9J15EcCMsXqrfwyd9mhiu3+rEo9pPpoJkdZqHjra4NvzFwuThNKy6hao/SlLw3ZADUcUp3w3SRVfW2rhl80zOgTYnKE0Hs2qp1J6H3xqPqIkvUDRMFDYyRbsFI3M9MEyovPk8rlw7/0a81cDVLmBsR2ze2pBuKb23fbeZC0uXoIvDppfTwIDxk1Oq2dGesGc+oJXWJLGkOha3CX+DUnzgAp9HGH9RsPZN63Hn4RMA5eSVhPHO+9RcRb/IOgtW31V1Q5IPGtoxPjC+MEJbVlIMYADd9aHYWUIQKopuPOHmoqSkubnAKnzgKHqgIOfW5RdAgotN6BN+O2ZYHkuemLnvQ8U9THVrS1RtLmKbcC7PeeDsYznvqzeg6VCNwmr0Yyx1wnLjyT84BZz3EJyCptD3yeueAyDWIs0L2qs/VQ3HUyqfrja0V1LdDzqAikeWuV4sc7RLIB69jEIBjCkyZedoUHqCrOvShVzyd73OdrJW0hPOuQv2qOoHDc9xVb6Yu6uq3Xqp2ZaH46A7lzevbxQEmfrzvAYSJuZ4WDk1Hz3QX1LVdiUK0EvlAGAYlG3Md30r7dcPN63yqBCIj25prpvZP0nI4+EgWoFG95V596CurXpKRBGRjQlHCvy5Ib/iW8nZJWwrET3mgd6mEhfP4KCuaLjopWs7h+MdXFdIv8dHQJgg1xi1eYqB0uDYjxwVmri0Sv5XKut/onqapC+FQiC2C1lvYJ9MVco6yDYsS3AANUfMtvtbYI2hfwZatiSsnoUeMZd34GVjkMMKA+XnjJpXgRW2SHTZplVowPmJsvXy6w3cfO1AK2dvtZEKTkC/TY9LFiKHCG0DnrMQdGm2lzlBHM9iEYynH2UcVMhUEjsc0oDBTgo2ZSQ1gzkAHeWeBXYFjYLuuf8yzTCy7/RFR81WDjXMbq2BOH5dURnxo6oivmxL3cKzKInlZkD31nvpHB9Kk7GfcfE1t+1V64b9LtgeJGlpRFxQCAqWJ5DoY77ski8gsOEOr2uywZaoO/NGa0X0y1pNQHBi3b2SUGNpcZxDT7rLbBf1FSnQ8guxGW3W+36BW0gBje4DOz6Ba6SVk0xiKgt+q2JOFyr4SYfnu+Ic1QZYIuwHBrgzr6UvOcSCzPTOo7D6IC4ISeS7zkl4h+2VoeHpnG/uWR3+ysNgPcOIXQbv0n4mr3BwQcdKJxgPSeyuP/z1Jjg4e9nUvoXegqQVIE30EHx5GHv+FAVUNTowYDJgyFhf5IvlYmEqRif6+WN1MkEJmDcQITx9FX23a4mxy1AQRsOHO/+eImX9l8EMJI3oPWzVXxSOeHU1dUWYr2uAA7AMb+vAEZSbU3qob9ibCyXeypEMpZ6863o6QPqlqGHZkuWABSTVNd4cOh9hv3qEpSx2Zy/DJMP6cItEmiBJ5PFqQnDEIt3NrA3COlOSgz43D7gpNFNJ5MBh4oFzhDPiglC2ypsNU4ISywY2erkyb1NC3Qh/IfWj0eDgZI4/ln8WPfBsT3meTjq1Uqt1E7Zl/qftqkx6aM9KueMCekSnMrcHj1CqTWWzEzPsZGcDe3Ue4Ws+XFYVxNbOFF8ezkvQGR6ZOtOLU2lQEnMBStx47vE6Pb7AYMBRj2OOfZXfisjJnpTfSNjo6sZ6qSvNxZNmDeS7Gk3yYyCk1HtKN2UnhMIjOXUzAqDv90lx9O/q/AT1ZMnit5XQe9wmQxnE/WSH0CqZ9/2Hy+Sfmpeg8RwsHI5Z8kC8H293m/LHVVM/BA7HaTJYg5Enk7M/xWpq0192ACfBai2LA/qrCjCr6Dh1BIMzMXINBmX96MJ5Hn2nxln/RXPFhwHxUmSV0EV2V0jm86/dxxuYSU1W7sVkEbN9EzkG0QFwPhyHKyb3t+Fj5WoUUTErcazE/N6EW6Lvp0d//SDPj7EV9UdJN+Amnf3Wwk3A0SlJ9Z00yvXZ7n3z70G47Hfsow8Wq1JXcfwnA+Yxa5mFsgV464KKP4T31wqIgzFPd3eCe3j5ory5fBF2hgCFyVFrLzI9eetNXvM7oQqyFgDo4CTp/hDV9NMX9JDHQ/nyHTLvZLNLF6ftn2OxjGm8+PqOwhxnPHWipkE/8wbtyri80Sr7pMNkQGMfo4ZYK9OcCC4ESVFFbLMIvlxSoRqWie0wxqnLfcLSXMSpMMQEJYDVObYsXIQNv4TGNwjq1kvT1UOkicTrG3IaBZ3XdScS3u8sgeZPVpOLkbiF940FjbCeNRINNvDbd01EPBrTCPpm12m43ze1bBB59Ia6Ovhnur/Nvx3IxwSWol+3H2qfCJR8df6aQf4v6WiONxkK+IqT4pKQrZK/LplgDI/PJZbOep8dtbV7oCr6CgfpWa8NczOkPx81iSHbsNhVSJBOtrLIMrL31LK9TqHqAbAHe0RLmmV806kRLDLNEhUEJfm9u0sxpkL93Zgd6rw+tqBfTMi59xqXHLXSHwSbSBl0EK0+loECOPtrl+/nsaFe197di4yUgoe4jKoAJDXc6DGDjrQOoFDWZJ9HXwt8xDrQP+7aRwWKWI1GF8s8O4KzxWBBcwnl3vnl1Oez3oh6Ea1vjR7/z7DDTrFtqU2W/KAEzAuXDNZ7MY73MF216dzdSbWmUp4lcm7keJfWaMHgut9x5C9mj66Z0lJ+yhsjVvyiWrfk1lzPOTdhG15Y7gQlXtacvI7qv/XNSscDwqkgwHT/gUsD5yB7LdRRvJxQGYINn9hTpodKFVSTPrtGvyQw+HlRFXIkodErAGu9Iy1YpfSPc3jkFh5CX3lPxv7aqjE/JAfTIpEjGb/H7MO0e2vsViSW1qa/Lmi4/n4DEI3g7lYrcanspDfEpKkdV1OjSLOy0BCUqVoECaB55vs06rXl4jqmLsPsFM/7vYJ0vrBhDCm/00A/H81l1uekJ/6Lml3Hb9+NKiLqATJmDpyzfYZFHumEjC662L0Bwkxi7E9U4cQA0XMVDuMYAIeLMPgQaMVOd8fmt5SflFIfuBoszeAw7ow5gXPE2Y/yBc/7jExARUf/BxIHQBF5Sn3i61w4z5xJdCyO1F1X3+3ax+JSvMeZ7S6QSKp1Fp/sjYz6Z+VgCZzibGeEoujryfMulH7Rai5kAft9ebcW50DyJr2uo2z97mTWIu45YsSnNSMrrNUuG1XsYBtD9TDYzQffKB87vWbkM4EbPAFgoBV4GQS+vtFDUqOFAoi1nTtmIOvg38N4hT2Sn8r8clmBCXspBlMBYTnrqFJGBT3wZOzAyJDre9dHH7+x7qaaKDOB4UQALD5ecS0DE4obubQEiuJZ0EpBVpLuYcce8Aa4PYd/V4DLDAJBYKQPCWTcrEaZ5HYbJi11Gd6hjGom1ii18VHYnG28NKpkz2UKVPxlhYSp8uZr367iOmoy7zsxehW9wzcy2zG0a80PBMCRQMb32hnaHeOR8fnNDzZhaNYhkOdDsBUZ3loDMa1YP0uS0cjUP3b/6DBlqmZOeNABDsLl5BI5QJups8uxAuWJdkUB/pO6Zax6tsg7fN5mjjDgMGngO+DPcKqiHIDbFIGudxtPTIyDi9SFMKBDcfdGQRv41q1AqmxgkVfJMnP8w/Bc7N9/TR6C7mGObFqFkIEom8sKi2xYqJLTCHK7cxzaZvqODo22c3wisBCP4HeAgcRbNPAsBkNRhSmD48dHupdBRw4mIvtS5oeF6zeT1KMCyhMnmhpkFAGWnGscoNkwvQ8ZM5lE/vgTHFYL99OuNxdFBxTEDd5v2qLR8y9WkXsWgG6kZNndFG+pO/UAkOCipqIhL3hq7cRSdrCq7YhUsTocEcnaFa6nVkhnSeRYUA1YO0z5itF9Sly3VlxYDw239TJJH6f3EUfYO5lb7bcFcz8Bp7Oo8QmnsUHOz/fagVUBtKEw1iT88j+aKkv8cscKNkMxjYr8344D1kFoZ7/td1W6LCNYN594301tUGRmFjAzeRg5vyoM1F6+bJZ/Q54jN/k8SFd3DxPTYaAUsivsBfgTn7Mx8H2SpPt4GOdYRnEJOH6jHM2p6SgB0gzIRq6fHxGMmSmqaPCmlfwxiuloaVIitLGN8wie2CDWhkzLoCJcODh7KIOAqbHEvXdUxaS4TTTs07Clzj/6GmVs9kiZDerMxEnhUB6QQPlcfqkG9882RqHoLiHGBoHfQuXIsAG8GTAtao2KVwRnvvam8jo1e312GQAKWEa4sUVEAMG4G6ckcONDwRcg1e2D3+ohXgY4UAWF8wHKQMrSnzCgfFpsxh+aHXMGtPQroQasRY4U6UdG0rz1Vjbka0MekOGRZQEvqQFlxseFor8zWFgHek3v29+WqN6gaK5gZOTOMZzpQIC1201LkMCXild3vWXSc5UX9xcFYfbRPzGFa1FDcPfPB/jUEq/FeGt419CI3YmBlVoHsa4KdcwQP5ZSwHHhFJ7/Ph/Rap/4vmG91eDwPP0lDfCDRCLszTqfzM71xpmiKi2HwS4WlqvGNwtvwF5Dqpn6KTq8ax00UMPkxDcZrEEEsIvHiUXXEphdb4GB4FymlPwBz4Gperqq5pW7TQ6/yNRhW8VT5NhuP0udlxo4gILq5ZxAZk8ZGh3g4CqxJlPKY7AQxupfUcVpWT5VItp1+30UqoyP4wWsRo3olRRgkWZZ2ZN6VC3OZFeXB8NbnUrSdikNptD1QiGuKkr8EmSR/AK9Rw+FF3s5uwuPbvHGiPeFOViltMK7AUaOsq9+x9cndk3iJEE5LKZRlWJbKOZweROzmPNVPkjE3K/TyA57Rs68TkZ3MR8akKpm7cFjnjPd/DdkWjgYoKHSr5Wu5ssoBYU4acRs5g2DHxUmdq8VXOXRbunD8QN0LhgkssgahcdoYsNvuXGUK/KXD/7oFb+VGdhqIn02veuM5bLudJOc2Ky0GMaG4W/xWBxIJcL7yliJOXOpx0AkBqUgzlDczmLT4iILXDxxtRR1oZa2JWFgiAb43obrJnG/TZC2KSK2wqOzRZTXavZZFMb1f3bXvVaNaK828w9TO610gk8JNf3gMfETzXXsbcvRGCG9JWQZ6+cDPqc4466Yo2RcKH+PILeKOqtnlbInR3MmBeGG3FH10yzkybuqEC2HSQwpA0An7d9+73BkDUTm30bZmoP/RGbgFN+GrCOfADgqr0WbI1a1okpFms8iHYw9hm0zUvlEMivBRxModrbJJ+9/p3jUdQQ9BCtQdxnOGrT5dzRUmw0593/mbRSdBg0nRvRZM5/E16m7ZHmDEtWhwvfdZCZ8J8M12W0yRMszXamWfQTwIZ4ayYktrnscQuWr8idp3PjT2eF/jmtdhIfcpMnb+IfZY2FebW6UY/AK3jP4u3Tu4zE4qlnQgLFbM19EBIsNf7KhjdbqQ/D6yiDb+NlEi2SKD+ivXVUK8ib0oBo366gXkR8ZxGjpJIDcEgZPa9TcYe0TIbiPl/rPUQDu3XBJ9X/GNq3FAUsKsll57DzaGMrjcT+gctp+9MLYXCq+sqP81eVQ0r9lt+gcQfZbACRbEjvlMskztZG8gbC8Qn9tt26Q7y7nDrbZq/LEz7kR6Jc6pg3N9rVX8Y5MJrGlML9p9lU4jbTkKqCveeZUJjHB03m2KRKR2TytoFkTXOLg7keU1s1lrPMQJpoOKLuAAC+y1HlJucU6ysB5hsXhvSPPLq5J7JtnqHKZ4vYjC4Vy8153QY+6780xDuGARsGbOs1WqzH0QS765rnSKEbbKlkO8oI/VDwUd0is13tKpqILu1mDJFNy/iJAWcvDgjxvusIT+PGz3ST/J9r9Mtfd0jpaGeiLYIqXc7DiHSS8TcjFVksi66PEkxW1z6ujbLLUGNNYnzOWpH8BZGK4bCK7iR+MbIv8ncDAz1u4StN3vTTzewr9IQjk9wxFxn+6N1ddKs0vffJiS08N3a4G1SVrlZ97Q/M+8G9fe5AP6d9/Qq4WRnORVhofPIKEdCr3llspUfE0oKIIYoByBRPh+bX1HLS3JWGJRhIvE1aW4NTd8ePi4Z+kXb+Z8snYfSNcqijhAgVsx4RCM54cXUiYkjeBmmC4ajOHrChoELscJJC7+9jjMjw5BagZKlgRMiSNYz7h7vvZIoQqbtQmspc0cUk1G/73iXtSpROl5wtLgQi0mW2Ex8i3WULhcggx6E1LMVHUsdc9GHI1PH3U2Ko0PyGdn9KdVOLm7FPBui0i9a0HpA60MsewVE4z8CAt5d401Gv6zXlIT5Ybit1VIA0FCs7wtvYreru1fUyW3oLAZ/+aTnZrOcYRNVA8spoRtlRoWflsRClFcgzkqiHOrf0/SVw+EpVaFlJ0g4Kxq1MMOmiQdpMNpte8lMMQqm6cIFXlnGbfJllysKDi+0JJMotkqgIxOSQgU9dn/lWkeVf8nUm3iwX2Nl3WDw9i6AUK3vBAbZZrcJpDQ/N64AVwjT07Jef30GSSmtNu2WlW7YoyW2FlWfZFQUwk867EdLYKk9VG6JgEnBiBxkY7LMo4YLQJJlAo9l/oTvJkSARDF/XtyAzM8O2t3eT/iXa6wDN3WewNmQHdPfsxChU/KtLG2Mn8i4ZqKdSlIaBZadxJmRzVS/o4yA65RTSViq60oa395Lqw0pzY4SipwE0SXXsKV+GZraGSkr/RW08wPRvqvSUkYBMA9lPx4m24az+IHmCbXA+0faxTRE9wuGeO06DIXa6QlKJ3puIyiuAVfPr736vzo2pBirS+Vxel3TMm3JKhz9o2ZoRvaFVpIkykb0Hcm4oHFBMcNSNj7/4GJt43ogonY2Vg4nsDQIWxAcorpXACzgBqQPjYsE/VUpXpwNManEru4NwMCFPkXvMoqvoeLN3qyu/N1eWEHttMD65v19l/0kH2mR35iv/FI+yjoHJ9gPMz67af3Mq/BoWXqu3rphiWMXVkmnPSEkpGpUI2h1MThideGFEOK6YZHPwYzMBvpNC7+ZHxPb7epfefGyIB4JzO9DTNEYnDLVVHdQyvOEVefrk6Uv5kTQYVYWWdqrdcIl7yljwwIWdfQ/y+2QB3eR/qxYObuYyB4gTbo2in4PzarU1sO9nETkmj9/AoxDA+JM3GMqQtJR4jtduHtnoCLxd1gQUscHRB/MoRYIEsP2pDZ9KvHgtlk1iTbWWbHhohwFEYX7y51fUV2nuUmnoUcqnWIQAAgl9LTVX+Bc0QGNEhChxHR4YjfE51PUdGfsSFE6ck7BL3/hTf9jLq4G1IafINxOLKeAtO7quulYvH5YOBc+zX7CrMgWnW47/jfRsWnJjYYoE7xMfWV2HN2iyIqLI";const jd=new Map([[8217,"apostrophe"],[8260,"fraction slash"],[12539,"middle dot"]]),Hd=4;function s1(t){let e=0;function s(){return t[e++]<<8|t[e++]}let n=s(),r=1,i=[0,1];for(let Y=1;Y<n;Y++)i.push(r+=s());let o=s(),l=e;e+=o;let c=0,u=0;function d(){return c==0&&(u=u<<8|t[e++],c=8),u>>--c&1}const f=31,h=2**f,y=h>>>1,T=y>>1,w=h-1;let k=0;for(let Y=0;Y<f;Y++)k=k<<1|d();let C=[],N=0,L=h;for(;;){let Y=Math.floor(((k-N+1)*r-1)/L),W=0,$=n;for(;$-W>1;){let re=W+$>>>1;Y<i[re]?$=re:W=re}if(W==0)break;C.push(W);let Q=N+Math.floor(L*i[W]/r),J=N+Math.floor(L*i[W+1]/r)-1;for(;((Q^J)&y)==0;)k=k<<1&w|d(),Q=Q<<1&w,J=J<<1&w|1;for(;Q&~J&T;)k=k&y|k<<1&w>>>1|d(),Q=Q<<1^y,J=(J^y)<<1|y|1;N=Q,L=1+J-Q}let D=n-4;return C.map(Y=>{switch(Y-D){case 3:return D+65792+(t[l++]<<16|t[l++]<<8|t[l++]);case 2:return D+256+(t[l++]<<8|t[l++]);case 1:return D+t[l++];default:return Y-1}})}function n1(t){let e=0;return()=>t[e++]}function sm(t){return n1(s1(r1(t)))}function r1(t){let e=[];[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"].forEach((r,i)=>e[r.charCodeAt(0)]=i);let s=t.length,n=new Uint8Array(6*s>>3);for(let r=0,i=0,o=0,l=0;r<s;r++)l=l<<6|e[t.charCodeAt(r)],o+=6,o>=8&&(n[i++]=l>>(o-=8));return n}function i1(t){return t&1?~t>>1:t>>1}function o1(t,e){let s=Array(t);for(let n=0,r=0;n<t;n++)s[n]=r+=i1(e());return s}function ro(t,e=0){let s=[];for(;;){let n=t(),r=t();if(!r)break;e+=n;for(let i=0;i<r;i++)s.push(e+i);e+=r+1}return s}function nm(t){return io(()=>{let e=ro(t);if(e.length)return e})}function rm(t){let e=[];for(;;){let s=t();if(s==0)break;e.push(a1(s,t))}for(;;){let s=t()-1;if(s<0)break;e.push(l1(s,t))}return e.flat()}function io(t){let e=[];for(;;){let s=t(e.length);if(!s)break;e.push(s)}return e}function im(t,e,s){let n=Array(t).fill().map(()=>[]);for(let r=0;r<e;r++)o1(t,s).forEach((i,o)=>n[o].push(i));return n}function a1(t,e){let s=1+e(),n=e(),r=io(e);return im(r.length,1+t,e).flatMap((o,l)=>{let[c,...u]=o;return Array(r[l]).fill().map((d,f)=>{let h=f*n;return[c+f*s,u.map(y=>y+h)]})})}function l1(t,e){let s=1+e();return im(s,1+t,e).map(r=>[r[0],r.slice(1)])}function c1(t){let e=[],s=ro(t);return r(n([]),[]),e;function n(i){let o=t(),l=io(()=>{let c=ro(t).map(u=>s[u]);if(c.length)return n(c)});return{S:o,B:l,Q:i}}function r({S:i,B:o},l,c){if(!(i&4&&c===l[l.length-1])){i&2&&(c=l[l.length-1]),i&1&&e.push(l);for(let u of o)for(let d of u.Q)r(u,[...l,d],c)}}}function u1(t){return t.toString(16).toUpperCase().padStart(2,"0")}function om(t){return`{${u1(t)}}`}function d1(t){let e=[];for(let s=0,n=t.length;s<n;){let r=t.codePointAt(s);s+=r<65536?1:2,e.push(r)}return e}function ai(t){let s=t.length;if(s<4096)return String.fromCodePoint(...t);let n=[];for(let r=0;r<s;)n.push(String.fromCodePoint(...t.slice(r,r+=4096)));return n.join("")}function f1(t,e){let s=t.length,n=s-e.length;for(let r=0;n==0&&r<s;r++)n=t[r]-e[r];return n}var h1="AEUDTAHBCFQATQDRADAAcgAgADQAFAAsABQAHwAOACQADQARAAoAFwAHABIACAAPAAUACwAFAAwABAAQAAMABwAEAAoABQAIAAIACgABAAQAFAALAAIACwABAAIAAQAHAAMAAwAEAAsADAAMAAwACgANAA0AAwAKAAkABAAdAAYAZwDSAdsDJgC0CkMB8xhZAqfoC190UGcThgBurwf7PT09Pb09AjgJum8OjDllxHYUKXAPxzq6tABAxgK8ysUvWAgMPT09PT09PSs6LT2HcgWXWwFLoSMEEEl5RFVMKvO0XQ8ExDdJMnIgsj26PTQyy8FfEQ8AY8IPAGcEbwRwBHEEcgRzBHQEdQR2BHcEeAR6BHsEfAR+BIAEgfndBQoBYgULAWIFDAFiBNcE2ATZBRAFEQUvBdALFAsVDPcNBw13DYcOMA4xDjMB4BllHI0B2grbAMDpHLkQ7QHVAPRNQQFnGRUEg0yEB2uaJF8AJpIBpob5AERSMAKNoAXqaQLUBMCzEiACnwRZEkkVsS7tANAsBG0RuAQLEPABv9HICTUBXigPZwRBApMDOwAamhtaABqEAY8KvKx3LQ4ArAB8UhwEBAVSagD8AEFZADkBIadVj2UMUgx5Il4ANQC9AxIB1BlbEPMAs30CGxlXAhwZKQIECBc6EbsCoxngzv7UzRQA8M0BawL6ZwkN7wABAD33OQRcsgLJCjMCjqUChtw/km+NAsXPAoP2BT84PwURAK0RAvptb6cApQS/OMMey5HJS84UdxpxTPkCogVFITaTOwERAK5pAvkNBOVyA7q3BKlOJSALAgUIBRcEdASpBXqzABXFSWZOawLCOqw//AolCZdvv3dSBkEQGyelEPcMMwG1ATsN7UvYBPEGOwTJH30ZGQ/NlZwIpS3dDO0m4y6hgFoj9SqDBe1L9DzdC01RaA9ZC2UJ4zpjgU4DIQENIosK3Q05CG0Q8wrJaw3lEUUHOQPVSZoApQcBCxEdNRW1JhBirAsJOXcG+xr2C48mrxMpevwF0xohBk0BKRr/AM8u54WwWjFcHE9fBgMLJSPHFKhQIA0lQLd4SBobBxUlqQKRQ3BKh1E2HpMh9jw9DWYuE1F8B/U8BRlPC4E8nkarRQ4R0j6NPUgiSUwsBDV/LC8niwnPD4UMuXxyAVkJIQmxDHETMREXN8UIOQcZLZckJxUIIUaVYJoE958D8xPRAwsFPwlBBxMDtRwtEy4VKQUNgSTXAvM21S6zAo9WgAEXBcsPJR/fEFBH4A7pCJsCZQODJesALRUhABcimwhDYwBfj9hTBS7LCMdqbCN0A2cU52ERcweRDlcHpxwzFb8c4XDIXguGCCijrwlbAXUJmQFfBOMICTVbjKAgQWdTi1gYmyBhQT9d/AIxDGUVn0S9h3gCiw9rEhsBNQFzBzkNAQJ3Ee0RaxCVCOuGBDW1M/g6JQRPIYMgEQonA09szgsnJvkM+GkBoxJiAww0PXfuZ6tgtiQX/QcZMsVBYCHxC5JPzQycGsEYQlQuGeQHvwPzGvMn6kFXBf8DowMTOk0z7gS9C2kIiwk/AEkOoxcH1xhqCnGM0AExiwG3mQNXkYMCb48GNwcLAGcLhwV55QAdAqcIowAFAM8DVwA5Aq0HnQAZAIVBAT0DJy8BIeUCjwOTCDHLAZUvAfMpBBvDDBUA9zduSgLDsQKAamaiBd1YAo4CSTUBTSUEBU5HUQOvceEA2wBLBhPfRwEVq0rLGuNDAd9vKwDHAPsABTUHBUEBzQHzbQC3AV8LMQmis7UBTekpAIMAFWsB1wKJAN0ANQB/8QFTAE0FWfkF0wJPSQERMRgrV2EBuwMfATMBDQB5BsuNpckHHwRtB9MCEBsV4QLvLge1AQMi3xPNQsUCvd5VoWACZIECYkJbTa9bNyACofcCaJgCZgkCn4Q4GwsCZjsCZiYEbgR/A38TA36SOQY5dxc5gjojIwJsHQIyNjgKAm3HAm2u74ozZ0UrAWcA3gDhAEoFB5gMjQD+C8IADbUCdy8CdqI/AnlLQwJ4uh1c20WuRtcCfD8CesgCfQkCfPAFWQUgSABIfWMkAoFtAoAAAoAFAn+uSVhKWxUXSswC0QEC0MxLJwOITwOH5kTFkTIC8qFdAwMDrkvOTC0lA89NTE2vAos/AorYwRsHHUNnBbcCjjcCjlxAl4ECjtkCjlx4UbRTNQpS1FSFApP7ApMMAOkAHFUeVa9V0AYsGymVhjLheGZFOzkCl58C77JYIagAWSUClo8ClnycAKlZrFoJgU0AOwKWtQKWTlxEXNECmcsCmWRcyl0HGQKcmznCOp0CnBYCn5sCnriKAB0PMSoPAp3xAp6SALU9YTRh7wKe0wKgbgGpAp6fHwKeTqVjyGQnJSsCJ68CJn4CoPsCoEwCot0CocQCpi8Cpc4Cp/8AfQKn8mh8aLEAA0lqHGrRAqzjAqyuAq1nAq0CAlcdAlXcArHh1wMfTmyXArK9DQKy6Bds4G1jbUhfAyXNArZcOz9ukAMpRQK4XgK5RxUCuSp3cDZw4QK9GQK72nCWAzIRAr6IcgIDM3ECvhpzInNPAsPLAsMEc4J0SzVFdOADPKcDPJoDPb8CxXwCxkcCxhCJAshpUQLIRALJTwLJLgJknQLd0nh5YXiueSVL0AMYo2cCAmH0GfOVJHsLXpJeuxECz2sCz2wvS1PS8xOfAMatAs9zASnqA04SfksFAtwnAtuKAtJPA1JcA1NfAQEDVYyAiT8AyxbtYEWCHILTgs6DjQLaxwLZ3oQQhEmnPAOGpQAvA2QOhnFZ+QBVAt9lAt64c3cC4i/tFAHzMCcB9JsB8tKHAuvzAulweQLq+QLq5AD5RwG5Au6JAuuclqqXAwLuPwOF4Jh5cOBxoQLzAwBpA44WmZMC9xMDkW4DkocC95gC+dkC+GaaHJqruzebHgOdgwL++gEbADmfHJ+zAwWNA6ZqA6bZANHFAwZqoYiiBQkDDEkCwAA/AwDhQRdTARHzA2sHl2cFAJMtK7evvdsBiZkUfxEEOQH7KQUhDp0JnwCS/SlXxQL3AZ0AtwW5AG8LbUEuFCaNLgFDAYD8AbUmAHUDDgRtACwCFgyhAAAKAj0CagPdA34EkQEgRQUhfAoABQBEABMANhICdwEABdUDa+8KxQIA9wqfJ7+xt+UBkSFBQgHpFH8RNMCJAAQAGwBaAkUChIsABjpTOpSNbQC4Oo860ACNOME63AClAOgAywE6gTo7Ofw5+Tt2iTpbO56JOm85GAFWATMBbAUvNV01njWtNWY1dTW2NcU1gjWRNdI14TWeNa017jX9NbI1wTYCNhE1xjXVNhY2JzXeNe02LjY9Ni41LSE2OjY9Njw2yTcIBJA8VzY4Nt03IDcPNsogN4k3MAoEsDxnNiQ3GTdsOo03IULUQwdC4EMLHA8PCZsobShRVQYA6X8A6bABFCnXAukBowC9BbcAbwNzBL8MDAMMAQgDAAkKCwsLCQoGBAVVBI/DvwDz9b29kaUCb0QtsRTNLt4eGBcSHAMZFhYZEhYEARAEBUEcQRxBHEEcQRxBHEEaQRxBHEFCSTxBPElISUhBNkM2QTYbNklISVmBVIgBFLWZAu0BhQCjBcEAbykBvwGJAaQcEZ0ePCklMAAhMvAIMAL54gC7Bm8EescjzQMpARQpKgDUABavAj626xQAJP0A3etzuf4NNRA7efy2Z9NQrCnC0OSyANz5BBIbJ5IFDR6miIavYS6tprjjmuKebxm5C74Q225X1pkaYYPb6f1DK4k3xMEBb9S2WMjEibTNWhsRJIA+vwNVEiXTE5iXs/wezV66oFLfp9NZGYW+Gk19J2+bCT6Ye2w6LDYdgzKMUabk595eLBCXANz9HUpWbATq9vqXVx9XDg+Pc9Xp4+bsS005SVM/BJBM4687WUuf+Uj9dEi8aDNaPxtpbDxcG1THTImUMZq4UCaaNYpsVqraNyKLJXDYsFZ/5jl7bLRtO88t7P3xZaAxhb5OdPMXqsSkp1WCieG8jXm1U99+blvLlXzPCS+M93VnJCiK+09LfaSaBAVBomyDgJua8dfUzR7ga34IvR2Nvj+A9heJ6lsl1KG4NkI1032Cnff1m1wof2B9oHJK4bi6JkEdSqeNeiuo6QoZZincoc73/TH9SXF8sCE7XyuYyW8WSgbGFCjPV0ihLKhdPs08Tx82fYAkLLc4I2wdl4apY7GU5lHRFzRWJep7Ww3wbeA3qmd59/86P4xuNaqDpygXt6M85glSBHOCGgJDnt+pN9bK7HApMguX6+06RZNjzVmcZJ+wcUrJ9//bpRNxNuKpNl9uFds+S9tdx7LaM5ZkIrPj6nIU9mnbFtVbs9s/uLgl8MVczAwet+iOEzzBlYW7RCMgE6gyNLeq6+1tIx4dpgZnd0DksJS5f+JNDpwwcPNXaaVspq1fbQajOrJgK0ofKtJ1Ne90L6VO4MOl5S886p7u6xo7OLjG8TGL+HU1JXGJgppg4nNbNJ5nlzSpuPYy21JUEcUA94PoFiZfjZue+QnyQ80ekOuZVkxx4g+cvhJfHgNl4hy1/a6+RKcKlar/J29y//EztlbVPHVUeQ1zX86eQVAjR/M3dA9w4W8LfaXp4EgM85wOWasli837PzVMOnsLzR+k3o75/lRPAJSE1xAKQzEi5v10ke+VBvRt1cwQRMd+U5mLCTGVd6XiZtgBG5cDi0w22GKcVNvHiu5LQbZEDVtz0onn7k5+heuKXVsZtSzilkLRAUmjMXEMB3J9YC50XBxPiz53SC+EhnPl9WsKCv92SM/OFFIMJZYfl0WW8tIO3UxYcwdMAj7FSmgrsZ2aAZO03BOhP1bNNZItyXYQFTpC3SG1VuPDqH9GkiCDmE+JwxyIVSO5siDErAOpEXFgjy6PQtOVDj+s6e1r8heWVvmZnTciuf4EiNZzCAd7SOMhXERIOlsHIMG399i9aLTy3m2hRLZjJVDNLS53iGIK11dPqQt0zBDyg6qc7YqkDm2M5Ve6dCWCaCbTXX2rToaIgz6+zh4lYUi/+6nqcFMAkQJKHYLK0wYk5N9szV6xihDbDDFr45lN1K4aCXBq/FitPSud9gLt5ZVn+ZqGX7cwm2z5EGMgfFpIFyhGGuDPmso6TItTMwny+7uPnLCf4W6goFQFV0oQSsc9VfMmVLcLr6ZetDZbaSFTLqnSO/bIPjA3/zAUoqgGFAEQS4IhuMzEp2I3jJzbzkk/IEmyax+rhZTwd6f+CGtwPixu8IvzACquPWPREu9ZvGkUzpRwvRRuaNN6cr0W1wWits9ICdYJ7ltbgMiSL3sTPeufgNcVqMVWFkCPDH4jG2jA0XcVgQj62Cb29v9f/z/+2KbYvIv/zzjpQAPkliaVDzNrW57TZ/ZOyZD0nlfMmAIBIAGAI0D3k/mdN4xr9v85ZbZbbqfH2jGd5hUqNZWwl5SPfoGmfElmazUIeNL1j/mkF7VNAzTq4jNt8JoQ11NQOcmhprXoxSxfRGJ9LDEOAQ+dmxAQH90iti9e2u/MoeuaGcDTHoC+xsmEeWmxEKefQuIzHbpw5Tc5cEocboAD09oipWQhtTO1wivf/O+DRe2rpl/E9wlrzBorjJsOeG1B/XPW4EaJEFdNlECEZga5ZoGRHXgYouGRuVkm8tDESiEyFNo+3s5M5puSdTyUL2llnINVHEt91XUNW4ewdMgJ4boJfEyt/iY5WXqbA+A2Fkt5Z0lutiWhe9nZIyIUjyXDC3UsaG1t+eNx6z4W/OYoTB7A6x+dNSTOi9AInctbESqm5gvOLww7OWXPrmHwVZasrl4eD113pm+JtT7JVOvnCXqdzzdTRHgJ0PiGTFYW5Gvt9R9LD6Lzfs0v/TZZHSmyVNq7viIHE6DBK7Qp07Iz55EM8SYtQvZf/obBniTWi5C2/ovHfw4VndkE5XYdjOhCMRjDeOEfXeN/CwfGduiUIfsoFeUxXeQXba7c7972XNv8w+dTjjUM0QeNAReW+J014dKAD/McQYXT7c0GQPIkn3Ll6R7gGjuiQoZD0TEeEqQpKoZ15g/0OPQI17QiSv9AUROa/V/TQN3dvLArec3RrsYlvBm1b8LWzltdugsC50lNKYLEp2a+ZZYqPejULRlOJh5zj/LVMyTDvwKhMxxwuDkxJ1QpoNI0OTWLom4Z71SNzI9TV1iXJrIu9Wcnd+MCaAw8o1jSXd94YU/1gnkrC9BUEOtQvEIQ7g0i6h+KL2JKk8Ydl7HruvgWMSAmNe+LshGhV4qnWHhO9/RIPQzY1tHRj2VqOyNsDpK0cww+56AdDC4gsWwY0XxoucIWIqs/GcwnWqlaT0KPr8mbK5U94/301i1WLt4YINTVvCFBrFZbIbY8eycOdeJ2teD5IfPLCRg7jjcFTwlMFNl9zdh/o3E/hHPwj7BWg0MU09pPrBLbrCgm54A6H+I6v27+jL5gkjWg/iYdks9jbfVP5y/n0dlgWEMlKasl7JvFZd56LfybW1eeaVO0gxTfXZwD8G4SI116yx7UKVRgui6Ya1YpixqXeNLc8IxtAwCU5IhwQgn+NqHnRaDv61CxKhOq4pOX7M6pkA+Pmpd4j1vn6ACUALoLLc4vpXci8VidLxzm7qFBe7s+quuJs6ETYmnpgS3LwSZxPIltgBDXz8M1k/W2ySNv2f9/NPhxLGK2D21dkHeSGmenRT3Yqcdl0m/h3OYr8V+lXNYGf8aCCpd4bWjE4QIPj7vUKN4Nrfs7ML6Y2OyS830JCnofg/k7lpFpt4SqZc5HGg1HCOrHvOdC8bP6FGDbE/VV0mX4IakzbdS/op+Kt3G24/8QbBV7y86sGSQ/vZzU8FXs7u6jIvwchsEP2BpIhW3G8uWNwa3HmjfH/ZjhhCWvluAcF+nMf14ClKg5hGgtPLJ98ueNAkc5Hs2WZlk2QHvfreCK1CCGO6nMZVSb99VM/ajr8WHTte9JSmkXq/i/U943HEbdzW6Re/S88dKgg8pGOLlAeNiqrcLkUR3/aClFpMXcOUP3rmETcWSfMXZE3TUOi8i+fqRnTYLflVx/Vb/6GJ7eIRZUA6k3RYR3iFSK9c4iDdNwJuZL2FKz/IK5VimcNWEqdXjSoxSgmF0UPlDoUlNrPcM7ftmA8Y9gKiqKEHuWN+AZRIwtVSxye2Kf8rM3lhJ5XcBXU9n4v0Oy1RU2M+4qM8AQPVwse8ErNSob5oFPWxuqZnVzo1qB/IBxkM3EVUKFUUlO3e51259GgNcJbCmlvrdjtoTW7rChm1wyCKzpCTwozUUEOIcWLneRLgMXh+SjGSFkAllzbGS5HK7LlfCMRNRDSvbQPjcXaenNYxCvu2Qyznz6StuxVj66SgI0T8B6/sfHAJYZaZ78thjOSIFumNWLQbeZixDCCC+v0YBtkxiBB3jefHqZ/dFHU+crbj6OvS1x/JDD7vlm7zOVPwpUC01nhxZuY/63E7g";const oo=44032,ha=4352,pa=4449,ma=4519,am=19,lm=21,li=28,ga=lm*li,p1=am*ga,m1=oo+p1,g1=ha+am,y1=pa+lm,v1=ma+li;function Ri(t){return t>>24&255}function cm(t){return t&16777215}let lc,Wd,cc,zo;function b1(){let t=sm(h1);lc=new Map(nm(t).flatMap((e,s)=>e.map(n=>[n,s+1<<24]))),Wd=new Set(ro(t)),cc=new Map,zo=new Map;for(let[e,s]of rm(t)){if(!Wd.has(e)&&s.length==2){let[n,r]=s,i=zo.get(n);i||(i=new Map,zo.set(n,i)),i.set(r,e)}cc.set(e,s.reverse())}}function um(t){return t>=oo&&t<m1}function w1(t,e){if(t>=ha&&t<g1&&e>=pa&&e<y1)return oo+(t-ha)*ga+(e-pa)*li;if(um(t)&&e>ma&&e<v1&&(t-oo)%li==0)return t+(e-ma);{let s=zo.get(t);return s&&(s=s.get(e),s)?s:-1}}function dm(t){lc||b1();let e=[],s=[],n=!1;function r(i){let o=lc.get(i);o&&(n=!0,i|=o),e.push(i)}for(let i of t)for(;;){if(i<128)e.push(i);else if(um(i)){let o=i-oo,l=o/ga|0,c=o%ga/li|0,u=o%li;r(ha+l),r(pa+c),u>0&&r(ma+u)}else{let o=cc.get(i);o?s.push(...o):r(i)}if(!s.length)break;i=s.pop()}if(n&&e.length>1){let i=Ri(e[0]);for(let o=1;o<e.length;o++){let l=Ri(e[o]);if(l==0||i<=l){i=l;continue}let c=o-1;for(;;){let u=e[c+1];if(e[c+1]=e[c],e[c]=u,!c||(i=Ri(e[--c]),i<=l))break}i=Ri(e[o])}}return e}function A1(t){let e=[],s=[],n=-1,r=0;for(let i of t){let o=Ri(i),l=cm(i);if(n==-1)o==0?n=l:e.push(l);else if(r>0&&r>=o)o==0?(e.push(n,...s),s.length=0,n=l):s.push(l),r=o;else{let c=w1(n,l);c>=0?n=c:r==0&&o==0?(e.push(n),n=l):(s.push(l),r=o)}}return n>=0&&e.push(n,...s),e}function fm(t){return dm(t).map(cm)}function E1(t){return A1(dm(t))}const Yd=45,hm=".",pm=65039,mm=1,ya=t=>Array.from(t);function ao(t,e){return t.P.has(e)||t.Q.has(e)}class _1 extends Array{get is_emoji(){return!0}}let uc,gm,vr,dc,ym,Zr,Sl,Vr,ur,Gd,fc;function au(){if(uc)return;let t=sm(t1);const e=()=>ro(t),s=()=>new Set(e()),n=(d,f)=>f.forEach(h=>d.add(h));uc=new Map(rm(t)),gm=s(),vr=e(),dc=new Set(e().map(d=>vr[d])),vr=new Set(vr),ym=s(),s();let r=nm(t),i=t();const o=()=>{let d=new Set;return e().forEach(f=>n(d,r[f])),n(d,e()),d};Zr=io(d=>{let f=io(t).map(h=>h+96);if(f.length){let h=d>=i;f[0]-=32,f=ai(f),h&&(f=`Restricted[${f}]`);let y=o(),T=o(),w=!t();return{N:f,P:y,Q:T,M:w,R:h}}}),Sl=s(),Vr=new Map;let l=e().concat(ya(Sl)).sort((d,f)=>d-f);l.forEach((d,f)=>{let h=t(),y=l[f]=h?l[f-h]:{V:[],M:new Map};y.V.push(d),Sl.has(d)||Vr.set(d,y)});for(let{V:d,M:f}of new Set(Vr.values())){let h=[];for(let T of d){let w=Zr.filter(C=>ao(C,T)),k=h.find(({G:C})=>w.some(N=>C.has(N)));k||(k={G:new Set,V:[]},h.push(k)),k.V.push(T),n(k.G,w)}let y=h.flatMap(T=>ya(T.G));for(let{G:T,V:w}of h){let k=new Set(y.filter(C=>!T.has(C)));for(let C of w)f.set(C,k)}}ur=new Set;let c=new Set;const u=d=>ur.has(d)?c.add(d):ur.add(d);for(let d of Zr){for(let f of d.P)u(f);for(let f of d.Q)u(f)}for(let d of ur)!Vr.has(d)&&!c.has(d)&&Vr.set(d,mm);n(ur,fm(ur)),Gd=c1(t).map(d=>_1.from(d)).sort(f1),fc=new Map;for(let d of Gd){let f=[fc];for(let h of d){let y=f.map(T=>{let w=T.get(h);return w||(w=new Map,T.set(h,w)),w});h===pm?f.push(...y):f=y}for(let h of f)h.V=d}}function lu(t){return(vm(t)?"":`${cu(Ga([t]))} `)+om(t)}function cu(t){return`"${t}"‎`}function T1(t){if(t.length>=4&&t[2]==Yd&&t[3]==Yd)throw new Error(`invalid label extension: "${ai(t.slice(0,4))}"`)}function P1(t){for(let s=t.lastIndexOf(95);s>0;)if(t[--s]!==95)throw new Error("underscore allowed only at start")}function k1(t){let e=t[0],s=jd.get(e);if(s)throw Vi(`leading ${s}`);let n=t.length,r=-1;for(let i=1;i<n;i++){e=t[i];let o=jd.get(e);if(o){if(r==i)throw Vi(`${s} + ${o}`);r=i+1,s=o}}if(r==n)throw Vi(`trailing ${s}`)}function Ga(t,e=1/0,s=om){let n=[];S1(t[0])&&n.push("◌"),t.length>e&&(e>>=1,t=[...t.slice(0,e),8230,...t.slice(-e)]);let r=0,i=t.length;for(let o=0;o<i;o++){let l=t[o];vm(l)&&(n.push(ai(t.slice(r,o))),n.push(s(l)),r=o+1)}return n.push(ai(t.slice(r,i))),n.join("")}function S1(t){return au(),vr.has(t)}function vm(t){return au(),ym.has(t)}function C1(t){return x1(I1(t,E1,O1))}function I1(t,e,s){if(!t)return[];au();let n=0;return t.split(hm).map(r=>{let i=d1(r),o={input:i,offset:n};n+=i.length+1;try{let l=o.tokens=L1(i,e,s),c=l.length,u;if(!c)throw new Error("empty label");let d=o.output=l.flat();if(P1(d),!(o.emoji=c>1||l[0].is_emoji)&&d.every(h=>h<128))T1(d),u="ASCII";else{let h=l.flatMap(y=>y.is_emoji?[]:y);if(!h.length)u="Emoji";else{if(vr.has(d[0]))throw Vi("leading combining mark");for(let w=1;w<c;w++){let k=l[w];if(!k.is_emoji&&vr.has(k[0]))throw Vi(`emoji + combining mark: "${ai(l[w-1])} + ${Ga([k[0]])}"`)}k1(d);let y=ya(new Set(h)),[T]=D1(y);N1(T,h),R1(T,y),u=T.N}}o.type=u}catch(l){o.error=l}return o})}function R1(t,e){let s,n=[];for(let r of e){let i=Vr.get(r);if(i===mm)return;if(i){let o=i.M.get(r);if(s=s?s.filter(l=>o.has(l)):ya(o),!s.length)return}else n.push(r)}if(s){for(let r of s)if(n.every(i=>ao(r,i)))throw new Error(`whole-script confusable: ${t.N}/${r.N}`)}}function D1(t){let e=Zr;for(let s of t){let n=e.filter(r=>ao(r,s));if(!n.length)throw Zr.some(r=>ao(r,s))?wm(e[0],s):bm(s);if(e=n,n.length==1)break}return e}function x1(t){return t.map(({input:e,error:s,output:n})=>{if(s){let r=s.message;throw new Error(t.length==1?r:`Invalid label ${cu(Ga(e,63))}: ${r}`)}return ai(n)}).join(hm)}function bm(t){return new Error(`disallowed character: ${lu(t)}`)}function wm(t,e){let s=lu(e),n=Zr.find(r=>r.P.has(e));return n&&(s=`${n.N} ${s}`),new Error(`illegal mixture: ${t.N} + ${s}`)}function Vi(t){return new Error(`illegal placement: ${t}`)}function N1(t,e){for(let s of e)if(!ao(t,s))throw wm(t,s);if(t.M){let s=fm(e);for(let n=1,r=s.length;n<r;n++)if(dc.has(s[n])){let i=n+1;for(let o;i<r&&dc.has(o=s[i]);i++)for(let l=n;l<i;l++)if(s[l]==o)throw new Error(`duplicate non-spacing marks: ${lu(o)}`);if(i-n>Hd)throw new Error(`excessive non-spacing marks: ${cu(Ga(s.slice(n-1,i)))} (${i-n}/${Hd})`);n=i}}}function L1(t,e,s){let n=[],r=[];for(t=t.slice().reverse();t.length;){let i=U1(t);if(i)r.length&&(n.push(e(r)),r=[]),n.push(s(i));else{let o=t.pop();if(ur.has(o))r.push(o);else{let l=uc.get(o);if(l)r.push(...l);else if(!gm.has(o))throw bm(o)}}}return r.length&&n.push(e(r)),n}function O1(t){return t.filter(e=>e!=pm)}function U1(t,e){let s=fc,n,r=t.length;for(;r&&(s=s.get(t[--r]),!!s);){let{V:i}=s;i&&(n=i,t.length=r)}return n}const Am=new Uint8Array(32);Am.fill(0);function Kd(t){return P(t.length!==0,"invalid ENS name; empty component","comp",t),t}function Em(t){const e=_n(B1(t)),s=[];if(t.length===0)return s;let n=0;for(let r=0;r<e.length;r++)e[r]===46&&(s.push(Kd(e.slice(n,r))),n=r+1);return P(n<e.length,"invalid ENS name; empty component","name",t),s.push(Kd(e.slice(n))),s}function B1(t){try{if(t.length===0)throw new Error("empty label");return C1(t)}catch(e){P(!1,`invalid ENS name (${e.message})`,"name",t)}}function hc(t){P(typeof t=="string","invalid ENS name; not a string","name",t),P(t.length,"invalid ENS name (empty label)","name",t);let e=Am;const s=Em(t);for(;s.length;)e=wt(At([e,wt(s.pop())]));return oe(e)}function M1(t,e){const s=e;return P(s<=255,"DNS encoded label cannot exceed 255","length",s),oe(At(Em(t).map(n=>{P(n.length<=s,`label ${JSON.stringify(t)} exceeds ${s} bytes`,"name",t);const r=new Uint8Array(n.length+1);return r.set(n,1),r[0]=r.length-1,r})))+"00"}const _m=new Uint8Array(32);_m.fill(0);const F1=BigInt(-1),Tm=BigInt(0),Pm=BigInt(1),V1=BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function $1(t){const e=Oe(t),s=e.length%32;return s?At([e,_m.slice(s)]):oe(e)}const j1=Jn(Pm,32),H1=Jn(Tm,32),zd={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},Cl=["name","version","chainId","verifyingContract","salt"];function Qd(t){return function(e){return P(typeof e=="string",`invalid domain value for ${JSON.stringify(t)}`,`domain.${t}`,e),e}}const W1={name:Qd("name"),version:Qd("version"),chainId:function(t){const e=he(t,"domain.chainId");return P(e>=0,"invalid chain ID","domain.chainId",t),Number.isSafeInteger(e)?Number(e):Hs(e)},verifyingContract:function(t){try{return Qe(t).toLowerCase()}catch{}P(!1,'invalid domain value "verifyingContract"',"domain.verifyingContract",t)},salt:function(t){const e=Oe(t,"domain.salt");return P(e.length===32,'invalid domain value "salt"',"domain.salt",t),oe(e)}};function Il(t){{const e=t.match(/^(u?)int(\d+)$/);if(e){const s=e[1]==="",n=parseInt(e[2]);P(n%8===0&&n!==0&&n<=256&&e[2]===String(n),"invalid numeric width","type",t);const r=gr(V1,s?n-1:n),i=s?(r+Pm)*F1:Tm;return function(o){const l=he(o,"value");return P(l>=i&&l<=r,`value out-of-bounds for ${t}`,"value",l),Jn(s?fp(l,256):l,32)}}}{const e=t.match(/^bytes(\d+)$/);if(e){const s=parseInt(e[1]);return P(s!==0&&s<=32&&e[1]===String(s),"invalid bytes width","type",t),function(n){const r=Oe(n);return P(r.length===s,`invalid length for ${t}`,"value",n),$1(n)}}}switch(t){case"address":return function(e){return Sn(Qe(e),32)};case"bool":return function(e){return e?j1:H1};case"bytes":return function(e){return wt(e)};case"string":return function(e){return Tr(e)}}return null}function Jd(t,e){return`${t}(${e.map(({name:s,type:n})=>n+" "+s).join(",")})`}function Fo(t){const e=t.match(/^([^\x5b]*)((\x5b\d*\x5d)*)(\x5b(\d*)\x5d)$/);return e?{base:e[1],index:e[2]+e[4],array:{base:e[1],prefix:e[1]+e[2],count:e[5]?parseInt(e[5]):-1}}:{base:t}}class _s{primaryType;#e;get types(){return JSON.parse(this.#e)}#t;#s;constructor(e){this.#t=new Map,this.#s=new Map;const s=new Map,n=new Map,r=new Map,i={};Object.keys(e).forEach(c=>{i[c]=e[c].map(({name:u,type:d})=>{let{base:f,index:h}=Fo(d);return f==="int"&&!e.int&&(f="int256"),f==="uint"&&!e.uint&&(f="uint256"),{name:u,type:f+(h||"")}}),s.set(c,new Set),n.set(c,[]),r.set(c,new Set)}),this.#e=JSON.stringify(i);for(const c in i){const u=new Set;for(const d of i[c]){P(!u.has(d.name),`duplicate variable name ${JSON.stringify(d.name)} in ${JSON.stringify(c)}`,"types",e),u.add(d.name);const f=Fo(d.type).base;P(f!==c,`circular type reference to ${JSON.stringify(f)}`,"types",e),!Il(f)&&(P(n.has(f),`unknown type ${JSON.stringify(f)}`,"types",e),n.get(f).push(c),s.get(c).add(f))}}const o=Array.from(n.keys()).filter(c=>n.get(c).length===0);P(o.length!==0,"missing primary type","types",e),P(o.length===1,`ambiguous primary types or unused types: ${o.map(c=>JSON.stringify(c)).join(", ")}`,"types",e),_e(this,{primaryType:o[0]});function l(c,u){P(!u.has(c),`circular type reference to ${JSON.stringify(c)}`,"types",e),u.add(c);for(const d of s.get(c))if(n.has(d)){l(d,u);for(const f of u)r.get(f).add(d)}u.delete(c)}l(this.primaryType,new Set);for(const[c,u]of r){const d=Array.from(u);d.sort(),this.#t.set(c,Jd(c,i[c])+d.map(f=>Jd(f,i[f])).join(""))}}getEncoder(e){let s=this.#s.get(e);return s||(s=this.#n(e),this.#s.set(e,s)),s}#n(e){{const r=Il(e);if(r)return r}const s=Fo(e).array;if(s){const r=s.prefix,i=this.getEncoder(r);return o=>{P(s.count===-1||s.count===o.length,`array length mismatch; expected length ${s.count}`,"value",o);let l=o.map(i);return this.#t.has(r)&&(l=l.map(wt)),wt(At(l))}}const n=this.types[e];if(n){const r=Tr(this.#t.get(e));return i=>{const o=n.map(({name:l,type:c})=>{const u=this.getEncoder(c)(i[l]);return this.#t.has(c)?wt(u):u});return o.unshift(r),At(o)}}P(!1,`unknown type: ${e}`,"type",e)}encodeType(e){const s=this.#t.get(e);return P(s,`unknown type: ${JSON.stringify(e)}`,"name",e),s}encodeData(e,s){return this.getEncoder(e)(s)}hashStruct(e,s){return wt(this.encodeData(e,s))}encode(e){return this.encodeData(this.primaryType,e)}hash(e){return this.hashStruct(this.primaryType,e)}_visit(e,s,n){if(Il(e))return n(e,s);const r=Fo(e).array;if(r)return P(r.count===-1||r.count===s.length,`array length mismatch; expected length ${r.count}`,"value",s),s.map(o=>this._visit(r.prefix,o,n));const i=this.types[e];if(i)return i.reduce((o,{name:l,type:c})=>(o[l]=this._visit(c,s[l],n),o),{});P(!1,`unknown type: ${e}`,"type",e)}visit(e,s){return this._visit(this.primaryType,e,s)}static from(e){return new _s(e)}static getPrimaryType(e){return _s.from(e).primaryType}static hashStruct(e,s,n){return _s.from(s).hashStruct(e,n)}static hashDomain(e){const s=[];for(const n in e){if(e[n]==null)continue;const r=zd[n];P(r,`invalid typed-data domain key: ${JSON.stringify(n)}`,"domain",e),s.push({name:n,type:r})}return s.sort((n,r)=>Cl.indexOf(n.name)-Cl.indexOf(r.name)),_s.hashStruct("EIP712Domain",{EIP712Domain:s},e)}static encode(e,s,n){return At(["0x1901",_s.hashDomain(e),_s.from(s).hash(n)])}static hash(e,s,n){return wt(_s.encode(e,s,n))}static async resolveNames(e,s,n,r){e=Object.assign({},e);for(const l in e)e[l]==null&&delete e[l];const i={};e.verifyingContract&&!ct(e.verifyingContract,20)&&(i[e.verifyingContract]="0x");const o=_s.from(s);o.visit(n,(l,c)=>(l==="address"&&!ct(c,20)&&(i[c]="0x"),c));for(const l in i)i[l]=await r(l);return e.verifyingContract&&i[e.verifyingContract]&&(e.verifyingContract=i[e.verifyingContract]),n=o.visit(n,(l,c)=>l==="address"&&i[c]?i[c]:c),{domain:e,value:n}}static getPayload(e,s,n){_s.hashDomain(e);const r={},i=[];Cl.forEach(c=>{const u=e[c];u!=null&&(r[c]=W1[c](u),i.push({name:c,type:zd[c]}))});const o=_s.from(s);s=o.types;const l=Object.assign({},s);return P(l.EIP712Domain==null,"types must not contain EIP712Domain type","types.EIP712Domain",s),l.EIP712Domain=i,o.encode(n),{types:l,domain:r,primaryType:o.primaryType,message:o.visit(n,(c,u)=>{if(c.match(/^bytes(\d*)/))return oe(Oe(u));if(c.match(/^u?int/))return he(u).toString();switch(c){case"address":return u.toLowerCase();case"bool":return!!u;case"string":return P(typeof u=="string","invalid string","value",u),u}P(!1,"unsupported type","type",c)})}}}function fs(t){const e=new Set;return t.forEach(s=>e.add(s)),Object.freeze(e)}const Y1="external public payable override",G1=fs(Y1.split(" ")),km="constant external internal payable private public pure view override",K1=fs(km.split(" ")),Sm="constructor error event fallback function receive struct",Cm=fs(Sm.split(" ")),Im="calldata memory storage payable indexed",z1=fs(Im.split(" ")),Q1="tuple returns",J1=[Sm,Im,Q1,km].join(" "),q1=fs(J1.split(" ")),Z1={"(":"OPEN_PAREN",")":"CLOSE_PAREN","[":"OPEN_BRACKET","]":"CLOSE_BRACKET",",":"COMMA","@":"AT"},X1=new RegExp("^(\\s*)"),eA=new RegExp("^([0-9]+)"),tA=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)"),Rm=new RegExp("^([a-zA-Z$_][a-zA-Z0-9$_]*)$"),Dm=new RegExp("^(address|bool|bytes([0-9]*)|string|u?int([0-9]*))$");class Bs{#e;#t;get offset(){return this.#e}get length(){return this.#t.length-this.#e}constructor(e){this.#e=0,this.#t=e.slice()}clone(){return new Bs(this.#t)}reset(){this.#e=0}#s(e=0,s=0){return new Bs(this.#t.slice(e,s).map(n=>Object.freeze(Object.assign({},n,{match:n.match-e,linkBack:n.linkBack-e,linkNext:n.linkNext-e}))))}popKeyword(e){const s=this.peek();if(s.type!=="KEYWORD"||!e.has(s.text))throw new Error(`expected keyword ${s.text}`);return this.pop().text}popType(e){if(this.peek().type!==e){const s=this.peek();throw new Error(`expected ${e}; got ${s.type} ${JSON.stringify(s.text)}`)}return this.pop().text}popParen(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const s=this.#s(this.#e+1,e.match+1);return this.#e=e.match+1,s}popParams(){const e=this.peek();if(e.type!=="OPEN_PAREN")throw new Error("bad start");const s=[];for(;this.#e<e.match-1;){const n=this.peek().linkNext;s.push(this.#s(this.#e+1,n)),this.#e=n}return this.#e=e.match+1,s}peek(){if(this.#e>=this.#t.length)throw new Error("out-of-bounds");return this.#t[this.#e]}peekKeyword(e){const s=this.peekType("KEYWORD");return s!=null&&e.has(s)?s:null}peekType(e){if(this.length===0)return null;const s=this.peek();return s.type===e?s.text:null}pop(){const e=this.peek();return this.#e++,e}toString(){const e=[];for(let s=this.#e;s<this.#t.length;s++){const n=this.#t[s];e.push(`${n.type}:${n.text}`)}return`<TokenString ${e.join(" ")}>`}}function Xn(t){const e=[],s=o=>{const l=i<t.length?JSON.stringify(t[i]):"$EOI";throw new Error(`invalid token ${l} at ${i}: ${o}`)};let n=[],r=[],i=0;for(;i<t.length;){let o=t.substring(i),l=o.match(X1);l&&(i+=l[1].length,o=t.substring(i));const c={depth:n.length,linkBack:-1,linkNext:-1,match:-1,type:"",text:"",offset:i,value:-1};e.push(c);let u=Z1[o[0]]||"";if(u){if(c.type=u,c.text=o[0],i++,u==="OPEN_PAREN")n.push(e.length-1),r.push(e.length-1);else if(u=="CLOSE_PAREN")n.length===0&&s("no matching open bracket"),c.match=n.pop(),e[c.match].match=e.length-1,c.depth--,c.linkBack=r.pop(),e[c.linkBack].linkNext=e.length-1;else if(u==="COMMA")c.linkBack=r.pop(),e[c.linkBack].linkNext=e.length-1,r.push(e.length-1);else if(u==="OPEN_BRACKET")c.type="BRACKET";else if(u==="CLOSE_BRACKET"){let d=e.pop().text;if(e.length>0&&e[e.length-1].type==="NUMBER"){const f=e.pop().text;d=f+d,e[e.length-1].value=Ne(f)}if(e.length===0||e[e.length-1].type!=="BRACKET")throw new Error("missing opening bracket");e[e.length-1].text+=d}continue}if(l=o.match(tA),l){if(c.text=l[1],i+=c.text.length,q1.has(c.text)){c.type="KEYWORD";continue}if(c.text.match(Dm)){c.type="TYPE";continue}c.type="ID";continue}if(l=o.match(eA),l){c.text=l[1],c.type="NUMBER",i+=c.text.length;continue}throw new Error(`unexpected token ${JSON.stringify(o[0])} at position ${i}`)}return new Bs(e.map(o=>Object.freeze(o)))}function qd(t,e){let s=[];for(const n in e.keys())t.has(n)&&s.push(n);if(s.length>1)throw new Error(`conflicting types: ${s.join(", ")}`)}function Ka(t,e){if(e.peekKeyword(Cm)){const s=e.pop().text;if(s!==t)throw new Error(`expected ${t}, got ${s}`)}return e.popType("ID")}function In(t,e){const s=new Set;for(;;){const n=t.peekType("KEYWORD");if(n==null||e&&!e.has(n))break;if(t.pop(),s.has(n))throw new Error(`duplicate keywords: ${JSON.stringify(n)}`);s.add(n)}return Object.freeze(s)}function xm(t){let e=In(t,K1);return qd(e,fs("constant payable nonpayable".split(" "))),qd(e,fs("pure view payable nonpayable".split(" "))),e.has("view")?"view":e.has("pure")?"pure":e.has("payable")?"payable":e.has("nonpayable")?"nonpayable":e.has("constant")?"view":"nonpayable"}function Tn(t,e){return t.popParams().map(s=>lt.from(s,e))}function Nm(t){if(t.peekType("AT")){if(t.pop(),t.peekType("NUMBER"))return he(t.pop().text);throw new Error("invalid gas")}return null}function Pr(t){if(t.length)throw new Error(`unexpected tokens at offset ${t.offset}: ${t.toString()}`)}const sA=new RegExp(/^(.*)\[([0-9]*)\]$/);function Zd(t){const e=t.match(Dm);if(P(e,"invalid type","type",t),t==="uint")return"uint256";if(t==="int")return"int256";if(e[2]){const s=parseInt(e[2]);P(s!==0&&s<=32,"invalid bytes length","type",t)}else if(e[3]){const s=parseInt(e[3]);P(s!==0&&s<=256&&s%8===0,"invalid numeric width","type",t)}return t}const gt={},ws=Symbol.for("_ethers_internal"),Xd="_ParamTypeInternal",ef="_ErrorInternal",tf="_EventInternal",sf="_ConstructorInternal",nf="_FallbackInternal",rf="_FunctionInternal",of="_StructInternal";class lt{name;type;baseType;indexed;components;arrayLength;arrayChildren;constructor(e,s,n,r,i,o,l,c){if(vo(e,gt,"ParamType"),Object.defineProperty(this,ws,{value:Xd}),o&&(o=Object.freeze(o.slice())),r==="array"){if(l==null||c==null)throw new Error("")}else if(l!=null||c!=null)throw new Error("");if(r==="tuple"){if(o==null)throw new Error("")}else if(o!=null)throw new Error("");_e(this,{name:s,type:n,baseType:r,indexed:i,components:o,arrayLength:l,arrayChildren:c})}format(e){if(e==null&&(e="sighash"),e==="json"){const n=this.name||"";if(this.isArray()){const i=JSON.parse(this.arrayChildren.format("json"));return i.name=n,i.type+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`,JSON.stringify(i)}const r={type:this.baseType==="tuple"?"tuple":this.type,name:n};return typeof this.indexed=="boolean"&&(r.indexed=this.indexed),this.isTuple()&&(r.components=this.components.map(i=>JSON.parse(i.format(e)))),JSON.stringify(r)}let s="";return this.isArray()?(s+=this.arrayChildren.format(e),s+=`[${this.arrayLength<0?"":String(this.arrayLength)}]`):this.isTuple()?s+="("+this.components.map(n=>n.format(e)).join(e==="full"?", ":",")+")":s+=this.type,e!=="sighash"&&(this.indexed===!0&&(s+=" indexed"),e==="full"&&this.name&&(s+=" "+this.name)),s}isArray(){return this.baseType==="array"}isTuple(){return this.baseType==="tuple"}isIndexable(){return this.indexed!=null}walk(e,s){if(this.isArray()){if(!Array.isArray(e))throw new Error("invalid array value");if(this.arrayLength!==-1&&e.length!==this.arrayLength)throw new Error("array is wrong length");const n=this;return e.map(r=>n.arrayChildren.walk(r,s))}if(this.isTuple()){if(!Array.isArray(e))throw new Error("invalid tuple value");if(e.length!==this.components.length)throw new Error("array is wrong length");const n=this;return e.map((r,i)=>n.components[i].walk(r,s))}return s(this.type,e)}#e(e,s,n,r){if(this.isArray()){if(!Array.isArray(s))throw new Error("invalid array value");if(this.arrayLength!==-1&&s.length!==this.arrayLength)throw new Error("array is wrong length");const o=this.arrayChildren,l=s.slice();l.forEach((c,u)=>{o.#e(e,c,n,d=>{l[u]=d})}),r(l);return}if(this.isTuple()){const o=this.components;let l;if(Array.isArray(s))l=s.slice();else{if(s==null||typeof s!="object")throw new Error("invalid tuple value");l=o.map(c=>{if(!c.name)throw new Error("cannot use object value with unnamed components");if(!(c.name in s))throw new Error(`missing value for component ${c.name}`);return s[c.name]})}if(l.length!==this.components.length)throw new Error("array is wrong length");l.forEach((c,u)=>{o[u].#e(e,c,n,d=>{l[u]=d})}),r(l);return}const i=n(this.type,s);i.then?e.push((async function(){r(await i)})()):r(i)}async walkAsync(e,s){const n=[],r=[e];return this.#e(n,e,s,i=>{r[0]=i}),n.length&&await Promise.all(n),r[0]}static from(e,s){if(lt.isParamType(e))return e;if(typeof e=="string")try{return lt.from(Xn(e),s)}catch{P(!1,"invalid param type","obj",e)}else if(e instanceof Bs){let l="",c="",u=null;In(e,fs(["tuple"])).has("tuple")||e.peekType("OPEN_PAREN")?(c="tuple",u=e.popParams().map(w=>lt.from(w)),l=`tuple(${u.map(w=>w.format()).join(",")})`):(l=Zd(e.popType("TYPE")),c=l);let d=null,f=null;for(;e.length&&e.peekType("BRACKET");){const w=e.pop();d=new lt(gt,"",l,c,null,u,f,d),f=w.value,l+=w.text,c="array",u=null}let h=null;if(In(e,z1).has("indexed")){if(!s)throw new Error("");h=!0}const T=e.peekType("ID")?e.pop().text:"";if(e.length)throw new Error("leftover tokens");return new lt(gt,T,l,c,h,u,f,d)}const n=e.name;P(!n||typeof n=="string"&&n.match(Rm),"invalid name","obj.name",n);let r=e.indexed;r!=null&&(P(s,"parameter cannot be indexed","obj.indexed",e.indexed),r=!!r);let i=e.type,o=i.match(sA);if(o){const l=parseInt(o[2]||"-1"),c=lt.from({type:o[1],components:e.components});return new lt(gt,n||"",i,"array",r,null,l,c)}if(i==="tuple"||i.startsWith("tuple(")||i.startsWith("(")){const l=e.components!=null?e.components.map(u=>lt.from(u)):null;return new lt(gt,n||"",i,"tuple",r,l,null,null)}return i=Zd(e.type),new lt(gt,n||"",i,i,r,null,null,null)}static isParamType(e){return e&&e[ws]===Xd}}class kr{type;inputs;constructor(e,s,n){vo(e,gt,"Fragment"),n=Object.freeze(n.slice()),_e(this,{type:s,inputs:n})}static from(e){if(typeof e=="string"){try{kr.from(JSON.parse(e))}catch{}return kr.from(Xn(e))}if(e instanceof Bs)switch(e.peekKeyword(Cm)){case"constructor":return An.from(e);case"error":return vs.from(e);case"event":return tn.from(e);case"fallback":case"receive":return mn.from(e);case"function":return sn.from(e);case"struct":return _r.from(e)}else if(typeof e=="object"){switch(e.type){case"constructor":return An.from(e);case"error":return vs.from(e);case"event":return tn.from(e);case"fallback":case"receive":return mn.from(e);case"function":return sn.from(e);case"struct":return _r.from(e)}j(!1,`unsupported type: ${e.type}`,"UNSUPPORTED_OPERATION",{operation:"Fragment.from"})}P(!1,"unsupported frgament object","obj",e)}static isConstructor(e){return An.isFragment(e)}static isError(e){return vs.isFragment(e)}static isEvent(e){return tn.isFragment(e)}static isFunction(e){return sn.isFragment(e)}static isStruct(e){return _r.isFragment(e)}}class za extends kr{name;constructor(e,s,n,r){super(e,s,r),P(typeof n=="string"&&n.match(Rm),"invalid identifier","name",n),r=Object.freeze(r.slice()),_e(this,{name:n})}}function lo(t,e){return"("+e.map(s=>s.format(t)).join(t==="full"?", ":",")+")"}class vs extends za{constructor(e,s,n){super(e,"error",s,n),Object.defineProperty(this,ws,{value:ef})}get selector(){return Tr(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const s=[];return e!=="sighash"&&s.push("error"),s.push(this.name+lo(e,this.inputs)),s.join(" ")}static from(e){if(vs.isFragment(e))return e;if(typeof e=="string")return vs.from(Xn(e));if(e instanceof Bs){const s=Ka("error",e),n=Tn(e);return Pr(e),new vs(gt,s,n)}return new vs(gt,e.name,e.inputs?e.inputs.map(lt.from):[])}static isFragment(e){return e&&e[ws]===ef}}class tn extends za{anonymous;constructor(e,s,n,r){super(e,"event",s,n),Object.defineProperty(this,ws,{value:tf}),_e(this,{anonymous:r})}get topicHash(){return Tr(this.format("sighash"))}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const s=[];return e!=="sighash"&&s.push("event"),s.push(this.name+lo(e,this.inputs)),e!=="sighash"&&this.anonymous&&s.push("anonymous"),s.join(" ")}static getTopicHash(e,s){return s=(s||[]).map(r=>lt.from(r)),new tn(gt,e,s,!1).topicHash}static from(e){if(tn.isFragment(e))return e;if(typeof e=="string")try{return tn.from(Xn(e))}catch{P(!1,"invalid event fragment","obj",e)}else if(e instanceof Bs){const s=Ka("event",e),n=Tn(e,!0),r=!!In(e,fs(["anonymous"])).has("anonymous");return Pr(e),new tn(gt,s,n,r)}return new tn(gt,e.name,e.inputs?e.inputs.map(s=>lt.from(s,!0)):[],!!e.anonymous)}static isFragment(e){return e&&e[ws]===tf}}class An extends kr{payable;gas;constructor(e,s,n,r,i){super(e,s,n),Object.defineProperty(this,ws,{value:sf}),_e(this,{payable:r,gas:i})}format(e){if(j(e!=null&&e!=="sighash","cannot format a constructor for sighash","UNSUPPORTED_OPERATION",{operation:"format(sighash)"}),e==="json")return JSON.stringify({type:"constructor",stateMutability:this.payable?"payable":"undefined",payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});const s=[`constructor${lo(e,this.inputs)}`];return this.payable&&s.push("payable"),this.gas!=null&&s.push(`@${this.gas.toString()}`),s.join(" ")}static from(e){if(An.isFragment(e))return e;if(typeof e=="string")try{return An.from(Xn(e))}catch{P(!1,"invalid constuctor fragment","obj",e)}else if(e instanceof Bs){In(e,fs(["constructor"]));const s=Tn(e),n=!!In(e,G1).has("payable"),r=Nm(e);return Pr(e),new An(gt,"constructor",s,n,r)}return new An(gt,"constructor",e.inputs?e.inputs.map(lt.from):[],!!e.payable,e.gas!=null?e.gas:null)}static isFragment(e){return e&&e[ws]===sf}}class mn extends kr{payable;constructor(e,s,n){super(e,"fallback",s),Object.defineProperty(this,ws,{value:nf}),_e(this,{payable:n})}format(e){const s=this.inputs.length===0?"receive":"fallback";if(e==="json"){const n=this.payable?"payable":"nonpayable";return JSON.stringify({type:s,stateMutability:n})}return`${s}()${this.payable?" payable":""}`}static from(e){if(mn.isFragment(e))return e;if(typeof e=="string")try{return mn.from(Xn(e))}catch{P(!1,"invalid fallback fragment","obj",e)}else if(e instanceof Bs){const s=e.toString(),n=e.peekKeyword(fs(["fallback","receive"]));if(P(n,"type must be fallback or receive","obj",s),e.popKeyword(fs(["fallback","receive"]))==="receive"){const l=Tn(e);return P(l.length===0,"receive cannot have arguments","obj.inputs",l),In(e,fs(["payable"])),Pr(e),new mn(gt,[],!0)}let i=Tn(e);i.length?P(i.length===1&&i[0].type==="bytes","invalid fallback inputs","obj.inputs",i.map(l=>l.format("minimal")).join(", ")):i=[lt.from("bytes")];const o=xm(e);if(P(o==="nonpayable"||o==="payable","fallback cannot be constants","obj.stateMutability",o),In(e,fs(["returns"])).has("returns")){const l=Tn(e);P(l.length===1&&l[0].type==="bytes","invalid fallback outputs","obj.outputs",l.map(c=>c.format("minimal")).join(", "))}return Pr(e),new mn(gt,i,o==="payable")}if(e.type==="receive")return new mn(gt,[],!0);if(e.type==="fallback"){const s=[lt.from("bytes")],n=e.stateMutability==="payable";return new mn(gt,s,n)}P(!1,"invalid fallback description","obj",e)}static isFragment(e){return e&&e[ws]===nf}}class sn extends za{constant;outputs;stateMutability;payable;gas;constructor(e,s,n,r,i,o){super(e,"function",s,r),Object.defineProperty(this,ws,{value:rf}),i=Object.freeze(i.slice()),_e(this,{constant:n==="view"||n==="pure",gas:o,outputs:i,payable:n==="payable",stateMutability:n})}get selector(){return Tr(this.format("sighash")).substring(0,10)}format(e){if(e==null&&(e="sighash"),e==="json")return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas!=null?this.gas:void 0,inputs:this.inputs.map(n=>JSON.parse(n.format(e))),outputs:this.outputs.map(n=>JSON.parse(n.format(e)))});const s=[];return e!=="sighash"&&s.push("function"),s.push(this.name+lo(e,this.inputs)),e!=="sighash"&&(this.stateMutability!=="nonpayable"&&s.push(this.stateMutability),this.outputs&&this.outputs.length&&(s.push("returns"),s.push(lo(e,this.outputs))),this.gas!=null&&s.push(`@${this.gas.toString()}`)),s.join(" ")}static getSelector(e,s){return s=(s||[]).map(r=>lt.from(r)),new sn(gt,e,"view",s,[],null).selector}static from(e){if(sn.isFragment(e))return e;if(typeof e=="string")try{return sn.from(Xn(e))}catch{P(!1,"invalid function fragment","obj",e)}else if(e instanceof Bs){const n=Ka("function",e),r=Tn(e),i=xm(e);let o=[];In(e,fs(["returns"])).has("returns")&&(o=Tn(e));const l=Nm(e);return Pr(e),new sn(gt,n,i,r,o,l)}let s=e.stateMutability;return s==null&&(s="payable",typeof e.constant=="boolean"?(s="view",e.constant||(s="payable",typeof e.payable=="boolean"&&!e.payable&&(s="nonpayable"))):typeof e.payable=="boolean"&&!e.payable&&(s="nonpayable")),new sn(gt,e.name,s,e.inputs?e.inputs.map(lt.from):[],e.outputs?e.outputs.map(lt.from):[],e.gas!=null?e.gas:null)}static isFragment(e){return e&&e[ws]===rf}}class _r extends za{constructor(e,s,n){super(e,"struct",s,n),Object.defineProperty(this,ws,{value:of})}format(){throw new Error("@TODO")}static from(e){if(typeof e=="string")try{return _r.from(Xn(e))}catch{P(!1,"invalid struct fragment","obj",e)}else if(e instanceof Bs){const s=Ka("struct",e),n=Tn(e);return Pr(e),new _r(gt,s,n)}return new _r(gt,e.name,e.inputs?e.inputs.map(lt.from):[])}static isFragment(e){return e&&e[ws]===of}}const zs=new Map;zs.set(0,"GENERIC_PANIC");zs.set(1,"ASSERT_FALSE");zs.set(17,"OVERFLOW");zs.set(18,"DIVIDE_BY_ZERO");zs.set(33,"ENUM_RANGE_ERROR");zs.set(34,"BAD_STORAGE_DATA");zs.set(49,"STACK_UNDERFLOW");zs.set(50,"ARRAY_RANGE_ERROR");zs.set(65,"OUT_OF_MEMORY");zs.set(81,"UNINITIALIZED_FUNCTION_CALL");const nA=new RegExp(/^bytes([0-9]*)$/),rA=new RegExp(/^(u?int)([0-9]*)$/);let Rl=null,af=1024;function iA(t,e,s,n){let r="missing revert data",i=null;const o=null;let l=null;if(s){r="execution reverted";const u=Oe(s);if(s=oe(s),u.length===0)r+=" (no data present; likely require(false) occurred",i="require(false)";else if(u.length%32!==4)r+=" (could not decode reason; invalid data length)";else if(oe(u.slice(0,4))==="0x08c379a0")try{i=n.decode(["string"],u.slice(4))[0],l={signature:"Error(string)",name:"Error",args:[i]},r+=`: ${JSON.stringify(i)}`}catch{r+=" (could not decode reason; invalid string data)"}else if(oe(u.slice(0,4))==="0x4e487b71")try{const d=Number(n.decode(["uint256"],u.slice(4))[0]);l={signature:"Panic(uint256)",name:"Panic",args:[d]},i=`Panic due to ${zs.get(d)||"UNKNOWN"}(${d})`,r+=`: ${i}`}catch{r+=" (could not decode panic code)"}else r+=" (unknown custom error)"}const c={to:e.to?Qe(e.to):null,data:e.data||"0x"};return e.from&&(c.from=Qe(e.from)),ht(r,"CALL_EXCEPTION",{action:t,data:s,reason:i,transaction:c,invocation:o,revert:l})}class Zn{#e(e){if(e.isArray())return new _w(this.#e(e.arrayChildren),e.arrayLength,e.name);if(e.isTuple())return new Mo(e.components.map(n=>this.#e(n)),e.name);switch(e.baseType){case"address":return new Aw(e.name);case"bool":return new Tw(e.name);case"string":return new Nw(e.name);case"bytes":return new Pw(e.name);case"":return new Cw(e.name)}let s=e.type.match(rA);if(s){let n=parseInt(s[2]||"256");return P(n!==0&&n<=256&&n%8===0,"invalid "+s[1]+" bit length","param",e),new xw(n/8,s[1]==="int",e.name)}if(s=e.type.match(nA),s){let n=parseInt(s[1]);return P(n!==0&&n<=32,"invalid bytes length","param",e),new kw(n,e.name)}P(!1,"invalid type","type",e.type)}getDefaultValue(e){const s=e.map(r=>this.#e(lt.from(r)));return new Mo(s,"_").defaultValue()}encode(e,s){cp(s.length,e.length,"types/values length mismatch");const n=e.map(o=>this.#e(lt.from(o))),r=new Mo(n,"_"),i=new sc;return r.encode(i,s),i.data}decode(e,s,n){const r=e.map(o=>this.#e(lt.from(o)));return new Mo(r,"_").decode(new qc(s,n,af))}static _setDefaultMaxInflation(e){P(typeof e=="number"&&Number.isInteger(e),"invalid defaultMaxInflation factor","value",e),af=e}static defaultAbiCoder(){return Rl==null&&(Rl=new Zn),Rl}static getBuiltinCallException(e,s,n){return iA(e,s,n,Zn.defaultAbiCoder())}}class oA{fragment;name;signature;topic;args;constructor(e,s,n){const r=e.name,i=e.format();_e(this,{fragment:e,name:r,signature:i,topic:s,args:n})}}class aA{fragment;name;args;signature;selector;value;constructor(e,s,n,r){const i=e.name,o=e.format();_e(this,{fragment:e,name:i,args:n,signature:o,selector:s,value:r})}}class lA{fragment;name;args;signature;selector;constructor(e,s,n){const r=e.name,i=e.format();_e(this,{fragment:e,name:r,args:n,signature:i,selector:s})}}class lf{hash;_isIndexed;static isIndexed(e){return!!(e&&e._isIndexed)}constructor(e){_e(this,{hash:e,_isIndexed:!0})}}const cf={0:"generic panic",1:"assert(false)",17:"arithmetic overflow",18:"division or modulo by zero",33:"enum overflow",34:"invalid encoded storage byte array accessed",49:"out-of-bounds array access; popping on an empty array",50:"out-of-bounds access of an array or bytesN",65:"out of memory",81:"uninitialized function"},uf={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:t=>`reverted with reason string ${JSON.stringify(t)}`},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"],reason:t=>{let e="unknown panic code";return t>=0&&t<=255&&cf[t.toString()]&&(e=cf[t.toString()]),`reverted with panic code 0x${t.toString(16)} (${e})`}}};class pr{fragments;deploy;fallback;receive;#e;#t;#s;#n;constructor(e){let s=[];typeof e=="string"?s=JSON.parse(e):s=e,this.#s=new Map,this.#e=new Map,this.#t=new Map;const n=[];for(const o of s)try{n.push(kr.from(o))}catch(l){console.log(`[Warning] Invalid Fragment ${JSON.stringify(o)}:`,l.message)}_e(this,{fragments:Object.freeze(n)});let r=null,i=!1;this.#n=this.getAbiCoder(),this.fragments.forEach((o,l)=>{let c;switch(o.type){case"constructor":if(this.deploy){console.log("duplicate definition - constructor");return}_e(this,{deploy:o});return;case"fallback":o.inputs.length===0?i=!0:(P(!r||o.payable!==r.payable,"conflicting fallback fragments",`fragments[${l}]`,o),r=o,i=r.payable);return;case"function":c=this.#s;break;case"event":c=this.#t;break;case"error":c=this.#e;break;default:return}const u=o.format();c.has(u)||c.set(u,o)}),this.deploy||_e(this,{deploy:An.from("constructor()")}),_e(this,{fallback:r,receive:i})}format(e){const s=e?"minimal":"full";return this.fragments.map(r=>r.format(s))}formatJson(){const e=this.fragments.map(s=>s.format("json"));return JSON.stringify(e.map(s=>JSON.parse(s)))}getAbiCoder(){return Zn.defaultAbiCoder()}#r(e,s,n){if(ct(e)){const i=e.toLowerCase();for(const o of this.#s.values())if(i===o.selector)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,l]of this.#s)o.split("(")[0]===e&&i.push(l);if(s){const o=s.length>0?s[s.length-1]:null;let l=s.length,c=!0;bt.isTyped(o)&&o.type==="overrides"&&(c=!1,l--);for(let u=i.length-1;u>=0;u--){const d=i[u].inputs.length;d!==l&&(!c||d!==l-1)&&i.splice(u,1)}for(let u=i.length-1;u>=0;u--){const d=i[u].inputs;for(let f=0;f<s.length;f++)if(bt.isTyped(s[f])){if(f>=d.length){if(s[f].type==="overrides")continue;i.splice(u,1);break}if(s[f].type!==d[f].baseType){i.splice(u,1);break}}}}if(i.length===1&&s&&s.length!==i[0].inputs.length){const o=s[s.length-1];(o==null||Array.isArray(o)||typeof o!="object")&&i.splice(0,1)}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(l=>JSON.stringify(l.format())).join(", ");P(!1,`ambiguous function description (i.e. matches ${o})`,"key",e)}return i[0]}const r=this.#s.get(sn.from(e).format());return r||null}getFunctionName(e){const s=this.#r(e,null,!1);return P(s,"no matching function","key",e),s.name}hasFunction(e){return!!this.#r(e,null,!1)}getFunction(e,s){return this.#r(e,s||null,!0)}forEachFunction(e){const s=Array.from(this.#s.keys());s.sort((n,r)=>n.localeCompare(r));for(let n=0;n<s.length;n++){const r=s[n];e(this.#s.get(r),n)}}#o(e,s,n){if(ct(e)){const i=e.toLowerCase();for(const o of this.#t.values())if(i===o.topicHash)return o;return null}if(e.indexOf("(")===-1){const i=[];for(const[o,l]of this.#t)o.split("(")[0]===e&&i.push(l);if(s){for(let o=i.length-1;o>=0;o--)i[o].inputs.length<s.length&&i.splice(o,1);for(let o=i.length-1;o>=0;o--){const l=i[o].inputs;for(let c=0;c<s.length;c++)if(bt.isTyped(s[c])&&s[c].type!==l[c].baseType){i.splice(o,1);break}}}if(i.length===0)return null;if(i.length>1&&n){const o=i.map(l=>JSON.stringify(l.format())).join(", ");P(!1,`ambiguous event description (i.e. matches ${o})`,"key",e)}return i[0]}const r=this.#t.get(tn.from(e).format());return r||null}getEventName(e){const s=this.#o(e,null,!1);return P(s,"no matching event","key",e),s.name}hasEvent(e){return!!this.#o(e,null,!1)}getEvent(e,s){return this.#o(e,s||null,!0)}forEachEvent(e){const s=Array.from(this.#t.keys());s.sort((n,r)=>n.localeCompare(r));for(let n=0;n<s.length;n++){const r=s[n];e(this.#t.get(r),n)}}getError(e,s){if(ct(e)){const r=e.toLowerCase();if(uf[r])return vs.from(uf[r].signature);for(const i of this.#e.values())if(r===i.selector)return i;return null}if(e.indexOf("(")===-1){const r=[];for(const[i,o]of this.#e)i.split("(")[0]===e&&r.push(o);if(r.length===0)return e==="Error"?vs.from("error Error(string)"):e==="Panic"?vs.from("error Panic(uint256)"):null;if(r.length>1){const i=r.map(o=>JSON.stringify(o.format())).join(", ");P(!1,`ambiguous error description (i.e. ${i})`,"name",e)}return r[0]}if(e=vs.from(e).format(),e==="Error(string)")return vs.from("error Error(string)");if(e==="Panic(uint256)")return vs.from("error Panic(uint256)");const n=this.#e.get(e);return n||null}forEachError(e){const s=Array.from(this.#e.keys());s.sort((n,r)=>n.localeCompare(r));for(let n=0;n<s.length;n++){const r=s[n];e(this.#e.get(r),n)}}_decodeParams(e,s){return this.#n.decode(e,s)}_encodeParams(e,s){return this.#n.encode(e,s)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,s){if(typeof e=="string"){const n=this.getError(e);P(n,"unknown error","fragment",e),e=n}return P(yt(s,0,4)===e.selector,`data signature does not match error ${e.name}.`,"data",s),this._decodeParams(e.inputs,yt(s,4))}encodeErrorResult(e,s){if(typeof e=="string"){const n=this.getError(e);P(n,"unknown error","fragment",e),e=n}return At([e.selector,this._encodeParams(e.inputs,s||[])])}decodeFunctionData(e,s){if(typeof e=="string"){const n=this.getFunction(e);P(n,"unknown function","fragment",e),e=n}return P(yt(s,0,4)===e.selector,`data signature does not match function ${e.name}.`,"data",s),this._decodeParams(e.inputs,yt(s,4))}encodeFunctionData(e,s){if(typeof e=="string"){const n=this.getFunction(e);P(n,"unknown function","fragment",e),e=n}return At([e.selector,this._encodeParams(e.inputs,s||[])])}decodeFunctionResult(e,s){if(typeof e=="string"){const i=this.getFunction(e);P(i,"unknown function","fragment",e),e=i}let n="invalid length for result data";const r=ls(s);if(r.length%32===0)try{return this.#n.decode(e.outputs,r)}catch{n="could not decode result data"}j(!1,n,"BAD_DATA",{value:oe(r),info:{method:e.name,signature:e.format()}})}makeError(e,s){const n=Oe(e,"data"),r=Zn.getBuiltinCallException("call",s,n);if(r.message.startsWith("execution reverted (unknown custom error)")){const l=oe(n.slice(0,4)),c=this.getError(l);if(c)try{const u=this.#n.decode(c.inputs,n.slice(4));r.revert={name:c.name,signature:c.format(),args:u},r.reason=r.revert.signature,r.message=`execution reverted: ${r.reason}`}catch{r.message="execution reverted (coult not decode custom error)"}}const o=this.parseTransaction(s);return o&&(r.invocation={method:o.name,signature:o.signature,args:o.args}),r}encodeFunctionResult(e,s){if(typeof e=="string"){const n=this.getFunction(e);P(n,"unknown function","fragment",e),e=n}return oe(this.#n.encode(e.outputs,s||[]))}encodeFilterTopics(e,s){if(typeof e=="string"){const i=this.getEvent(e);P(i,"unknown event","eventFragment",e),e=i}j(s.length<=e.inputs.length,`too many arguments for ${e.format()}`,"UNEXPECTED_ARGUMENT",{count:s.length,expectedCount:e.inputs.length});const n=[];e.anonymous||n.push(e.topicHash);const r=(i,o)=>i.type==="string"?Tr(o):i.type==="bytes"?wt(oe(o)):(i.type==="bool"&&typeof o=="boolean"?o=o?"0x01":"0x00":i.type.match(/^u?int/)?o=Jn(o):i.type.match(/^bytes/)?o=Tv(o,32):i.type==="address"&&this.#n.encode(["address"],[o]),Sn(oe(o),32));for(s.forEach((i,o)=>{const l=e.inputs[o];if(!l.indexed){P(i==null,"cannot filter non-indexed parameters; must be null","contract."+l.name,i);return}i==null?n.push(null):l.baseType==="array"||l.baseType==="tuple"?P(!1,"filtering with tuples or arrays not supported","contract."+l.name,i):Array.isArray(i)?n.push(i.map(c=>r(l,c))):n.push(r(l,i))});n.length&&n[n.length-1]===null;)n.pop();return n}encodeEventLog(e,s){if(typeof e=="string"){const o=this.getEvent(e);P(o,"unknown event","eventFragment",e),e=o}const n=[],r=[],i=[];return e.anonymous||n.push(e.topicHash),P(s.length===e.inputs.length,"event arguments/values mismatch","values",s),e.inputs.forEach((o,l)=>{const c=s[l];if(o.indexed)if(o.type==="string")n.push(Tr(c));else if(o.type==="bytes")n.push(wt(c));else{if(o.baseType==="tuple"||o.baseType==="array")throw new Error("not implemented");n.push(this.#n.encode([o.type],[c]))}else r.push(o),i.push(c)}),{data:this.#n.encode(r,i),topics:n}}decodeEventLog(e,s,n){if(typeof e=="string"){const y=this.getEvent(e);P(y,"unknown event","eventFragment",e),e=y}if(n!=null&&!e.anonymous){const y=e.topicHash;P(ct(n[0],32)&&n[0].toLowerCase()===y,"fragment/topic mismatch","topics[0]",n[0]),n=n.slice(1)}const r=[],i=[],o=[];e.inputs.forEach((y,T)=>{y.indexed?y.type==="string"||y.type==="bytes"||y.baseType==="tuple"||y.baseType==="array"?(r.push(lt.from({type:"bytes32",name:y.name})),o.push(!0)):(r.push(y),o.push(!1)):(i.push(y),o.push(!1))});const l=n!=null?this.#n.decode(r,At(n)):null,c=this.#n.decode(i,s,!0),u=[],d=[];let f=0,h=0;return e.inputs.forEach((y,T)=>{let w=null;if(y.indexed)if(l==null)w=new lf(null);else if(o[T])w=new lf(l[h++]);else try{w=l[h++]}catch(k){w=k}else try{w=c[f++]}catch(k){w=k}u.push(w),d.push(y.name||null)}),wn.fromItems(u,d)}parseTransaction(e){const s=Oe(e.data,"tx.data"),n=he(e.value!=null?e.value:0,"tx.value"),r=this.getFunction(oe(s.slice(0,4)));if(!r)return null;const i=this.#n.decode(r.inputs,s.slice(4));return new aA(r,r.selector,i,n)}parseCallResult(e){throw new Error("@TODO")}parseLog(e){const s=this.getEvent(e.topics[0]);return!s||s.anonymous?null:new oA(s,s.topicHash,this.decodeEventLog(s,e.data,e.topics))}parseError(e){const s=oe(e),n=this.getError(yt(s,0,4));if(!n)return null;const r=this.#n.decode(n.inputs,yt(s,4));return new lA(n,n.selector,r)}static from(e){return e instanceof pr?e:typeof e=="string"?new pr(JSON.parse(e)):typeof e.formatJson=="function"?new pr(e.formatJson()):typeof e.format=="function"?new pr(e.format("json")):new pr(e)}}const Lm=BigInt(0);function Xr(t){return t??null}function Tt(t){return t==null?null:t.toString()}class df{gasPrice;maxFeePerGas;maxPriorityFeePerGas;constructor(e,s,n){_e(this,{gasPrice:Xr(e),maxFeePerGas:Xr(s),maxPriorityFeePerGas:Xr(n)})}toJSON(){const{gasPrice:e,maxFeePerGas:s,maxPriorityFeePerGas:n}=this;return{_type:"FeeData",gasPrice:Tt(e),maxFeePerGas:Tt(s),maxPriorityFeePerGas:Tt(n)}}}function va(t){const e={};t.to&&(e.to=t.to),t.from&&(e.from=t.from),t.data&&(e.data=oe(t.data));const s="chainId,gasLimit,gasPrice,maxFeePerBlobGas,maxFeePerGas,maxPriorityFeePerGas,value".split(/,/);for(const r of s)!(r in t)||t[r]==null||(e[r]=he(t[r],`request.${r}`));const n="type,nonce".split(/,/);for(const r of n)!(r in t)||t[r]==null||(e[r]=Ne(t[r],`request.${r}`));return t.accessList&&(e.accessList=Ir(t.accessList)),t.authorizationList&&(e.authorizationList=t.authorizationList.slice()),"blockTag"in t&&(e.blockTag=t.blockTag),"enableCcipRead"in t&&(e.enableCcipRead=!!t.enableCcipRead),"customData"in t&&(e.customData=t.customData),"blobVersionedHashes"in t&&t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.slice()),"kzg"in t&&(e.kzg=t.kzg),"blobs"in t&&t.blobs&&(e.blobs=t.blobs.map(r=>Jc(r)?oe(r):Object.assign({},r))),e}class cA{provider;number;hash;timestamp;parentHash;parentBeaconBlockRoot;nonce;difficulty;gasLimit;gasUsed;stateRoot;receiptsRoot;blobGasUsed;excessBlobGas;miner;prevRandao;extraData;baseFeePerGas;#e;constructor(e,s){this.#e=e.transactions.map(n=>typeof n!="string"?new Eo(n,s):n),_e(this,{provider:s,hash:Xr(e.hash),number:e.number,timestamp:e.timestamp,parentHash:e.parentHash,parentBeaconBlockRoot:e.parentBeaconBlockRoot,nonce:e.nonce,difficulty:e.difficulty,gasLimit:e.gasLimit,gasUsed:e.gasUsed,blobGasUsed:e.blobGasUsed,excessBlobGas:e.excessBlobGas,miner:e.miner,prevRandao:Xr(e.prevRandao),extraData:e.extraData,baseFeePerGas:Xr(e.baseFeePerGas),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot})}get transactions(){return this.#e.map(e=>typeof e=="string"?e:e.hash)}get prefetchedTransactions(){const e=this.#e.slice();return e.length===0?[]:(j(typeof e[0]=="object","transactions were not prefetched with block request","UNSUPPORTED_OPERATION",{operation:"transactionResponses()"}),e)}toJSON(){const{baseFeePerGas:e,difficulty:s,extraData:n,gasLimit:r,gasUsed:i,hash:o,miner:l,prevRandao:c,nonce:u,number:d,parentHash:f,parentBeaconBlockRoot:h,stateRoot:y,receiptsRoot:T,timestamp:w,transactions:k}=this;return{_type:"Block",baseFeePerGas:Tt(e),difficulty:Tt(s),extraData:n,gasLimit:Tt(r),gasUsed:Tt(i),blobGasUsed:Tt(this.blobGasUsed),excessBlobGas:Tt(this.excessBlobGas),hash:o,miner:l,prevRandao:c,nonce:u,number:d,parentHash:f,timestamp:w,parentBeaconBlockRoot:h,stateRoot:y,receiptsRoot:T,transactions:k}}[Symbol.iterator](){let e=0;const s=this.transactions;return{next:()=>e<this.length?{value:s[e++],done:!1}:{value:void 0,done:!0}}}get length(){return this.#e.length}get date(){return this.timestamp==null?null:new Date(this.timestamp*1e3)}async getTransaction(e){let s;if(typeof e=="number")s=this.#e[e];else{const n=e.toLowerCase();for(const r of this.#e)if(typeof r=="string"){if(r!==n)continue;s=r;break}else{if(r.hash!==n)continue;s=r;break}}if(s==null)throw new Error("no such tx");return typeof s=="string"?await this.provider.getTransaction(s):s}getPrefetchedTransaction(e){const s=this.prefetchedTransactions;if(typeof e=="number")return s[e];e=e.toLowerCase();for(const n of s)if(n.hash===e)return n;P(!1,"no matching transaction","indexOrHash",e)}isMined(){return!!this.hash}isLondon(){return!!this.baseFeePerGas}orphanedEvent(){if(!this.isMined())throw new Error("");return uA(this)}}class Ao{provider;transactionHash;blockHash;blockNumber;removed;address;data;topics;index;transactionIndex;constructor(e,s){this.provider=s;const n=Object.freeze(e.topics.slice());_e(this,{transactionHash:e.transactionHash,blockHash:e.blockHash,blockNumber:e.blockNumber,removed:e.removed,address:e.address,data:e.data,topics:n,index:e.index,transactionIndex:e.transactionIndex})}toJSON(){const{address:e,blockHash:s,blockNumber:n,data:r,index:i,removed:o,topics:l,transactionHash:c,transactionIndex:u}=this;return{_type:"log",address:e,blockHash:s,blockNumber:n,data:r,index:i,removed:o,topics:l,transactionHash:c,transactionIndex:u}}async getBlock(){const e=await this.provider.getBlock(this.blockHash);return j(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransaction(){const e=await this.provider.getTransaction(this.transactionHash);return j(!!e,"failed to find transaction","UNKNOWN_ERROR",{}),e}async getTransactionReceipt(){const e=await this.provider.getTransactionReceipt(this.transactionHash);return j(!!e,"failed to find transaction receipt","UNKNOWN_ERROR",{}),e}removedEvent(){return dA(this)}}class Om{provider;to;from;contractAddress;hash;index;blockHash;blockNumber;logsBloom;gasUsed;blobGasUsed;cumulativeGasUsed;gasPrice;blobGasPrice;type;status;root;#e;constructor(e,s){this.#e=Object.freeze(e.logs.map(r=>new Ao(r,s)));let n=Lm;e.effectiveGasPrice!=null?n=e.effectiveGasPrice:e.gasPrice!=null&&(n=e.gasPrice),_e(this,{provider:s,to:e.to,from:e.from,contractAddress:e.contractAddress,hash:e.hash,index:e.index,blockHash:e.blockHash,blockNumber:e.blockNumber,logsBloom:e.logsBloom,gasUsed:e.gasUsed,cumulativeGasUsed:e.cumulativeGasUsed,blobGasUsed:e.blobGasUsed,gasPrice:n,blobGasPrice:e.blobGasPrice,type:e.type,status:e.status,root:e.root})}get logs(){return this.#e}toJSON(){const{to:e,from:s,contractAddress:n,hash:r,index:i,blockHash:o,blockNumber:l,logsBloom:c,logs:u,status:d,root:f}=this;return{_type:"TransactionReceipt",blockHash:o,blockNumber:l,contractAddress:n,cumulativeGasUsed:Tt(this.cumulativeGasUsed),from:s,gasPrice:Tt(this.gasPrice),blobGasUsed:Tt(this.blobGasUsed),blobGasPrice:Tt(this.blobGasPrice),gasUsed:Tt(this.gasUsed),hash:r,index:i,logs:u,logsBloom:c,root:f,status:d,to:e}}get length(){return this.logs.length}[Symbol.iterator](){let e=0;return{next:()=>e<this.length?{value:this.logs[e++],done:!1}:{value:void 0,done:!0}}}get fee(){return this.gasUsed*this.gasPrice}async getBlock(){const e=await this.provider.getBlock(this.blockHash);if(e==null)throw new Error("TODO");return e}async getTransaction(){const e=await this.provider.getTransaction(this.hash);if(e==null)throw new Error("TODO");return e}async getResult(){return await this.provider.getTransactionResult(this.hash)}async confirmations(){return await this.provider.getBlockNumber()-this.blockNumber+1}removedEvent(){return Bm(this)}reorderedEvent(e){return j(!e||e.isMined(),"unmined 'other' transction cannot be orphaned","UNSUPPORTED_OPERATION",{operation:"reorderedEvent(other)"}),Um(this,e)}}class Eo{provider;blockNumber;blockHash;index;hash;type;to;from;nonce;gasLimit;gasPrice;maxPriorityFeePerGas;maxFeePerGas;maxFeePerBlobGas;data;value;chainId;signature;accessList;blobVersionedHashes;authorizationList;#e;constructor(e,s){this.provider=s,this.blockNumber=e.blockNumber!=null?e.blockNumber:null,this.blockHash=e.blockHash!=null?e.blockHash:null,this.hash=e.hash,this.index=e.index,this.type=e.type,this.from=e.from,this.to=e.to||null,this.gasLimit=e.gasLimit,this.nonce=e.nonce,this.data=e.data,this.value=e.value,this.gasPrice=e.gasPrice,this.maxPriorityFeePerGas=e.maxPriorityFeePerGas!=null?e.maxPriorityFeePerGas:null,this.maxFeePerGas=e.maxFeePerGas!=null?e.maxFeePerGas:null,this.maxFeePerBlobGas=e.maxFeePerBlobGas!=null?e.maxFeePerBlobGas:null,this.chainId=e.chainId,this.signature=e.signature,this.accessList=e.accessList!=null?e.accessList:null,this.blobVersionedHashes=e.blobVersionedHashes!=null?e.blobVersionedHashes:null,this.authorizationList=e.authorizationList!=null?e.authorizationList:null,this.#e=-1}toJSON(){const{blockNumber:e,blockHash:s,index:n,hash:r,type:i,to:o,from:l,nonce:c,data:u,signature:d,accessList:f,blobVersionedHashes:h}=this;return{_type:"TransactionResponse",accessList:f,blockNumber:e,blockHash:s,blobVersionedHashes:h,chainId:Tt(this.chainId),data:u,from:l,gasLimit:Tt(this.gasLimit),gasPrice:Tt(this.gasPrice),hash:r,maxFeePerGas:Tt(this.maxFeePerGas),maxPriorityFeePerGas:Tt(this.maxPriorityFeePerGas),maxFeePerBlobGas:Tt(this.maxFeePerBlobGas),nonce:c,signature:d,to:o,index:n,type:i,value:Tt(this.value)}}async getBlock(){let e=this.blockNumber;if(e==null){const n=await this.getTransaction();n&&(e=n.blockNumber)}if(e==null)return null;const s=this.provider.getBlock(e);if(s==null)throw new Error("TODO");return s}async getTransaction(){return this.provider.getTransaction(this.hash)}async confirmations(){if(this.blockNumber==null){const{tx:s,blockNumber:n}=await rs({tx:this.getTransaction(),blockNumber:this.provider.getBlockNumber()});return s==null||s.blockNumber==null?0:n-s.blockNumber+1}return await this.provider.getBlockNumber()-this.blockNumber+1}async wait(e,s){const n=e??1,r=s??0;let i=this.#e,o=-1,l=i===-1;const c=async()=>{if(l)return null;const{blockNumber:h,nonce:y}=await rs({blockNumber:this.provider.getBlockNumber(),nonce:this.provider.getTransactionCount(this.from)});if(y<this.nonce){i=h;return}if(l)return null;const T=await this.getTransaction();if(!(T&&T.blockNumber!=null))for(o===-1&&(o=i-3,o<this.#e&&(o=this.#e));o<=h;){if(l)return null;const w=await this.provider.getBlock(o,!0);if(w==null)return;for(const k of w)if(k===this.hash)return;for(let k=0;k<w.length;k++){const C=await w.getTransaction(k);if(C.from===this.from&&C.nonce===this.nonce){if(l)return null;const N=await this.provider.getTransactionReceipt(C.hash);if(N==null||h-N.blockNumber+1<n)return;let L="replaced";C.data===this.data&&C.to===this.to&&C.value===this.value?L="repriced":C.data==="0x"&&C.from===C.to&&C.value===Lm&&(L="cancelled"),j(!1,"transaction was replaced","TRANSACTION_REPLACED",{cancelled:L==="replaced"||L==="cancelled",reason:L,replacement:C.replaceableTransaction(i),hash:C.hash,receipt:N})}}o++}},u=h=>{if(h==null||h.status!==0)return h;j(!1,"transaction execution reverted","CALL_EXCEPTION",{action:"sendTransaction",data:null,reason:null,invocation:null,revert:null,transaction:{to:h.to,from:h.from,data:""},receipt:h})},d=await this.provider.getTransactionReceipt(this.hash);if(n===0)return u(d);if(d){if(n===1||await d.confirmations()>=n)return u(d)}else if(await c(),n===0)return null;return await new Promise((h,y)=>{const T=[],w=()=>{T.forEach(C=>C())};if(T.push(()=>{l=!0}),r>0){const C=setTimeout(()=>{w(),y(ht("wait for transaction timeout","TIMEOUT"))},r);T.push(()=>{clearTimeout(C)})}const k=async C=>{if(await C.confirmations()>=n){w();try{h(u(C))}catch(N){y(N)}}};if(T.push(()=>{this.provider.off(this.hash,k)}),this.provider.on(this.hash,k),i>=0){const C=async()=>{try{await c()}catch(N){if(Gt(N,"TRANSACTION_REPLACED")){w(),y(N);return}}l||this.provider.once("block",C)};T.push(()=>{this.provider.off("block",C)}),this.provider.once("block",C)}})}isMined(){return this.blockHash!=null}isLegacy(){return this.type===0}isBerlin(){return this.type===1}isLondon(){return this.type===2}isCancun(){return this.type===3}removedEvent(){return j(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Bm(this)}reorderedEvent(e){return j(this.isMined(),"unmined transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),j(!e||e.isMined(),"unmined 'other' transaction canot be orphaned","UNSUPPORTED_OPERATION",{operation:"removeEvent()"}),Um(this,e)}replaceableTransaction(e){P(Number.isInteger(e)&&e>=0,"invalid startBlock","startBlock",e);const s=new Eo(this,this.provider);return s.#e=e,s}}function uA(t){return{orphan:"drop-block",hash:t.hash,number:t.number}}function Um(t,e){return{orphan:"reorder-transaction",tx:t,other:e}}function Bm(t){return{orphan:"drop-transaction",tx:t}}function dA(t){return{orphan:"drop-log",log:{transactionHash:t.transactionHash,blockHash:t.blockHash,blockNumber:t.blockNumber,address:t.address,data:t.data,topics:Object.freeze(t.topics.slice()),index:t.index}}}class uu extends Ao{interface;fragment;args;constructor(e,s,n){super(e,e.provider);const r=s.decodeEventLog(n,e.data,e.topics);_e(this,{args:r,fragment:n,interface:s})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}class Mm extends Ao{error;constructor(e,s){super(e,e.provider),_e(this,{error:s})}}class fA extends Om{#e;constructor(e,s,n){super(n,s),this.#e=e}get logs(){return super.logs.map(e=>{const s=e.topics.length?this.#e.getEvent(e.topics[0]):null;if(s)try{return new uu(e,this.#e,s)}catch(n){return new Mm(e,n)}return e})}}class du extends Eo{#e;constructor(e,s,n){super(n,s),this.#e=e}async wait(e,s){const n=await super.wait(e,s);return n==null?null:new fA(this.#e,this.provider,n)}}class Fm extends hp{log;constructor(e,s,n,r){super(e,s,n),_e(this,{log:r})}async getBlock(){return await this.log.getBlock()}async getTransaction(){return await this.log.getTransaction()}async getTransactionReceipt(){return await this.log.getTransactionReceipt()}}class hA extends Fm{constructor(e,s,n,r,i){super(e,s,n,new uu(i,e.interface,r));const o=e.interface.decodeEventLog(r,this.log.data,this.log.topics);_e(this,{args:o,fragment:r})}get eventName(){return this.fragment.name}get eventSignature(){return this.fragment.format()}}const ff=BigInt(0);function Vm(t){return t&&typeof t.call=="function"}function $m(t){return t&&typeof t.estimateGas=="function"}function Qa(t){return t&&typeof t.resolveName=="function"}function jm(t){return t&&typeof t.sendTransaction=="function"}function Hm(t){if(t!=null){if(Qa(t))return t;if(t.provider)return t.provider}}class pA{#e;fragment;constructor(e,s,n){if(_e(this,{fragment:s}),s.inputs.length<n.length)throw new Error("too many arguments");const r=Sr(e.runner,"resolveName"),i=Qa(r)?r:null;this.#e=(async function(){const o=await Promise.all(s.inputs.map((l,c)=>n[c]==null?null:l.walkAsync(n[c],(d,f)=>d==="address"?Array.isArray(f)?Promise.all(f.map(h=>ds(h,i))):ds(f,i):f)));return e.interface.encodeFilterTopics(s,o)})()}getTopicFilter(){return this.#e}}function Sr(t,e){return t==null?null:typeof t[e]=="function"?t:t.provider&&typeof t.provider[e]=="function"?t.provider:null}function br(t){return t==null?null:t.provider||null}async function Wm(t,e){const s=bt.dereference(t,"overrides");P(typeof s=="object","invalid overrides parameter","overrides",t);const n=va(s);return P(n.to==null||(e||[]).indexOf("to")>=0,"cannot override to","overrides.to",n.to),P(n.data==null||(e||[]).indexOf("data")>=0,"cannot override data","overrides.data",n.data),n.from&&(n.from=n.from),n}async function mA(t,e,s){const n=Sr(t,"resolveName"),r=Qa(n)?n:null;return await Promise.all(e.map((i,o)=>i.walkAsync(s[o],(l,c)=>(c=bt.dereference(c,l),l==="address"?ds(c,r):c))))}function gA(t){const e=async function(o){const l=await Wm(o,["data"]);l.to=await t.getAddress(),l.from&&(l.from=await ds(l.from,Hm(t.runner)));const c=t.interface,u=he(l.value||ff,"overrides.value")===ff,d=(l.data||"0x")==="0x";c.fallback&&!c.fallback.payable&&c.receive&&!d&&!u&&P(!1,"cannot send data to receive or send value to non-payable fallback","overrides",o),P(c.fallback||d,"cannot send data to receive-only contract","overrides.data",l.data);const f=c.receive||c.fallback&&c.fallback.payable;return P(f||u,"cannot send value to non-payable fallback","overrides.value",l.value),P(c.fallback||d,"cannot send data to receive-only contract","overrides.data",l.data),l},s=async function(o){const l=Sr(t.runner,"call");j(Vm(l),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const c=await e(o);try{return await l.call(c)}catch(u){throw Qc(u)&&u.data?t.interface.makeError(u.data,c):u}},n=async function(o){const l=t.runner;j(jm(l),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const c=await l.sendTransaction(await e(o)),u=br(t.runner);return new du(t.interface,u,c)},r=async function(o){const l=Sr(t.runner,"estimateGas");return j($m(l),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await l.estimateGas(await e(o))},i=async o=>await n(o);return _e(i,{_contract:t,estimateGas:r,populateTransaction:e,send:n,staticCall:s}),i}function yA(t,e){const s=function(...u){const d=t.interface.getFunction(e,u);return j(d,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:u}}),d},n=async function(...u){const d=s(...u);let f={};if(d.inputs.length+1===u.length&&(f=await Wm(u.pop()),f.from&&(f.from=await ds(f.from,Hm(t.runner)))),d.inputs.length!==u.length)throw new Error("internal error: fragment inputs doesn't match arguments; should not happen");const h=await mA(t.runner,d.inputs,u);return Object.assign({},f,await rs({to:t.getAddress(),data:t.interface.encodeFunctionData(d,h)}))},r=async function(...u){const d=await l(...u);return d.length===1?d[0]:d},i=async function(...u){const d=t.runner;j(jm(d),"contract runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});const f=await d.sendTransaction(await n(...u)),h=br(t.runner);return new du(t.interface,h,f)},o=async function(...u){const d=Sr(t.runner,"estimateGas");return j($m(d),"contract runner does not support gas estimation","UNSUPPORTED_OPERATION",{operation:"estimateGas"}),await d.estimateGas(await n(...u))},l=async function(...u){const d=Sr(t.runner,"call");j(Vm(d),"contract runner does not support calling","UNSUPPORTED_OPERATION",{operation:"call"});const f=await n(...u);let h="0x";try{h=await d.call(f)}catch(T){throw Qc(T)&&T.data?t.interface.makeError(T.data,f):T}const y=s(...u);return t.interface.decodeFunctionResult(y,h)},c=async(...u)=>s(...u).constant?await r(...u):await i(...u);return _e(c,{name:t.interface.getFunctionName(e),_contract:t,_key:e,getFragment:s,estimateGas:o,populateTransaction:n,send:i,staticCall:r,staticCallResult:l}),Object.defineProperty(c,"fragment",{configurable:!1,enumerable:!0,get:()=>{const u=t.interface.getFunction(e);return j(u,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),u}}),c}function vA(t,e){const s=function(...r){const i=t.interface.getEvent(e,r);return j(i,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e,args:r}}),i},n=function(...r){return new pA(t,s(...r),r)};return _e(n,{name:t.interface.getEventName(e),_contract:t,_key:e,getFragment:s}),Object.defineProperty(n,"fragment",{configurable:!1,enumerable:!0,get:()=>{const r=t.interface.getEvent(e);return j(r,"no matching fragment","UNSUPPORTED_OPERATION",{operation:"fragment",info:{key:e}}),r}}),n}const ba=Symbol.for("_ethersInternal_contract"),Ym=new WeakMap;function bA(t,e){Ym.set(t[ba],e)}function Ts(t){return Ym.get(t[ba])}function wA(t){return t&&typeof t=="object"&&"getTopicFilter"in t&&typeof t.getTopicFilter=="function"&&t.fragment}async function fu(t,e){let s,n=null;if(Array.isArray(e)){const i=function(o){if(ct(o,32))return o;const l=t.interface.getEvent(o);return P(l,"unknown fragment","name",o),l.topicHash};s=e.map(o=>o==null?null:Array.isArray(o)?o.map(i):i(o))}else e==="*"?s=[null]:typeof e=="string"?ct(e,32)?s=[e]:(n=t.interface.getEvent(e),P(n,"unknown fragment","event",e),s=[n.topicHash]):wA(e)?s=await e.getTopicFilter():"fragment"in e?(n=e.fragment,s=[n.topicHash]):P(!1,"unknown event name","event",e);s=s.map(i=>{if(i==null)return null;if(Array.isArray(i)){const o=Array.from(new Set(i.map(l=>l.toLowerCase())).values());return o.length===1?o[0]:(o.sort(),o)}return i.toLowerCase()});const r=s.map(i=>i==null?"null":Array.isArray(i)?i.join("|"):i).join("&");return{fragment:n,tag:r,topics:s}}async function Di(t,e){const{subs:s}=Ts(t);return s.get((await fu(t,e)).tag)||null}async function hf(t,e,s){const n=br(t.runner);j(n,"contract runner does not support subscribing","UNSUPPORTED_OPERATION",{operation:e});const{fragment:r,tag:i,topics:o}=await fu(t,s),{addr:l,subs:c}=Ts(t);let u=c.get(i);if(!u){const f={address:l||t,topics:o},h=k=>{let C=r;if(C==null)try{C=t.interface.getEvent(k.topics[0])}catch{}if(C){const N=C,L=r?t.interface.decodeEventLog(r,k.data,k.topics):[];mc(t,s,L,D=>new hA(t,D,s,N,k))}else mc(t,s,[],N=>new Fm(t,N,s,k))};let y=[];u={tag:i,listeners:[],start:()=>{y.length||y.push(n.on(f,h))},stop:async()=>{if(y.length==0)return;let k=y;y=[],await Promise.all(k),n.off(f,h)}},c.set(i,u)}return u}let pc=Promise.resolve();async function AA(t,e,s,n){await pc;const r=await Di(t,e);if(!r)return!1;const i=r.listeners.length;return r.listeners=r.listeners.filter(({listener:o,once:l})=>{const c=Array.from(s);n&&c.push(n(l?null:o));try{o.call(t,...c)}catch{}return!l}),r.listeners.length===0&&(r.stop(),Ts(t).subs.delete(r.tag)),i>0}async function mc(t,e,s,n){try{await pc}catch{}const r=AA(t,e,s,n);return pc=r,await r}const Vo=["then"];class $i{target;interface;runner;filters;[ba];fallback;constructor(e,s,n,r){P(typeof e=="string"||qp(e),"invalid value for Contract target","target",e),n==null&&(n=null);const i=pr.from(s);_e(this,{target:e,runner:n,interface:i}),Object.defineProperty(this,ba,{value:{}});let o,l=null,c=null;if(r){const f=br(n);c=new du(this.interface,f,r)}let u=new Map;if(typeof e=="string")if(ct(e))l=e,o=Promise.resolve(e);else{const f=Sr(n,"resolveName");if(!Qa(f))throw ht("contract runner does not support name resolution","UNSUPPORTED_OPERATION",{operation:"resolveName"});o=f.resolveName(e).then(h=>{if(h==null)throw ht("an ENS name used for a contract target must be correctly configured","UNCONFIGURED_NAME",{value:e});return Ts(this).addr=h,h})}else o=e.getAddress().then(f=>{if(f==null)throw new Error("TODO");return Ts(this).addr=f,f});bA(this,{addrPromise:o,addr:l,deployTx:c,subs:u});const d=new Proxy({},{get:(f,h,y)=>{if(typeof h=="symbol"||Vo.indexOf(h)>=0)return Reflect.get(f,h,y);try{return this.getEvent(h)}catch(T){if(!Gt(T,"INVALID_ARGUMENT")||T.argument!=="key")throw T}},has:(f,h)=>Vo.indexOf(h)>=0?Reflect.has(f,h):Reflect.has(f,h)||this.interface.hasEvent(String(h))});return _e(this,{filters:d}),_e(this,{fallback:i.receive||i.fallback?gA(this):null}),new Proxy(this,{get:(f,h,y)=>{if(typeof h=="symbol"||h in f||Vo.indexOf(h)>=0)return Reflect.get(f,h,y);try{return f.getFunction(h)}catch(T){if(!Gt(T,"INVALID_ARGUMENT")||T.argument!=="key")throw T}},has:(f,h)=>typeof h=="symbol"||h in f||Vo.indexOf(h)>=0?Reflect.has(f,h):f.interface.hasFunction(h)})}connect(e){return new $i(this.target,this.interface,e)}attach(e){return new $i(e,this.interface,this.runner)}async getAddress(){return await Ts(this).addrPromise}async getDeployedCode(){const e=br(this.runner);j(e,"runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"getDeployedCode"});const s=await e.getCode(await this.getAddress());return s==="0x"?null:s}async waitForDeployment(){const e=this.deploymentTransaction();if(e)return await e.wait(),this;if(await this.getDeployedCode()!=null)return this;const n=br(this.runner);return j(n!=null,"contract runner does not support .provider","UNSUPPORTED_OPERATION",{operation:"waitForDeployment"}),new Promise((r,i)=>{const o=async()=>{try{if(await this.getDeployedCode()!=null)return r(this);n.once("block",o)}catch(l){i(l)}};o()})}deploymentTransaction(){return Ts(this).deployTx}getFunction(e){return typeof e!="string"&&(e=e.format()),yA(this,e)}getEvent(e){return typeof e!="string"&&(e=e.format()),vA(this,e)}async queryTransaction(e){throw new Error("@TODO")}async queryFilter(e,s,n){s==null&&(s=0),n==null&&(n="latest");const{addr:r,addrPromise:i}=Ts(this),o=r||await i,{fragment:l,topics:c}=await fu(this,e),u={address:o,topics:c,fromBlock:s,toBlock:n},d=br(this.runner);return j(d,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await d.getLogs(u)).map(f=>{let h=l;if(h==null)try{h=this.interface.getEvent(f.topics[0])}catch{}if(h)try{return new uu(f,this.interface,h)}catch(y){return new Mm(f,y)}return new Ao(f,d)})}async on(e,s){const n=await hf(this,"on",e);return n.listeners.push({listener:s,once:!1}),n.start(),this}async once(e,s){const n=await hf(this,"once",e);return n.listeners.push({listener:s,once:!0}),n.start(),this}async emit(e,...s){return await mc(this,e,s,null)}async listenerCount(e){if(e){const r=await Di(this,e);return r?r.listeners.length:0}const{subs:s}=Ts(this);let n=0;for(const{listeners:r}of s.values())n+=r.length;return n}async listeners(e){if(e){const r=await Di(this,e);return r?r.listeners.map(({listener:i})=>i):[]}const{subs:s}=Ts(this);let n=[];for(const{listeners:r}of s.values())n=n.concat(r.map(({listener:i})=>i));return n}async off(e,s){const n=await Di(this,e);if(!n)return this;if(s){const r=n.listeners.map(({listener:i})=>i).indexOf(s);r>=0&&n.listeners.splice(r,1)}return(s==null||n.listeners.length===0)&&(n.stop(),Ts(this).subs.delete(n.tag)),this}async removeAllListeners(e){if(e){const s=await Di(this,e);if(!s)return this;s.stop(),Ts(this).subs.delete(s.tag)}else{const{subs:s}=Ts(this);for(const{tag:n,stop:r}of s.values())r(),s.delete(n)}return this}async addListener(e,s){return await this.on(e,s)}async removeListener(e,s){return await this.off(e,s)}static buildClass(e){class s extends $i{constructor(r,i=null){super(r,e,i)}}return s}static from(e,s,n){return n==null&&(n=null),new this(e,s,n)}}function EA(){return $i}class Wt extends EA(){}function Dl(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):P(!1,"unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}class _A{name;constructor(e){_e(this,{name:e})}connect(e){return this}supportsCoinType(e){return!1}async encodeAddress(e,s){throw new Error("unsupported coin")}async decodeAddress(e,s){throw new Error("unsupported coin")}}const Gm=new RegExp("^(ipfs)://(.*)$","i"),pf=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),Gm,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];class ei{provider;address;name;#e;#t;constructor(e,s,n){_e(this,{provider:e,address:s,name:n}),this.#e=null,this.#t=new Wt(s,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],e)}async supportsWildcard(){return this.#e==null&&(this.#e=(async()=>{try{return await this.#t.supportsInterface("0x9061b923")}catch(e){if(Gt(e,"CALL_EXCEPTION"))return!1;throw this.#e=null,e}})()),await this.#e}async#s(e,s){s=(s||[]).slice();const n=this.#t.interface;s.unshift(hc(this.name));let r=null;await this.supportsWildcard()&&(r=n.getFunction(e),j(r,"missing fragment","UNKNOWN_ERROR",{info:{funcName:e}}),s=[M1(this.name,255),n.encodeFunctionData(r,s)],e="resolve(bytes,bytes)"),s.push({enableCcipRead:!0});try{const i=await this.#t[e](...s);return r?n.decodeFunctionResult(r,i)[0]:i}catch(i){if(!Gt(i,"CALL_EXCEPTION"))throw i}return null}async getAddress(e){if(e==null&&(e=60),e===60)try{const i=await this.#s("addr(bytes32)");return i==null||i===no?null:i}catch(i){if(Gt(i,"CALL_EXCEPTION"))return null;throw i}if(e>=0&&e<2147483648){let i=e+2147483648;const o=await this.#s("addr(bytes32,uint)",[i]);if(ct(o,20))return Qe(o)}let s=null;for(const i of this.provider.plugins)if(i instanceof _A&&i.supportsCoinType(e)){s=i;break}if(s==null)return null;const n=await this.#s("addr(bytes32,uint)",[e]);if(n==null||n==="0x")return null;const r=await s.decodeAddress(e,n);if(r!=null)return r;j(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${e})`,info:{coinType:e,data:n}})}async getText(e){const s=await this.#s("text(bytes32,string)",[e]);return s==null||s==="0x"?null:s}async getContentHash(){const e=await this.#s("contenthash(bytes32)");if(e==null||e==="0x")return null;const s=e.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(s){const r=s[1]==="e3010170"?"ipfs":"ipns",i=parseInt(s[4],16);if(s[5].length===i*2)return`${r}://${kv("0x"+s[2])}`}const n=e.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===64)return`bzz://${n[1]}`;j(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:e}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const e=[{type:"name",value:this.name}];try{const s=await this.getText("avatar");if(s==null)return e.push({type:"!avatar",value:""}),{url:null,linkage:e};e.push({type:"avatar",value:s});for(let n=0;n<pf.length;n++){const r=s.match(pf[n]);if(r==null)continue;const i=r[1].toLowerCase();switch(i){case"https":case"data":return e.push({type:"url",value:s}),{linkage:e,url:s};case"ipfs":{const o=Dl(s);return e.push({type:"ipfs",value:s}),e.push({type:"url",value:o}),{linkage:e,url:o}}case"erc721":case"erc1155":{const o=i==="erc721"?"tokenURI(uint256)":"uri(uint256)";e.push({type:i,value:s});const l=await this.getAddress();if(l==null)return e.push({type:"!owner",value:""}),{url:null,linkage:e};const c=(r[2]||"").split("/");if(c.length!==2)return e.push({type:`!${i}caip`,value:r[2]||""}),{url:null,linkage:e};const u=c[1],d=new Wt(c[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if(i==="erc721"){const w=await d.ownerOf(u);if(l!==w)return e.push({type:"!owner",value:w}),{url:null,linkage:e};e.push({type:"owner",value:w})}else if(i==="erc1155"){const w=await d.balanceOf(l,u);if(!w)return e.push({type:"!balance",value:"0"}),{url:null,linkage:e};e.push({type:"balance",value:w.toString()})}let f=await d[o](u);if(f==null||f==="0x")return e.push({type:"!metadata-url",value:""}),{url:null,linkage:e};e.push({type:"metadata-url-base",value:f}),i==="erc1155"&&(f=f.replace("{id}",Jn(u,32).substring(2)),e.push({type:"metadata-url-expanded",value:f})),f.match(/^ipfs:/i)&&(f=Dl(f)),e.push({type:"metadata-url",value:f});let h={};const y=await new Cn(f).send();y.assertOk();try{h=y.bodyJson}catch{try{e.push({type:"!metadata",value:y.bodyText})}catch{const C=y.body;return C&&e.push({type:"!metadata",value:oe(C)}),{url:null,linkage:e}}return{url:null,linkage:e}}if(!h)return e.push({type:"!metadata",value:""}),{url:null,linkage:e};e.push({type:"metadata",value:JSON.stringify(h)});let T=h.image;if(typeof T!="string")return e.push({type:"!imageUrl",value:""}),{url:null,linkage:e};if(!T.match(/^(https:\/\/|data:)/i)){if(T.match(Gm)==null)return e.push({type:"!imageUrl-ipfs",value:T}),{url:null,linkage:e};e.push({type:"imageUrl-ipfs",value:T}),T=Dl(T)}return e.push({type:"url",value:T}),{linkage:e,url:T}}}}}catch{}return{linkage:e,url:null}}static async getEnsAddress(e){const s=await e.getNetwork(),n=s.getPlugin("org.ethers.plugins.network.Ens");return j(n,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:s}}),n.address}static async#n(e,s){const n=await ei.getEnsAddress(e);try{const i=await new Wt(n,["function resolver(bytes32) view returns (address)"],e).resolver(hc(s),{enableCcipRead:!0});return i===no?null:i}catch(r){throw r}return null}static async fromName(e,s){let n=s;for(;;){if(n===""||n==="."||s!=="eth"&&n==="eth")return null;const r=await ei.#n(e,n);if(r!=null){const i=new ei(e,r,s);return n!==s&&!await i.supportsWildcard()?null:i}n=n.split(".").slice(1).join(".")}}}const mf=BigInt(0);function Ve(t,e){return(function(s){return s==null?e:t(s)})}function co(t,e){return(s=>{if(e&&s==null)return null;if(!Array.isArray(s))throw new Error("not an array");return s.map(n=>t(n))})}function _o(t,e){return(s=>{const n={};for(const r in t){let i=r;if(e&&r in e&&!(i in s)){for(const o of e[r])if(o in s){i=o;break}}try{const o=t[r](s[i]);o!==void 0&&(n[r]=o)}catch(o){const l=o instanceof Error?o.message:"not-an-error";j(!1,`invalid value for value.${r} (${l})`,"BAD_DATA",{value:s})}}return n})}function TA(t){switch(t){case!0:case"true":return!0;case!1:case"false":return!1}P(!1,`invalid boolean; ${JSON.stringify(t)}`,"value",t)}function ci(t){return P(ct(t,!0),"invalid data","value",t),t}function Yt(t){return P(ct(t,32),"invalid hash","value",t),t}const PA=_o({address:Qe,blockHash:Yt,blockNumber:Ne,data:ci,index:Ne,removed:Ve(TA,!1),topics:co(Yt),transactionHash:Yt,transactionIndex:Ne},{index:["logIndex"]});function kA(t){return PA(t)}const SA=_o({hash:Ve(Yt),parentHash:Yt,parentBeaconBlockRoot:Ve(Yt,null),number:Ne,timestamp:Ne,nonce:Ve(ci),difficulty:he,gasLimit:he,gasUsed:he,stateRoot:Ve(Yt,null),receiptsRoot:Ve(Yt,null),blobGasUsed:Ve(he,null),excessBlobGas:Ve(he,null),miner:Ve(Qe),prevRandao:Ve(Yt,null),extraData:ci,baseFeePerGas:Ve(he)},{prevRandao:["mixHash"]});function CA(t){const e=SA(t);return e.transactions=t.transactions.map(s=>typeof s=="string"?s:Km(s)),e}const IA=_o({transactionIndex:Ne,blockNumber:Ne,transactionHash:Yt,address:Qe,topics:co(Yt),data:ci,index:Ne,blockHash:Yt},{index:["logIndex"]});function RA(t){return IA(t)}const DA=_o({to:Ve(Qe,null),from:Ve(Qe,null),contractAddress:Ve(Qe,null),index:Ne,root:Ve(oe),gasUsed:he,blobGasUsed:Ve(he,null),logsBloom:Ve(ci),blockHash:Yt,hash:Yt,logs:co(RA),blockNumber:Ne,cumulativeGasUsed:he,effectiveGasPrice:Ve(he),blobGasPrice:Ve(he,null),status:Ve(Ne),type:Ve(Ne,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function xA(t){return DA(t)}function Km(t){t.to&&he(t.to)===mf&&(t.to="0x0000000000000000000000000000000000000000");const e=_o({hash:Yt,index:Ve(Ne,void 0),type:s=>s==="0x"||s==null?0:Ne(s),accessList:Ve(Ir,null),blobVersionedHashes:Ve(co(Yt,!0),null),authorizationList:Ve(co(s=>{let n;if(s.signature)n=s.signature;else{let r=s.yParity;r==="0x1b"?r=0:r==="0x1c"&&(r=1),n=Object.assign({},s,{yParity:r})}return{address:Qe(s.address),chainId:he(s.chainId),nonce:he(s.nonce),signature:vt.from(n)}},!1),null),blockHash:Ve(Yt,null),blockNumber:Ve(Ne,null),transactionIndex:Ve(Ne,null),from:Qe,gasPrice:Ve(he),maxPriorityFeePerGas:Ve(he),maxFeePerGas:Ve(he),maxFeePerBlobGas:Ve(he,null),gasLimit:he,to:Ve(Qe,null),value:he,nonce:Ne,data:ci,creates:Ve(Qe,null),chainId:Ve(he,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(t);if(e.to==null&&e.creates==null&&(e.creates=ww(e)),(t.type===1||t.type===2)&&t.accessList==null&&(e.accessList=[]),t.signature?e.signature=vt.from(t.signature):e.signature=vt.from(t),e.chainId==null){const s=e.signature.legacyChainId;s!=null&&(e.chainId=s)}return e.blockHash&&he(e.blockHash)===mf&&(e.blockHash=null),e}const NA="0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e";class To{name;constructor(e){_e(this,{name:e})}clone(){return new To(this.name)}}class Ja extends To{effectiveBlock;txBase;txCreate;txDataZero;txDataNonzero;txAccessListStorageKey;txAccessListAddress;constructor(e,s){e==null&&(e=0),super(`org.ethers.network.plugins.GasCost#${e||0}`);const n={effectiveBlock:e};function r(i,o){let l=(s||{})[i];l==null&&(l=o),P(typeof l=="number",`invalud value for ${i}`,"costs",s),n[i]=l}r("txBase",21e3),r("txCreate",32e3),r("txDataZero",4),r("txDataNonzero",16),r("txAccessListStorageKey",1900),r("txAccessListAddress",2400),_e(this,n)}clone(){return new Ja(this.effectiveBlock,this)}}class qa extends To{address;targetNetwork;constructor(e,s){super("org.ethers.plugins.network.Ens"),_e(this,{address:e||NA,targetNetwork:s??1})}clone(){return new qa(this.address,this.targetNetwork)}}class LA extends To{#e;#t;get url(){return this.#e}get processFunc(){return this.#t}constructor(e,s){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin"),this.#e=e,this.#t=s}clone(){return this}}const xl=new Map;class Ss{#e;#t;#s;constructor(e,s){this.#e=e,this.#t=he(s),this.#s=new Map}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return this.#e}set name(e){this.#e=e}get chainId(){return this.#t}set chainId(e){this.#t=he(e,"chainId")}matches(e){if(e==null)return!1;if(typeof e=="string"){try{return this.chainId===he(e)}catch{}return this.name===e}if(typeof e=="number"||typeof e=="bigint"){try{return this.chainId===he(e)}catch{}return!1}if(typeof e=="object"){if(e.chainId!=null){try{return this.chainId===he(e.chainId)}catch{}return!1}return e.name!=null?this.name===e.name:!1}return!1}get plugins(){return Array.from(this.#s.values())}attachPlugin(e){if(this.#s.get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return this.#s.set(e.name,e.clone()),this}getPlugin(e){return this.#s.get(e)||null}getPlugins(e){return this.plugins.filter(s=>s.name.split("#")[0]===e)}clone(){const e=new Ss(this.name,this.chainId);return this.plugins.forEach(s=>{e.attachPlugin(s.clone())}),e}computeIntrinsicGas(e){const s=this.getPlugin("org.ethers.plugins.network.GasCost")||new Ja;let n=s.txBase;if(e.to==null&&(n+=s.txCreate),e.data)for(let r=2;r<e.data.length;r+=2)e.data.substring(r,r+2)==="00"?n+=s.txDataZero:n+=s.txDataNonzero;if(e.accessList){const r=Ir(e.accessList);for(const i in r)n+=s.txAccessListAddress+s.txAccessListStorageKey*r[i].storageKeys.length}return n}static from(e){if(OA(),e==null)return Ss.from("mainnet");if(typeof e=="number"&&(e=BigInt(e)),typeof e=="string"||typeof e=="bigint"){const s=xl.get(e);if(s)return s();if(typeof e=="bigint")return new Ss("unknown",e);P(!1,"unknown network","network",e)}if(typeof e.clone=="function")return e.clone();if(typeof e=="object"){P(typeof e.name=="string"&&typeof e.chainId=="number","invalid network object name or chainId","network",e);const s=new Ss(e.name,e.chainId);return(e.ensAddress||e.ensNetwork!=null)&&s.attachPlugin(new qa(e.ensAddress,e.ensNetwork)),s}P(!1,"invalid network","network",e)}static register(e,s){typeof e=="number"&&(e=BigInt(e));const n=xl.get(e);n&&P(!1,`conflicting network for ${JSON.stringify(n.name)}`,"nameOrChainId",e),xl.set(e,s)}}function gf(t,e){const s=String(t);if(!s.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${t}`);const n=s.split(".");if(n.length===1&&n.push(""),n.length!==2)throw new Error(`invalid gwei value: ${t}`);for(;n[1].length<e;)n[1]+="0";if(n[1].length>9){let r=BigInt(n[1].substring(0,9));n[1].substring(9).match(/^0+$/)||r++,n[1]=r.toString()}return BigInt(n[0]+n[1])}function yf(t){return new LA(t,async(e,s,n)=>{n.setHeader("User-Agent","ethers");let r;try{const[i,o]=await Promise.all([n.send(),e()]);r=i;const l=r.bodyJson.standard;return{gasPrice:o.gasPrice,maxFeePerGas:gf(l.maxFee,9),maxPriorityFeePerGas:gf(l.maxPriorityFee,9)}}catch(i){j(!1,`error encountered with polygon gas station (${JSON.stringify(n.url)})`,"SERVER_ERROR",{request:n,response:r,error:i})}})}let vf=!1;function OA(){if(vf)return;vf=!0;function t(e,s,n){const r=function(){const i=new Ss(e,s);return n.ensNetwork!=null&&i.attachPlugin(new qa(null,n.ensNetwork)),i.attachPlugin(new Ja),(n.plugins||[]).forEach(o=>{i.attachPlugin(o)}),i};Ss.register(e,r),Ss.register(s,r),n.altNames&&n.altNames.forEach(i=>{Ss.register(i,r)})}t("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),t("ropsten",3,{ensNetwork:3}),t("rinkeby",4,{ensNetwork:4}),t("goerli",5,{ensNetwork:5}),t("kovan",42,{ensNetwork:42}),t("sepolia",11155111,{ensNetwork:11155111}),t("holesky",17e3,{ensNetwork:17e3}),t("classic",61,{}),t("classicKotti",6,{}),t("arbitrum",42161,{ensNetwork:1}),t("arbitrum-goerli",421613,{}),t("arbitrum-sepolia",421614,{}),t("base",8453,{ensNetwork:1}),t("base-goerli",84531,{}),t("base-sepolia",84532,{}),t("bnb",56,{ensNetwork:1}),t("bnbt",97,{}),t("linea",59144,{ensNetwork:1}),t("linea-goerli",59140,{}),t("linea-sepolia",59141,{}),t("matic",137,{ensNetwork:1,plugins:[yf("https://gasstation.polygon.technology/v2")]}),t("matic-amoy",80002,{}),t("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[yf("https://gasstation-testnet.polygon.technology/v2")]}),t("optimism",10,{ensNetwork:1,plugins:[]}),t("optimism-goerli",420,{}),t("optimism-sepolia",11155420,{}),t("xdai",100,{ensNetwork:1})}function gc(t){return JSON.parse(JSON.stringify(t))}class UA{#e;#t;#s;#n;constructor(e){this.#e=e,this.#t=null,this.#s=4e3,this.#n=-2}get pollingInterval(){return this.#s}set pollingInterval(e){this.#s=e}async#r(){try{const e=await this.#e.getBlockNumber();if(this.#n===-2){this.#n=e;return}if(e!==this.#n){for(let s=this.#n+1;s<=e;s++){if(this.#t==null)return;await this.#e.emit("block",s)}this.#n=e}}catch{}this.#t!=null&&(this.#t=this.#e._setTimeout(this.#r.bind(this),this.#s))}start(){this.#t||(this.#t=this.#e._setTimeout(this.#r.bind(this),this.#s),this.#r())}stop(){this.#t&&(this.#e._clearTimeout(this.#t),this.#t=null)}pause(e){this.stop(),e&&(this.#n=-2)}resume(){this.start()}}class hu{#e;#t;#s;constructor(e){this.#e=e,this.#s=!1,this.#t=s=>{this._poll(s,this.#e)}}async _poll(e,s){throw new Error("sub-classes must override this")}start(){this.#s||(this.#s=!0,this.#t(-2),this.#e.on("block",this.#t))}stop(){this.#s&&(this.#s=!1,this.#e.off("block",this.#t))}pause(e){this.stop()}resume(){this.start()}}class BA extends hu{#e;#t;constructor(e,s){super(e),this.#e=s,this.#t=-2}pause(e){e&&(this.#t=-2),super.pause(e)}async _poll(e,s){const n=await s.getBlock(this.#e);n!=null&&(this.#t===-2?this.#t=n.number:n.number>this.#t&&(s.emit(this.#e,n.number),this.#t=n.number))}}class MA extends hu{#e;constructor(e,s){super(e),this.#e=gc(s)}async _poll(e,s){throw new Error("@TODO")}}class FA extends hu{#e;constructor(e,s){super(e),this.#e=s}async _poll(e,s){const n=await s.getTransactionReceipt(this.#e);n&&s.emit(this.#e,n)}}class pu{#e;#t;#s;#n;#r;constructor(e,s){this.#e=e,this.#t=gc(s),this.#s=this.#o.bind(this),this.#n=!1,this.#r=-2}async#o(e){if(this.#r===-2)return;const s=gc(this.#t);s.fromBlock=this.#r+1,s.toBlock=e;const n=await this.#e.getLogs(s);if(n.length===0){this.#r<e-60&&(this.#r=e-60);return}for(const r of n)this.#e.emit(this.#t,r),this.#r=r.blockNumber}start(){this.#n||(this.#n=!0,this.#r===-2&&this.#e.getBlockNumber().then(e=>{this.#r=e}),this.#e.on("block",this.#s))}stop(){this.#n&&(this.#n=!1,this.#e.off("block",this.#s))}pause(e){this.stop(),e&&(this.#r=-2)}resume(){this.start()}}const VA=BigInt(2),$A=10;function $o(t){return t&&typeof t.then=="function"}function Qo(t,e){return t+":"+JSON.stringify(e,(s,n)=>{if(n==null)return"null";if(typeof n=="bigint")return`bigint:${n.toString()}`;if(typeof n=="string")return n.toLowerCase();if(typeof n=="object"&&!Array.isArray(n)){const r=Object.keys(n);return r.sort(),r.reduce((i,o)=>(i[o]=n[o],i),{})}return n})}class zm{name;constructor(e){_e(this,{name:e})}start(){}stop(){}pause(e){}resume(){}}function jA(t){return JSON.parse(JSON.stringify(t))}function yc(t){return t=Array.from(new Set(t).values()),t.sort(),t}async function Nl(t,e){if(t==null)throw new Error("invalid event");if(Array.isArray(t)&&(t={topics:t}),typeof t=="string")switch(t){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:t,tag:t}}if(ct(t,32)){const s=t.toLowerCase();return{type:"transaction",tag:Qo("tx",{hash:s}),hash:s}}if(t.orphan){const s=t;return{type:"orphan",tag:Qo("orphan",s),filter:jA(s)}}if(t.address||t.topics){const s=t,n={topics:(s.topics||[]).map(r=>r==null?null:Array.isArray(r)?yc(r.map(i=>i.toLowerCase())):r.toLowerCase())};if(s.address){const r=[],i=[],o=l=>{ct(l)?r.push(l):i.push((async()=>{r.push(await ds(l,e))})())};Array.isArray(s.address)?s.address.forEach(o):o(s.address),i.length&&await Promise.all(i),n.address=yc(r.map(l=>l.toLowerCase()))}return{filter:n,tag:Qo("event",n),type:"event"}}P(!1,"unknown ProviderEvent","event",t)}function Ll(){return new Date().getTime()}const HA={cacheTimeout:250,pollingInterval:4e3};class WA{#e;#t;#s;#n;#r;#o;#i;#a;#d;#c;#p;#m;constructor(e,s){if(this.#m=Object.assign({},HA,s||{}),e==="any")this.#o=!0,this.#r=null;else if(e){const n=Ss.from(e);this.#o=!1,this.#r=Promise.resolve(n),setTimeout(()=>{this.emit("network",n,null)},0)}else this.#o=!1,this.#r=null;this.#a=-1,this.#i=new Map,this.#e=new Map,this.#t=new Map,this.#s=null,this.#n=!1,this.#d=1,this.#c=new Map,this.#p=!1}get pollingInterval(){return this.#m.pollingInterval}get provider(){return this}get plugins(){return Array.from(this.#t.values())}attachPlugin(e){if(this.#t.get(e.name))throw new Error(`cannot replace existing plugin: ${e.name} `);return this.#t.set(e.name,e.connect(this)),this}getPlugin(e){return this.#t.get(e)||null}get disableCcipRead(){return this.#p}set disableCcipRead(e){this.#p=!!e}async#l(e){const s=this.#m.cacheTimeout;if(s<0)return await this._perform(e);const n=Qo(e.method,e);let r=this.#i.get(n);return r||(r=this._perform(e),this.#i.set(n,r),setTimeout(()=>{this.#i.get(n)===r&&this.#i.delete(n)},s)),await r}async ccipReadFetch(e,s,n){if(this.disableCcipRead||n.length===0||e.to==null)return null;const r=e.to.toLowerCase(),i=s.toLowerCase(),o=[];for(let l=0;l<n.length;l++){const c=n[l],u=c.replace("{sender}",r).replace("{data}",i),d=new Cn(u);c.indexOf("{data}")===-1&&(d.body={data:i,sender:r}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:d,index:l,urls:n});let f="unknown error",h;try{h=await d.send()}catch(y){o.push(y.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:d,result:{error:y}});continue}try{const y=h.bodyJson;if(y.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:d,result:y}),y.data;y.message&&(f=y.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:d,result:y})}catch{}j(h.statusCode<400||h.statusCode>=500,`response not found during CCIP fetch: ${f}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:e,info:{url:c,errorMessage:f}}),o.push(f)}j(!1,`error encountered during CCIP fetch: ${o.map(l=>JSON.stringify(l)).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:e,info:{urls:n,errorMessages:o}})}_wrapBlock(e,s){return new cA(CA(e),this)}_wrapLog(e,s){return new Ao(kA(e),this)}_wrapTransactionReceipt(e,s){return new Om(xA(e),this)}_wrapTransactionResponse(e,s){return new Eo(Km(e),this)}_detectNetwork(){j(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(e){j(!1,`unsupported method: ${e.method}`,"UNSUPPORTED_OPERATION",{operation:e.method,info:e})}async getBlockNumber(){const e=Ne(await this.#l({method:"getBlockNumber"}),"%response");return this.#a>=0&&(this.#a=e),e}_getAddress(e){return ds(e,this)}_getBlockTag(e){if(e==null)return"latest";switch(e){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return e}if(ct(e))return ct(e,32)?e:Hs(e);if(typeof e=="bigint"&&(e=Ne(e,"blockTag")),typeof e=="number")return e>=0?Hs(e):this.#a>=0?Hs(this.#a+e):this.getBlockNumber().then(s=>Hs(s+e));P(!1,"invalid blockTag","blockTag",e)}_getFilter(e){const s=(e.topics||[]).map(c=>c==null?null:Array.isArray(c)?yc(c.map(u=>u.toLowerCase())):c.toLowerCase()),n="blockHash"in e?e.blockHash:void 0,r=(c,u,d)=>{let f;switch(c.length){case 0:break;case 1:f=c[0];break;default:c.sort(),f=c}if(n&&(u!=null||d!=null))throw new Error("invalid filter");const h={};return f&&(h.address=f),s.length&&(h.topics=s),u&&(h.fromBlock=u),d&&(h.toBlock=d),n&&(h.blockHash=n),h};let i=[];if(e.address)if(Array.isArray(e.address))for(const c of e.address)i.push(this._getAddress(c));else i.push(this._getAddress(e.address));let o;"fromBlock"in e&&(o=this._getBlockTag(e.fromBlock));let l;return"toBlock"in e&&(l=this._getBlockTag(e.toBlock)),i.filter(c=>typeof c!="string").length||o!=null&&typeof o!="string"||l!=null&&typeof l!="string"?Promise.all([Promise.all(i),o,l]).then(c=>r(c[0],c[1],c[2])):r(i,o,l)}_getTransactionRequest(e){const s=va(e),n=[];if(["to","from"].forEach(r=>{if(s[r]==null)return;const i=ds(s[r],this);$o(i)?n.push((async function(){s[r]=await i})()):s[r]=i}),s.blockTag!=null){const r=this._getBlockTag(s.blockTag);$o(r)?n.push((async function(){s.blockTag=await r})()):s.blockTag=r}return n.length?(async function(){return await Promise.all(n),s})():s}async getNetwork(){if(this.#r==null){const r=(async()=>{try{const i=await this._detectNetwork();return this.emit("network",i,null),i}catch(i){throw this.#r===r&&(this.#r=null),i}})();return this.#r=r,(await r).clone()}const e=this.#r,[s,n]=await Promise.all([e,this._detectNetwork()]);return s.chainId!==n.chainId&&(this.#o?(this.emit("network",n,s),this.#r===e&&(this.#r=Promise.resolve(n))):j(!1,`network changed: ${s.chainId} => ${n.chainId} `,"NETWORK_ERROR",{event:"changed"})),s.clone()}async getFeeData(){const e=await this.getNetwork(),s=async()=>{const{_block:r,gasPrice:i,priorityFee:o}=await rs({_block:this.#y("latest",!1),gasPrice:(async()=>{try{const d=await this.#l({method:"getGasPrice"});return he(d,"%response")}catch{}return null})(),priorityFee:(async()=>{try{const d=await this.#l({method:"getPriorityFee"});return he(d,"%response")}catch{}return null})()});let l=null,c=null;const u=this._wrapBlock(r,e);return u&&u.baseFeePerGas&&(c=o??BigInt("1000000000"),l=u.baseFeePerGas*VA+c),new df(i,l,c)},n=e.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(n){const r=new Cn(n.url),i=await n.processFunc(s,this,r);return new df(i.gasPrice,i.maxFeePerGas,i.maxPriorityFeePerGas)}return await s()}async estimateGas(e){let s=this._getTransactionRequest(e);return $o(s)&&(s=await s),he(await this.#l({method:"estimateGas",transaction:s}),"%response")}async#u(e,s,n){j(n<$A,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},e,{blockTag:s,enableCcipRead:!0})});const r=va(e);try{return oe(await this._perform({method:"call",transaction:r,blockTag:s}))}catch(i){if(!this.disableCcipRead&&Qc(i)&&i.data&&n>=0&&s==="latest"&&r.to!=null&&yt(i.data,0,4)==="0x556f1830"){const o=i.data,l=await ds(r.to,this);let c;try{c=QA(yt(i.data,4))}catch(f){j(!1,f.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:r,info:{data:o}})}j(c.sender.toLowerCase()===l.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:o,reason:"OffchainLookup",transaction:r,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:c.errorArgs}});const u=await this.ccipReadFetch(r,c.calldata,c.urls);j(u!=null,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:r,info:{data:i.data,errorArgs:c.errorArgs}});const d={to:l,data:At([c.selector,zA([u,c.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:d});try{const f=await this.#u(d,s,n+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},d),result:f}),f}catch(f){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},d),error:f}),f}}throw i}}async#f(e){const{value:s}=await rs({network:this.getNetwork(),value:e});return s}async call(e){const{tx:s,blockTag:n}=await rs({tx:this._getTransactionRequest(e),blockTag:this._getBlockTag(e.blockTag)});return await this.#f(this.#u(s,n,e.enableCcipRead?0:-1))}async#h(e,s,n){let r=this._getAddress(s),i=this._getBlockTag(n);return(typeof r!="string"||typeof i!="string")&&([r,i]=await Promise.all([r,i])),await this.#f(this.#l(Object.assign(e,{address:r,blockTag:i})))}async getBalance(e,s){return he(await this.#h({method:"getBalance"},e,s),"%response")}async getTransactionCount(e,s){return Ne(await this.#h({method:"getTransactionCount"},e,s),"%response")}async getCode(e,s){return oe(await this.#h({method:"getCode"},e,s))}async getStorage(e,s,n){const r=he(s,"position");return oe(await this.#h({method:"getStorage",position:r},e,n))}async broadcastTransaction(e){const{blockNumber:s,hash:n,network:r}=await rs({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:e}),network:this.getNetwork()}),i=$s.from(e);if(i.hash!==n)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(i,r).replaceableTransaction(s)}async#y(e,s){if(ct(e,32))return await this.#l({method:"getBlock",blockHash:e,includeTransactions:s});let n=this._getBlockTag(e);return typeof n!="string"&&(n=await n),await this.#l({method:"getBlock",blockTag:n,includeTransactions:s})}async getBlock(e,s){const{network:n,params:r}=await rs({network:this.getNetwork(),params:this.#y(e,!!s)});return r==null?null:this._wrapBlock(r,n)}async getTransaction(e){const{network:s,params:n}=await rs({network:this.getNetwork(),params:this.#l({method:"getTransaction",hash:e})});return n==null?null:this._wrapTransactionResponse(n,s)}async getTransactionReceipt(e){const{network:s,params:n}=await rs({network:this.getNetwork(),params:this.#l({method:"getTransactionReceipt",hash:e})});if(n==null)return null;if(n.gasPrice==null&&n.effectiveGasPrice==null){const r=await this.#l({method:"getTransaction",hash:e});if(r==null)throw new Error("report this; could not find tx or effectiveGasPrice");n.effectiveGasPrice=r.gasPrice}return this._wrapTransactionReceipt(n,s)}async getTransactionResult(e){const{result:s}=await rs({network:this.getNetwork(),result:this.#l({method:"getTransactionResult",hash:e})});return s==null?null:oe(s)}async getLogs(e){let s=this._getFilter(e);$o(s)&&(s=await s);const{network:n,params:r}=await rs({network:this.getNetwork(),params:this.#l({method:"getLogs",filter:s})});return r.map(i=>this._wrapLog(i,n))}_getProvider(e){j(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(e){return await ei.fromName(this,e)}async getAvatar(e){const s=await this.getResolver(e);return s?await s.getAvatar():null}async resolveName(e){const s=await this.getResolver(e);return s?await s.getAddress():null}async lookupAddress(e){e=Qe(e);const s=hc(e.substring(2).toLowerCase()+".addr.reverse");try{const n=await ei.getEnsAddress(this),i=await new Wt(n,["function resolver(bytes32) view returns (address)"],this).resolver(s);if(i==null||i===no)return null;const l=await new Wt(i,["function name(bytes32) view returns (string)"],this).name(s);return await this.resolveName(l)!==e?null:l}catch(n){if(Gt(n,"BAD_DATA")&&n.value==="0x"||Gt(n,"CALL_EXCEPTION"))return null;throw n}return null}async waitForTransaction(e,s,n){const r=s??1;return r===0?this.getTransactionReceipt(e):new Promise(async(i,o)=>{let l=null;const c=(async u=>{try{const d=await this.getTransactionReceipt(e);if(d!=null&&u-d.blockNumber+1>=r){i(d),l&&(clearTimeout(l),l=null);return}}catch(d){console.log("EEE",d)}this.once("block",c)});n!=null&&(l=setTimeout(()=>{l!=null&&(l=null,this.off("block",c),o(ht("timeout","TIMEOUT",{reason:"timeout"})))},n)),c(await this.getBlockNumber())})}async waitForBlock(e){j(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(e){const s=this.#c.get(e);s&&(s.timer&&clearTimeout(s.timer),this.#c.delete(e))}_setTimeout(e,s){s==null&&(s=0);const n=this.#d++,r=()=>{this.#c.delete(n),e()};if(this.paused)this.#c.set(n,{timer:null,func:r,time:s});else{const i=setTimeout(r,s);this.#c.set(n,{timer:i,func:r,time:Ll()})}return n}_forEachSubscriber(e){for(const s of this.#e.values())e(s.subscriber)}_getSubscriber(e){switch(e.type){case"debug":case"error":case"network":return new zm(e.type);case"block":{const s=new UA(this);return s.pollingInterval=this.pollingInterval,s}case"safe":case"finalized":return new BA(this,e.type);case"event":return new pu(this,e.filter);case"transaction":return new FA(this,e.hash);case"orphan":return new MA(this,e.filter)}throw new Error(`unsupported event: ${e.type}`)}_recoverSubscriber(e,s){for(const n of this.#e.values())if(n.subscriber===e){n.started&&n.subscriber.stop(),n.subscriber=s,n.started&&s.start(),this.#s!=null&&s.pause(this.#s);break}}async#g(e,s){let n=await Nl(e,this);return n.type==="event"&&s&&s.length>0&&s[0].removed===!0&&(n=await Nl({orphan:"drop-log",log:s[0]},this)),this.#e.get(n.tag)||null}async#v(e){const s=await Nl(e,this),n=s.tag;let r=this.#e.get(n);return r||(r={subscriber:this._getSubscriber(s),tag:n,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},this.#e.set(n,r)),r}async on(e,s){const n=await this.#v(e);return n.listeners.push({listener:s,once:!1}),n.started||(n.subscriber.start(),n.started=!0,this.#s!=null&&n.subscriber.pause(this.#s)),this}async once(e,s){const n=await this.#v(e);return n.listeners.push({listener:s,once:!0}),n.started||(n.subscriber.start(),n.started=!0,this.#s!=null&&n.subscriber.pause(this.#s)),this}async emit(e,...s){const n=await this.#g(e,s);if(!n||n.listeners.length===0)return!1;const r=n.listeners.length;return n.listeners=n.listeners.filter(({listener:i,once:o})=>{const l=new hp(this,o?null:i,e);try{i.call(this,...s,l)}catch{}return!o}),n.listeners.length===0&&(n.started&&n.subscriber.stop(),this.#e.delete(n.tag)),r>0}async listenerCount(e){if(e){const n=await this.#g(e);return n?n.listeners.length:0}let s=0;for(const{listeners:n}of this.#e.values())s+=n.length;return s}async listeners(e){if(e){const n=await this.#g(e);return n?n.listeners.map(({listener:r})=>r):[]}let s=[];for(const{listeners:n}of this.#e.values())s=s.concat(n.map(({listener:r})=>r));return s}async off(e,s){const n=await this.#g(e);if(!n)return this;if(s){const r=n.listeners.map(({listener:i})=>i).indexOf(s);r>=0&&n.listeners.splice(r,1)}return(!s||n.listeners.length===0)&&(n.started&&n.subscriber.stop(),this.#e.delete(n.tag)),this}async removeAllListeners(e){if(e){const{tag:s,started:n,subscriber:r}=await this.#v(e);n&&r.stop(),this.#e.delete(s)}else for(const[s,{started:n,subscriber:r}]of this.#e)n&&r.stop(),this.#e.delete(s);return this}async addListener(e,s){return await this.on(e,s)}async removeListener(e,s){return this.off(e,s)}get destroyed(){return this.#n}destroy(){this.removeAllListeners();for(const e of this.#c.keys())this._clearTimeout(e);this.#n=!0}get paused(){return this.#s!=null}set paused(e){!!e!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(e){if(this.#a=-1,this.#s!=null){if(this.#s==!!e)return;j(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber(s=>s.pause(e)),this.#s=!!e;for(const s of this.#c.values())s.timer&&clearTimeout(s.timer),s.time=Ll()-s.time}resume(){if(this.#s!=null){this._forEachSubscriber(e=>e.resume()),this.#s=null;for(const e of this.#c.values()){let s=e.time;s<0&&(s=0),e.time=Ll(),setTimeout(e.func,s)}}}}function YA(t,e){try{const s=vc(t,e);if(s)return ua(s)}catch{}return null}function vc(t,e){if(t==="0x")return null;try{const s=Ne(yt(t,e,e+32)),n=Ne(yt(t,s,s+32));return yt(t,s+32,s+32+n)}catch{}return null}function bf(t){const e=Lt(t);if(e.length>32)throw new Error("internal; should not happen");const s=new Uint8Array(32);return s.set(e,32-e.length),s}function GA(t){if(t.length%32===0)return t;const e=new Uint8Array(Math.ceil(t.length/32)*32);return e.set(t),e}const KA=new Uint8Array([]);function zA(t){const e=[];let s=0;for(let n=0;n<t.length;n++)e.push(KA),s+=32;for(let n=0;n<t.length;n++){const r=Oe(t[n]);e[n]=bf(s),e.push(bf(r.length)),e.push(GA(r)),s+=32+Math.ceil(r.length/32)*32}return At(e)}const wf="0x0000000000000000000000000000000000000000000000000000000000000000";function QA(t){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};j(Jr(t)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const s=yt(t,0,32);j(yt(s,0,12)===yt(wf,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=yt(s,12);try{const n=[],r=Ne(yt(t,32,64)),i=Ne(yt(t,r,r+32)),o=yt(t,r+32);for(let l=0;l<i;l++){const c=YA(o,l*32);if(c==null)throw new Error("abort");n.push(c)}e.urls=n}catch{j(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const n=vc(t,64);if(n==null)throw new Error("abort");e.calldata=n}catch{j(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}j(yt(t,100,128)===yt(wf,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=yt(t,96,100);try{const n=vc(t,128);if(n==null)throw new Error("abort");e.extraData=n}catch{j(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map(n=>e[n]),e}function lr(t,e){if(t.provider)return t.provider;j(!1,"missing provider","UNSUPPORTED_OPERATION",{operation:e})}async function Af(t,e){let s=va(e);if(s.to!=null&&(s.to=ds(s.to,t)),s.from!=null){const n=s.from;s.from=Promise.all([t.getAddress(),ds(n,t)]).then(([r,i])=>(P(r.toLowerCase()===i.toLowerCase(),"transaction from mismatch","tx.from",i),r))}else s.from=t.getAddress();return await rs(s)}class JA{provider;constructor(e){_e(this,{provider:e||null})}async getNonce(e){return lr(this,"getTransactionCount").getTransactionCount(await this.getAddress(),e)}async populateCall(e){return await Af(this,e)}async populateTransaction(e){const s=lr(this,"populateTransaction"),n=await Af(this,e);n.nonce==null&&(n.nonce=await this.getNonce("pending")),n.gasLimit==null&&(n.gasLimit=await this.estimateGas(n));const r=await this.provider.getNetwork();if(n.chainId!=null){const o=he(n.chainId);P(o===r.chainId,"transaction chainId mismatch","tx.chainId",e.chainId)}else n.chainId=r.chainId;const i=n.maxFeePerGas!=null||n.maxPriorityFeePerGas!=null;if(n.gasPrice!=null&&(n.type===2||i)?P(!1,"eip-1559 transaction do not support gasPrice","tx",e):(n.type===0||n.type===1)&&i&&P(!1,"pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","tx",e),(n.type===2||n.type==null)&&n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)n.type=2;else if(n.type===0||n.type===1){const o=await s.getFeeData();j(o.gasPrice!=null,"network does not support gasPrice","UNSUPPORTED_OPERATION",{operation:"getGasPrice"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice)}else{const o=await s.getFeeData();if(n.type==null)if(o.maxFeePerGas!=null&&o.maxPriorityFeePerGas!=null)if(n.authorizationList&&n.authorizationList.length?n.type=4:n.type=2,n.gasPrice!=null){const l=n.gasPrice;delete n.gasPrice,n.maxFeePerGas=l,n.maxPriorityFeePerGas=l}else n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas);else o.gasPrice!=null?(j(!i,"network does not support EIP-1559","UNSUPPORTED_OPERATION",{operation:"populateTransaction"}),n.gasPrice==null&&(n.gasPrice=o.gasPrice),n.type=0):j(!1,"failed to get consistent fee data","UNSUPPORTED_OPERATION",{operation:"signer.getFeeData"});else(n.type===2||n.type===3||n.type===4)&&(n.maxFeePerGas==null&&(n.maxFeePerGas=o.maxFeePerGas),n.maxPriorityFeePerGas==null&&(n.maxPriorityFeePerGas=o.maxPriorityFeePerGas))}return await rs(n)}async populateAuthorization(e){const s=Object.assign({},e);return s.chainId==null&&(s.chainId=(await lr(this,"getNetwork").getNetwork()).chainId),s.nonce==null&&(s.nonce=await this.getNonce()),s}async estimateGas(e){return lr(this,"estimateGas").estimateGas(await this.populateCall(e))}async call(e){return lr(this,"call").call(await this.populateCall(e))}async resolveName(e){return await lr(this,"resolveName").resolveName(e)}async sendTransaction(e){const s=lr(this,"sendTransaction"),n=await this.populateTransaction(e);delete n.from;const r=$s.from(n);return await s.broadcastTransaction(await this.signTransaction(r))}authorize(e){j(!1,"authorization not implemented for this signer","UNSUPPORTED_OPERATION",{operation:"authorize"})}}function qA(t){return JSON.parse(JSON.stringify(t))}class Qm{#e;#t;#s;#n;#r;#o;constructor(e){this.#e=e,this.#t=null,this.#s=this.#i.bind(this),this.#n=!1,this.#r=null,this.#o=!1}_subscribe(e){throw new Error("subclasses must override this")}_emitResults(e,s){throw new Error("subclasses must override this")}_recover(e){throw new Error("subclasses must override this")}async#i(e){try{this.#t==null&&(this.#t=this._subscribe(this.#e));let s=null;try{s=await this.#t}catch(i){if(!Gt(i,"UNSUPPORTED_OPERATION")||i.operation!=="eth_newFilter")throw i}if(s==null){this.#t=null,this.#e._recoverSubscriber(this,this._recover(this.#e));return}const n=await this.#e.getNetwork();if(this.#r||(this.#r=n),this.#r.chainId!==n.chainId)throw new Error("chaid changed");if(this.#o)return;const r=await this.#e.send("eth_getFilterChanges",[s]);await this._emitResults(this.#e,r)}catch(s){console.log("@TODO",s)}this.#e.once("block",this.#s)}#a(){const e=this.#t;e&&(this.#t=null,e.then(s=>{this.#e.destroyed||this.#e.send("eth_uninstallFilter",[s])}))}start(){this.#n||(this.#n=!0,this.#i(-2))}stop(){this.#n&&(this.#n=!1,this.#o=!0,this.#a(),this.#e.off("block",this.#s))}pause(e){e&&this.#a(),this.#e.off("block",this.#s)}resume(){this.start()}}class ZA extends Qm{#e;constructor(e,s){super(e),this.#e=qA(s)}_recover(e){return new pu(e,this.#e)}async _subscribe(e){return await e.send("eth_newFilter",[this.#e])}async _emitResults(e,s){for(const n of s)e.emit(this.#e,e._wrapLog(n,e._network))}}class XA extends Qm{async _subscribe(e){return await e.send("eth_newPendingTransactionFilter",[])}async _emitResults(e,s){for(const n of s)e.emit("pending",n)}}const eE="bigint,boolean,function,number,string,symbol".split(/,/g);function Jo(t){if(t==null||eE.indexOf(typeof t)>=0||typeof t.getAddress=="function")return t;if(Array.isArray(t))return t.map(Jo);if(typeof t=="object")return Object.keys(t).reduce((e,s)=>(e[s]=t[s],e),{});throw new Error(`should not happen: ${t} (${typeof t})`)}function tE(t){return new Promise(e=>{setTimeout(e,t)})}function Mr(t){return t&&t.toLowerCase()}function Ef(t){return t&&typeof t.pollingInterval=="number"}const Jm={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class Ol extends JA{address;constructor(e,s){super(e),s=Qe(s),_e(this,{address:s})}connect(e){j(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(e){return await this.populateCall(e)}async sendUncheckedTransaction(e){const s=Jo(e),n=[];if(s.from){const i=s.from;n.push((async()=>{const o=await ds(i,this.provider);P(o!=null&&o.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),s.from=o})())}else s.from=this.address;if(s.gasLimit==null&&n.push((async()=>{s.gasLimit=await this.provider.estimateGas({...s,from:this.address})})()),s.to!=null){const i=s.to;n.push((async()=>{s.to=await ds(i,this.provider)})())}n.length&&await Promise.all(n);const r=this.provider.getRpcTransaction(s);return this.provider.send("eth_sendTransaction",[r])}async sendTransaction(e){const s=await this.provider.getBlockNumber(),n=await this.sendUncheckedTransaction(e);return await new Promise((r,i)=>{const o=[1e3,100];let l=0;const c=async()=>{try{const u=await this.provider.getTransaction(n);if(u!=null){r(u.replaceableTransaction(s));return}}catch(u){if(Gt(u,"CANCELLED")||Gt(u,"BAD_DATA")||Gt(u,"NETWORK_ERROR")||Gt(u,"UNSUPPORTED_OPERATION")){u.info==null&&(u.info={}),u.info.sendTransactionHash=n,i(u);return}if(Gt(u,"INVALID_ARGUMENT")&&(l++,u.info==null&&(u.info={}),u.info.sendTransactionHash=n,l>10)){i(u);return}this.provider.emit("error",ht("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:u}))}this.provider._setTimeout(()=>{c()},o.pop()||4e3)};c()})}async signTransaction(e){const s=Jo(e);if(s.from){const r=await ds(s.from,this.provider);P(r!=null&&r.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",e),s.from=r}else s.from=this.address;const n=this.provider.getRpcTransaction(s);return await this.provider.send("eth_signTransaction",[n])}async signMessage(e){const s=typeof e=="string"?_n(e):e;return await this.provider.send("personal_sign",[oe(s),this.address.toLowerCase()])}async signTypedData(e,s,n){const r=Jo(n),i=await _s.resolveNames(e,s,r,async o=>{const l=await ds(o);return P(l!=null,"TypedData does not support null address","value",o),l});return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(_s.getPayload(i.domain,s,i.value))])}async unlock(e){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),e,null])}async _legacySignMessage(e){const s=typeof e=="string"?_n(e):e;return await this.provider.send("eth_sign",[this.address.toLowerCase(),oe(s)])}}class sE extends WA{#e;#t;#s;#n;#r;#o;#i;#a(){if(this.#n)return;const e=this._getOption("batchMaxCount")===1?0:this._getOption("batchStallTime");this.#n=setTimeout(()=>{this.#n=null;const s=this.#s;for(this.#s=[];s.length;){const n=[s.shift()];for(;s.length&&n.length!==this.#e.batchMaxCount;)if(n.push(s.shift()),JSON.stringify(n.map(i=>i.payload)).length>this.#e.batchMaxSize){s.unshift(n.pop());break}(async()=>{const r=n.length===1?n[0].payload:n.map(i=>i.payload);this.emit("debug",{action:"sendRpcPayload",payload:r});try{const i=await this._send(r);this.emit("debug",{action:"receiveRpcResult",result:i});for(const{resolve:o,reject:l,payload:c}of n){if(this.destroyed){l(ht("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:c.method}));continue}const u=i.filter(d=>d.id===c.id)[0];if(u==null){const d=ht("missing response for request","BAD_DATA",{value:i,info:{payload:c}});this.emit("error",d),l(d);continue}if("error"in u){l(this.getRpcError(c,u));continue}o(u.result)}}catch(i){this.emit("debug",{action:"receiveRpcError",error:i});for(const{reject:o}of n)o(i)}})()}},e)}constructor(e,s){super(e,s),this.#t=1,this.#e=Object.assign({},Jm,s||{}),this.#s=[],this.#n=null,this.#o=null,this.#i=null;{let r=null;const i=new Promise(o=>{r=o});this.#r={promise:i,resolve:r}}const n=this._getOption("staticNetwork");typeof n=="boolean"?(P(!n||e!=="any","staticNetwork cannot be used on special network 'any'","options",s),n&&e!=null&&(this.#o=Ss.from(e))):n&&(P(e==null||n.matches(e),"staticNetwork MUST match network object","options",s),this.#o=n)}_getOption(e){return this.#e[e]}get _network(){return j(this.#o,"network is not available yet","NETWORK_ERROR"),this.#o}async _perform(e){if(e.method==="call"||e.method==="estimateGas"){let n=e.transaction;if(n&&n.type!=null&&he(n.type)&&n.maxFeePerGas==null&&n.maxPriorityFeePerGas==null){const r=await this.getFeeData();r.maxFeePerGas==null&&r.maxPriorityFeePerGas==null&&(e=Object.assign({},e,{transaction:Object.assign({},n,{type:void 0})}))}}const s=this.getRpcRequest(e);return s!=null?await this.send(s.method,s.args):super._perform(e)}async _detectNetwork(){const e=this._getOption("staticNetwork");if(e)if(e===!0){if(this.#o)return this.#o}else return e;return this.#i?await this.#i:this.ready?(this.#i=(async()=>{try{const s=Ss.from(he(await this.send("eth_chainId",[])));return this.#i=null,s}catch(s){throw this.#i=null,s}})(),await this.#i):(this.#i=(async()=>{const s={id:this.#t++,method:"eth_chainId",params:[],jsonrpc:"2.0"};this.emit("debug",{action:"sendRpcPayload",payload:s});let n;try{n=(await this._send(s))[0],this.#i=null}catch(r){throw this.#i=null,this.emit("debug",{action:"receiveRpcError",error:r}),r}if(this.emit("debug",{action:"receiveRpcResult",result:n}),"result"in n)return Ss.from(he(n.result));throw this.getRpcError(s,n)})(),await this.#i)}_start(){this.#r==null||this.#r.resolve==null||(this.#r.resolve(),this.#r=null,(async()=>{for(;this.#o==null&&!this.destroyed;)try{this.#o=await this._detectNetwork()}catch(e){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",ht("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:e}})),await tE(1e3)}this.#a()})())}async _waitUntilReady(){if(this.#r!=null)return await this.#r.promise}_getSubscriber(e){return e.type==="pending"?new XA(this):e.type==="event"?this._getOption("polling")?new pu(this,e.filter):new ZA(this,e.filter):e.type==="orphan"&&e.filter.orphan==="drop-log"?new zm("orphan"):super._getSubscriber(e)}get ready(){return this.#r==null}getRpcTransaction(e){const s={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(n=>{if(e[n]==null)return;let r=n;n==="gasLimit"&&(r="gas"),s[r]=Hs(he(e[n],`tx.${n}`))}),["from","to","data"].forEach(n=>{e[n]!=null&&(s[n]=oe(e[n]))}),e.accessList&&(s.accessList=Ir(e.accessList)),e.blobVersionedHashes&&(s.blobVersionedHashes=e.blobVersionedHashes.map(n=>n.toLowerCase())),e.authorizationList&&(s.authorizationList=e.authorizationList.map(n=>{const r=tm(n);return{address:r.address,nonce:Hs(r.nonce),chainId:Hs(r.chainId),yParity:Hs(r.signature.yParity),r:Hs(r.signature.r),s:Hs(r.signature.s)}})),s}getRpcRequest(e){switch(e.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Mr(e.address),e.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Mr(e.address),e.blockTag]};case"getCode":return{method:"eth_getCode",args:[Mr(e.address),e.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Mr(e.address),"0x"+e.position.toString(16),e.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[e.signedTransaction]};case"getBlock":if("blockTag"in e)return{method:"eth_getBlockByNumber",args:[e.blockTag,!!e.includeTransactions]};if("blockHash"in e)return{method:"eth_getBlockByHash",args:[e.blockHash,!!e.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[e.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[e.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(e.transaction),e.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(e.transaction)]};case"getLogs":return e.filter&&e.filter.address!=null&&(Array.isArray(e.filter.address)?e.filter.address=e.filter.address.map(Mr):e.filter.address=Mr(e.filter.address)),{method:"eth_getLogs",args:[e.filter]}}return null}getRpcError(e,s){const{method:n}=e,{error:r}=s;if(n==="eth_estimateGas"&&r.message){const l=r.message;if(!l.match(/revert/i)&&l.match(/insufficient funds/i))return ht("insufficient funds","INSUFFICIENT_FUNDS",{transaction:e.params[0],info:{payload:e,error:r}});if(l.match(/nonce/i)&&l.match(/too low/i))return ht("nonce has already been used","NONCE_EXPIRED",{transaction:e.params[0],info:{payload:e,error:r}})}if(n==="eth_call"||n==="eth_estimateGas"){const l=bc(r),c=Zn.getBuiltinCallException(n==="eth_call"?"call":"estimateGas",e.params[0],l?l.data:null);return c.info={error:r,payload:e},c}const i=JSON.stringify(rE(r));if(typeof r.message=="string"&&r.message.match(/user denied|ethers-user-denied/i))return ht("user rejected action","ACTION_REJECTED",{action:{eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"}[n]||"unknown",reason:"rejected",info:{payload:e,error:r}});if(n==="eth_sendRawTransaction"||n==="eth_sendTransaction"){const l=e.params[0];if(i.match(/insufficient funds|base fee exceeds gas limit/i))return ht("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:l,info:{error:r}});if(i.match(/nonce/i)&&i.match(/too low/i))return ht("nonce has already been used","NONCE_EXPIRED",{transaction:l,info:{error:r}});if(i.match(/replacement transaction/i)&&i.match(/underpriced/i))return ht("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:l,info:{error:r}});if(i.match(/only replay-protected/i))return ht("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:n,info:{transaction:l,info:{error:r}}})}let o=!!i.match(/the method .* does not exist/i);return o||r&&r.details&&r.details.startsWith("Unauthorized method:")&&(o=!0),o?ht("unsupported operation","UNSUPPORTED_OPERATION",{operation:e.method,info:{error:r,payload:e}}):ht("could not coalesce error","UNKNOWN_ERROR",{error:r,payload:e})}send(e,s){if(this.destroyed)return Promise.reject(ht("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e}));const n=this.#t++,r=new Promise((i,o)=>{this.#s.push({resolve:i,reject:o,payload:{method:e,params:s,id:n,jsonrpc:"2.0"}})});return this.#a(),r}async getSigner(e){e==null&&(e=0);const s=this.send("eth_accounts",[]);if(typeof e=="number"){const r=await s;if(e>=r.length)throw new Error("no such account");return new Ol(this,r[e])}const{accounts:n}=await rs({network:this.getNetwork(),accounts:s});e=Qe(e);for(const r of n)if(Qe(r)===e)return new Ol(this,e);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map(s=>new Ol(this,s))}destroy(){this.#n&&(clearTimeout(this.#n),this.#n=null);for(const{payload:e,reject:s}of this.#s)s(ht("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:e.method}));this.#s=[],super.destroy()}}class nE extends sE{#e;constructor(e,s){super(e,s);let n=this._getOption("pollingInterval");n==null&&(n=Jm.pollingInterval),this.#e=n}_getSubscriber(e){const s=super._getSubscriber(e);return Ef(s)&&(s.pollingInterval=this.#e),s}get pollingInterval(){return this.#e}set pollingInterval(e){if(!Number.isInteger(e)||e<0)throw new Error("invalid interval");this.#e=e,this._forEachSubscriber(s=>{Ef(s)&&(s.pollingInterval=this.#e)})}}function bc(t){if(t==null)return null;if(typeof t.message=="string"&&t.message.match(/revert/i)&&ct(t.data))return{message:t.message,data:t.data};if(typeof t=="object"){for(const e in t){const s=bc(t[e]);if(s)return s}return null}if(typeof t=="string")try{return bc(JSON.parse(t))}catch{}return null}function wc(t,e){if(t!=null){if(typeof t.message=="string"&&e.push(t.message),typeof t=="object")for(const s in t)wc(t[s],e);if(typeof t=="string")try{return wc(JSON.parse(t),e)}catch{}}}function rE(t){const e=[];return wc(t,e),e}class cs extends nE{#e;#t;constructor(e,s,n){const r=Object.assign({},n??{},{batchMaxCount:1});P(e&&e.request,"invalid EIP-1193 provider","ethereum",e),super(s,r),this.#t=null,n&&n.providerInfo&&(this.#t=n.providerInfo),this.#e=async(i,o)=>{const l={method:i,params:o};this.emit("debug",{action:"sendEip1193Request",payload:l});try{const c=await e.request(l);return this.emit("debug",{action:"receiveEip1193Result",result:c}),c}catch(c){const u=new Error(c.message);throw u.code=c.code,u.data=c.data,u.payload=l,this.emit("debug",{action:"receiveEip1193Error",error:u}),u}}}get providerInfo(){return this.#t}async send(e,s){return await this._start(),await super.send(e,s)}async _send(e){P(!Array.isArray(e),"EIP-1193 does not support batch request","payload",e);try{const s=await this.#e(e.method,e.params||[]);return[{id:e.id,result:s}]}catch(s){return[{id:e.id,error:{code:s.code,data:s.data,message:s.message}}]}}getRpcError(e,s){switch(s=JSON.parse(JSON.stringify(s)),s.error.code||-1){case 4001:s.error.message=`ethers-user-denied: ${s.error.message}`;break;case 4200:s.error.message=`ethers-unsupported: ${s.error.message}`;break}return super.getRpcError(e,s)}async hasSigner(e){e==null&&(e=0);const s=await this.send("eth_accounts",[]);return typeof e=="number"?s.length>e:(e=e.toLowerCase(),s.filter(n=>n.toLowerCase()===e).length!==0)}async getSigner(e){if(e==null&&(e=0),!await this.hasSigner(e))try{await this.#e("eth_requestAccounts",[])}catch(s){const n=s.payload;throw this.getRpcError(n,{id:n.id,error:s})}return await super.getSigner(e)}static async discover(e){if(e==null&&(e={}),e.provider)return new cs(e.provider);const s=e.window?e.window:typeof window<"u"?window:null;if(s==null)return null;const n=e.anyProvider;if(n&&s.ethereum)return new cs(s.ethereum);if(!("addEventListener"in s&&"dispatchEvent"in s&&"removeEventListener"in s))return null;const r=e.timeout?e.timeout:300;return r===0?null:await new Promise((i,o)=>{let l=[];const c=f=>{l.push(f.detail),n&&u()},u=()=>{if(clearTimeout(d),l.length)if(e&&e.filter){const f=e.filter(l.map(h=>Object.assign({},h.info)));if(f==null)i(null);else if(f instanceof cs)i(f);else{let h=null;if(f.uuid&&(h=l.filter(T=>f.uuid===T.info.uuid)[0]),h){const{provider:y,info:T}=h;i(new cs(y,void 0,{providerInfo:T}))}else o(ht("filter returned unknown info","UNSUPPORTED_OPERATION",{value:f}))}}else{const{provider:f,info:h}=l[0];i(new cs(f,void 0,{providerInfo:h}))}else i(null);s.removeEventListener("eip6963:announceProvider",c)},d=setTimeout(()=>{u()},r);s.addEventListener("eip6963:announceProvider",c),s.dispatchEvent(new Event("eip6963:requestProvider"))})}}const ui=fe(!1),Cs=fe(""),os=fe(null),mu=fe(""),Za=fe("ETH"),Xa=fe(0n),di=fe(null),wa=fe(null),Aa=mo([]),js=fe(""),Ns=fe(""),Ac=fe(!1),iE=fe("tokens");let Xt=null,qm=null,Ea=!1,ji=null,Ec=!1;const oE={1:[{address:"0x7b21325dcB87A8167A7eFF504ec876C0F520dc17",label:"PWL-P"},{address:"#",label:"PWL-P"},{address:"#",label:"PWL-I"}],11155111:[{address:"0xYOUR_PWLP_SEPOLIA",label:"PWL-P"},{address:"0xYOUR_PWLI_SEPOLIA",label:"PWL-I"}]},Zm=["function balanceOf(address) view returns (uint256)","function decimals() view returns (uint8)","function symbol() view returns (string)","function name() view returns (string)"],aE=Ae(()=>Cs.value||""),lE=Ae(()=>{const t=Cs.value;return t?`${t.slice(0,6)}...${t.slice(-4)}`:""}),cE=Ae(()=>{try{return Xt?_t(Xa.value):"0"}catch{return"0"}}),Xm=Ae(()=>di.value?(Number(_t(Xa.value))*di.value).toLocaleString(void 0,{maximumFractionDigits:2}):"0"),uE=Ae(()=>`AUD$${Xm.value||"0"} AUD`);function dE(t,e){try{return Number(to(t,e)).toLocaleString(void 0,{maximumFractionDigits:6})}catch{return"0"}}function _f(t,e){return t().catch(()=>e)}function fE(t){return t&&t[0].toUpperCase()+t.slice(1)}function Hi(t){const e=t&&(t.reason||t.message)?t.reason||t.message:String(t);return e.toLowerCase().includes("user rejected")?"User rejected the request.":e}function eg(){window.ethereum&&(window.ethereum.on("accountsChanged",tg),window.ethereum.on("chainChanged",sg),Xt&&!Ea&&(ji=async()=>{try{await yu()}catch{}},Xt.on("block",ji),Ea=!0))}function hE(){window.ethereum&&(window.ethereum.removeListener("accountsChanged",tg),window.ethereum.removeListener("chainChanged",sg)),Xt&&Ea&&ji&&(Xt.removeListener("block",ji),Ea=!1,ji=null)}async function tg(t){if(console.log("🔄 Accounts changed:",t),!t||t.length===0)ng();else{const e=Cs.value;Cs.value=t[0],e&&e!==t[0]&&(console.log("🔄 Wallet address changed from",e,"to",t[0]),window.dispatchEvent(new CustomEvent("walletAddressChanged",{detail:{oldAddress:e,newAddress:t[0]}}))),await gu()}}async function sg(){await gu()}async function pE(){try{const t=Za.value==="MATIC"?"matic-network":"ethereum",s=await(await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${t}&vs_currencies=aud&include_24hr_change=true`)).json();di.value=s?.[t]?.aud||null,wa.value=s?.[t]?.aud_24h_change||null}catch{di.value=null,wa.value=null}}async function mE(){console.log("🔄 useWallet connect() called"),Ns.value="",js.value="";try{if(!window.ethereum){console.log("❌ MetaMask not detected"),js.value="MetaMask not detected. Please install MetaMask extension.";return}console.log("🔗 Creating provider..."),Xt=new cs(window.ethereum,"any"),console.log("📝 Requesting accounts...");const t=await Xt.send("eth_requestAccounts",[]);if(console.log("📋 Received accounts:",t),!t||t.length===0){console.log("❌ No accounts found"),Ns.value="No accounts found. Please unlock your wallet or create a new account.";return}console.log("🔐 Getting signer..."),qm=await Xt.getSigner(),Cs.value=t[0],ui.value=!0,console.log("🔄 Refreshing wallet data..."),await rg(),await yu(),await vu(),eg(),console.log("✅ Wallet connected successfully:",t[0]),window.dispatchEvent(new CustomEvent("walletConnected",{detail:{address:t[0],chainId:os.value}}))}catch(t){console.error("❌ Wallet connection failed:",t),t.code===4001?Ns.value="User rejected the connection request.":t.code===-32002?Ns.value="Connection request already pending. Please check your MetaMask.":t.message.includes("User denied")?Ns.value="Connection was denied. Please approve the connection in MetaMask.":t.message.includes("Already processing")?Ns.value="MetaMask is already processing a request. Please wait and try again.":Ns.value=Hi(t)}}async function ng(){const t=ui.value,e=Cs.value;try{window.ethereum&&window.ethereum.disconnect&&(console.log("🔌 Attempting to disconnect from MetaMask..."),await window.ethereum.disconnect()),localStorage.removeItem("walletConnected"),localStorage.removeItem("walletAddress"),localStorage.removeItem("primaryWallet");const n=JSON.parse(localStorage.getItem("linkedWallets")||"[]").filter(r=>r!==e);localStorage.setItem("linkedWallets",JSON.stringify(n))}catch(s){console.warn("MetaMask disconnect failed, continuing with local disconnect:",s)}ui.value=!1,Cs.value="",os.value=null,mu.value="",Za.value="ETH",Xa.value=0n,di.value=null,wa.value=null,Aa.splice(0),hE(),t&&(console.log("🔌 Wallet disconnected, triggering event..."),window.dispatchEvent(new CustomEvent("walletDisconnected",{detail:{address:e}})))}async function gu(){ui.value&&(await rg(),await yu(),await vu())}async function rg(){const t=await Xt.getNetwork();os.value=Number(t.chainId),mu.value=t.name&&t.name!=="unknown"?fE(t.name):`Chain ${os.value}`,Za.value=os.value===1?"ETH":os.value===137?"MATIC":(os.value===42161||os.value===10,"ETH"),pE()}async function yu(){Xa.value=await Xt.getBalance(Cs.value)}async function vu(){Ac.value=!0,Aa.splice(0);try{const t=oE[os.value]||[],e=bu(os.value),s=[...t,...e];for(const n of s)if(fa(n.address))try{const r=new Wt(n.address,Zm,Xt);let i=!1;try{await r.symbol(),i=!0}catch(f){console.warn(`合约 ${n.address} 不存在或不是ERC20代币:`,f.message);continue}if(!i)continue;const[o,l,c,u]=await Promise.all([r.balanceOf(Cs.value).catch(f=>(console.warn(`查询 ${n.address} 余额失败:`,f.message),0n)),r.decimals().catch(f=>(console.warn(`获取 ${n.address} 小数位失败:`,f.message),18)),_f(()=>r.symbol(),n.label||"TKN"),_f(()=>r.name(),n.label||"Token")]),d=dE(o,l);Aa.push({address:n.address,symbol:c||n.label||"TKN",name:u||n.label||"Token",decimals:l,displayBalance:d})}catch(r){console.warn(`处理代币 ${n.address} 时出错:`,r.message),n.source==="ImportFromUs"&&(console.log(`移除无效的自定义代币: ${n.address}`),ag(n.address));continue}}catch(t){Ns.value=Hi(t)}finally{Ac.value=!1}}function gE(){Cs.value&&navigator.clipboard.writeText(Cs.value)}function ig(t){return`customTokens:${t||""}`}function bu(t){try{const e=sessionStorage.getItem(ig(t)),s=e?JSON.parse(e):[];return Array.isArray(s)?s.filter(n=>n&&n.address):[]}catch{return[]}}function og(t,e){try{sessionStorage.setItem(ig(t),JSON.stringify(e||[]))}catch{}}async function yE(t,e){try{if(!fa(t))return js.value="Invalid token address format.",!1;const s=bu(os.value);if(s.find(n=>n.address.toLowerCase()===t.toLowerCase()))return js.value="Token already exists in your list.",!0;if(Xt)try{const n=new Wt(t,Zm,Xt),[r,i,o]=await Promise.all([n.symbol().catch(()=>"UNKNOWN"),n.name().catch(()=>"Unknown Token"),n.decimals().catch(()=>18)]);console.log(`✅ 合约 ${t} 验证成功:`,{symbol:r,name:i,decimals:o});let l=e||r||"Token";(r==="LPT"||r==="LIT")&&(l=`${r} (RWA ${r==="LPT"?"本金币":"利息币"})`),s.push({address:t,label:l,addedAt:Date.now(),source:"ImportFromUs",symbol:r,name:i,decimals:o})}catch(n){return console.error(`❌ 合约 ${t} 验证失败:`,n.message),n.code==="BAD_DATA"||n.message.includes("could not decode result data")?js.value="Contract address is invalid or not an ERC20 token.":n.code==="CALL_EXCEPTION"?js.value="Contract call failed. Please check the address and network.":js.value=`Contract validation failed: ${n.message}`,!1}else s.push({address:t,label:e||"Token",addedAt:Date.now(),source:"ImportFromUs",unverified:!0});return og(os.value,s),js.value="",!0}catch(s){return js.value=`Failed to add token: ${s.message}`,!1}}function ag(t){try{const e=bu(os.value).filter(s=>s.address.toLowerCase()!==(t||"").toLowerCase());og(os.value,e)}catch{}}function Tf(){if(!Ec){if(Ec=!0,!window.ethereum){js.value="MetaMask not detected.";return}try{Xt=new cs(window.ethereum,"any"),Xt.send("eth_accounts",[]).then(async t=>{if(t&&t.length>0)try{qm=await Xt.getSigner(),Cs.value=t[0],ui.value=!0,await gu(),eg()}catch(e){console.error("Failed to initialize wallet:",e),Ns.value=Hi(e)}}).catch(t=>{console.error("Failed to get accounts:",t),Ns.value=Hi(t)})}catch(t){console.error("Failed to create provider:",t),Ns.value=Hi(t)}}}function zt(){return Tf(),mi(()=>{Ec||Tf()}),Na(()=>{}),{connected:ui,address:Cs,fullAddress:aE,shortAddress:lE,chainId:os,networkLabel:mu,nativeSymbol:Za,nativeBalanceDisplay:cE,nativeToAudDisplay:Xm,bigAudDisplay:uE,tokens:Aa,warning:js,error:Ns,loadingTokens:Ac,activeTab:iE,audPrice:di,priceChange24h:wa,connect:mE,disconnect:ng,refreshTokens:vu,copyAddress:gE,addCustomToken:yE,removeCustomToken:ag}}const lg="/icons/RWA-logo.svg",vE="/icons/search-icon.png",It=(t,e)=>{const s=t.__vccOpts||t;for(const[n,r]of e)s[n]=r;return s},bE={name:"AppHeader",props:{},setup(){const{connected:t,fullAddress:e,shortAddress:s,connect:n,disconnect:r}=zt();return{connected:t,fullAddress:e,shortAddress:s,connect:n,disconnect:r}},data(){return{searchOpen:!1,searchText:"",isLoggedIn:!1,moreDropdownOpen:!1,mobileMenuOpen:!1,walletDropdownOpen:!1,showLinkWalletModal:!1,showDisconnectModal:!1,showDisconnectSuccess:!1,disconnectSuccessMsg:"",availableAccounts:[],selectedAccountIndex:-1,loadingAccounts:!1,accountBalances:{}}},methods:{noop(){},go(t){this.$router.push(t),this.closeSearch(),this.closeMoreDropdown(),this.closeMobileMenu()},toggleMoreDropdown(){this.moreDropdownOpen=!this.moreDropdownOpen,this.closeSearch(),this.closeMobileMenu()},closeMoreDropdown(){this.moreDropdownOpen=!1},toggleWalletDropdown(){this.walletDropdownOpen=!this.walletDropdownOpen,this.updateArrowRotation()},hideWalletDropdown(){this.walletDropdownOpen=!1,this.updateArrowRotation()},updateArrowRotation(){this.$nextTick(()=>{const t=this.$el.querySelector(".dropdown-arrow");t&&(t.style.transform=this.walletDropdownOpen?"rotate(180deg)":"rotate(0deg)")})},toggleMobileMenu(){this.mobileMenuOpen=!this.mobileMenuOpen,this.closeSearch(),this.closeMoreDropdown()},closeMobileMenu(){this.mobileMenuOpen=!1},checkLogin(){this.isLoggedIn=mr()},logout(){Av(),this.$router.push("/login")},toggleSearch(){this.searchOpen=!this.searchOpen,this.$nextTick(()=>{this.searchOpen&&this.$refs.searchInput&&this.$refs.searchInput.focus()})},closeSearch(){this.searchOpen=!1,this.searchText=""},submitSearch(){this.$emit("search",this.searchText)},onDocClick(t){const e=this.$refs.searchInput,s=this.$el.querySelector(".search-toggle"),n=this.$el.querySelector(".dropdown-container"),r=this.$el.querySelector(".mobile-menu-btn"),i=this.$el.querySelector(".mobile-menu"),o=this.$el.querySelector(".wallet-dropdown-container");e&&this.searchOpen&&!e.contains(t.target)&&!s.contains(t.target)&&this.closeSearch(),n&&this.moreDropdownOpen&&!n.contains(t.target)&&this.closeMoreDropdown(),o&&this.walletDropdownOpen&&!o.contains(t.target)&&this.hideWalletDropdown(),i&&this.mobileMenuOpen&&!i.contains(t.target)&&!r.contains(t.target)&&this.closeMobileMenu()},async connectWallet(){try{await this.connect(),console.log("Wallet connected successfully")}catch(t){console.error("Wallet connection failed:",t)}},shortenAddress(t){return t.slice(0,6)+"..."+t.slice(-4)},goToWallet(){this.go("/wallet")},goToProfile(){this.go("/profile")},linkNewWallet(){this.hideWalletDropdown(),this.connectWallet()},addManualWallet(){this.hideWalletDropdown();const t=prompt("请输入钱包地址:");t&&t.trim()&&this.addManualWalletAddress(t.trim())},addManualWalletAddress(t){if(t.length===42&&t.startsWith("0x")){const e=JSON.parse(localStorage.getItem("linkedWallets")||"[]");e.includes(t)?alert("该钱包地址已存在"):(e.push(t),localStorage.setItem("linkedWallets",JSON.stringify(e)),alert(`钱包地址 ${t} 已添加`),this.$emit("wallet-added",t))}else alert("请输入有效的以太坊地址")},setPrimaryWallet(){this.hideWalletDropdown();const t=JSON.parse(localStorage.getItem("linkedWallets")||"[]"),e=localStorage.getItem("walletAddress");if(t.length===0){alert("没有可设置的钱包地址");return}let s=t.map((i,o)=>`${o+1}. ${i}${i===e?" (当前)":""}`).join(`
`);const n=prompt(`选择要设置为主钱包的地址:
${s}

请输入序号:`),r=parseInt(n)-1;if(r>=0&&r<t.length){const i=t[r];localStorage.setItem("primaryWallet",i),localStorage.setItem("walletAddress",i),alert(`主钱包已设置为: ${i}`),this.$emit("primary-wallet-changed",i)}else n!==null&&alert("无效的选择")},async linkNewWallet(){this.hideWalletDropdown(),this.showLinkWalletModal=!0,await this.loadAvailableAccounts()},async loadAvailableAccounts(){this.loadingAccounts=!0,this.availableAccounts=[],this.selectedAccountIndex=-1,this.accountBalances={};try{if(typeof window.ethereum<"u"){const t=await window.ethereum.request({method:"eth_accounts"}),e=this.fullAddress;this.availableAccounts=t.filter(s=>s.toLowerCase()!==e.toLowerCase()),console.log("Available accounts:",this.availableAccounts),await this.loadAccountBalances()}else console.error("MetaMask not detected")}catch(t){console.error("Failed to load accounts:",t)}finally{this.loadingAccounts=!1}},async loadAccountBalances(){for(const t of this.availableAccounts)try{const e=await window.ethereum.request({method:"eth_getBalance",params:[t,"latest"]}),s=(parseInt(e,16)/Math.pow(10,18)).toFixed(4);this.accountBalances[t]=s,this.$forceUpdate()}catch(e){console.error(`Failed to get balance for ${t}:`,e),this.accountBalances[t]="Error"}},generateWalletAvatar(t){const e=this.simpleHash(t),s=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FFEAA7","#DDA0DD","#98D8C8","#F7DC6F","#BB8FCE","#85C1E9"],i=`
        <svg width="80" height="80" xmlns="http://www.w3.org/2000/svg">
          <rect width="80" height="80" fill="${s[e%s.length]}" rx="40"/>
          <text x="40" y="45" font-family="Arial, sans-serif" font-size="24" font-weight="bold" 
                text-anchor="middle" fill="#FFFFFF">
            ${t.slice(2,4).toUpperCase()}
          </text>
        </svg>
      `;return`data:image/svg+xml;base64,${btoa(i)}`},simpleHash(t){let e=0;for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);e=(e<<5)-e+n,e=e&e}return Math.abs(e)},selectAccount(t){this.selectedAccountIndex=t},formatAddress(t){return t?`${t.slice(0,6)}...${t.slice(-4)}`:""},async linkSelectedAccount(){if(this.selectedAccountIndex!==-1)try{const t=this.availableAccounts[this.selectedAccountIndex];await window.ethereum.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]}),await window.ethereum.request({method:"eth_requestAccounts"}),this.showLinkWalletModal=!1,console.log("Account switched successfully to:",t),alert(`Successfully linked account: ${this.formatAddress(t)}`)}catch(t){console.error("Failed to link account:",t),t.code===4001?alert("User rejected the account switch request."):alert("Failed to link account. Please try again.")}},disconnectWallet(){this.hideWalletDropdown(),this.showDisconnectModal=!0},async confirmDisconnect(){try{await this.disconnect(),this.showDisconnectModal=!1,this.showDisconnectSuccess=!0,this.disconnectSuccessMsg="Wallet has been disconnected successfully.",console.log("Wallet disconnected successfully")}catch(t){console.error("Wallet disconnection failed:",t),this.showDisconnectModal=!1,alert("Failed to disconnect wallet. Please try again.")}},disconnectWalletConnection(t){const s=JSON.parse(localStorage.getItem("linkedWallets")||"[]").filter(r=>r!==t);localStorage.setItem("linkedWallets",JSON.stringify(s)),localStorage.getItem("walletAddress")===t&&(localStorage.removeItem("walletConnected"),localStorage.removeItem("walletAddress"),localStorage.removeItem("primaryWallet")),alert(`钱包 ${t} 已断开连接`),this.$emit("wallet-disconnected",t)}},mounted(){document.addEventListener("click",this.onDocClick),this.checkLogin(),window.addEventListener(cd,this.checkLogin),this.isLoggedIn=mr()},beforeUnmount(){document.removeEventListener("click",this.onDocClick),window.removeEventListener(cd,this.checkLogin)}},wE={key:0,class:"modal-mask"},AE={class:"modal-wrapper"},EE={class:"modal-container"},_E={key:0,class:"account-grid"},TE=["onClick"],PE={class:"wallet-avatar"},kE=["src","alt"],SE={class:"account-details"},CE={class:"account-name"},IE={class:"account-address"},RE={key:0,class:"account-balance"},DE={key:1,class:"account-balance"},xE={key:0,class:"selection-indicator"},NE={key:1,class:"loading-accounts"},LE={key:2,class:"no-accounts"},OE={style:{"text-align":"right","margin-top":"20px"}},UE=["disabled"],BE={key:1,class:"modal-mask"},ME={class:"modal-wrapper"},FE={class:"modal-container"},VE={style:{display:"block","font-size":"15px",padding:"8px 0",color:"#ffffff",background:"#2a2a4a","border-radius":"8px"}},$E={style:{"text-align":"right"}},jE={key:2,class:"modal-mask"},HE={class:"modal-wrapper"},WE={class:"modal-container"},YE={style:{color:"#ffffff"}},GE={style:{"text-align":"right"}},KE={class:"header"},zE={class:"container nav"},QE={class:"left"},JE={class:"menu","aria-label":"Primary"},qE={class:"dropdown-container"},ZE={key:0,class:"dropdown-menu"},XE={class:"right"},e2={class:"search-wrapper"},t2={key:0},s2={key:0,class:"wallet-connect-section"},n2={key:1,class:"wallet-dropdown-container"},r2={class:"wallet-btn-wrapper"},i2={key:0,class:"wallet-dropdown-menu"},o2={key:1},a2={key:0,class:"mobile-menu"},l2={class:"mobile-menu-content"};function c2(t,e,s,n,r,i){return m(),g(me,null,[r.showLinkWalletModal?(m(),g("div",wE,[a("div",AE,[a("div",EE,[e[37]||(e[37]=a("h2",{style:{"margin-bottom":"8px",color:"#ffffff"}},"Link New Wallet",-1)),e[38]||(e[38]=a("p",{style:{color:"#ffffff"}},"Select a MetaMask account to link to your profile:",-1)),r.availableAccounts.length>0?(m(),g("div",_E,[(m(!0),g(me,null,dt(r.availableAccounts,(o,l)=>(m(),g("div",{key:o,class:be(["account-card",{selected:r.selectedAccountIndex===l}]),onClick:c=>i.selectAccount(l)},[a("div",PE,[a("img",{src:i.generateWalletAvatar(o),alt:`Wallet ${l+1}`,class:"avatar-image"},null,8,kE),e[33]||(e[33]=a("div",{class:"avatar-overlay"},[a("span",{class:"avatar-icon"},"🦊")],-1))]),a("div",SE,[a("div",CE,"Account "+p(l+1),1),a("div",IE,p(i.formatAddress(o)),1),r.accountBalances[o]?(m(),g("div",RE,p(r.accountBalances[o])+" ETH ",1)):(m(),g("div",DE," Loading... "))]),r.selectedAccountIndex===l?(m(),g("div",xE,[...e[34]||(e[34]=[a("div",{class:"checkmark"},"✓",-1)])])):B("",!0)],10,TE))),128))])):B("",!0),r.loadingAccounts?(m(),g("div",NE,[...e[35]||(e[35]=[a("div",{class:"loading-spinner"},null,-1),a("span",null,"Loading accounts...",-1)])])):B("",!0),!r.loadingAccounts&&r.availableAccounts.length===0?(m(),g("div",LE,[...e[36]||(e[36]=[a("p",null,"No additional accounts found in MetaMask.",-1),a("p",null,"Please add more accounts in MetaMask and try again.",-1)])])):B("",!0),a("div",OE,[a("button",{class:"mm-btn mm-outline",onClick:e[0]||(e[0]=o=>r.showLinkWalletModal=!1)},"Cancel"),r.availableAccounts.length>0?(m(),g("button",{key:0,class:"mm-btn mm-primary",style:{"margin-left":"8px"},onClick:e[1]||(e[1]=(...o)=>i.linkSelectedAccount&&i.linkSelectedAccount(...o)),disabled:r.selectedAccountIndex===-1}," Link Selected Account ",8,UE)):B("",!0)])])])])):B("",!0),r.showDisconnectModal?(m(),g("div",BE,[a("div",ME,[a("div",FE,[e[39]||(e[39]=a("h2",{style:{"margin-bottom":"8px",color:"#ffffff"}},"Disconnect Wallet",-1)),e[40]||(e[40]=a("p",{style:{color:"#ffffff"}},"Are you sure you want to disconnect this wallet?",-1)),a("div",null,[a("span",VE,p(n.fullAddress),1)]),a("div",$E,[a("button",{class:"mm-btn mm-outline",onClick:e[2]||(e[2]=o=>r.showDisconnectModal=!1)},"Cancel"),a("button",{class:"mm-btn mm-outline",style:{"margin-left":"8px"},onClick:e[3]||(e[3]=(...o)=>i.confirmDisconnect&&i.confirmDisconnect(...o))},"Confirm")])])])])):B("",!0),r.showDisconnectSuccess?(m(),g("div",jE,[a("div",HE,[a("div",WE,[e[41]||(e[41]=a("h2",{style:{"margin-bottom":"8px",color:"#ffffff"}},"Wallet Disconnected",-1)),a("p",YE,p(r.disconnectSuccessMsg),1),a("div",GE,[a("button",{class:"mm-btn mm-outline",onClick:e[4]||(e[4]=o=>r.showDisconnectSuccess=!1)},"Confirm")])])])])):B("",!0),a("header",KE,[a("div",zE,[a("div",QE,[a("a",{class:"brand",href:"#",onClick:e[5]||(e[5]=ue(o=>i.go("/"),["prevent"]))},[...e[42]||(e[42]=[a("img",{src:lg,alt:"Mortgage RWA",class:"brand-logo"},null,-1)])]),a("nav",JE,[a("a",{href:"#",onClick:e[6]||(e[6]=ue(o=>i.go("/home"),["prevent"])),class:"menu-item"},"Home"),a("a",{href:"#",onClick:e[7]||(e[7]=ue(o=>i.go("/listedprojects"),["prevent"])),class:"menu-item"},"Listed Projects"),a("a",{href:"#",onClick:e[8]||(e[8]=ue(o=>i.go("/to-be-listed"),["prevent"])),class:"menu-item"},"To be listed"),a("a",{href:"#",onClick:e[9]||(e[9]=ue(o=>i.go("/portfolio"),["prevent"])),class:"menu-item"},"Portfolio"),a("div",qE,[a("a",{href:"#",class:"menu-item more-link",onClick:e[10]||(e[10]=ue((...o)=>i.toggleMoreDropdown&&i.toggleMoreDropdown(...o),["prevent"]))},"More ▾"),r.moreDropdownOpen?(m(),g("div",ZE,[a("a",{href:"#",onClick:e[11]||(e[11]=ue(o=>i.go("/overview"),["prevent"])),class:"dropdown-item"},"Overview"),a("a",{href:"#",onClick:e[12]||(e[12]=ue(o=>i.go("/about"),["prevent"])),class:"dropdown-item"},"About Us")])):B("",!0)])]),a("button",{class:be(["mobile-menu-btn",{active:r.mobileMenuOpen}]),onClick:e[13]||(e[13]=(...o)=>i.toggleMobileMenu&&i.toggleMobileMenu(...o)),"aria-label":"Toggle mobile menu"},[...e[43]||(e[43]=[a("span",{class:"hamburger-line"},null,-1),a("span",{class:"hamburger-line"},null,-1),a("span",{class:"hamburger-line"},null,-1)])],2)]),a("div",XE,[a("div",e2,[a("form",{class:"search-form",onSubmit:e[16]||(e[16]=ue((...o)=>i.submitSearch&&i.submitSearch(...o),["prevent"]))},[Pe(a("input",{ref:"searchInput",type:"text",class:be(["search-input",{expanded:r.searchOpen}]),placeholder:"Search...","onUpdate:modelValue":e[14]||(e[14]=o=>r.searchText=o)},null,2),[[Ze,r.searchText]]),a("button",{type:"button",class:"search-toggle",onClick:e[15]||(e[15]=(...o)=>i.toggleSearch&&i.toggleSearch(...o))},[...e[44]||(e[44]=[a("img",{src:vE,alt:"Search"},null,-1)])])],32)]),r.isLoggedIn?(m(),g("div",t2,[n.connected?(m(),g("div",n2,[a("div",r2,[a("button",{class:"btn orange pill wallet-main-btn",onClick:e[18]||(e[18]=ue(o=>i.goToWallet(),["prevent"]))},[a("span",null,p(n.shortAddress),1)]),e[47]||(e[47]=a("div",{class:"wallet-divider"},null,-1)),a("button",{class:"btn orange pill wallet-dropdown-btn",onClick:e[19]||(e[19]=ue((...o)=>i.toggleWalletDropdown&&i.toggleWalletDropdown(...o),["prevent"]))},[...e[46]||(e[46]=[a("span",{class:"dropdown-arrow"},"▾",-1)])])]),r.walletDropdownOpen?(m(),g("div",i2,[e[50]||(e[50]=a("div",{class:"wallet-dropdown-header"},"Wallet Management",-1)),a("a",{href:"#",onClick:e[20]||(e[20]=ue(o=>{r.showLinkWalletModal=!0,r.walletDropdownOpen=!1},["prevent"])),class:"wallet-dropdown-item"},[...e[48]||(e[48]=[a("span",null,"Link new wallet",-1)])]),a("a",{href:"#",onClick:e[21]||(e[21]=ue(o=>{r.showDisconnectModal=!0,r.walletDropdownOpen=!1},["prevent"])),class:"wallet-dropdown-item"},[...e[49]||(e[49]=[a("span",null,"Disconnect wallet",-1)])])])):B("",!0)])):(m(),g("div",s2,[a("button",{class:"btn orange pill",onClick:e[17]||(e[17]=ue((...o)=>i.connectWallet&&i.connectWallet(...o),["prevent"]))},[...e[45]||(e[45]=[a("span",null,"Connect Wallet",-1)])])])),a("button",{class:"btn light pill",onClick:e[22]||(e[22]=ue(o=>i.goToProfile(),["prevent"]))},[...e[51]||(e[51]=[a("span",null,"👤",-1)])]),a("button",{class:"btn ghost pill settings-btn",onClick:e[23]||(e[23]=ue(o=>i.go("/settings"),["prevent"]))},"⚙️")])):(m(),g("div",o2,[a("a",{class:"btn ghost",href:"#",onClick:e[24]||(e[24]=ue(o=>i.go("/login"),["prevent"]))},"Log in"),a("a",{class:"btn orange",href:"#",onClick:e[25]||(e[25]=ue(o=>i.go("/signup"),["prevent"]))},"Sign up")]))])]),r.mobileMenuOpen?(m(),g("div",a2,[a("div",l2,[a("a",{href:"#",onClick:e[26]||(e[26]=ue(o=>i.go("/home"),["prevent"])),class:"mobile-menu-item"},[...e[52]||(e[52]=[a("span",null,"Home",-1)])]),a("a",{href:"#",onClick:e[27]||(e[27]=ue(o=>i.go("/listedprojects"),["prevent"])),class:"mobile-menu-item"},[...e[53]||(e[53]=[a("span",null,"Listed Projects",-1)])]),a("a",{href:"#",onClick:e[28]||(e[28]=ue(o=>i.go("/to-be-listed"),["prevent"])),class:"mobile-menu-item"},[...e[54]||(e[54]=[a("span",null,"To be listed",-1)])]),a("a",{href:"#",onClick:e[29]||(e[29]=ue(o=>i.go("/portfolio"),["prevent"])),class:"mobile-menu-item"},[...e[55]||(e[55]=[a("span",null,"Portfolio",-1)])]),e[59]||(e[59]=a("div",{class:"mobile-menu-divider"},null,-1)),a("a",{href:"#",onClick:e[30]||(e[30]=ue(o=>i.go("/overview"),["prevent"])),class:"mobile-menu-item"},[...e[56]||(e[56]=[a("span",null,"Overview",-1)])]),a("a",{href:"#",onClick:e[31]||(e[31]=ue(o=>i.go("/about"),["prevent"])),class:"mobile-menu-item"},[...e[57]||(e[57]=[a("span",null,"About Us",-1)])]),a("a",{href:"#",onClick:e[32]||(e[32]=ue(o=>i.go("/contact"),["prevent"])),class:"mobile-menu-item"},[...e[58]||(e[58]=[a("span",null,"Contact Us",-1)])])])])):B("",!0)])],64)}const u2=It(bE,[["render",c2],["__scopeId","data-v-03ce8578"]]),d2={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"http://localhost:3000/api",VITE_API_LOANS_BY_CODE_URL:"http://localhost:3000/api/loans",VITE_API_LOANS_SUBSCRIPTION_URL:"http://localhost:3000/api/loans",VITE_API_LOANS_URL:"http://localhost:3000/api/loans",VITE_API_LOGIN_URL:"http://localhost:3000/user/login",VITE_API_PROJECTS_URL:"http://localhost:3000/api/projects",VITE_API_PROJECT_BY_CODE_DIRECT_URL:"http://localhost:3000/project",VITE_API_PROJECT_BY_CODE_URL:"http://localhost:3000/api/project",VITE_API_PROJECT_DIRECT_URL:"http://localhost:3000/project",VITE_API_PROJECT_SUBSCRIPTION_DIRECT_URL:"http://localhost:3000/project",VITE_API_PROJECT_SUBSCRIPTION_URL:"http://localhost:3000/api/loans",VITE_API_PROJECT_URL:"http://localhost:3000/api/project",VITE_API_REGISTER_URL:"http://localhost:3000/user/reguser",VITE_API_TRANSACTION_URL:"http://localhost:3000/api/transaction",VITE_API_USER_INFO_URL:"http://localhost:3000/user/userinfo",VITE_APP_ENV:"development",VITE_APP_NAME:"RWA Trading Platform",VITE_APP_VERSION:"1.0.0",VITE_AUTO_REFRESH_INTERVAL:"30",VITE_BACKEND_PORT:"3000",VITE_COMPLIANCE_GUARD_ADDRESS:"0x1234567890123456789012345678901234567890",VITE_COMPLIANCE_GUARD_ADDRESS_PROD:"0x1234567890123456789012345678901234567890",VITE_DB_HOST:"localhost",VITE_DB_NAME:"rwa",VITE_DB_PASSWORD:"123456",VITE_DB_PORT:"3306",VITE_DB_USER:"root",VITE_ENABLE_AUTO_REFRESH:"true",VITE_ENABLE_KYC:"true",VITE_ENABLE_TRADING:"true",VITE_INTEREST_TOKEN_ADDRESS:"0xE6aeE4a898c6d99033ee5380Df407C5DD470fb17",VITE_INTEREST_TOKEN_ADDRESS_PROD:"0xE6aeE4a898c6d99033ee5380Df407C5DD470fb17",VITE_KYC_DEFAULT_LEVEL:"3",VITE_KYC_DEFAULT_LEVEL_PROD:"3",VITE_KYC_DEFAULT_SUCCESS:"true",VITE_KYC_DEFAULT_SUCCESS_PROD:"true",VITE_KYC_REGISTRY_ADDRESS:"0x4533f47BE0ce8b80F7bbdF02939f81F4A15b7A45",VITE_KYC_REGISTRY_ADDRESS_PROD:"0x4533f47BE0ce8b80F7bbdF02939f81F4A15b7A45",VITE_LOAN_ISSUER_ADDRESS:"0x13159e6417D98528C220b12Ec4950D5A343E5eAA",VITE_LOAN_ISSUER_ADDRESS_PROD:"0x1234567890123456789012345678901234567890",VITE_NETWORK_CHAIN_ID:"11155111",VITE_NETWORK_CHAIN_ID_PROD:"1",VITE_NETWORK_NAME:"Sepolia Testnet",VITE_NETWORK_NAME_PROD:"Ethereum Mainnet",VITE_PRINCIPAL_TOKEN_ADDRESS:"0x45b1eCb3D9af651244eC656ed15B86404924c354",VITE_PRINCIPAL_TOKEN_ADDRESS_PROD:"0x45b1eCb3D9af651244eC656ed15B86404924c354",VITE_RPC_URL:"https://sepolia.infura.io/v3/YOUR_INFURA_PROJECT_ID",VITE_RPC_URL_PROD:"https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID",VITE_TRADE_CONTRACT_ADDRESS:"0x1234567890123456789012345678901234567890",VITE_TRADE_CONTRACT_ADDRESS_PROD:"0x1234567890123456789012345678901234567890"},Ul=(t,e)=>d2[t]||e,jo={async getAllProjects(){try{console.log("📊 API: 从数据库获取所有项目数据");const t=await fetch(Ul("VITE_API_PROJECT_URL","http://localhost:3000/api/project"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();return console.log("📊 API: 数据库返回数据:",e),e}catch(t){return console.error("❌ API: 获取项目数据失败:",t),{status:1,message:t instanceof Error?t.message:"Unknown error",data:[]}}},async getProjectByCode(t){try{console.log("📊 API: 从数据库根据代码获取项目:",t);const e=await fetch(`${Ul("VITE_API_PROJECT_BY_CODE_URL","http://localhost:3000/api/project")}/${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const s=await e.json();return console.log("📊 API: 数据库返回项目详情:",s),s}catch(e){return console.error("❌ API: 获取项目详情失败:",e),{status:1,message:e instanceof Error?e.message:"Unknown error",data:null}}},async searchProjects(t){try{console.log("📊 API: 搜索项目:",t);const e=await this.getAllProjects();if(e.status!==0)return e;const s=e.data||[];return!t||t.trim()===""?{status:0,message:"Success",data:s}:{status:0,message:"Success",data:s.filter(r=>{const i=t.toLowerCase();return r.code.toLowerCase().includes(i)||r.name.toLowerCase().includes(i)||r.propertyLocation.toLowerCase().includes(i)||r.propertyState.toLowerCase().includes(i)})}}catch(e){return console.error("❌ API: 搜索项目失败:",e),{status:1,message:e instanceof Error?e.message:"Unknown error",data:[]}}},async getProjectsByType(t){try{console.log("📊 API: 根据类型获取项目:",t);const e=await this.getAllProjects();if(e.status!==0)return e;const s=e.data||[];return!t||t==="all"?{status:0,message:"Success",data:s}:{status:0,message:"Success",data:s.filter(r=>r.propertyType===t)}}catch(e){return console.error("❌ API: 根据类型获取项目失败:",e),{status:1,message:e instanceof Error?e.message:"Unknown error",data:[]}}},async getProjectsByStatus(t){try{console.log("📊 API: 根据状态获取项目:",t);const e=await this.getAllProjects();if(e.status!==0)return e;const s=e.data||[];return!t||t==="all"?{status:0,message:"Success",data:s}:{status:0,message:"Success",data:s.filter(r=>r.status===t)}}catch(e){return console.error("❌ API: 根据状态获取项目失败:",e),{status:1,message:e instanceof Error?e.message:"Unknown error",data:[]}}},async updateProjectSubscription(t,e){try{console.log("📊 API: 更新项目订阅信息:",t,e);const s={subscribe_token:e.subscribed||e.subscribe_token},n=await fetch(`${Ul("VITE_API_PROJECT_SUBSCRIPTION_URL","http://localhost:3000/api/loans")}/${t}/subscription`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const r=await n.json();return console.log("📊 API: 数据库更新订阅信息结果:",r),r}catch(s){return console.error("❌ API: 更新项目订阅信息失败:",s),{status:1,message:s instanceof Error?s.message:"Unknown error",data:null}}}},Kt={...jo,getAllProducts:jo.getAllProjects,getProductByCode:jo.getProjectByCode,updateProductSubscription:jo.updateProjectSubscription},wu="userInfo",f2="userName",_c={name:"",email:"",phone:"",firstName:"",lastName:"",dob:"1990-01-01",country:"US",docType:"passport",agreeEmailUpdates:!1};function Ct(){try{const t=localStorage.getItem(wu);if(t){const e=JSON.parse(t);return{..._c,...e}}}catch(t){console.error("Failed to get user info:",t)}return{..._c}}function wr(t){try{const e={..._c,...t};localStorage.setItem(wu,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("user-info-changed",{detail:e}))}catch(e){console.error("Failed to set user info:",e)}}function _a(){return Ct().name||"User"}function cg(){return Ct().email||""}function h2(){return Ct().phone||""}function p2(){return _a().charAt(0).toUpperCase()||"U"}function ug(t){const e=t.trim().split(" "),s=e[0]||"",n=e.slice(1).join(" ")||"";return{firstName:s,lastName:n}}function m2(){localStorage.removeItem(wu),localStorage.removeItem(f2),window.dispatchEvent(new CustomEvent("user-info-changed",{detail:null}))}function g2(){const t=Ct();return!!(t.name||t.email)}function dg(t){const e={name:t.user_name||"",email:t.user_email||"",phone:t.user_phone||"",agreeEmailUpdates:t.agree_email_updates||!1,...ug(t.user_name||"")};wr(e)}function fg(t){const e=Ct();if(t.user_name){e.name=t.user_name;const{firstName:s,lastName:n}=ug(t.user_name);e.firstName=s,e.lastName=n}t.user_email&&(e.email=t.user_email),t.user_phone&&(e.phone=t.user_phone),wr(e)}const Pf="user-info-changed";class y2{constructor(){this.baseUrl="http://localhost:3000/api",this.userInfo=null,this.loading=!1,this.error=null}async getUserData(e=null){try{if(this.loading=!0,this.error=null,console.log("🔄 UserDataService: 开始获取用户信息...",{userId:e}),!e){const o=Ct();o&&o.user_id&&(e=o.user_id)}if(!e)throw new Error("用户ID未提供且本地存储中未找到");const s=[`${this.baseUrl}/user/profile/${e}`,`${this.baseUrl}/user/${e}`,`${this.baseUrl}/profile/${e}`];let n=null,r=null;for(const o of s)try{console.log(`📡 尝试端点: ${o}`);const l=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(console.log(`📡 ${o} 响应状态:`,l.status),l.ok){const c=await l.json();if(console.log(`✅ ${o} 返回数据:`,c),c.status===0&&c.data){n=c.data;break}else if(c.user_id||c.user_name){n=c;break}}}catch(l){console.warn(`⚠️ 端点 ${o} 失败:`,l.message),r=l}if(!n)throw r||new Error("所有API端点都无法获取用户数据");const i=this.standardizeUserData(n);return wr(i),this.userInfo=i,console.log("✅ UserDataService: 用户信息获取成功:",i),{success:!0,data:i}}catch(s){return this.error=s.message,console.error("❌ UserDataService: 获取用户信息失败:",s),{success:!1,error:s.message,data:null}}finally{this.loading=!1}}async updateUserData(e,s){try{this.loading=!0,this.error=null,console.log("🔄 UserDataService: 开始更新用户信息...",{userId:e,userData:s});const n=await fetch(`${this.baseUrl}/user/${e}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(s)});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const r=await n.json();if(r.status===0){const i={...Ct(),...s};return wr(i),this.userInfo=i,console.log("✅ UserDataService: 用户信息更新成功"),{success:!0,data:r.data}}else throw new Error(r.message||"更新失败")}catch(n){return this.error=n.message,console.error("❌ UserDataService: 更新用户信息失败:",n),{success:!1,error:n.message}}finally{this.loading=!1}}async sendEmailVerification(e){try{if(this.loading=!0,this.error=null,!this.isValidEmail(e))throw new Error("请输入有效的邮箱地址");console.log("🔄 UserDataService: 发送邮箱验证码...",{email:e});const n=await(await fetch(`${this.baseUrl}/email/verify`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({user_email:e})})).json();if(n.status===0)return console.log("✅ UserDataService: 邮箱验证码发送成功"),{success:!0,message:n.message||"验证码已发送到您的邮箱",code:n.code};throw new Error(n.message||"发送验证码失败")}catch(s){return this.error=s.message,console.error("❌ UserDataService: 发送邮箱验证码失败:",s),{success:!1,error:s.message}}finally{this.loading=!1}}async verifyEmailCode(e,s){try{if(this.loading=!0,this.error=null,!this.isValidEmail(e))throw new Error("请输入有效的邮箱地址");if(!s||s.length<4)throw new Error("请输入有效的验证码");console.log("🔄 UserDataService: 验证邮箱验证码...",{email:e,code:s});const r=await(await fetch(`${this.baseUrl}/email/verify`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({user_email:e,verification_code:s})})).json();if(r.status===0){const i=Ct();return i.email=e,i.email_verified=!0,wr(i),console.log("✅ UserDataService: 邮箱验证成功"),{success:!0,message:r.message||"邮箱验证成功"}}else throw new Error(r.message||"验证码验证失败")}catch(n){return this.error=n.message,console.error("❌ UserDataService: 验证邮箱验证码失败:",n),{success:!1,error:n.message}}finally{this.loading=!1}}getUserStatus(){const e=Ct();return{isLoggedIn:g2(),userName:_a(),userEmail:cg(),userPhone:h2(),emailVerified:e.email_verified||!1,kycStatus:e.kyc_status||"unverified",kycLevel:e.kyc_level||0,lastLogin:e.last_login||null}}updateUserStatus(e){const n={...Ct(),...e};wr(n),this.userInfo=n}clearUserData(){m2(),this.userInfo=null,this.error=null}standardizeUserData(e){return{user_id:e.user_id||e.id||null,user_name:e.user_name||e.name||e.username||"",user_email:e.user_email||e.email||"",user_phone:e.user_phone||e.phone||"",user_wallet:e.user_wallet||e.wallet_address||"",email_verified:e.email_verified||!1,kyc_status:e.kyc_status||"unverified",kyc_level:e.kyc_level||0,is_active:e.is_active!==!1,created_at:e.created_at||null,updated_at:e.updated_at||null,last_login:e.last_login||null}}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}getUserInitial(){return _a().charAt(0).toUpperCase()||"U"}setUserFromLogin(e){fg(e),this.userInfo=Ct()}setUserFromSignup(e){dg(e),this.userInfo=Ct()}}const Tc=new y2,{getUserData:dU,updateUserData:fU,sendEmailVerification:hU,verifyEmailCode:pU,getUserStatus:mU,updateUserStatus:gU,clearUserData:yU,getUserInitial:vU}=Tc;class v2{constructor(){this.baseUrl="http://localhost:3000/api",this.projects=[],this.currentProject=null,this.loading=!1,this.error=null,this.filters={q:"",type:"",status:"",minYield:0,maxYield:20},this.syncInterval=null}async getAllProjects(e={}){try{this.loading=!0,this.error=null,this.filters={...this.filters,...e},console.log("🔄 ProjectDataService: 从数据库加载项目数据...",this.filters);const s=await Kt.getAllProducts();if(s.status===0)return this.projects=(s.data||[]).map(n=>this.standardizeProjectData(n)),console.log("✅ ProjectDataService: 项目数据加载成功:",this.projects.length,"个项目"),{success:!0,data:this.projects,count:this.projects.length};throw new Error(s.message||"获取项目列表失败")}catch(s){return this.error=s.message,console.error("❌ ProjectDataService: 获取项目列表失败:",s),{success:!1,error:s.message,data:[]}}finally{this.loading=!1}}async getProjectById(e){try{this.loading=!0,this.error=null,console.log("🔄 ProjectDataService: 获取项目详情...",{projectId:e});const s=await Kt.getProductByCode(e);if(s.status===0)return this.currentProject=this.standardizeProjectData(s.data),console.log("✅ ProjectDataService: 项目详情获取成功:",this.currentProject),{success:!0,data:this.currentProject};throw new Error(s.message||"获取项目详情失败")}catch(s){return this.error=s.message,console.error("❌ ProjectDataService: 获取项目详情失败:",s),{success:!1,error:s.message,data:null}}finally{this.loading=!1}}async getProjectByCode(e){try{this.loading=!0,this.error=null,console.log("🔄 ProjectDataService: 根据代码获取项目详情...",{projectCode:e});const s=await Kt.getProductByCode(e);if(s.status===0)return this.currentProject=this.standardizeProjectData(s.data),console.log("✅ ProjectDataService: 项目详情获取成功:",this.currentProject),{success:!0,data:this.currentProject};throw new Error(s.message||"获取项目详情失败")}catch(s){return this.error=s.message,console.error("❌ ProjectDataService: 获取项目详情失败:",s),{success:!1,error:s.message,data:null}}finally{this.loading=!1}}searchProjects(e){if(!e||!e.trim())return this.projects;const s=e.trim().toLowerCase();return this.projects.filter(n=>{const r=n.code&&n.code.toLowerCase().includes(s),i=n.name&&n.name.toLowerCase().includes(s),o=n.subtitle&&n.subtitle.toLowerCase().includes(s),l=n.location&&n.location.toLowerCase().includes(s);return r||i||o||l})}filterProjects(e={}){const s={...this.filters,...e};return this.projects.filter(n=>{const r=s.q?.trim().toLowerCase()||"",i=!r||n.code&&n.code.toLowerCase().includes(r)||n.name&&n.name.toLowerCase().includes(r)||n.subtitle&&n.subtitle.toLowerCase().includes(r)||n.location&&n.location.toLowerCase().includes(r),o=!s.type||n.type===s.type,l=!s.status||n.status===s.status,c=n.estimatedYield||0,u=c>=s.minYield&&c<=s.maxYield;return i&&o&&l&&u})}getFilteredProjects(e={}){return this.filterProjects(e).sort((n,r)=>{const i=n.estimatedYield||0;return(r.estimatedYield||0)-i})}async refreshProjectData(e=!1){try{return console.log("🔄 ProjectDataService: 刷新项目数据...",{forceRefresh:e}),this.currentProject?await this.getProjectByCode(this.currentProject.code):await this.getAllProjects()}catch(s){return console.error("❌ ProjectDataService: 刷新项目数据失败:",s),{success:!1,error:s.message}}}setupDatabaseSync(e=3e4){this.syncInterval&&clearInterval(this.syncInterval),this.syncInterval=setInterval(async()=>{try{console.log("🔄 ProjectDataService: 自动同步项目数据..."),await this.refreshProjectData()}catch(s){console.error("❌ ProjectDataService: 自动同步失败:",s)}},e),console.log("✅ ProjectDataService: 数据库同步已设置，间隔:",e,"ms")}stopDatabaseSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,console.log("✅ ProjectDataService: 数据库同步已停止"))}async updateProjectStatus(e,s){try{this.loading=!0,this.error=null,console.log("🔄 ProjectDataService: 更新项目状态...",{projectCode:e,status:s});const n=await fetch(`${this.baseUrl}/project/${e}/status`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({status:s})});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const r=await n.json();if(r.status===0){const i=this.projects.findIndex(o=>o.code===e);return i!==-1&&(this.projects[i].status=s),this.currentProject&&this.currentProject.code===e&&(this.currentProject.status=s),console.log("✅ ProjectDataService: 项目状态更新成功"),{success:!0,data:r.data}}else throw new Error(r.message||"更新项目状态失败")}catch(n){return this.error=n.message,console.error("❌ ProjectDataService: 更新项目状态失败:",n),{success:!1,error:n.message}}finally{this.loading=!1}}standardizeProjectData(e){return{id:e.id||e.project_id,code:e.project_code||e.code,name:e.project_name||e.name,subtitle:e.property_summary||e.subtitle||"",status:e.loan_status||e.status||"INCOMING",subscribeToken:parseFloat(e.subscribe_token||0),totalOfferingToken:parseFloat(e.total_offering_token||0),loanAmount:parseFloat(e.loan_amount||0),interestRate:parseFloat(e.interest_rate||0),lvr:parseFloat(e.lvr||0),location:e.property_location||e.location||"",state:e.property_state||e.state||"",type:e.property_type||e.type||"",value:parseFloat(e.property_value||0),loanType:e.loan_type||"",loanProduct:e.loan_product||"",loanPurpose:e.loan_purpose||"",loanTermMonths:parseInt(e.loan_term_months||0),commencementDate:e.commencement_date||null,expiryDate:e.expiry_date||null,expectedRecoveryDate:e.expected_recovery_date||null,estimatedYield:this.calculateEstimatedYield(e),progressPercentage:this.calculateProgressPercentage(e),remainingAmount:this.calculateRemainingAmount(e),createdAt:e.created_at||null,updatedAt:e.updated_at||null,createdBy:e.created_by||null,updatedBy:e.updated_by||null}}calculateEstimatedYield(e){const s=parseFloat(e.interest_rate||0),n=parseInt(e.loan_term_months||0);return s>0&&n>0?s:0}calculateProgressPercentage(e){const s=parseFloat(e.subscribe_token||0),n=parseFloat(e.total_offering_token||0);return n>0?Math.min(s/n*100,100):0}calculateRemainingAmount(e){const s=parseFloat(e.subscribe_token||0),n=parseFloat(e.total_offering_token||0);return Math.max(n-s,0)}getCurrentState(){return{projects:this.projects,currentProject:this.currentProject,loading:this.loading,error:this.error,filters:this.filters,isSyncing:!!this.syncInterval}}clearError(){this.error=null}reset(){this.projects=[],this.currentProject=null,this.loading=!1,this.error=null,this.filters={q:"",type:"",status:"",minYield:0,maxYield:20},this.stopDatabaseSync()}}const hg=new v2,{getAllProjects:bU,getProjectById:wU,getProjectByCode:AU,searchProjects:EU,filterProjects:_U,getFilteredProjects:TU,refreshProjectData:PU,setupDatabaseSync:kU,stopDatabaseSync:SU,updateProjectStatus:CU,getCurrentState:IU,clearError:RU,reset:DU}=hg;class b2{constructor(){this.provider=null,this.signer=null,this.address=null,this.connected=!1,this.chainId=null,this.networkLabel="",this.nativeBalance=0n,this.nativeSymbol="ETH",this.audPrice=null,this.tokens=[],this.walletActivity=[],this.loading=!1,this.error=null,this.blockListenerAttached=!1,this.blockHandler=null}async connectWallet(){try{if(this.loading=!0,this.error=null,console.log("🔄 WalletService: 开始连接钱包..."),!window.ethereum)throw new Error("MetaMask未检测到，请安装MetaMask钱包");return this.provider=new cs(window.ethereum,"any"),await window.ethereum.request({method:"eth_requestAccounts"}),this.signer=await this.provider.getSigner(),this.address=await this.signer.getAddress(),this.connected=!0,await this.refreshAll(),this.attachEventListeners(),console.log("✅ WalletService: 钱包连接成功:",this.address),{success:!0,address:this.address,chainId:this.chainId,networkLabel:this.networkLabel}}catch(e){return this.error=e.message,console.error("❌ WalletService: 钱包连接失败:",e),{success:!1,error:e.message}}finally{this.loading=!1}}async disconnectWallet(){try{return console.log("🔄 WalletService: 断开钱包连接..."),this.detachEventListeners(),this.provider=null,this.signer=null,this.address=null,this.connected=!1,this.chainId=null,this.networkLabel="",this.nativeBalance=0n,this.nativeSymbol="ETH",this.audPrice=null,this.tokens=[],this.walletActivity=[],this.error=null,console.log("✅ WalletService: 钱包断开连接成功"),{success:!0,message:"钱包已断开连接"}}catch(e){return this.error=e.message,console.error("❌ WalletService: 断开钱包连接失败:",e),{success:!1,error:e.message}}}async refreshAll(){if(this.connected)try{await this.refreshNetwork(),await this.refreshNative(),await this.refreshTokens(),await this.loadWalletActivity()}catch(e){console.error("❌ WalletService: 刷新数据失败:",e)}}async refreshNetwork(){try{const e=await this.provider.getNetwork();this.chainId=Number(e.chainId),this.networkLabel=e.name&&e.name!=="unknown"?this.capitalize(e.name):`Chain ${this.chainId}`,this.nativeSymbol=this.chainId===1?"ETH":this.chainId===137?"MATIC":(this.chainId===11155111,"ETH"),await this.fetchAudPriceSafely(),console.log("✅ WalletService: 网络信息刷新成功:",this.networkLabel)}catch(e){console.error("❌ WalletService: 刷新网络信息失败:",e)}}async refreshNative(){try{this.nativeBalance=await this.provider.getBalance(this.address),console.log("✅ WalletService: 原生代币余额刷新成功:",_t(this.nativeBalance))}catch(e){console.error("❌ WalletService: 刷新原生代币余额失败:",e)}}async refreshTokens(){try{console.log("✅ WalletService: 代币余额刷新完成")}catch(e){console.error("❌ WalletService: 刷新代币余额失败:",e)}}async sendTransaction(e){try{if(this.loading=!0,this.error=null,!this.connected||!this.signer)throw new Error("钱包未连接");console.log("🔄 WalletService: 发送交易...",e);const n=await(await this.signer.sendTransaction(e)).wait();return await this.recordTransaction({hash:n.hash,from:n.from,to:n.to,value:n.value,gasUsed:n.gasUsed,blockNumber:n.blockNumber,timestamp:Date.now(),type:"transaction"}),console.log("✅ WalletService: 交易发送成功:",n.hash),{success:!0,hash:n.hash,receipt:n}}catch(s){return this.error=s.message,console.error("❌ WalletService: 发送交易失败:",s),{success:!1,error:s.message}}finally{this.loading=!1}}async sendEthTransaction(e,s,n={}){try{const r=si(s.toString()),i={to:e,value:r,...n};return await this.sendTransaction(i)}catch(r){return console.error("❌ WalletService: 发送ETH交易失败:",r),{success:!1,error:r.message}}}async getBalance(e=null){try{const s=e||this.address;if(!s)throw new Error("地址未提供");const n=await this.provider.getBalance(s);return _t(n)}catch(s){return console.error("❌ WalletService: 获取余额失败:",s),"0"}}async getTokenBalance(e,s=null){try{const n=s||this.address;if(!n)throw new Error("用户地址未提供");const r=new Wt(e,["function balanceOf(address owner) view returns (uint256)","function decimals() view returns (uint8)"],this.provider),[i,o]=await Promise.all([r.balanceOf(n),r.decimals()]);return to(i,o)}catch(n){return console.error("❌ WalletService: 获取代币余额失败:",n),"0"}}async switchNetwork(e){try{if(!window.ethereum)throw new Error("MetaMask未检测到");const s="0x"+e.toString(16);return await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:s}]}),await this.refreshNetwork(),console.log("✅ WalletService: 网络切换成功:",e),{success:!0,chainId:e}}catch(s){return console.error("❌ WalletService: 切换网络失败:",s),{success:!1,error:s.message}}}getCurrentNetwork(){return{chainId:this.chainId,networkLabel:this.networkLabel,nativeSymbol:this.nativeSymbol}}async loadWalletActivity(){try{this.loading=!0,console.log("🔄 WalletService: 加载钱包活动记录...");const e=localStorage.getItem("walletActivity");e&&(this.walletActivity=JSON.parse(e));for(const s of this.walletActivity)if(s.transactionHash&&!s.etherscan)try{const n=await this.fetchTransactionDetails(s.transactionHash);n.success&&(s.etherscan={hash:n.transaction.hash,from:n.transaction.from,to:n.transaction.to,value:n.transaction.value,gasUsed:n.receipt.gasUsed,blockNumber:n.transaction.blockNumber,timestamp:parseInt(n.transaction.timeStamp)*1e3})}catch(n){console.warn("获取交易详情失败:",n)}console.log("✅ WalletService: 钱包活动记录加载完成:",this.walletActivity.length,"条记录")}catch(e){console.error("❌ WalletService: 加载钱包活动记录失败:",e)}finally{this.loading=!1}}async recordTransaction(e){try{const s={id:Date.now().toString(),type:e.type||"transaction",transactionHash:e.hash,from:e.from,to:e.to,value:e.value,gasUsed:e.gasUsed,blockNumber:e.blockNumber,timestamp:e.timestamp||Date.now(),status:"confirmed"};this.walletActivity.unshift(s),this.walletActivity.length>100&&(this.walletActivity=this.walletActivity.slice(0,100)),localStorage.setItem("walletActivity",JSON.stringify(this.walletActivity)),window.dispatchEvent(new CustomEvent("walletActivityUpdated",{detail:{activity:s,allActivity:this.walletActivity}})),console.log("✅ WalletService: 交易记录已保存:",s.hash)}catch(s){console.error("❌ WalletService: 记录交易失败:",s)}}async fetchTransactionDetails(e){try{console.log("🔍 WalletService: 从Etherscan获取交易详情:",e);const s=`https://api-sepolia.etherscan.io/api?module=proxy&action=eth_getTransactionByHash&txhash=${e}`,n=`https://api-sepolia.etherscan.io/api?module=proxy&action=eth_getTransactionReceipt&txhash=${e}`,[r,i]=await Promise.all([fetch(s),fetch(n)]),[o,l]=await Promise.all([r.json(),i.json()]);if(o.result&&l.result)return console.log("✅ WalletService: 成功获取交易详情:",o.result),{success:!0,transaction:o.result,receipt:l.result};throw new Error("无法获取交易详情")}catch(s){return console.error("❌ WalletService: 获取交易详情失败:",s),{success:!1,error:s.message}}}attachEventListeners(){window.ethereum&&(window.ethereum.on("accountsChanged",this.handleAccountsChanged.bind(this)),window.ethereum.on("chainChanged",this.handleChainChanged.bind(this)),this.provider&&!this.blockListenerAttached&&(this.blockHandler=async()=>{try{await this.refreshNative()}catch(e){console.error("刷新原生代币余额失败:",e)}},this.provider.on("block",this.blockHandler),this.blockListenerAttached=!0))}detachEventListeners(){window.ethereum&&(window.ethereum.removeAllListeners("accountsChanged"),window.ethereum.removeAllListeners("chainChanged")),this.provider&&this.blockListenerAttached&&(this.provider.off("block",this.blockHandler),this.blockListenerAttached=!1)}async handleAccountsChanged(e){!e||e.length===0?await this.disconnectWallet():(this.address=e[0],await this.refreshAll())}async handleChainChanged(){await this.refreshAll()}formatUnitsSafe(e,s){try{return Number(to(e,s)).toLocaleString(void 0,{maximumFractionDigits:6})}catch{return"0"}}async fetchAudPriceSafely(){try{const e=this.nativeSymbol==="MATIC"?"matic-network":"ethereum",n=await(await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${e}&vs_currencies=aud`)).json();this.audPrice=n?.[e]?.aud||null}catch{this.audPrice=null}}capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}getCurrentState(){return{connected:this.connected,address:this.address,chainId:this.chainId,networkLabel:this.networkLabel,nativeBalance:this.nativeBalance,nativeSymbol:this.nativeSymbol,audPrice:this.audPrice,tokens:this.tokens,walletActivity:this.walletActivity,loading:this.loading,error:this.error}}clearError(){this.error=null}reset(){this.detachEventListeners(),this.provider=null,this.signer=null,this.address=null,this.connected=!1,this.chainId=null,this.networkLabel="",this.nativeBalance=0n,this.nativeSymbol="ETH",this.audPrice=null,this.tokens=[],this.walletActivity=[],this.loading=!1,this.error=null}}const Pc=new b2,{connectWallet:xU,disconnectWallet:NU,refreshAll:LU,sendTransaction:OU,sendEthTransaction:UU,getBalance:BU,getTokenBalance:MU,switchNetwork:FU,getCurrentNetwork:VU,loadWalletActivity:$U,recordTransaction:jU,getCurrentState:HU,clearError:WU,reset:YU}=Pc,w2={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"http://localhost:3000/api",VITE_API_LOANS_BY_CODE_URL:"http://localhost:3000/api/loans",VITE_API_LOANS_SUBSCRIPTION_URL:"http://localhost:3000/api/loans",VITE_API_LOANS_URL:"http://localhost:3000/api/loans",VITE_API_LOGIN_URL:"http://localhost:3000/user/login",VITE_API_PROJECTS_URL:"http://localhost:3000/api/projects",VITE_API_PROJECT_BY_CODE_DIRECT_URL:"http://localhost:3000/project",VITE_API_PROJECT_BY_CODE_URL:"http://localhost:3000/api/project",VITE_API_PROJECT_DIRECT_URL:"http://localhost:3000/project",VITE_API_PROJECT_SUBSCRIPTION_DIRECT_URL:"http://localhost:3000/project",VITE_API_PROJECT_SUBSCRIPTION_URL:"http://localhost:3000/api/loans",VITE_API_PROJECT_URL:"http://localhost:3000/api/project",VITE_API_REGISTER_URL:"http://localhost:3000/user/reguser",VITE_API_TRANSACTION_URL:"http://localhost:3000/api/transaction",VITE_API_USER_INFO_URL:"http://localhost:3000/user/userinfo",VITE_APP_ENV:"development",VITE_APP_NAME:"RWA Trading Platform",VITE_APP_VERSION:"1.0.0",VITE_AUTO_REFRESH_INTERVAL:"30",VITE_BACKEND_PORT:"3000",VITE_COMPLIANCE_GUARD_ADDRESS:"0x1234567890123456789012345678901234567890",VITE_COMPLIANCE_GUARD_ADDRESS_PROD:"0x1234567890123456789012345678901234567890",VITE_DB_HOST:"localhost",VITE_DB_NAME:"rwa",VITE_DB_PASSWORD:"123456",VITE_DB_PORT:"3306",VITE_DB_USER:"root",VITE_ENABLE_AUTO_REFRESH:"true",VITE_ENABLE_KYC:"true",VITE_ENABLE_TRADING:"true",VITE_INTEREST_TOKEN_ADDRESS:"0xE6aeE4a898c6d99033ee5380Df407C5DD470fb17",VITE_INTEREST_TOKEN_ADDRESS_PROD:"0xE6aeE4a898c6d99033ee5380Df407C5DD470fb17",VITE_KYC_DEFAULT_LEVEL:"3",VITE_KYC_DEFAULT_LEVEL_PROD:"3",VITE_KYC_DEFAULT_SUCCESS:"true",VITE_KYC_DEFAULT_SUCCESS_PROD:"true",VITE_KYC_REGISTRY_ADDRESS:"0x4533f47BE0ce8b80F7bbdF02939f81F4A15b7A45",VITE_KYC_REGISTRY_ADDRESS_PROD:"0x4533f47BE0ce8b80F7bbdF02939f81F4A15b7A45",VITE_LOAN_ISSUER_ADDRESS:"0x13159e6417D98528C220b12Ec4950D5A343E5eAA",VITE_LOAN_ISSUER_ADDRESS_PROD:"0x1234567890123456789012345678901234567890",VITE_NETWORK_CHAIN_ID:"11155111",VITE_NETWORK_CHAIN_ID_PROD:"1",VITE_NETWORK_NAME:"Sepolia Testnet",VITE_NETWORK_NAME_PROD:"Ethereum Mainnet",VITE_PRINCIPAL_TOKEN_ADDRESS:"0x45b1eCb3D9af651244eC656ed15B86404924c354",VITE_PRINCIPAL_TOKEN_ADDRESS_PROD:"0x45b1eCb3D9af651244eC656ed15B86404924c354",VITE_RPC_URL:"https://sepolia.infura.io/v3/YOUR_INFURA_PROJECT_ID",VITE_RPC_URL_PROD:"https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID",VITE_TRADE_CONTRACT_ADDRESS:"0x1234567890123456789012345678901234567890",VITE_TRADE_CONTRACT_ADDRESS_PROD:"0x1234567890123456789012345678901234567890"},et=(t,e)=>w2[t]||e;et("VITE_KYC_REGISTRY_ADDRESS","0x4533f47BE0ce8b80F7bbdF02939f81F4A15b7A45"),et("VITE_LOAN_ISSUER_ADDRESS","0x13159e6417D98528C220b12Ec4950D5A343E5eAA"),et("VITE_PRINCIPAL_TOKEN_ADDRESS","0x45b1eCb3D9af651244eC656ed15B86404924c354"),et("VITE_INTEREST_TOKEN_ADDRESS","0xE6aeE4a898c6d99033ee5380Df407C5DD470fb17"),et("VITE_TRADE_CONTRACT_ADDRESS","0x13159e6417D98528C220b12Ec4950D5A343E5eAA"),et("VITE_COMPLIANCE_GUARD_ADDRESS","0x1234567890123456789012345678901234567890"),parseInt(et("VITE_NETWORK_CHAIN_ID","11155111")),et("VITE_NETWORK_NAME","Sepolia Testnet"),et("VITE_RPC_URL","https://sepolia.infura.io/v3/YOUR_INFURA_PROJECT_ID"),et("VITE_KYC_DEFAULT_SUCCESS","false"),parseInt(et("VITE_KYC_DEFAULT_LEVEL","0"));const A2={KYC_REGISTRY_ADDRESS:et("VITE_KYC_REGISTRY_ADDRESS_PROD","0x4533f47BE0ce8b80F7bbdF02939f81F4A15b7A45"),LOAN_ISSUER_ADDRESS:et("VITE_LOAN_ISSUER_ADDRESS_PROD","0x1234567890123456789012345678901234567890"),PRINCIPAL_TOKEN_ADDRESS:et("VITE_PRINCIPAL_TOKEN_ADDRESS_PROD","0x45b1eCb3D9af651244eC656ed15B86404924c354"),INTEREST_TOKEN_ADDRESS:et("VITE_INTEREST_TOKEN_ADDRESS_PROD","0xE6aeE4a898c6d99033ee5380Df407C5DD470fb17"),TRADE_CONTRACT_ADDRESS:et("VITE_TRADE_CONTRACT_ADDRESS_PROD","0x1234567890123456789012345678901234567890"),COMPLIANCE_GUARD_ADDRESS:et("VITE_COMPLIANCE_GUARD_ADDRESS_PROD","0x1234567890123456789012345678901234567890"),NETWORK:{chainId:parseInt(et("VITE_NETWORK_CHAIN_ID_PROD","1")),name:et("VITE_NETWORK_NAME_PROD","Ethereum Mainnet"),rpcUrl:et("VITE_RPC_URL_PROD","https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID")},KYC:{DEFAULT_SUCCESS:et("VITE_KYC_DEFAULT_SUCCESS_PROD","false")==="true",DEFAULT_LEVEL:parseInt(et("VITE_KYC_DEFAULT_LEVEL_PROD","0"))}},ke=A2,kc=ke.KYC;et("VITE_APP_NAME","RWA Trading Platform"),et("VITE_APP_VERSION","1.0.0"),et("VITE_APP_ENV","development");et("VITE_ENABLE_KYC","true"),et("VITE_ENABLE_TRADING","true"),et("VITE_ENABLE_AUTO_REFRESH","true"),parseInt(et("VITE_AUTO_REFRESH_INTERVAL","30"));const Jt={UNVERIFIED:"unverified",PENDING:"pending",VERIFIED:"verified",REJECTED:"rejected"},Se={LEVEL_0:0,LEVEL_1:1,LEVEL_2:2,LEVEL_3:3},pg="kycStatus",mg="kycLevel";function Wn(){return kc.DEFAULT_SUCCESS?Jt.VERIFIED:localStorage.getItem(pg)||Jt.UNVERIFIED}function Ls(){if(kc.DEFAULT_SUCCESS)return kc.DEFAULT_LEVEL;const t=localStorage.getItem(mg);return t?parseInt(t):Se.LEVEL_0}function Ta(t){localStorage.setItem(pg,t)}function Yn(t){localStorage.setItem(mg,t.toString())}class E2{constructor(){this.provider=null,this.signer=null,this.contracts={kycRegistry:null,loanIssuer:null,principalToken:null,interestToken:null,trade:null,complianceGuard:null},this.isInitialized=!1,this.loading=!1,this.error=null}async initializeContract(){try{if(this.loading=!0,this.error=null,console.log("🚀 ContractService: 初始化智能合约服务..."),typeof window.ethereum>"u")throw new Error("Web3钱包未检测到，请安装MetaMask或类似钱包");return this.validateContractAddresses(),await this.checkNetwork(),this.provider=new cs(window.ethereum),await window.ethereum.request({method:"eth_requestAccounts"}),this.signer=await this.provider.getSigner(),await this.initializeContracts(),this.isInitialized=!0,console.log("✅ ContractService: 智能合约服务初始化成功!"),{success:!0,message:"合约服务初始化成功"}}catch(e){return this.error=e.message,console.error("❌ ContractService: 初始化失败:",e),{success:!1,error:e.message}}finally{this.loading=!1}}validateContractAddresses(){const e={"KYC Registry":ke.KYC_REGISTRY_ADDRESS,"Loan Issuer":ke.LOAN_ISSUER_ADDRESS,"Principal Token":ke.PRINCIPAL_TOKEN_ADDRESS,"Interest Token":ke.INTEREST_TOKEN_ADDRESS,"Trade Contract":ke.TRADE_CONTRACT_ADDRESS,"Compliance Guard":ke.COMPLIANCE_GUARD_ADDRESS};for(const[s,n]of Object.entries(e))this.validateContractAddress(n,s)}async checkNetwork(){const e=await window.ethereum.request({method:"eth_chainId"}),s="0x"+ke.NETWORK.chainId.toString(16),n=parseInt(e,16);if(console.log("🌐 当前链ID:",n),console.log("🎯 目标链ID:",ke.NETWORK.chainId),e!==s)throw new Error(`请切换到 ${ke.NETWORK.name} (链ID: ${ke.NETWORK.chainId})`)}async initializeContracts(){const e=[{name:"kycRegistry",address:ke.KYC_REGISTRY_ADDRESS,abi:this.getKycRegistryABI()},{name:"loanIssuer",address:ke.LOAN_ISSUER_ADDRESS,abi:this.getLoanIssuerABI()},{name:"principalToken",address:ke.PRINCIPAL_TOKEN_ADDRESS,abi:this.getCompliantERC20ABI()},{name:"interestToken",address:ke.INTEREST_TOKEN_ADDRESS,abi:this.getCompliantERC20ABI()},{name:"trade",address:ke.TRADE_CONTRACT_ADDRESS,abi:this.getTradeContractABI()},{name:"complianceGuard",address:ke.COMPLIANCE_GUARD_ADDRESS,abi:this.getComplianceGuardABI()}];for(const s of e)try{this.contracts[s.name]=new Wt(s.address,s.abi,this.signer),console.log(`✅ ${s.name} 合约初始化成功`)}catch(n){throw console.error(`❌ ${s.name} 合约初始化失败:`,n),new Error(`初始化 ${s.name} 合约失败: ${n.message}`)}}async buyTokens(e){try{this.isInitialized||await this.initializeContract();const s=await this.getUserAddress();if(!s)throw new Error("无法获取用户钱包地址，请确保钱包已连接");if(console.log("💰 购买代币:",{amount:e,userAddress:s}),!ke.TRADE_CONTRACT_ADDRESS||ke.TRADE_CONTRACT_ADDRESS==="0x1234567890123456789012345678901234567890"){console.warn("⚠️ 交易合约地址未配置，模拟成功交易");const l="0x"+Math.random().toString(16).substr(2,64),c=Math.floor(Math.random()*1e6)+1e6;return{success:!0,transactionHash:l,blockNumber:c,tokenPrice:"1.0",totalCost:e.toString(),userAddress:s}}let n,r;try{n=await this.contracts.trade.getTokenPrice(),r=n*BigInt(e),console.log("💰 获取到代币价格:",n.toString())}catch(l){console.warn("⚠️ 无法获取代币价格，使用默认价格:",l.message),n=si("1.0"),r=n*BigInt(e)}console.log("💰 购买代币:",{amount:e,userAddress:s,tokenPrice:n.toString(),totalCost:r.toString()});const o=await(await this.contracts.trade.buyTokens(e,{value:r})).wait();return{success:!0,transactionHash:o.transactionHash,blockNumber:o.blockNumber,tokenPrice:_t(n),totalCost:_t(r),userAddress:s}}catch(s){return console.error("❌ 购买代币失败:",s),{success:!1,error:s.message}}}async sellTokens(e){try{this.isInitialized||await this.initializeContract();const s=await this.getUserAddress();if(!s)throw new Error("无法获取用户钱包地址，请确保钱包已连接");if(console.log("💸 出售代币:",{amount:e,userAddress:s}),!ke.TRADE_CONTRACT_ADDRESS||ke.TRADE_CONTRACT_ADDRESS==="0x1234567890123456789012345678901234567890"){console.warn("⚠️ 交易合约地址未配置，模拟成功交易");const l="0x"+Math.random().toString(16).substr(2,64),c=Math.floor(Math.random()*1e6)+1e6;return{success:!0,transactionHash:l,blockNumber:c,tokenPrice:"1.0",totalCost:e.toString(),userAddress:s}}let n,r;try{n=await this.contracts.trade.getTokenPrice(),r=n*BigInt(e),console.log("💰 获取到代币价格:",n.toString())}catch(l){console.warn("⚠️ 无法获取代币价格，使用默认价格:",l.message),n=si("1.0"),r=n*BigInt(e)}console.log("💸 出售代币:",{amount:e,userAddress:s,tokenPrice:n.toString(),totalRevenue:r.toString()});const o=await(await this.contracts.trade.sellTokens(e)).wait();return{success:!0,transactionHash:o.transactionHash,blockNumber:o.blockNumber,tokenPrice:_t(n),totalCost:_t(r),userAddress:s}}catch(s){return console.error("❌ 出售代币失败:",s),{success:!1,error:s.message}}}async getTokenPrice(){try{if(this.isInitialized||await this.initializeContract(),console.log("🔍 尝试从合约获取代币价格:",ke.TRADE_CONTRACT_ADDRESS),!ke.TRADE_CONTRACT_ADDRESS||ke.TRADE_CONTRACT_ADDRESS==="0x1234567890123456789012345678901234567890")return console.warn("⚠️ 交易合约地址未配置，返回默认价格"),"1.0";const e=await this.contracts.trade.getTokenPrice();return console.log("✅ 代币价格获取成功:",_t(e)),_t(e)}catch(e){return console.error("❌ 获取代币价格失败:",e),e.message.includes("BAD_DATA")||e.message.includes("UNSUPPORTED_OPERATION")?(console.warn("⚠️ 合约方法不可用，使用默认价格"),"1.0"):"0"}}async getUserTokenBalance(e,s=null){try{this.isInitialized||await this.initializeContract(),e||(e=await this.getUserAddress()),s||(s=ke.PRINCIPAL_TOKEN_ADDRESS);const r=await new Wt(s,this.getCompliantERC20ABI(),this.signer).balanceOf(e);return _t(r)}catch(n){return console.error("❌ 获取代币余额失败:",n),"0"}}async applyForKYC(e){try{this.isInitialized||await this.initializeContract();const s=await this.getUserAddress();if(await this.contracts.kycRegistry.blocked(s))throw new Error("用户已被阻止进行KYC验证");const r=await this.contracts.kycRegistry.kycLevel(s);if(r>=2)return{success:!0,message:"用户已有足够的KYC等级",currentLevel:r};const i=wt(Zn.defaultAbiCoder().encode(["string","string","string","string","string"],[e.firstName,e.lastName,e.dob,e.country,e.docType]));return console.log("KYC数据哈希:",i),console.log("KYC数据:",e),Ta(Jt.VERIFIED),Yn(Se.LEVEL_2),{success:!0,message:"KYC申请提交成功",kycHash:i,userAddress:s}}catch(s){return console.error("KYC申请失败:",s),{success:!1,error:s.message}}}async getKycLevel(e=null){try{return this.isInitialized||await this.initializeContract(),e||(e=await this.getUserAddress()),await this.contracts.kycRegistry.kycLevel(e)}catch(s){return console.error("检查KYC等级失败:",s),0}}async isBlocked(e=null){try{return this.isInitialized||await this.initializeContract(),e||(e=await this.getUserAddress()),await this.contracts.kycRegistry.blocked(e)}catch(s){return console.error("检查阻止状态失败:",s),!1}}async isWhitelisted(e){try{this.isInitialized||await this.initializeContract(),console.log("🔍 检查白名单状态:",e);const s=await this.contracts.complianceGuard.whitelist(e);return console.log("✅ 白名单状态:",s),s}catch(s){return console.error("❌ 检查白名单状态失败:",s),!1}}async getWhitelistStatus(e){try{console.log("🔍 获取综合白名单状态:",e);const[s,n,r,i]=await Promise.all([this.isWhitelisted(e),this.isBlocked(e),this.getKycLevel(e),this.getKycExpireAt(e)]),o=Math.floor(Date.now()/1e3),l=i>0&&o>i;let c="none";return n?c="rejected":s&&r>=2&&!l||s&&r>=2?c="approved":s&&r>=1&&(c="pending"),console.log("✅ 白名单状态:",c),{status:c,isWhitelisted:s,isBlocked:n,kycLevel:r,kycExpireAt:i,isKycExpired:l}}catch(s){return console.error("❌ 获取白名单状态失败:",s),{status:"none",isWhitelisted:!1,isBlocked:!1,kycLevel:0,kycExpireAt:0,isKycExpired:!1}}}async getUserAddress(){try{if(this.signer)return await this.signer.getAddress();if(typeof window.ethereum<"u"){const e=await window.ethereum.request({method:"eth_accounts"});if(e&&e.length>0)return e[0]}throw new Error("无法获取用户地址")}catch(e){return console.error("❌ 获取用户地址失败:",e),null}}validateContractAddress(e,s){if(!e||e==="#"||e==="0x...")throw new Error(`${s} 合约地址未正确配置`);if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`${s} 合约地址格式无效: ${e}`);return!0}getKycRegistryABI(){return["function kycLevel(address user) external view returns (uint8)","function blocked(address user) external view returns (bool)","function setKycLevel(address user, uint8 level) external","function setBlocked(address user, bool isBlocked) external","function kycSigner() external view returns (address)","function DOMAIN_SEPARATOR() external view returns (bytes32)"]}getLoanIssuerABI(){return["function registry() external view returns (address)","function principalToken() external view returns (address)","function interestToken() external view returns (address)","function nextLoanId() external view returns (uint256)","function loans(uint256 loanId) external view returns (uint256 principal, uint256 annualRateBps, uint64 startDate, uint64 dueDate, string memory borrower, string memory lender, string memory collateral, string memory note, bool closed)","function loanHolder(uint256 loanId) external view returns (address)"]}getCompliantERC20ABI(){return["function name() external view returns (string memory)","function symbol() external view returns (string memory)","function decimals() external pure returns (uint8)","function totalSupply() external view returns (uint256)","function balanceOf(address account) external view returns (uint256)","function allowance(address owner, address spender) external view returns (uint256)","function transfer(address to, uint256 amount) external returns (bool)","function approve(address spender, uint256 amount) external returns (bool)","function transferFrom(address from, address to, uint256 amount) external returns (bool)"]}getTradeContractABI(){return["function buyTokens(uint256 amount) external payable","function sellTokens(uint256 amount) external","function getTokenPrice() external view returns (uint256)","function getUserBalance(address user) external view returns (uint256)"]}getComplianceGuardABI(){return["function whitelist(address user) external view returns (bool)","function blocked(address user) external view returns (bool)","function kycTier(address user) external view returns (uint8)","function kycExpireAt(address user) external view returns (uint64)"]}getCurrentState(){return{isInitialized:this.isInitialized,loading:this.loading,error:this.error,contracts:Object.keys(this.contracts).reduce((e,s)=>(e[s]=this.contracts[s]?"initialized":"not_initialized",e),{})}}clearError(){this.error=null}reset(){this.provider=null,this.signer=null,this.contracts={kycRegistry:null,loanIssuer:null,principalToken:null,interestToken:null,trade:null,complianceGuard:null},this.isInitialized=!1,this.loading=!1,this.error=null}}const gg=new E2,{initializeContract:GU,buyTokens:KU,sellTokens:zU,getTokenPrice:QU,getUserTokenBalance:JU,applyForKYC:qU,getKycLevel:ZU,isBlocked:XU,isWhitelisted:eB,getWhitelistStatus:tB,getCurrentState:sB,clearError:nB,reset:rB}=gg;class _2{constructor(){this.syncIntervals=new Map,this.isRunning=!1,this.syncConfig={userData:{interval:3e4,enabled:!0},projectData:{interval:3e4,enabled:!0},walletData:{interval:15e3,enabled:!0},contractData:{interval:6e4,enabled:!1}},this.cache=new Map,this.lastSync=new Map,this.errorCount=new Map,this.maxRetries=3,this.subscribers=new Map,this.lastRefreshTime=null}subscribe(e,s){if(this.subscribers.has(e)||this.subscribers.set(e,new Set),this.subscribers.get(e).add(s),this.cache.has(e)){const n=this.cache.get(e);s(n.data||n)}return()=>this.unsubscribe(e,s)}unsubscribe(e,s){this.subscribers.has(e)&&(this.subscribers.get(e).delete(s),this.subscribers.get(e).size===0&&this.subscribers.delete(e))}notify(e,s){this.subscribers.has(e)&&this.subscribers.get(e).forEach(n=>{try{n(s)}catch(r){console.error("❌ DataSyncService: 通知订阅者失败:",r)}})}async startDataSync(e={}){try{return console.log("🔄 DataSyncService: 启动数据同步服务..."),this.syncConfig={...this.syncConfig,...e},this.syncConfig.userData.enabled&&await this.startUserDataSync(),this.syncConfig.projectData.enabled&&await this.startProjectDataSync(),this.syncConfig.walletData.enabled&&await this.startWalletDataSync(),this.syncConfig.contractData.enabled&&await this.startContractDataSync(),this.isRunning=!0,console.log("✅ DataSyncService: 数据同步服务启动成功"),{success:!0,message:"数据同步服务启动成功",config:this.syncConfig}}catch(s){return console.error("❌ DataSyncService: 启动数据同步服务失败:",s),{success:!1,error:s.message}}}async stopDataSync(){try{console.log("🔄 DataSyncService: 停止数据同步服务...");for(const[e,s]of this.syncIntervals)clearInterval(s),console.log(`✅ 停止 ${e} 数据同步`);return this.syncIntervals.clear(),this.isRunning=!1,console.log("✅ DataSyncService: 数据同步服务已停止"),{success:!0,message:"数据同步服务已停止"}}catch(e){return console.error("❌ DataSyncService: 停止数据同步服务失败:",e),{success:!1,error:e.message}}}async startUserDataSync(){const e=this.syncConfig.userData.interval,s=async()=>{try{if(console.log("🔄 DataSyncService: 同步用户数据..."),!this.shouldSync("userData"))return;await this.syncUserData(),this.lastSync.set("userData",Date.now()),this.errorCount.set("userData",0),console.log("✅ DataSyncService: 用户数据同步完成")}catch(r){console.error("❌ DataSyncService: 用户数据同步失败:",r),this.handleSyncError("userData",r)}};await s();const n=setInterval(s,e);this.syncIntervals.set("userData",n),console.log(`✅ DataSyncService: 用户数据同步已启动，间隔: ${e}ms`)}async syncUserData(){try{if(Tc.getUserStatus().isLoggedIn){const s=await Tc.getUserData();s.success&&(this.cache.set("userData",s.data),console.log("✅ 用户数据已更新到缓存"))}}catch(e){throw console.error("❌ 同步用户数据失败:",e),e}}async startProjectDataSync(){const e=this.syncConfig.projectData.interval,s=async()=>{try{if(console.log("🔄 DataSyncService: 同步项目数据..."),!this.shouldSync("projectData"))return;await this.syncProjectData(),this.lastSync.set("projectData",Date.now()),this.errorCount.set("projectData",0),console.log("✅ DataSyncService: 项目数据同步完成")}catch(r){console.error("❌ DataSyncService: 项目数据同步失败:",r),this.handleSyncError("projectData",r)}};await s();const n=setInterval(s,e);this.syncIntervals.set("projectData",n),console.log(`✅ DataSyncService: 项目数据同步已启动，间隔: ${e}ms`)}async syncProjectData(){try{const e=await hg.refreshProjectData();if(e.success){const s=e.data||[];this.setCacheWithTimestamp("products",s),this.cache.set("projectData",s),this.notify("products",s);const n=await this.checkForNewProjects(s);n.length>0&&this.notify("new_projects",n),console.log("✅ 项目数据已更新到缓存并通知订阅者")}}catch(e){throw console.error("❌ 同步项目数据失败:",e),e}}async startWalletDataSync(){const e=this.syncConfig.walletData.interval,s=async()=>{try{if(console.log("🔄 DataSyncService: 同步钱包数据..."),!this.shouldSync("walletData"))return;await this.syncWalletData(),this.lastSync.set("walletData",Date.now()),this.errorCount.set("walletData",0),console.log("✅ DataSyncService: 钱包数据同步完成")}catch(r){console.error("❌ DataSyncService: 钱包数据同步失败:",r),this.handleSyncError("walletData",r)}};await s();const n=setInterval(s,e);this.syncIntervals.set("walletData",n),console.log(`✅ DataSyncService: 钱包数据同步已启动，间隔: ${e}ms`)}async syncWalletData(){try{const e=Pc.getCurrentState();e.connected&&(await Pc.refreshAll(),this.cache.set("walletData",e),console.log("✅ 钱包数据已更新到缓存"))}catch(e){throw console.error("❌ 同步钱包数据失败:",e),e}}async startContractDataSync(){const e=this.syncConfig.contractData.interval,s=async()=>{try{if(console.log("🔄 DataSyncService: 同步合约数据..."),!this.shouldSync("contractData"))return;await this.syncContractData(),this.lastSync.set("contractData",Date.now()),this.errorCount.set("contractData",0),console.log("✅ DataSyncService: 合约数据同步完成")}catch(r){console.error("❌ DataSyncService: 合约数据同步失败:",r),this.handleSyncError("contractData",r)}};await s();const n=setInterval(s,e);this.syncIntervals.set("contractData",n),console.log(`✅ DataSyncService: 合约数据同步已启动，间隔: ${e}ms`)}async syncContractData(){try{const e=gg.getCurrentState();e.isInitialized&&(this.cache.set("contractData",e),console.log("✅ 合约数据已更新到缓存"))}catch(e){throw console.error("❌ 同步合约数据失败:",e),e}}async syncAllData(){try{console.log("🔄 DataSyncService: 手动同步所有数据...");const e={userData:{success:!1,error:null},projectData:{success:!1,error:null},walletData:{success:!1,error:null},contractData:{success:!1,error:null}};try{await this.syncUserData(),e.userData.success=!0}catch(r){e.userData.error=r.message}try{await this.syncProjectData(),e.projectData.success=!0}catch(r){e.projectData.error=r.message}try{await this.syncWalletData(),e.walletData.success=!0}catch(r){e.walletData.error=r.message}try{await this.syncContractData(),e.contractData.success=!0}catch(r){e.contractData.error=r.message}const s=Object.values(e).filter(r=>r.success).length,n=Object.keys(e).length;return console.log(`✅ DataSyncService: 手动同步完成，成功: ${s}/${n}`),{success:s>0,results:e,summary:`${s}/${n} 项数据同步成功`}}catch(e){return console.error("❌ DataSyncService: 手动同步失败:",e),{success:!1,error:e.message}}}setCacheWithTimestamp(e,s){this.cache.set(e,{data:s,timestamp:Date.now()})}getCacheWithTimestamp(e,s=300*1e3){const n=this.cache.get(e);return n&&n.timestamp&&!(Date.now()-n.timestamp>s)?n.data:null}async checkForNewProjects(e){try{const s=this.getCacheWithTimestamp("products")||[],n=e.filter(r=>!s.some(i=>i.code===r.code||i.project_code===r.project_code));return n.length>0&&console.log("🆕 DataSyncService: 发现",n.length,"个新项目:",n.map(r=>r.code||r.project_code)),n}catch(s){return console.error("❌ DataSyncService: 检查新项目失败:",s),[]}}getCachedData(e){return this.cache.get(e)}setCachedData(e,s){this.cache.set(e,s)}clearCache(e=null){e?(this.cache.delete(e),console.log(`✅ 清除缓存: ${e}`)):(this.cache.clear(),console.log("✅ 清除所有缓存"))}shouldSync(e){const s=this.lastSync.get(e);if((this.errorCount.get(e)||0)>=this.maxRetries)return console.warn(`⚠️ ${e} 同步错误次数过多，暂停同步`),!1;if(!s)return!0;const r=this.syncConfig[e]?.interval||3e4;return Date.now()-s>=r}handleSyncError(e,s){const r=(this.errorCount.get(e)||0)+1;this.errorCount.set(e,r),console.error(`❌ ${e} 同步错误 (${r}/${this.maxRetries}):`,s.message),r>=this.maxRetries&&(console.error(`❌ ${e} 同步错误次数过多，停止同步`),this.stopDataTypeSync(e))}stopDataTypeSync(e){const s=this.syncIntervals.get(e);s&&(clearInterval(s),this.syncIntervals.delete(e),console.log(`✅ 停止 ${e} 数据同步`))}resetErrorCount(e){this.errorCount.set(e,0),console.log(`✅ 重置 ${e} 错误计数`)}getSyncStatus(){return{isRunning:this.isRunning,config:this.syncConfig,lastSync:Object.fromEntries(this.lastSync),errorCount:Object.fromEntries(this.errorCount),cacheSize:this.cache.size,activeSyncs:Array.from(this.syncIntervals.keys())}}getCacheStatus(){const e={};for(const[s,n]of this.cache)e[s]={size:JSON.stringify(n).length,lastUpdated:this.lastSync.get(s)||null,hasData:n!=null};return e}reset(){this.stopDataSync(),this.cache.clear(),this.lastSync.clear(),this.errorCount.clear(),this.subscribers.clear(),this.isRunning=!1,this.lastRefreshTime=null,console.log("✅ DataSyncService: 服务状态已重置")}}const mt=new _2,{startDataSync:iB,stopDataSync:oB,syncAllData:T2,getCachedData:P2,setCachedData:aB,clearCache:lB,getSyncStatus:cB,getCacheStatus:uB,reset:dB,subscribe:fB,unsubscribe:hB,notify:pB,setCacheWithTimestamp:mB,getCacheWithTimestamp:gB,checkForNewProjects:yB}=mt,Dr=()=>({subscribeProducts:t=>mt.subscribe("products",t),subscribeProduct:(t,e)=>mt.subscribe(`product_${t}`,e),subscribeNewProjects:t=>mt.subscribe("new_projects",t),refresh:()=>mt.syncAllData(),getLastRefreshTime:()=>mt.lastRefreshTime,checkForUpdates:()=>mt.checkForNewProjects(mt.getCachedData("projectData")||[]),startAutoRefresh:t=>mt.startDataSync({projectData:{interval:t||3e4,enabled:!0}}),stopAutoRefresh:()=>mt.stopDataSync()});mt.subscribe.bind(mt),mt.unsubscribe.bind(mt),mt.notify.bind(mt),mt.setCacheWithTimestamp.bind(mt),mt.getCacheWithTimestamp.bind(mt);const k2="/videos/Introvideo.mp4",S2={name:"HomeView",components:{},emits:["notify"],data(){return{products:[],loading:!1,error:null,form:{name:"",email:"",phone:"",subject:"",message:""},isSubmitting:!1,showIntroVideo:!1,introVideoLoading:!0,showIntroSkipButton:!1,introVideoError:!1,introVideoTimer:null,isTransitioning:!1,transitionTimer:null}},computed:{upcomingProjects(){return this.products.filter(t=>t.status==="INCOMING").sort((t,e)=>t.code.localeCompare(e.code))},newListingProject(){return this.upcomingProjects.length>0?this.upcomingProjects[0]:null}},methods:{notify(t){this.$emit("notify",t)},async loadProducts(){this.loading=!0,this.error=null;try{console.log("HomeView: 从数据库加载产品数据...");const t=await Kt.getAllProducts();if(t.status===0){const e=t.data||[];if(this.products=e,console.log("HomeView: 成功加载",e.length,"个产品"),console.log("HomeView: Upcoming项目:",this.upcomingProjects),e.length>0){const s=this.upcomingProjects.length;s>0&&this.notify(`成功加载 ${s} 个即将发布的项目`)}this.$nextTick(()=>{console.log("HomeView: UI已更新，项目列表已显示")})}else this.error=t.message||"加载产品数据失败",console.error("HomeView: 加载产品数据失败:",this.error),this.notify("加载产品数据失败: "+this.error)}catch(t){this.error=t.message||"网络错误",console.error("HomeView: 加载产品数据异常:",t),this.notify("加载产品数据异常: "+this.error)}finally{this.loading=!1}},setupDatabaseSync(){const{subscribeProducts:t,subscribeNewProjects:e}=Dr();this.unsubscribeProducts=t(s=>{console.log("🔄 HomeView: 收到产品数据更新，共",s.length,"个项目");const n=[...this.products];this.products=s;const r=n.filter(o=>o.status==="INCOMING").length,i=s.filter(o=>o.status==="INCOMING").length;i>r&&(console.log("🆕 HomeView: 发现",i-r,"个新的upcoming项目"),this.notify(`发现 ${i-r} 个新项目`)),this.$nextTick(()=>{console.log("HomeView: 实时更新完成，项目列表已刷新")})}),this.unsubscribeNewProjects=e(s=>{console.log("🆕 HomeView: 收到新项目通知:",s),this.notify(`新增 ${s.length} 个项目`)})},getStatusText(t){return{ACTIVE:"Active",INCOMING:"Upcoming",PERFORMING:"Performing",DEFAULT:"Default"}[t]||"Unknown"},getStatusClass(t){return{ACTIVE:"status-active",INCOMING:"status-upcoming",PERFORMING:"status-performing",DEFAULT:"status-default"}[t]||"status-unknown"},viewProjectDetails(t){this.$router.push(`/detail/${t}`)},addToWatchlist(t){this.notify(`Added ${t} to watchlist`),console.log("Added to watchlist:",t)},refreshListings(){this.notify("Refreshing listings..."),console.log("🔄 Refreshing listings..."),this.loadProducts()},viewAllProjects(){this.$router.push("/projects")},formatNumber(t){return t?new Intl.NumberFormat("en-US").format(t):"0"},handleWalletActivityUpdate(t){console.log("🏠 HomeView: Received wallet activity update:",t)},playIntroVideo(){this.showIntroVideo=!0,this.introVideoLoading=!0,this.introVideoError=!1,this.showIntroSkipButton=!1,this.introVideoTimer=setTimeout(()=>{this.showIntroSkipButton=!0},3e3)},goToProjects(){this.$router.push("/listedprojects")},goToContact(){const t=document.querySelector(".contact-content");t?t.scrollIntoView({behavior:"smooth"}):this.$router.push("/projects")},handleIntroVideoReady(){this.introVideoLoading=!1,console.log("开场视频加载完成")},handleIntroVideoEnd(){console.log("开场视频播放完成"),this.startTransition()},handleIntroVideoError(){console.error("开场视频加载失败"),this.introVideoLoading=!1,this.introVideoError=!0},skipIntroVideo(){console.log("用户跳过开场视频"),this.startTransition()},startTransition(){this.isTransitioning=!0;const t=this.$refs.introVideo;t&&t.pause(),this.transitionTimer=setTimeout(()=>{this.showIntroVideo=!1,setTimeout(()=>{this.isTransitioning=!1,this.resetVideoState()},10)},10)},closeIntroVideo(){this.showIntroVideo=!1,this.introVideoLoading=!1,this.introVideoError=!1,this.showIntroSkipButton=!1,this.isTransitioning=!1,this.introVideoTimer&&(clearTimeout(this.introVideoTimer),this.introVideoTimer=null),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null),this.resetVideoState()},resetVideoState(){const t=this.$refs.introVideo;t&&(t.pause(),t.currentTime=0),this.introVideoLoading=!1,this.introVideoError=!1,this.showIntroSkipButton=!1,this.isTransitioning=!1},async submitForm(){if(this.isSubmitting)return;if(!this.form.name||!this.form.email||!this.form.subject||!this.form.message){alert("Please fill in all required fields");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.form.email)){alert("Please enter a valid email address");return}this.isSubmitting=!0;try{console.log("Submit contact form:",this.form),await new Promise(e=>setTimeout(e,1e3)),alert("Message sent successfully! We will reply to you as soon as possible."),this.form={name:"",email:"",phone:"",subject:"",message:""}}catch(e){console.error("Form submission failed:",e),alert("Message sending failed, please try again later.")}finally{this.isSubmitting=!1}}},async mounted(){console.log("🏠 HomeView: 组件已挂载，开始初始化..."),this.setupDatabaseSync(),console.log("🏠 HomeView: 开始加载产品数据..."),await this.loadProducts(),console.log("🏠 HomeView: Loaded product data:",this.products.length,"projects"),console.log("📋 HomeView: Upcoming项目:",this.upcomingProjects),console.log("🆕 HomeView: New Listing项目:",this.newListingProject),this.newListingProject?(console.log("✅ HomeView: Project Details of New Listing:",{code:this.newListingProject.code,name:this.newListingProject.name,loanAmount:this.newListingProject.loanAmount,targetYield:this.newListingProject.targetYield,loanTerm:this.newListingProject.loanTerm,status:this.newListingProject.status}),this.$nextTick(()=>{console.log("🏠 HomeView: 项目列表已显示在UI中")})):console.log("ℹ️ HomeView: No upcoming project"),this.$root.$on("walletActivityUpdated",this.handleWalletActivityUpdate)},beforeUnmount(){this.unsubscribeProducts&&this.unsubscribeProducts(),this.unsubscribeNewProjects&&this.unsubscribeNewProjects(),this.$root.$off("walletActivityUpdated",this.handleWalletActivityUpdate),this.introVideoTimer&&clearTimeout(this.introVideoTimer),this.transitionTimer&&clearTimeout(this.transitionTimer)}},C2={class:"video-overlay"},I2={key:0,class:"loading-indicator"},R2={key:1,class:"error-message"},D2={class:"grid"},x2={style:{"margin-top":"40px","margin-left":"100px",display:"flex",gap:"20px",width:"500px"}},N2={class:"contact-container"},L2={class:"contact-layout"},O2={class:"contact-form-column"},U2={class:"contact-form-card"},B2={class:"form-group"},M2={class:"form-group"},F2={class:"form-group"},V2={class:"form-group"},$2=["disabled"];function j2(t,e,s,n,r,i){return m(),g(me,null,[r.showIntroVideo||r.isTransitioning?(m(),g("div",{key:0,class:be(["intro-video-overlay",{"fade-out":r.isTransitioning}])},[a("div",{class:be(["intro-video-container",{"fade-out":r.isTransitioning}])},[a("video",{ref:"introVideo",class:"intro-video",autoplay:"",muted:"",playsinline:"",onEnded:e[0]||(e[0]=(...o)=>i.handleIntroVideoEnd&&i.handleIntroVideoEnd(...o)),onCanplaythrough:e[1]||(e[1]=(...o)=>i.handleIntroVideoReady&&i.handleIntroVideoReady(...o)),onError:e[2]||(e[2]=(...o)=>i.handleIntroVideoError&&i.handleIntroVideoError(...o))},[...e[12]||(e[12]=[a("source",{src:k2,type:"video/mp4"},null,-1),ne(" 您的浏览器不支持视频播放 ",-1)])],544),a("div",C2,[r.introVideoLoading?(m(),g("div",I2,[...e[13]||(e[13]=[a("div",{class:"loading-spinner"},null,-1),a("p",{class:"loading-text"},"正在加载视频...",-1)])])):B("",!0),r.introVideoError?(m(),g("div",R2,[e[14]||(e[14]=a("p",null,"视频加载失败",-1)),a("button",{class:"btn btn-secondary",onClick:e[3]||(e[3]=(...o)=>i.closeIntroVideo&&i.closeIntroVideo(...o))},"关闭")])):B("",!0)]),e[15]||(e[15]=a("div",{class:"brand-info"},[a("div",{class:"logo-container"}),a("h1",{class:"headline"},[ne("我们专注于将房地产资产打造为"),a("br"),ne("投资人偏爱的 RWA 底层资产 ")]),a("p",{class:"brand-subtitle"},"澳洲地产资产上链 · 安全、低风险、高回报的 RWA 投资平台")],-1))],2)],2)):B("",!0),a("section",{class:be(["container hero",{"fade-in":!r.showIntroVideo&&!r.isTransitioning}])},[a("div",D2,[a("div",null,[e[17]||(e[17]=a("h1",{class:"headline"},[ne("我们专注于将房地产资产打造为"),a("br"),ne("投资人偏爱的 RWA 底层资产 ")],-1)),e[18]||(e[18]=a("p",{class:"sub"},"澳洲地产资产上链 · 安全、低风险、高回报的 RWA 投资平台 ",-1)),e[19]||(e[19]=a("p",{class:"foot"},[ne("By continuing, you agree to our Terms and acknowledge our "),a("a",{href:"/src/components/privacypolicy.vue"},"Privacy Policy.")],-1)),a("div",x2,[a("button",{class:"btn-primary",onClick:e[4]||(e[4]=(...o)=>i.goToProjects&&i.goToProjects(...o))},"Invest Now"),a("button",{class:"btn-secondary",onClick:e[5]||(e[5]=(...o)=>i.goToContact&&i.goToContact(...o))},"Contact Us"),a("button",{class:"btn-intro",onClick:e[6]||(e[6]=(...o)=>i.playIntroVideo&&i.playIntroVideo(...o))},[...e[16]||(e[16]=[a("span",{class:"btn-icon"},"🎬",-1),ne(" 观看介绍视频 ",-1)])])])])])],2),a("section",{class:be(["contact-section",{"fade-in":!r.showIntroVideo&&!r.isTransitioning}])},[e[28]||(e[28]=Nt('<div class="contact-bg-decoration" data-v-6ccf5f4c><div class="blockchain-token token-1" data-v-6ccf5f4c></div><div class="blockchain-token token-2" data-v-6ccf5f4c></div><div class="blockchain-token token-3" data-v-6ccf5f4c></div><div class="real-estate-icon building-1" data-v-6ccf5f4c></div><div class="real-estate-icon building-2" data-v-6ccf5f4c></div></div>',1)),a("div",N2,[e[26]||(e[26]=a("header",{class:"contact-header"},[a("h2",{class:"headline"},"Contact Us")],-1)),a("div",L2,[e[25]||(e[25]=Nt('<div class="contact-info-column" data-v-6ccf5f4c><div class="contact-info-card" data-v-6ccf5f4c><div class="contact-item" data-v-6ccf5f4c><div class="contact-icon location-icon" data-v-6ccf5f4c><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6ccf5f4c><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="currentColor" data-v-6ccf5f4c></path></svg></div><div class="contact-details" data-v-6ccf5f4c><h4 data-v-6ccf5f4c>Office Address</h4><p data-v-6ccf5f4c>Level 15, 123 George Street<br data-v-6ccf5f4c>Sydney NSW 2000, Australia</p></div></div><div class="contact-item" data-v-6ccf5f4c><div class="contact-icon email-icon" data-v-6ccf5f4c><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6ccf5f4c><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z" fill="currentColor" data-v-6ccf5f4c></path></svg></div><div class="contact-details" data-v-6ccf5f4c><h4 data-v-6ccf5f4c>Email Address</h4><p data-v-6ccf5f4c>support@mortgagerwa.com<br data-v-6ccf5f4c>business@mortgagerwa.com</p></div></div><div class="contact-item" data-v-6ccf5f4c><div class="contact-icon phone-icon" data-v-6ccf5f4c><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6ccf5f4c><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z" fill="currentColor" data-v-6ccf5f4c></path></svg></div><div class="contact-details" data-v-6ccf5f4c><h4 data-v-6ccf5f4c>Phone Number</h4><p data-v-6ccf5f4c>+61 2 1234 5678<br data-v-6ccf5f4c>Monday to Friday 9:00-18:00</p></div></div><div class="contact-item" data-v-6ccf5f4c><div class="contact-icon hours-icon" data-v-6ccf5f4c><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6ccf5f4c><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z" fill="currentColor" data-v-6ccf5f4c></path><path d="M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z" fill="currentColor" data-v-6ccf5f4c></path></svg></div><div class="contact-details" data-v-6ccf5f4c><h4 data-v-6ccf5f4c>Business Hours</h4><p data-v-6ccf5f4c>Monday - Friday: 9:00 AM - 6:00 PM<br data-v-6ccf5f4c>Saturday: 10:00 AM - 2:00 PM</p></div></div></div></div>',1)),a("div",O2,[a("div",U2,[a("form",{onSubmit:e[11]||(e[11]=ue((...o)=>i.submitForm&&i.submitForm(...o),["prevent"])),class:"modern-form"},[a("div",B2,[e[20]||(e[20]=a("label",{for:"contact-name"},"Full Name *",-1)),Pe(a("input",{type:"text",id:"contact-name","onUpdate:modelValue":e[7]||(e[7]=o=>r.form.name=o),required:"",placeholder:"Enter your full name"},null,512),[[Ze,r.form.name]])]),a("div",M2,[e[21]||(e[21]=a("label",{for:"contact-email"},"Email *",-1)),Pe(a("input",{type:"email",id:"contact-email","onUpdate:modelValue":e[8]||(e[8]=o=>r.form.email=o),required:"",placeholder:"Enter your email address"},null,512),[[Ze,r.form.email]])]),a("div",F2,[e[23]||(e[23]=a("label",{for:"contact-subject"},"Subject *",-1)),Pe(a("select",{id:"contact-subject","onUpdate:modelValue":e[9]||(e[9]=o=>r.form.subject=o),required:""},[...e[22]||(e[22]=[Nt('<option value="" data-v-6ccf5f4c>Select a subject</option><option value="investor" data-v-6ccf5f4c>Investment Inquiry</option><option value="asset_holder" data-v-6ccf5f4c>Asset Listing</option><option value="general" data-v-6ccf5f4c>General Question</option><option value="technical" data-v-6ccf5f4c>Technical Support</option><option value="business" data-v-6ccf5f4c>Business Partnership</option><option value="other" data-v-6ccf5f4c>Other</option>',7)])],512),[[bs,r.form.subject]])]),a("div",V2,[e[24]||(e[24]=a("label",{for:"contact-message"},"Message *",-1)),Pe(a("textarea",{id:"contact-message","onUpdate:modelValue":e[10]||(e[10]=o=>r.form.message=o),rows:"5",required:"",placeholder:"Tell us how we can help you..."},null,512),[[Ze,r.form.message]])]),a("button",{type:"submit",class:"send-message-btn",disabled:r.isSubmitting},p(r.isSubmitting?"Sending...":"Send Message"),9,$2)],32)])])]),e[27]||(e[27]=Nt('<div class="social-media-section" data-v-6ccf5f4c><h3 data-v-6ccf5f4c>Follow Us</h3><div class="social-links" data-v-6ccf5f4c><a href="#" class="social-link" title="LinkedIn" data-v-6ccf5f4c><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6ccf5f4c><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" fill="currentColor" data-v-6ccf5f4c></path></svg></a><a href="#" class="social-link" title="Instagram" data-v-6ccf5f4c><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6ccf5f4c><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" fill="currentColor" data-v-6ccf5f4c></path></svg></a><a href="#" class="social-link" title="X (Twitter)" data-v-6ccf5f4c><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6ccf5f4c><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" fill="currentColor" data-v-6ccf5f4c></path></svg></a></div></div>',1))])],2)],64)}const yg=It(S2,[["render",j2],["__scopeId","data-v-6ccf5f4c"]]),H2={name:"ListedProjectsView",props:{code:{type:String,default:null}},data(){return{filters:{q:"",type:"",status:"",minYield:0,maxYield:20},products:[],currentProduct:null,loading:!0,error:null,refreshInterval:null,lastRefreshTime:null,isDetailView:!1}},async mounted(){this.isDetailView=!!this.code,this.isDetailView?await this.loadSingleProduct():await this.loadProducts(),this.setupDatabaseSync()},beforeUnmount(){this.cleanupDatabaseSync()},watch:{$route(t,e){t.params.code!==e.params.code&&(this.code=t.params.code,this.isDetailView=!!this.code,this.isDetailView?this.loadSingleProduct():this.loadProducts())},code:{handler(t){this.isDetailView=!!t,this.isDetailView?this.loadSingleProduct():this.loadProducts()},immediate:!0}},methods:{async loadSingleProduct(){try{this.loading=!0,this.error=null,console.log("🔄 ProjectsView: 从数据库加载单个产品数据...",this.code);const t=await Kt.getProductByCode(this.code);if(t.status===0){const e=t.data,s={...e,totalOffering:e.total_token,subscribed:e.current_subscribed_token,targetYield:e.target_yield,ltv:e.LTV,annualInterestRate:e.annual_interest_rate,loanAmount:e.loan_amount,valuation:e.valuation,image:e.image||this.getProductImage(e.code),totalOfferingRaw:e.total_token||0,subscribedRaw:e.current_subscribed_token||0};this.currentProduct={code:s.code,name:s.name,image:s.image,subtitle:s.subtitle,type:s.type,risk:s.risk,targetYield:s.targetYield,status:s.status,summary:s.summary,totalOffering:s.totalOffering,subscribed:s.subscribed,totalSubscriptionTokens:s.totalSubscriptionTokens,subscribedTokens:s.subscribedTokens,metrics:{currentElaraPrice:this.calculateTokenPrice(s),collateralPropertyValue:s.valuation||"TBA",rentalIncome:this.calculateRentalIncome(s),targetLoanYield:`${s.targetYield}% p.a.`},loanAmount:s.loanAmount,annualInterestRate:s.annualInterestRate,loanTerm:s.loanTerm,ltv:s.ltv,drawdownDate:s.drawdownDate,earlyRepayment:s.earlyRepayment,repaymentArrangement:s.repaymentArrangement,issuer:s.issuer,pwShareholders:s.pwShareholders,lender:s.lender,borrower:s.borrower,guarantor:s.guarantor,disbursementMethod:s.disbursementMethod,interest:s.interest,earlyRepaymentDetails:s.earlyRepaymentDetails,maturityDate:s.maturityDate,propertyAddress:s.propertyAddress,valuation:s.valuation,securityRank:s.securityRank,defaultInterestRate:s.defaultInterestRate,defaultTriggers:s.defaultTriggers,defaultProcess:s.defaultProcess,issuerToken:s.issuerToken,loanToken:s.loanToken,valuationReport:s.valuationReport,mortgageDeed:s.mortgageDeed},this.lastRefreshTime=new Date,console.log("✅ ProjectsView: 单个产品数据加载成功:",this.currentProduct)}else this.error=t.message||"获取产品数据失败",console.error("❌ ProjectsView: API返回错误:",t)}catch(t){this.error="网络错误，无法获取产品数据",console.error("❌ ProjectsView: 获取单个产品数据失败:",t)}finally{this.loading=!1}},async loadProducts(){try{this.loading=!0,this.error=null,console.log("🔄 从数据库加载产品数据...");const t=await Kt.getAllProducts();t.status===0?(this.products=(t.data||[]).map(e=>{const s={id:e.id,code:e.code,name:e.name,status:e.status,totalOffering:e.total_offering_token?`AUD$${e.total_offering_token.toLocaleString()}`:"AUD$0",subscribed:e.subscribe_token?`AUD$${e.subscribe_token.toLocaleString()}`:"AUD$0",totalOfferingRaw:e.total_offering_token||0,subscribedRaw:e.subscribe_token||0,property_location:e.propertyLocation,property_state:e.propertyState,property_type:e.propertyType,property_value:e.propertyValue,property_summary:e.propertySummary,loan_type:e.loanType,loan_product:e.loanProduct,loan_amount:e.loanAmount,loan_purpose:e.loanPurpose,loan_term_months:e.loanTermMonths,lvr:e.lvr,interest_rate:e.interestRate,default_rate:e.defaultRate,commencement_date:e.commencementDate,expiry_date:e.expiryDate,expected_recovery_date:e.expectedRecoveryDate,subtitle:`${e.loanProduct} - ${e.propertyType}`,loanAmount:e.loanAmount?`AUD$${e.loanAmount.toLocaleString()}`:"AUD$0",loanTerm:`${e.loanTermMonths} months`,targetYield:e.interestRate,image:e.image||this.getProductImage(e.code)};return s.metrics={currentElaraPrice:this.calculateTokenPrice(s),collateralPropertyValue:e.propertyValue?`AUD$${e.propertyValue.toLocaleString()}`:"TBA",rentalIncome:this.calculateRentalIncome(s),targetLoanYield:`${e.interestRate}% p.a.`},s}),this.lastRefreshTime=new Date,console.log("✅ 产品数据加载成功，共",this.products.length,"个项目")):(this.error=t.message||"获取产品数据失败",console.error("❌ API返回错误:",t))}catch(t){this.error="网络错误，无法获取产品数据",console.error("❌ 加载产品数据失败:",t)}finally{this.loading=!1}},async refreshProducts(){console.log("🔄 手动刷新产品数据..."),this.isDetailView?await this.loadSingleProduct():await this.loadProducts()},setupDatabaseSync(){const{subscribeProducts:t,subscribeNewProjects:e,getLastRefreshTime:s}=Dr();this.unsubscribeProducts=t(r=>{console.log("📡 ProjectsView: 收到产品数据更新，共",r.length,"个项目"),this.products=r.map(i=>({...i,totalOffering:i.total_token,subscribed:i.current_subscribed_token,targetYield:i.target_yield,ltv:i.LTV,annualInterestRate:i.annual_interest_rate,totalOfferingRaw:i.total_token||0,subscribedRaw:i.current_subscribed_token||0,loanAmount:i.loan_amount,valuation:i.valuation,image:i.image||this.getProductImage(i.code)})),this.lastRefreshTime=new Date}),this.unsubscribeNewProjects=e(r=>{console.log("🆕 ProjectsView: 发现",r.length,"个新项目"),this.showNewProjectsNotification(r)});const n=s();n&&(this.lastRefreshTime=n)},cleanupDatabaseSync(){this.unsubscribeProducts&&this.unsubscribeProducts(),this.unsubscribeNewProjects&&this.unsubscribeNewProjects()},showNewProjectsNotification(t){if(t.length>0){const e=t.map(s=>s.name).join(", ");console.log("🆕 发现新项目:",e)}},startAutoRefresh(){this.refreshInterval=setInterval(()=>{console.log("🔄 自动刷新产品数据..."),this.loadProducts()},3e4)},stopAutoRefresh(){this.refreshInterval&&(clearInterval(this.refreshInterval),this.refreshInterval=null,console.log("⏹️ 停止自动刷新"))},formatCurrency(t){if(!t)return null;const e=parseFloat(t);return isNaN(e)?t:`AUD$${e.toLocaleString()}`},resetFilters(){this.filters={q:"",type:"",risk:"",status:"",minYield:0,maxYield:20}},onFilterChange(){console.log("筛选器变化:",this.filters),this.$forceUpdate()},openDetail(t){const e=this.products.find(n=>n.code===t);try{sessionStorage.setItem("lastProduct",JSON.stringify(e))}catch{}const s=e.project_id||t;this.$router.push({name:"detail",params:{id:s}})},openTrade(t){const e=this.products.find(s=>s.code===t);try{sessionStorage.setItem("lastProduct",JSON.stringify(e))}catch{}this.$router.push({name:"tradeProject",params:{code:t}})},getProgressPercentage(t){if(!t)return 0;const e=t.totalOfferingRaw||0,s=t.subscribedRaw||0;if(e===0)return 0;const n=s/e*100;return Math.min(Math.round(n),100)},getStatusText(t){return{INCOMING:"Incoming",ACTIVE:"Active",PERFORMING:"Performing",DEFAULT:"Default",COMPLETED:"Completed"}[t]||"Unknown"},joinWaitlist(t){this.addToWatchlist(t)},registerInterest(t){this.addToWatchlist(t)},addToWatchlist(t){try{let e=[];const s=localStorage.getItem("projectWatchlist");if(s&&(e=JSON.parse(s)),e.includes(t)){alert("This Project is already in your watchlist!");return}e.push(t),localStorage.setItem("projectWatchlist",JSON.stringify(e));const n=this.products.find(r=>r.code===t);alert(`Added ${n.name} to your watchlist!`),console.log("Added to watchlist:",t)}catch(e){console.error("❌ Projects: Failed to add to watchlist:",e),alert("Failed to add to watchlist, please try again")}},formatTime(t){if(!t)return"";const s=new Date-t,n=Math.floor(s/6e4);if(n<1)return"Just now";if(n<60)return`${n} minutes ago`;const r=Math.floor(n/60);return r<24?`${r} hours ago`:`${Math.floor(r/24)} days ago`},getProductImage(t){return{RWA001:"/pics/TYMU.png",RWA002:"/pics/SQNB.png",RWA003:"/pics/LZYT.png",YYD:"/pics/YYD.png",COMP:"/pics/TYMU.png"}[t]||"/pics/TYMU.png"},calculateTokenPrice(t){return`AUD$${(1*((t.targetYield||6)/6)).toFixed(2)}`},calculateRentalIncome(t){if(!t.valuation)return"TBA";const e=t.valuation.replace(/[AUD$,]/g,""),s=parseFloat(e),n=(t.targetYield||6)/12/100;return`AUD$${(s*n).toLocaleString("en-AU",{maximumFractionDigits:0})} / month`},getSubscriptionProgress(t){if(!t)return 0;const e=t.totalOfferingRaw||0,s=t.subscribedRaw||0;if(e===0)return 0;const n=s/e*100;return Math.round(n*100)/100},formatNumber(t){if(!t)return"0";const e=parseFloat(t);return isNaN(e)?t:e.toLocaleString()}},computed:{filteredProducts(){const t=this.filters.q.trim().toLowerCase();return this.products.filter(e=>{if(e.status!=="ACTIVE")return!1;const s=!t||e.code.toLowerCase().includes(t)||(e.name||"").toLowerCase().includes(t)||(e.subtitle||"").toLowerCase().includes(t),n=!this.filters.type||e.property_type===this.filters.type,r=!this.filters.status||e.status===this.filters.status,i=parseFloat(e.targetYield)||0,o=i>=this.filters.minYield&&i<=this.filters.maxYield;return s&&n&&r&&o}).sort((e,s)=>e.code.localeCompare(s.code))},hasActiveFilters(){return this.filters.q.trim()!==""||this.filters.type!==""||this.filters.status!==""||this.filters.minYield>0||this.filters.maxYield<20},projectData(){const t=this.project;if(t)return console.log("TradeProjectView: Retrieve project data from database:",t),{code:t.code,name:t.name,image:t.image||this.getProductImage(t.code),subtitle:t.subtitle,type:t.type,risk:t.risk,targetYield:t.targetYield,status:t.status,summary:t.summary,totalOffering:t.totalOffering,subscribed:t.subscribed,totalSubscriptionTokens:t.totalSubscriptionTokens,subscribedTokens:t.subscribedTokens,metrics:{currentElaraPrice:this.calculateTokenPrice(t),collateralPropertyValue:t.valuation||"TBA",rentalIncome:this.calculateRentalIncome(t),targetLoanYield:`${t.targetYield}% p.a.`},loanAmount:t.loanAmount,annualInterestRate:t.annualInterestRate,loanTerm:t.loanTerm,ltv:t.ltv,drawdownDate:t.drawdownDate,earlyRepayment:t.earlyRepayment,repaymentArrangement:t.repaymentArrangement,issuer:t.issuer,pwShareholders:t.pwShareholders,lender:t.lender,borrower:t.borrower,guarantor:t.guarantor,disbursementMethod:t.disbursementMethod,interest:t.interest,earlyRepaymentDetails:t.earlyRepaymentDetails,maturityDate:t.maturityDate,propertyAddress:t.propertyAddress,valuation:t.valuation,securityRank:t.securityRank,defaultInterestRate:t.defaultInterestRate,defaultTriggers:t.defaultTriggers,defaultProcess:t.defaultProcess,issuerToken:t.issuerToken,loanToken:t.loanToken,valuationReport:t.valuationReport,mortgageDeed:t.mortgageDeed}}}},W2={class:"container"},Y2={class:"project-container"},G2={class:"doc-header"},K2={class:"headline"},z2={class:"subline"},Q2={key:0,class:"filters",style:{display:"flex",gap:"10px","flex-wrap":"wrap","align-items":"center",margin:"8px 0 6px"}},J2={class:"yield-range-filter"},q2={class:"yield-range-container"},Z2={class:"yield-range-slider"},X2=["max"],e_=["min"],t_={class:"yield-range-display"},s_={key:1,class:"filter-stats",style:{margin:"8px 0",color:"var(--muted)","font-size":"14px",display:"flex","justify-content":"space-between","align-items":"center","flex-wrap":"wrap",gap:"8px"}},n_={key:0,style:{"margin-left":"12px"}},r_={style:{display:"flex","align-items":"center",gap:"12px"}},i_={key:0,style:{"font-size":"12px",color:"#6b7280"}},o_=["disabled"],a_={key:2,class:"loading-container"},l_={key:3,class:"error-container"},c_={class:"error-message"},u_={key:4,class:"doc-list"},d_={class:"doc-card","aria-labelledby":"'title-' + currentProduct.code"},f_={class:"main-content"},h_={class:"left-content"},p_={class:"title-section"},m_={class:"title-header"},g_=["id"],y_={class:"doc-code"},v_={class:"doc-name"},b_={class:"doc-subtitle"},w_={class:"project-basic-info"},A_={class:"info-item"},E_={class:"info-value"},__={class:"progress-actions-row"},T_={class:"progress-container"},P_={class:"progress-bar"},k_={class:"progress-text"},S_={class:"doc-actions"},C_={key:5,class:"doc-list"},I_={class:"pf-project-header"},R_=["src","alt"],D_={class:"pf-project-info"},x_=["id"],N_={class:"pf-project-metrics"},L_={class:"pf-project-metric"},O_={class:"pf-metric-value"},U_={class:"pf-project-metric"},B_={class:"pf-metric-value",style:{color:"#16a34a"}},M_={class:"pf-project-metric"},F_={class:"pf-metric-value"},V_={class:"pf-investment-progress"},$_={class:"pf-progress-metrics"},j_={class:"pf-progress-metric"},H_={class:"pf-progress-value"},W_={class:"pf-progress-metric"},Y_={class:"pf-progress-value"},G_={class:"pf-progress-bar-container"},K_={class:"pf-progress-bar"},z_={class:"pf-progress-text"},Q_={class:"pf-project-actions"},J_=["onClick"],q_=["onClick"],Z_=["onClick"],X_=["onClick"],eT=["onClick"],tT=["onClick"],sT=["onClick"],nT=["onClick"],rT=["onClick"];function iT(t,e,s,n,r,i){return m(),g("div",W2,[a("div",Y2,[a("header",G2,[a("h1",K2,[r.isDetailView&&r.currentProduct?(m(),g(me,{key:0},[ne(p(r.currentProduct.name)+" - "+p(r.currentProduct.code),1)],64)):(m(),g(me,{key:1},[ne(" Active Property Loans ")],64))]),a("p",z2,[r.isDetailView&&r.currentProduct?(m(),g(me,{key:0},[ne(p(r.currentProduct.subtitle),1)],64)):B("",!0)])]),r.isDetailView?B("",!0):(m(),g("div",Q2,[Pe(a("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.filters.q=o),class:"input",placeholder:"Search code/name/subtitle",style:{"max-width":"240px",height:"38px"}},null,512),[[Ze,r.filters.q]]),Pe(a("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.filters.type=o),class:"input",style:{"max-width":"160px",height:"38px"}},[...e[19]||(e[19]=[Nt('<option value="" data-v-48be05bd>All Types</option><option value="Single House" data-v-48be05bd>Single House</option><option value="Commercial Building" data-v-48be05bd>Commercial Building</option><option value="Unit Development" data-v-48be05bd>Unit Development</option><option value="Residential Land" data-v-48be05bd>Residential Land</option><option value="Mixed Use" data-v-48be05bd>Mixed Use</option><option value="Retail" data-v-48be05bd>Retail</option><option value="Office" data-v-48be05bd>Office</option><option value="Industrial" data-v-48be05bd>Industrial</option><option value="Student Accommodation" data-v-48be05bd>Student Accommodation</option>',10)])],512),[[bs,r.filters.type]]),a("div",J2,[e[20]||(e[20]=a("label",{class:"yield-range-label"},"EST. YIELD (IRR) Range:",-1)),a("div",q2,[a("div",Z2,[Pe(a("input",{type:"range","onUpdate:modelValue":e[2]||(e[2]=o=>r.filters.minYield=o),min:0,max:r.filters.maxYield-.5,step:.5,onInput:e[3]||(e[3]=(...o)=>i.onFilterChange&&i.onFilterChange(...o)),class:"yield-slider yield-slider-min"},null,40,X2),[[Ze,r.filters.minYield,void 0,{number:!0}]]),Pe(a("input",{type:"range","onUpdate:modelValue":e[4]||(e[4]=o=>r.filters.maxYield=o),min:r.filters.minYield+.5,max:20,step:.5,onInput:e[5]||(e[5]=(...o)=>i.onFilterChange&&i.onFilterChange(...o)),class:"yield-slider yield-slider-max"},null,40,e_),[[Ze,r.filters.maxYield,void 0,{number:!0}]])]),a("div",t_,p(r.filters.minYield)+"% - "+p(r.filters.maxYield)+"% ",1)])]),a("button",{class:"btn",onClick:e[6]||(e[6]=(...o)=>i.resetFilters&&i.resetFilters(...o))},"Reset")])),r.isDetailView?B("",!0):(m(),g("div",s_,[a("div",null,[ne(" Showing "+p(i.filteredProducts.length)+" of "+p(r.products.length)+" projects ",1),i.hasActiveFilters?(m(),g("span",n_,[a("button",{onClick:e[7]||(e[7]=(...o)=>i.resetFilters&&i.resetFilters(...o)),style:{background:"none",border:"none",color:"#3b82f6","text-decoration":"underline",cursor:"pointer"}}," Clear filters ")])):B("",!0)]),a("div",r_,[r.lastRefreshTime?(m(),g("span",i_," Last Updated: "+p(i.formatTime(r.lastRefreshTime)),1)):B("",!0),a("button",{onClick:e[8]||(e[8]=(...o)=>i.refreshProducts&&i.refreshProducts(...o)),disabled:r.loading,class:"refresh-btn",style:xt([{background:"#374151",border:"1px solid #4b5563",color:"#ffffff",padding:"6px 12px","border-radius":"6px","font-size":"12px",cursor:"pointer",transition:"all 0.2s ease"},{opacity:r.loading?.6:1,cursor:r.loading?"not-allowed":"pointer"}])},p(r.loading?"Refreshing...":"Refresh Data"),13,o_)])])),r.loading?(m(),g("div",a_,[...e[21]||(e[21]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Loading product data...",-1)])])):r.error?(m(),g("div",l_,[a("div",c_,[e[22]||(e[22]=a("h3",null,"Load Failed",-1)),a("button",{onClick:e[9]||(e[9]=(...o)=>i.loadProducts&&i.loadProducts(...o)),class:"btn retry-btn"},"Retry")])])):r.isDetailView&&r.currentProduct?(m(),g("section",u_,[a("article",d_,[a("div",f_,[a("div",h_,[a("section",p_,[a("div",m_,[a("h2",{id:"title-"+r.currentProduct.code},[a("span",y_,p(r.currentProduct.code),1),a("span",v_,p(r.currentProduct.name),1)],8,g_),a("div",{class:be(["status-badge","status-"+r.currentProduct.status])},p(i.getStatusText(r.currentProduct.status)),3)]),a("p",b_,p(r.currentProduct.subtitle),1),a("div",w_,[a("div",A_,[e[23]||(e[23]=a("span",{class:"info-label"},"Type:",-1)),a("span",E_,p(r.currentProduct.type),1)])])]),e[24]||(e[24]=a("hr",{class:"sep"},null,-1))])]),a("div",__,[a("div",T_,[a("div",P_,[a("div",{class:"progress-fill",style:xt({width:i.getProgressPercentage(r.currentProduct)+"%"})},null,4),a("div",{class:"progress-empty",style:xt({width:100-i.getProgressPercentage(r.currentProduct)+"%"})},null,4)]),a("span",k_,p(i.getProgressPercentage(r.currentProduct))+"%",1)]),a("div",S_,[r.currentProduct.status==="ACTIVE"?(m(),g(me,{key:0},[a("a",{href:"#",class:"btn small orange",onClick:e[10]||(e[10]=ue(o=>i.openTrade(r.currentProduct.code),["prevent"]))},"Buy"),a("a",{href:"#",class:"btn small",onClick:e[11]||(e[11]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"Detail")],64)):r.currentProduct.status==="INCOMING"?(m(),g(me,{key:1},[a("a",{href:"#",class:"btn small",onClick:e[12]||(e[12]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"Preview"),a("a",{href:"#",class:"btn small",onClick:e[13]||(e[13]=ue(o=>i.joinWaitlist(r.currentProduct.code),["prevent"]))},"Join Waitlist")],64)):r.currentProduct.status==="PERFORMING"?(m(),g("a",{key:2,href:"#",class:"btn small",onClick:e[14]||(e[14]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):r.currentProduct.status==="COMPLETED"?(m(),g("a",{key:3,href:"#",class:"btn small",onClick:e[15]||(e[15]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):r.currentProduct.status==="COMPLETE"?(m(),g("a",{key:4,href:"#",class:"btn small",onClick:e[16]||(e[16]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):r.currentProduct.status==="DEFAULT"?(m(),g("a",{key:5,href:"#",class:"btn small",onClick:e[17]||(e[17]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):(m(),g("a",{key:6,href:"#",class:"btn small",onClick:e[18]||(e[18]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"Learn More"))])])])])):(m(),g("section",C_,[(m(!0),g(me,null,dt(i.filteredProducts,o=>(m(),g("article",{key:o.code,class:"pf-project-card","aria-labelledby":"'title-' + p.code"},[a("div",I_,[a("img",{src:o.image,class:"pf-project-image",alt:o.code},null,8,R_),a("div",D_,[a("h4",{id:"title-"+o.code},p(o.code)+" • "+p(o.name),9,x_),a("p",null,p(o.subtitle),1)]),a("div",{class:be(["status-badge","status-"+o.status])},p(i.getStatusText(o.status)),3)]),a("div",N_,[a("div",L_,[e[25]||(e[25]=a("span",{class:"pf-metric-label"},"LOAN SIZE",-1)),a("span",O_,p(o.loanAmount),1)]),a("div",U_,[e[26]||(e[26]=a("span",{class:"pf-metric-label"},"EST. YIELD (IRR)",-1)),a("span",B_,p(o.metrics.targetLoanYield),1)]),a("div",M_,[e[27]||(e[27]=a("span",{class:"pf-metric-label"},"TERM",-1)),a("span",F_,p(o.loanTerm),1)])]),a("div",V_,[a("div",$_,[a("div",j_,[e[28]||(e[28]=a("span",{class:"pf-progress-label"},"SUBSCRIBED",-1)),a("span",H_,p(i.formatNumber(o.subscribed||0)),1)]),a("div",W_,[e[29]||(e[29]=a("span",{class:"pf-progress-label"},"TOTAL OFFERING",-1)),a("span",Y_,p(i.formatNumber(o.totalOffering||0)),1)])]),a("div",G_,[a("div",K_,[a("div",{class:"pf-progress-fill",style:xt({width:i.getSubscriptionProgress(o)+"%"})},null,4)]),a("div",z_,p(i.getSubscriptionProgress(o))+"% Subscribed",1)])]),a("div",Q_,[o.status==="ACTIVE"?(m(),g(me,{key:0},[a("button",{class:"pf-project-btn pf-project-btn-secondary",onClick:l=>i.openTrade(o.code)},"BUY",8,J_),a("button",{class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,q_)],64)):o.status==="INCOMING"?(m(),g(me,{key:1},[a("button",{class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,Z_),a("button",{class:"pf-project-btn",onClick:l=>i.joinWaitlist(o.code)},"ADD TO WATCHLIST",8,X_)],64)):o.status==="PERFORMING"?(m(),g("button",{key:2,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,eT)):o.status==="COMPLETED"?(m(),g("button",{key:3,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,tT)):o.status==="COMPLETE"?(m(),g("button",{key:4,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,sT)):o.status==="DEFAULT"?(m(),g("button",{key:5,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,nT)):(m(),g("button",{key:6,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,rT))])]))),128))]))])])}const Sc=It(H2,[["render",iT],["__scopeId","data-v-48be05bd"]]);/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const $r=typeof document<"u";function vg(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function oT(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&vg(t.default)}const Je=Object.assign;function Bl(t,e){const s={};for(const n in e){const r=e[n];s[n]=Ks(r)?r.map(t):t(r)}return s}const Wi=()=>{},Ks=Array.isArray,bg=/#/g,aT=/&/g,lT=/\//g,cT=/=/g,uT=/\?/g,wg=/\+/g,dT=/%5B/g,fT=/%5D/g,Ag=/%5E/g,hT=/%60/g,Eg=/%7B/g,pT=/%7C/g,_g=/%7D/g,mT=/%20/g;function Au(t){return encodeURI(""+t).replace(pT,"|").replace(dT,"[").replace(fT,"]")}function gT(t){return Au(t).replace(Eg,"{").replace(_g,"}").replace(Ag,"^")}function Cc(t){return Au(t).replace(wg,"%2B").replace(mT,"+").replace(bg,"%23").replace(aT,"%26").replace(hT,"`").replace(Eg,"{").replace(_g,"}").replace(Ag,"^")}function yT(t){return Cc(t).replace(cT,"%3D")}function vT(t){return Au(t).replace(bg,"%23").replace(uT,"%3F")}function bT(t){return t==null?"":vT(t).replace(lT,"%2F")}function uo(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const wT=/\/$/,AT=t=>t.replace(wT,"");function Ml(t,e,s="/"){let n,r={},i="",o="";const l=e.indexOf("#");let c=e.indexOf("?");return l<c&&l>=0&&(c=-1),c>-1&&(n=e.slice(0,c),i=e.slice(c+1,l>-1?l:e.length),r=t(i)),l>-1&&(n=n||e.slice(0,l),o=e.slice(l,e.length)),n=PT(n??e,s),{fullPath:n+(i&&"?")+i+o,path:n,query:r,hash:uo(o)}}function ET(t,e){const s=e.query?t(e.query):"";return e.path+(s&&"?")+s+(e.hash||"")}function kf(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function _T(t,e,s){const n=e.matched.length-1,r=s.matched.length-1;return n>-1&&n===r&&fi(e.matched[n],s.matched[r])&&Tg(e.params,s.params)&&t(e.query)===t(s.query)&&e.hash===s.hash}function fi(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Tg(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(!TT(t[s],e[s]))return!1;return!0}function TT(t,e){return Ks(t)?Sf(t,e):Ks(e)?Sf(e,t):t===e}function Sf(t,e){return Ks(e)?t.length===e.length&&t.every((s,n)=>s===e[n]):t.length===1&&t[0]===e}function PT(t,e){if(t.startsWith("/"))return t;if(!t)return e;const s=e.split("/"),n=t.split("/"),r=n[n.length-1];(r===".."||r===".")&&n.push("");let i=s.length-1,o,l;for(o=0;o<n.length;o++)if(l=n[o],l!==".")if(l==="..")i>1&&i--;else break;return s.slice(0,i).join("/")+"/"+n.slice(o).join("/")}const Mn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var fo;(function(t){t.pop="pop",t.push="push"})(fo||(fo={}));var Yi;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Yi||(Yi={}));function kT(t){if(!t)if($r){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),AT(t)}const ST=/^[^#]+#/;function CT(t,e){return t.replace(ST,"#")+e}function IT(t,e){const s=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:e.behavior,left:n.left-s.left-(e.left||0),top:n.top-s.top-(e.top||0)}}const el=()=>({left:window.scrollX,top:window.scrollY});function RT(t){let e;if("el"in t){const s=t.el,n=typeof s=="string"&&s.startsWith("#"),r=typeof s=="string"?n?document.getElementById(s.slice(1)):document.querySelector(s):s;if(!r)return;e=IT(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Cf(t,e){return(history.state?history.state.position-e:-1)+t}const Ic=new Map;function DT(t,e){Ic.set(t,e)}function xT(t){const e=Ic.get(t);return Ic.delete(t),e}let NT=()=>location.protocol+"//"+location.host;function Pg(t,e){const{pathname:s,search:n,hash:r}=e,i=t.indexOf("#");if(i>-1){let l=r.includes(t.slice(i))?t.slice(i).length:1,c=r.slice(l);return c[0]!=="/"&&(c="/"+c),kf(c,"")}return kf(s,t)+n+r}function LT(t,e,s,n){let r=[],i=[],o=null;const l=({state:h})=>{const y=Pg(t,location),T=s.value,w=e.value;let k=0;if(h){if(s.value=y,e.value=h,o&&o===T){o=null;return}k=w?h.position-w.position:0}else n(y);r.forEach(C=>{C(s.value,T,{delta:k,type:fo.pop,direction:k?k>0?Yi.forward:Yi.back:Yi.unknown})})};function c(){o=s.value}function u(h){r.push(h);const y=()=>{const T=r.indexOf(h);T>-1&&r.splice(T,1)};return i.push(y),y}function d(){const{history:h}=window;h.state&&h.replaceState(Je({},h.state,{scroll:el()}),"")}function f(){for(const h of i)h();i=[],window.removeEventListener("popstate",l),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",l),window.addEventListener("beforeunload",d,{passive:!0}),{pauseListeners:c,listen:u,destroy:f}}function If(t,e,s,n=!1,r=!1){return{back:t,current:e,forward:s,replaced:n,position:window.history.length,scroll:r?el():null}}function OT(t){const{history:e,location:s}=window,n={value:Pg(t,s)},r={value:e.state};r.value||i(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,u,d){const f=t.indexOf("#"),h=f>-1?(s.host&&document.querySelector("base")?t:t.slice(f))+c:NT()+t+c;try{e[d?"replaceState":"pushState"](u,"",h),r.value=u}catch(y){console.error(y),s[d?"replace":"assign"](h)}}function o(c,u){const d=Je({},e.state,If(r.value.back,c,r.value.forward,!0),u,{position:r.value.position});i(c,d,!0),n.value=c}function l(c,u){const d=Je({},r.value,e.state,{forward:c,scroll:el()});i(d.current,d,!0);const f=Je({},If(n.value,c,null),{position:d.position+1},u);i(c,f,!1),n.value=c}return{location:n,state:r,push:l,replace:o}}function UT(t){t=kT(t);const e=OT(t),s=LT(t,e.state,e.location,e.replace);function n(i,o=!0){o||s.pauseListeners(),history.go(i)}const r=Je({location:"",base:t,go:n,createHref:CT.bind(null,t)},e,s);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function BT(t){return typeof t=="string"||t&&typeof t=="object"}function kg(t){return typeof t=="string"||typeof t=="symbol"}const Sg=Symbol("");var Rf;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Rf||(Rf={}));function hi(t,e){return Je(new Error,{type:t,[Sg]:!0},e)}function un(t,e){return t instanceof Error&&Sg in t&&(e==null||!!(t.type&e))}const Df="[^/]+?",MT={sensitive:!1,strict:!1,start:!0,end:!0},FT=/[.+*?^${}()[\]/\\]/g;function VT(t,e){const s=Je({},MT,e),n=[];let r=s.start?"^":"";const i=[];for(const u of t){const d=u.length?[]:[90];s.strict&&!u.length&&(r+="/");for(let f=0;f<u.length;f++){const h=u[f];let y=40+(s.sensitive?.25:0);if(h.type===0)f||(r+="/"),r+=h.value.replace(FT,"\\$&"),y+=40;else if(h.type===1){const{value:T,repeatable:w,optional:k,regexp:C}=h;i.push({name:T,repeatable:w,optional:k});const N=C||Df;if(N!==Df){y+=10;try{new RegExp(`(${N})`)}catch(D){throw new Error(`Invalid custom RegExp for param "${T}" (${N}): `+D.message)}}let L=w?`((?:${N})(?:/(?:${N}))*)`:`(${N})`;f||(L=k&&u.length<2?`(?:/${L})`:"/"+L),k&&(L+="?"),r+=L,y+=20,k&&(y+=-8),w&&(y+=-20),N===".*"&&(y+=-50)}d.push(y)}n.push(d)}if(s.strict&&s.end){const u=n.length-1;n[u][n[u].length-1]+=.7000000000000001}s.strict||(r+="/?"),s.end?r+="$":s.strict&&!r.endsWith("/")&&(r+="(?:/|$)");const o=new RegExp(r,s.sensitive?"":"i");function l(u){const d=u.match(o),f={};if(!d)return null;for(let h=1;h<d.length;h++){const y=d[h]||"",T=i[h-1];f[T.name]=y&&T.repeatable?y.split("/"):y}return f}function c(u){let d="",f=!1;for(const h of t){(!f||!d.endsWith("/"))&&(d+="/"),f=!1;for(const y of h)if(y.type===0)d+=y.value;else if(y.type===1){const{value:T,repeatable:w,optional:k}=y,C=T in u?u[T]:"";if(Ks(C)&&!w)throw new Error(`Provided param "${T}" is an array but it is not repeatable (* or + modifiers)`);const N=Ks(C)?C.join("/"):C;if(!N)if(k)h.length<2&&(d.endsWith("/")?d=d.slice(0,-1):f=!0);else throw new Error(`Missing required param "${T}"`);d+=N}}return d||"/"}return{re:o,score:n,keys:i,parse:l,stringify:c}}function $T(t,e){let s=0;for(;s<t.length&&s<e.length;){const n=e[s]-t[s];if(n)return n;s++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function Cg(t,e){let s=0;const n=t.score,r=e.score;for(;s<n.length&&s<r.length;){const i=$T(n[s],r[s]);if(i)return i;s++}if(Math.abs(r.length-n.length)===1){if(xf(n))return 1;if(xf(r))return-1}return r.length-n.length}function xf(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const jT={type:0,value:""},HT=/[a-zA-Z0-9_]/;function WT(t){if(!t)return[[]];if(t==="/")return[[jT]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(y){throw new Error(`ERR (${s})/"${u}": ${y}`)}let s=0,n=s;const r=[];let i;function o(){i&&r.push(i),i=[]}let l=0,c,u="",d="";function f(){u&&(s===0?i.push({type:0,value:u}):s===1||s===2||s===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:d,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),u="")}function h(){u+=c}for(;l<t.length;){if(c=t[l++],c==="\\"&&s!==2){n=s,s=4;continue}switch(s){case 0:c==="/"?(u&&f(),o()):c===":"?(f(),s=1):h();break;case 4:h(),s=n;break;case 1:c==="("?s=2:HT.test(c)?h():(f(),s=0,c!=="*"&&c!=="?"&&c!=="+"&&l--);break;case 2:c===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+c:s=3:d+=c;break;case 3:f(),s=0,c!=="*"&&c!=="?"&&c!=="+"&&l--,d="";break;default:e("Unknown state");break}}return s===2&&e(`Unfinished custom RegExp for param "${u}"`),f(),o(),r}function YT(t,e,s){const n=VT(WT(t.path),s),r=Je(n,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function GT(t,e){const s=[],n=new Map;e=Uf({strict:!1,end:!0,sensitive:!1},e);function r(f){return n.get(f)}function i(f,h,y){const T=!y,w=Lf(f);w.aliasOf=y&&y.record;const k=Uf(e,f),C=[w];if("alias"in f){const D=typeof f.alias=="string"?[f.alias]:f.alias;for(const Y of D)C.push(Lf(Je({},w,{components:y?y.record.components:w.components,path:Y,aliasOf:y?y.record:w})))}let N,L;for(const D of C){const{path:Y}=D;if(h&&Y[0]!=="/"){const W=h.record.path,$=W[W.length-1]==="/"?"":"/";D.path=h.record.path+(Y&&$+Y)}if(N=YT(D,h,k),y?y.alias.push(N):(L=L||N,L!==N&&L.alias.push(N),T&&f.name&&!Of(N)&&o(f.name)),Ig(N)&&c(N),w.children){const W=w.children;for(let $=0;$<W.length;$++)i(W[$],N,y&&y.children[$])}y=y||N}return L?()=>{o(L)}:Wi}function o(f){if(kg(f)){const h=n.get(f);h&&(n.delete(f),s.splice(s.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=s.indexOf(f);h>-1&&(s.splice(h,1),f.record.name&&n.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function l(){return s}function c(f){const h=QT(f,s);s.splice(h,0,f),f.record.name&&!Of(f)&&n.set(f.record.name,f)}function u(f,h){let y,T={},w,k;if("name"in f&&f.name){if(y=n.get(f.name),!y)throw hi(1,{location:f});k=y.record.name,T=Je(Nf(h.params,y.keys.filter(L=>!L.optional).concat(y.parent?y.parent.keys.filter(L=>L.optional):[]).map(L=>L.name)),f.params&&Nf(f.params,y.keys.map(L=>L.name))),w=y.stringify(T)}else if(f.path!=null)w=f.path,y=s.find(L=>L.re.test(w)),y&&(T=y.parse(w),k=y.record.name);else{if(y=h.name?n.get(h.name):s.find(L=>L.re.test(h.path)),!y)throw hi(1,{location:f,currentLocation:h});k=y.record.name,T=Je({},h.params,f.params),w=y.stringify(T)}const C=[];let N=y;for(;N;)C.unshift(N.record),N=N.parent;return{name:k,path:w,params:T,matched:C,meta:zT(C)}}t.forEach(f=>i(f));function d(){s.length=0,n.clear()}return{addRoute:i,resolve:u,removeRoute:o,clearRoutes:d,getRoutes:l,getRecordMatcher:r}}function Nf(t,e){const s={};for(const n of e)n in t&&(s[n]=t[n]);return s}function Lf(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:KT(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function KT(t){const e={},s=t.props||!1;if("component"in t)e.default=s;else for(const n in t.components)e[n]=typeof s=="object"?s[n]:s;return e}function Of(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function zT(t){return t.reduce((e,s)=>Je(e,s.meta),{})}function Uf(t,e){const s={};for(const n in t)s[n]=n in e?e[n]:t[n];return s}function QT(t,e){let s=0,n=e.length;for(;s!==n;){const i=s+n>>1;Cg(t,e[i])<0?n=i:s=i+1}const r=JT(t);return r&&(n=e.lastIndexOf(r,n-1)),n}function JT(t){let e=t;for(;e=e.parent;)if(Ig(e)&&Cg(t,e)===0)return e}function Ig({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function qT(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<n.length;++r){const i=n[r].replace(wg," "),o=i.indexOf("="),l=uo(o<0?i:i.slice(0,o)),c=o<0?null:uo(i.slice(o+1));if(l in e){let u=e[l];Ks(u)||(u=e[l]=[u]),u.push(c)}else e[l]=c}return e}function Bf(t){let e="";for(let s in t){const n=t[s];if(s=yT(s),n==null){n!==void 0&&(e+=(e.length?"&":"")+s);continue}(Ks(n)?n.map(i=>i&&Cc(i)):[n&&Cc(n)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+s,i!=null&&(e+="="+i))})}return e}function ZT(t){const e={};for(const s in t){const n=t[s];n!==void 0&&(e[s]=Ks(n)?n.map(r=>r==null?null:""+r):n==null?n:""+n)}return e}const XT=Symbol(""),Mf=Symbol(""),tl=Symbol(""),Rg=Symbol(""),Rc=Symbol("");function Si(){let t=[];function e(n){return t.push(n),()=>{const r=t.indexOf(n);r>-1&&t.splice(r,1)}}function s(){t=[]}return{add:e,list:()=>t.slice(),reset:s}}function jn(t,e,s,n,r,i=o=>o()){const o=n&&(n.enterCallbacks[r]=n.enterCallbacks[r]||[]);return()=>new Promise((l,c)=>{const u=h=>{h===!1?c(hi(4,{from:s,to:e})):h instanceof Error?c(h):BT(h)?c(hi(2,{from:e,to:h})):(o&&n.enterCallbacks[r]===o&&typeof h=="function"&&o.push(h),l())},d=i(()=>t.call(n&&n.instances[r],e,s,u));let f=Promise.resolve(d);t.length<3&&(f=f.then(u)),f.catch(h=>c(h))})}function Fl(t,e,s,n,r=i=>i()){const i=[];for(const o of t)for(const l in o.components){let c=o.components[l];if(!(e!=="beforeRouteEnter"&&!o.instances[l]))if(vg(c)){const d=(c.__vccOpts||c)[e];d&&i.push(jn(d,s,n,o,l,r))}else{let u=c();i.push(()=>u.then(d=>{if(!d)throw new Error(`Couldn't resolve component "${l}" at "${o.path}"`);const f=oT(d)?d.default:d;o.mods[l]=d,o.components[l]=f;const y=(f.__vccOpts||f)[e];return y&&jn(y,s,n,o,l,r)()}))}}return i}function Ff(t){const e=rn(tl),s=rn(Rg),n=Ae(()=>{const c=Ke(t.to);return e.resolve(c)}),r=Ae(()=>{const{matched:c}=n.value,{length:u}=c,d=c[u-1],f=s.matched;if(!d||!f.length)return-1;const h=f.findIndex(fi.bind(null,d));if(h>-1)return h;const y=Vf(c[u-2]);return u>1&&Vf(d)===y&&f[f.length-1].path!==y?f.findIndex(fi.bind(null,c[u-2])):h}),i=Ae(()=>r.value>-1&&rP(s.params,n.value.params)),o=Ae(()=>r.value>-1&&r.value===s.matched.length-1&&Tg(s.params,n.value.params));function l(c={}){if(nP(c)){const u=e[Ke(t.replace)?"replace":"push"](Ke(t.to)).catch(Wi);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>u),u}return Promise.resolve()}return{route:n,href:Ae(()=>n.value.href),isActive:i,isExactActive:o,navigate:l}}function eP(t){return t.length===1?t[0]:t}const tP=Dh({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:Ff,setup(t,{slots:e}){const s=mo(Ff(t)),{options:n}=rn(tl),r=Ae(()=>({[$f(t.activeClass,n.linkActiveClass,"router-link-active")]:s.isActive,[$f(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:s.isExactActive}));return()=>{const i=e.default&&eP(e.default(s));return t.custom?i:zc("a",{"aria-current":s.isExactActive?t.ariaCurrentValue:null,href:s.href,onClick:s.navigate,class:r.value},i)}}}),sP=tP;function nP(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function rP(t,e){for(const s in e){const n=e[s],r=t[s];if(typeof n=="string"){if(n!==r)return!1}else if(!Ks(r)||r.length!==n.length||n.some((i,o)=>i!==r[o]))return!1}return!0}function Vf(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const $f=(t,e,s)=>t??e??s,iP=Dh({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:s}){const n=rn(Rc),r=Ae(()=>t.route||n.value),i=rn(Mf,0),o=Ae(()=>{let u=Ke(i);const{matched:d}=r.value;let f;for(;(f=d[u])&&!f.components;)u++;return u}),l=Ae(()=>r.value.matched[o.value]);Wo(Mf,Ae(()=>o.value+1)),Wo(XT,l),Wo(Rc,r);const c=fe();return en(()=>[c.value,l.value,t.name],([u,d,f],[h,y,T])=>{d&&(d.instances[f]=u,y&&y!==d&&u&&u===h&&(d.leaveGuards.size||(d.leaveGuards=y.leaveGuards),d.updateGuards.size||(d.updateGuards=y.updateGuards))),u&&d&&(!y||!fi(d,y)||!h)&&(d.enterCallbacks[f]||[]).forEach(w=>w(u))},{flush:"post"}),()=>{const u=r.value,d=t.name,f=l.value,h=f&&f.components[d];if(!h)return jf(s.default,{Component:h,route:u});const y=f.props[d],T=y?y===!0?u.params:typeof y=="function"?y(u):y:null,k=zc(h,Je({},T,e,{onVnodeUnmounted:C=>{C.component.isUnmounted&&(f.instances[d]=null)},ref:c}));return jf(s.default,{Component:k,route:u})||k}}});function jf(t,e){if(!t)return null;const s=t(e);return s.length===1?s[0]:s}const oP=iP;function aP(t){const e=GT(t.routes,t),s=t.parseQuery||qT,n=t.stringifyQuery||Bf,r=t.history,i=Si(),o=Si(),l=Si(),c=ky(Mn);let u=Mn;$r&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=Bl.bind(null,O=>""+O),f=Bl.bind(null,bT),h=Bl.bind(null,uo);function y(O,te){let Z,le;return kg(O)?(Z=e.getRecordMatcher(O),le=te):le=O,e.addRoute(le,Z)}function T(O){const te=e.getRecordMatcher(O);te&&e.removeRoute(te)}function w(){return e.getRoutes().map(O=>O.record)}function k(O){return!!e.getRecordMatcher(O)}function C(O,te){if(te=Je({},te||c.value),typeof O=="string"){const I=Ml(s,O,te.path),U=e.resolve({path:I.path},te),V=r.createHref(I.fullPath);return Je(I,U,{params:h(U.params),hash:uo(I.hash),redirectedFrom:void 0,href:V})}let Z;if(O.path!=null)Z=Je({},O,{path:Ml(s,O.path,te.path).path});else{const I=Je({},O.params);for(const U in I)I[U]==null&&delete I[U];Z=Je({},O,{params:f(I)}),te.params=f(te.params)}const le=e.resolve(Z,te),De=O.hash||"";le.params=d(h(le.params));const v=ET(n,Je({},O,{hash:gT(De),path:le.path})),_=r.createHref(v);return Je({fullPath:v,hash:De,query:n===Bf?ZT(O.query):O.query||{}},le,{redirectedFrom:void 0,href:_})}function N(O){return typeof O=="string"?Ml(s,O,c.value.path):Je({},O)}function L(O,te){if(u!==O)return hi(8,{from:te,to:O})}function D(O){return $(O)}function Y(O){return D(Je(N(O),{replace:!0}))}function W(O){const te=O.matched[O.matched.length-1];if(te&&te.redirect){const{redirect:Z}=te;let le=typeof Z=="function"?Z(O):Z;return typeof le=="string"&&(le=le.includes("?")||le.includes("#")?le=N(le):{path:le},le.params={}),Je({query:O.query,hash:O.hash,params:le.path!=null?{}:O.params},le)}}function $(O,te){const Z=u=C(O),le=c.value,De=O.state,v=O.force,_=O.replace===!0,I=W(Z);if(I)return $(Je(N(I),{state:typeof I=="object"?Je({},De,I.state):De,force:v,replace:_}),te||Z);const U=Z;U.redirectedFrom=te;let V;return!v&&_T(n,le,Z)&&(V=hi(16,{to:U,from:le}),je(le,le,!0,!1)),(V?Promise.resolve(V):re(U,le)).catch(M=>un(M)?un(M,2)?M:Ye(M):ge(M,U,le)).then(M=>{if(M){if(un(M,2))return $(Je({replace:_},N(M.to),{state:typeof M.to=="object"?Je({},De,M.to.state):De,force:v}),te||U)}else M=H(U,le,!0,_,De);return ce(U,le,M),M})}function Q(O,te){const Z=L(O,te);return Z?Promise.reject(Z):Promise.resolve()}function J(O){const te=Xe.values().next().value;return te&&typeof te.runWithContext=="function"?te.runWithContext(O):O()}function re(O,te){let Z;const[le,De,v]=lP(O,te);Z=Fl(le.reverse(),"beforeRouteLeave",O,te);for(const I of le)I.leaveGuards.forEach(U=>{Z.push(jn(U,O,te))});const _=Q.bind(null,O,te);return Z.push(_),st(Z).then(()=>{Z=[];for(const I of i.list())Z.push(jn(I,O,te));return Z.push(_),st(Z)}).then(()=>{Z=Fl(De,"beforeRouteUpdate",O,te);for(const I of De)I.updateGuards.forEach(U=>{Z.push(jn(U,O,te))});return Z.push(_),st(Z)}).then(()=>{Z=[];for(const I of v)if(I.beforeEnter)if(Ks(I.beforeEnter))for(const U of I.beforeEnter)Z.push(jn(U,O,te));else Z.push(jn(I.beforeEnter,O,te));return Z.push(_),st(Z)}).then(()=>(O.matched.forEach(I=>I.enterCallbacks={}),Z=Fl(v,"beforeRouteEnter",O,te,J),Z.push(_),st(Z))).then(()=>{Z=[];for(const I of o.list())Z.push(jn(I,O,te));return Z.push(_),st(Z)}).catch(I=>un(I,8)?I:Promise.reject(I))}function ce(O,te,Z){l.list().forEach(le=>J(()=>le(O,te,Z)))}function H(O,te,Z,le,De){const v=L(O,te);if(v)return v;const _=te===Mn,I=$r?history.state:{};Z&&(le||_?r.replace(O.fullPath,Je({scroll:_&&I&&I.scroll},De)):r.push(O.fullPath,De)),c.value=O,je(O,te,Z,_),Ye()}let we;function Ce(){we||(we=r.listen((O,te,Z)=>{if(!Et.listening)return;const le=C(O),De=W(le);if(De){$(Je(De,{replace:!0,force:!0}),le).catch(Wi);return}u=le;const v=c.value;$r&&DT(Cf(v.fullPath,Z.delta),el()),re(le,v).catch(_=>un(_,12)?_:un(_,2)?($(Je(N(_.to),{force:!0}),le).then(I=>{un(I,20)&&!Z.delta&&Z.type===fo.pop&&r.go(-1,!1)}).catch(Wi),Promise.reject()):(Z.delta&&r.go(-Z.delta,!1),ge(_,le,v))).then(_=>{_=_||H(le,v,!1),_&&(Z.delta&&!un(_,8)?r.go(-Z.delta,!1):Z.type===fo.pop&&un(_,20)&&r.go(-1,!1)),ce(le,v,_)}).catch(Wi)}))}let K=Si(),ee=Si(),ae;function ge(O,te,Z){Ye(O);const le=ee.list();return le.length?le.forEach(De=>De(O,te,Z)):console.error(O),Promise.reject(O)}function Re(){return ae&&c.value!==Mn?Promise.resolve():new Promise((O,te)=>{K.add([O,te])})}function Ye(O){return ae||(ae=!O,Ce(),K.list().forEach(([te,Z])=>O?Z(O):te()),K.reset()),O}function je(O,te,Z,le){const{scrollBehavior:De}=t;if(!$r||!De)return Promise.resolve();const v=!Z&&xT(Cf(O.fullPath,0))||(le||!Z)&&history.state&&history.state.scroll||null;return zi().then(()=>De(O,te,v)).then(_=>_&&RT(_)).catch(_=>ge(_,O,te))}const He=O=>r.go(O);let St;const Xe=new Set,Et={currentRoute:c,listening:!0,addRoute:y,removeRoute:T,clearRoutes:e.clearRoutes,hasRoute:k,getRoutes:w,resolve:C,options:t,push:D,replace:Y,go:He,back:()=>He(-1),forward:()=>He(1),beforeEach:i.add,beforeResolve:o.add,afterEach:l.add,onError:ee.add,isReady:Re,install(O){const te=this;O.component("RouterLink",sP),O.component("RouterView",oP),O.config.globalProperties.$router=te,Object.defineProperty(O.config.globalProperties,"$route",{enumerable:!0,get:()=>Ke(c)}),$r&&!St&&c.value===Mn&&(St=!0,D(r.location).catch(De=>{}));const Z={};for(const De in Mn)Object.defineProperty(Z,De,{get:()=>c.value[De],enumerable:!0});O.provide(tl,te),O.provide(Rg,gh(Z)),O.provide(Rc,c);const le=O.unmount;Xe.add(O),O.unmount=function(){Xe.delete(O),Xe.size<1&&(u=Mn,we&&we(),we=null,c.value=Mn,St=!1,ae=!1),le()}}};function st(O){return O.reduce((te,Z)=>te.then(()=>J(Z)),Promise.resolve())}return Et}function lP(t,e){const s=[],n=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const l=e.matched[o];l&&(t.matched.find(u=>fi(u,l))?n.push(l):s.push(l));const c=t.matched[o];c&&(e.matched.find(u=>fi(u,c))||r.push(c))}return[s,n,r]}function cP(){return rn(tl)}const uP={class:"container pf-page"},dP={class:"pf-mobile-header"},fP={class:"pf-mobile-nav"},hP={class:"pf-mobile-actions"},pP={class:"pf-main-content"},mP={class:"pf-body"},gP={class:"pf-side-head"},yP={class:"pf-side-tools"},vP={class:"pf-acc-group"},bP={class:"pf-acc-list"},wP=["onClick"],AP={class:"pf-acc-info"},EP={class:"pf-acc-name"},_P=["title"],TP={class:"pf-acc-balance"},PP={key:0,class:"pf-account-overview"},kP={class:"pf-stats"},SP={class:"pf-stat-card"},CP={class:"pf-stat-value"},IP={class:"pf-stat-card"},RP={class:"pf-stat-card"},DP={class:"pf-sidebar-pie-section"},xP={class:"pf-pie-chart-container"},NP={class:"pf-pie-chart"},LP={viewBox:"0 0 200 200",class:"pf-pie-svg"},OP=["stroke","stroke-dasharray","stroke-dashoffset"],UP=["x1","y1","x2","y2","stroke"],BP=["x","y","fill"],MP={class:"pf-pie-center"},FP={class:"pf-pie-total"},VP={class:"pf-chart-legend"},$P={class:"pf-legend-left"},jP={class:"pf-legend-code"},HP={class:"pf-legend-right"},WP={class:"pf-legend-value"},YP={class:"pf-main"},GP={class:"pf-hero"},KP={class:"pf-balance"},zP={class:"pf-tabs"},QP=["onClick"],JP={key:0,class:"pf-projects"},qP={key:0,class:"pf-empty-projects"},ZP={key:1,class:"pf-projects-grid"},XP={class:"pf-project-header"},ek=["src","alt"],tk={class:"pf-project-info"},sk={class:"pf-project-metrics"},nk={class:"pf-project-metric"},rk={class:"pf-metric-value"},ik={class:"pf-project-metric"},ok={key:0,class:"pf-project-metric"},ak={class:"pf-metric-value"},lk={key:1,class:"pf-project-metric"},ck={key:2,class:"pf-project-metric"},uk={class:"pf-project-actions"},dk=["onClick"],fk=["onClick"],hk=["onClick"],pk={key:1,class:"pf-watchlist"},mk={class:"pf-watchlist-header"},gk={class:"pf-watchlist-stats"},yk={class:"pf-watchlist-count"},vk={key:0,class:"pf-empty-watchlist"},bk={key:1,class:"pf-watchlist-grid"},wk={class:"pf-watchlist-card-header"},Ak=["src","alt"],Ek={class:"pf-watchlist-info"},_k={class:"pf-watchlist-actions"},Tk=["onClick"],Pk={class:"pf-watchlist-metrics"},kk={class:"pf-watchlist-metric"},Sk={class:"pf-watchlist-value"},Ck={class:"pf-watchlist-metric"},Ik={class:"pf-watchlist-value",style:{color:"#16a34a"}},Rk={class:"pf-watchlist-metric"},Dk={class:"pf-watchlist-progress"},xk={class:"pf-watchlist-progress-bar"},Nk={class:"pf-watchlist-progress-text"},Lk={class:"pf-watchlist-actions-bottom"},Ok=["onClick"],Uk=["onClick"],Bk={key:2,class:"pf-analysis"},Mk={class:"pf-analysis-overview"},Fk={class:"pf-analysis-header"},Vk={class:"pf-analysis-actions"},$k=["disabled"],jk={key:0},Hk={key:1},Wk={class:"pf-analysis-stats-four"},Yk={class:"pf-analysis-stat-card"},Gk={class:"pf-stat-content"},Kk={class:"pf-stat-label-inline"},zk={class:"pf-stat-number"},Qk={class:"pf-analysis-stat-card"},Jk={class:"pf-stat-content"},qk={class:"pf-stat-label-inline"},Zk={class:"pf-stat-number"},Xk={class:"pf-analysis-stat-card"},eS={class:"pf-stat-content"},tS={class:"pf-stat-label-inline"},sS={class:"pf-stat-number"},nS={class:"pf-analysis-stat-card"},rS={class:"pf-stat-content"},iS={class:"pf-stat-label-inline"},oS={class:"pf-stat-number"},aS={class:"pf-transaction-breakdown"},lS={class:"pf-breakdown-header"},cS={class:"pf-breakdown-controls"},uS={class:"pf-breakdown-content"},dS={key:0,class:"pf-analysis-loading"},fS={key:1,class:"pf-analysis-empty"},hS={key:2,class:"pf-breakdown-list"},pS={class:"pf-day-header"},mS={class:"pf-day-date"},gS={class:"pf-day-summary"},yS={class:"pf-day-total"},vS={class:"pf-day-value"},bS={class:"pf-day-transactions"},wS={class:"pf-type-header"},AS={class:"pf-type-info"},ES={class:"pf-type-name"},_S={class:"pf-type-count"},TS={class:"pf-type-value"},PS={class:"pf-type-amount"},kS={class:"pf-type-avg"},SS={class:"pf-type-projects"},CS={class:"pf-project-info"},IS={class:"pf-project-code"},RS={class:"pf-project-name"},DS={class:"pf-project-stats"},xS={class:"pf-project-count"},NS={class:"pf-project-value"},LS={key:3,class:"pf-transactions"},OS={class:"pf-transactions-header"},US={class:"pf-transactions-actions"},BS=["disabled"],MS={key:0},FS={key:1},VS={key:0,class:"pf-filters"},$S=["value"],jS={class:"pf-transactions-list"},HS={key:0,class:"pf-no-transactions"},WS={key:1},YS=["onClick"],GS={class:"pf-transaction-details"},KS={class:"pf-transaction-title"},zS={class:"pf-transaction-subtitle"},QS={class:"pf-transaction-value"},JS={class:"pf-transaction-time"},qS={class:"pf-transaction-price"},ZS={__name:"PortfolioView",setup(t){const e=cP(),{fullAddress:s,connected:n,nativeBalanceDisplay:r,nativeSymbol:i}=zt();Ae(()=>!0);const o=["Projects","My Watchlist","Analysis","Transactions"],l=fe("Projects"),c=fe(null);fe("1d");const u=fe("3d"),d=fe(!1),f=fe([]),h=fe("30d"),y=fe(800),T=fe(200);fe({visible:!1,x:0,y:0,content:"",type:""});const w=fe(!1),k=fe(!1),C=fe(""),N=fe(""),L=fe(!0),D=fe(""),Y=fe(!1);let W=null;const $=fe([]),Q=fe([]),J=fe([]);async function re(){try{Z.value=!0,le.value=null,console.log("🔄 PortfolioView: 从数据库加载项目数据...");const A=await Kt.getAllProducts();A.status===0?(te.value=A.data||[],console.log("✅ PortfolioView: 项目数据加载成功，共",te.value.length,"个项目")):(le.value=A.message||"获取项目数据失败",console.error("❌ PortfolioView: API返回错误:",A))}catch(A){le.value="网络错误，无法获取项目数据",console.error("❌ PortfolioView: 加载项目数据失败:",A)}finally{Z.value=!1}}function ce(){try{const A=localStorage.getItem("projectWatchlist");A?(Q.value=JSON.parse(A),console.log("📂 Portfolio loaded watchlist:",Q.value)):Q.value=[]}catch(A){console.error("❌ Portfolio: 加载 watchlist 失败:",A),Q.value=[]}}async function H(){try{if(Q.value.length===0){J.value=[];return}console.log("🔄 Portfolio: 加载 watchlist 项目详情...");const A=te.value.length>0?te.value:null;if(A)we(A);else{const E=await Kt.getAllProducts();if(E.status===0){const b=E.data||[];we(b)}else console.error("❌ Portfolio: 获取 watchlist 项目失败:",E),J.value=[]}}catch(A){console.error("❌ Portfolio: 加载 watchlist 项目失败:",A),J.value=[]}}function we(A){J.value=A.filter(E=>Q.value.includes(E.code)).map(E=>({...E,totalOfferingRaw:E.total_offering_token||0,subscribedRaw:E.subscribe_token||0,totalOffering:E.total_offering_token?`AUD$${E.total_offering_token.toLocaleString()}`:"AUD$0",subscribed:E.subscribe_token?`AUD$${E.subscribe_token.toLocaleString()}`:"AUD$0"})),console.log("✅ Portfolio: watchlist 项目更新成功，共",J.value.length,"个项目")}function Ce(A){try{const E=Q.value.indexOf(A);E>-1&&(Q.value.splice(E,1),localStorage.setItem("projectWatchlist",JSON.stringify(Q.value)),J.value=J.value.filter(b=>b.code!==A),console.log("✅ Portfolio: 已从 watchlist 移除项目:",A))}catch(E){console.error("❌ Portfolio: 移除 watchlist 项目失败:",E)}}function K(A){return{RWA001:"/pics/TYMU.png",RWA002:"/pics/SQNB.png",RWA003:"/pics/LZYT.png",YYD:"/pics/YYD.png",COMP:"/pics/TYMU.png"}[A]||"/pics/TYMU.png"}function ee(A){if(!A)return 0;const E=A.totalOfferingRaw||0,b=A.subscribedRaw||0;if(E===0)return 0;const F=b/E*100;return Math.round(F*100)/100}function ae(A){return ee(A)}function ge(A){if(!A)return"0";const E=parseFloat(A);return isNaN(E)?A:E.toLocaleString()}function Re(A){return{ACTIVE:"#16a34a",INCOMING:"#d97706",PERFORMING:"#2563eb",COMPLETED:"#6b7280"}[A]||"#6b7280"}function Ye(A){return{ACTIVE:"Active",INCOMING:"Incoming",PERFORMING:"Performing",COMPLETED:"Completed",active:"Active",upcoming:"Upcoming",research:"Research",planning:"Planning",completed:"Completed"}[A]||"Unknown"}function je(A){e.push({name:"detail",params:{id:A}})}function He(A){e.push({name:"tradeProject",params:{code:A}})}function St(){e.push({name:"projects"})}function Xe(){try{const A=localStorage.getItem("walletBoundAccounts");if(A){const E=JSON.parse(A);$.value=E.map((b,F)=>({address:b,name:`Wallet ${F+1}`,balance:0})),console.log("📂 Portfolio loaded bound accounts:",$.value)}else s.value?($.value=[{address:s.value,name:"Main Account",balance:0}],console.log("📂 Portfolio using current connected wallet:",s.value)):($.value=[{address:"0x1234567890123456789012345678901234567890",name:"Demo Account",balance:1.5}],console.log("📂 Portfolio using demo account for display"));Et(),st()}catch(A){console.error("❌ Failed to load bound accounts:",A),$.value=[{address:"Please connect your wallet",name:"No Account",balance:0}],st()}}function Et(){$.value.forEach(A=>{if(A.address===s.value&&n.value){const E=r.value;A.balance=parseFloat(E)||0,console.log(`💰 Updated balance for ${A.address}: ${A.balance} ${i.value}`)}else A.balance===0&&(A.balance=Math.random()*2)})}function st(){if($.value.length===0)return;const A={};$.value.forEach((E,b)=>{b===0?A[E.address]=[{id:1,type:"buy",projectCode:"TYMU",amount:100,price:1,timestamp:Date.now()-36e5},{id:2,type:"buy",projectCode:"SQNB",amount:50,price:1.02,timestamp:Date.now()-72e5}]:b===1?A[E.address]=[{id:3,type:"sell",projectCode:"LZYT",amount:25,price:.98,timestamp:Date.now()-108e5},{id:4,type:"buy",projectCode:"YYD",amount:75,price:1.05,timestamp:Date.now()-144e5}]:A[E.address]=[{id:5,type:"buy",projectCode:"TYMU",amount:200,price:.99,timestamp:Date.now()-18e6}]}),O.value=A,console.log("📊 Portfolio initialized transaction data:",O.value)}const O=fe({}),te=fe([]),Z=fe(!0),le=fe(null),De=Ae(()=>{let E=v().filter(b=>b.type==="buy"||b.type==="sell");return E.length===0?(console.log("📊 PortfolioView: 没有找到交易活动数据"),[]):(E=E.map(b=>({id:b.id||Date.now()+Math.random(),type:b.type,projectCode:b.project_code||b.projectCode,projectName:b.project_name||"Unknown Project",amount:b.amount||0,price:b.price||1,timestamp:b.timestamp||Date.now(),userAddress:b.user_address||D.value})),C.value&&(E=E.filter(b=>b.type===C.value)),N.value&&(E=E.filter(b=>b.projectCode===N.value)),E.sort((b,F)=>F.timestamp-b.timestamp))}),v=()=>{try{const A=JSON.parse(localStorage.getItem("walletActivity")||"[]");return console.log("📊 PortfolioView: 获取到WalletView活动数据:",A.length,"条记录"),A}catch(A){return console.error("❌ PortfolioView: 获取wallet activity数据失败:",A),[]}},_=A=>{if(!A)return[];const b=v().filter(q=>q.type==="buy"||q.type==="sell");console.log("📊 PortfolioView: 账户",A,"的交易活动:",b.length,"条");const F=new Map;return b.forEach(q=>{const pe=q.project_code||q.projectCode;F.has(pe)||F.set(pe,{code:pe,amount:0,totalCost:0,totalInvestment:0});const Fe=F.get(pe),ft=te.value.find(Dt=>Dt.code===pe),pt=ft&&ft.currentPrice||1;q.type==="buy"?(Fe.amount+=q.amount,Fe.totalCost+=q.amount*pt,Fe.totalInvestment+=q.amount*(q.price||pt)):(Fe.amount-=q.amount,Fe.totalCost-=q.amount*pt,Fe.totalInvestment-=q.amount*(q.price||pt))}),Array.from(F.values()).filter(q=>q.amount>0).map(q=>{const pe=te.value.find(Dt=>Dt.code===q.code),Fe=pe&&pe.currentPrice||1,ft=q.amount*Fe,pt=q.totalInvestment>0?(ft-q.totalInvestment)/q.totalInvestment*100:0;return{...q,currentPrice:Fe,change:pt}})},I=A=>{const b=_(A).reduce((F,q)=>F+(q.totalInvestment||0),0);return console.log("💰 PortfolioView: 账户",A,"总投资:",b),b},U=A=>{const b=_(A).reduce((F,q)=>F+q.amount*q.currentPrice,0);return console.log("📈 PortfolioView: 账户",A,"当前价值:",b),b},V=A=>{const E=U(A),b=I(A),F=E-b;return console.log("📊 PortfolioView: 账户",A,"总收益:",F,"(当前价值:",E,"- 总投资:",b,")"),F},M=A=>{if(!D.value)return null;const b=_(D.value).find(F=>F.code===A);return b?{amount:b.amount,currentPrice:b.currentPrice,currentValue:b.amount*b.currentPrice,totalInvestment:b.totalInvestment,change:b.change}:null},se=A=>{const E=I(A),b=V(A),F=E>0?b/E*100:0;return console.log("📈 PortfolioView: 账户",A,"ROI:",F.toFixed(2)+"%","(总收益:",b,"/ 总投资:",E,")"),F},X=()=>{const E=v().filter(q=>q.type==="buy"||q.type==="sell");console.log("📊 PortfolioView: 获取所有资产分布，共",E.length,"条交易记录");const b=new Map;E.forEach(q=>{const pe=q.project_code||q.projectCode;b.has(pe)||b.set(pe,{code:pe,amount:0,totalCost:0,totalInvestment:0,projectName:q.project_name||"Unknown Project"});const Fe=b.get(pe),ft=te.value.find(Dt=>Dt.code===pe),pt=ft&&ft.currentPrice||1;Fe.currentPrice=pt,q.type==="buy"?(Fe.amount+=parseFloat(q.amount)||0,Fe.totalCost+=(parseFloat(q.amount)||0)*(parseFloat(q.price)||1),Fe.totalInvestment+=(parseFloat(q.amount)||0)*(parseFloat(q.price)||1)):q.type==="sell"&&(Fe.amount-=parseFloat(q.amount)||0,Fe.totalCost-=(parseFloat(q.amount)||0)*(parseFloat(q.price)||1))});const F=Array.from(b.values()).filter(q=>q.amount>0);return console.log("📊 PortfolioView: 所有资产分布:",F),F},z=Ae(()=>{const A=X();return A.length>0?A:[{code:"TYMU",amount:100,totalCost:100,currentPrice:1,change:2.5},{code:"SQNB",amount:50,totalCost:51,currentPrice:1.02,change:-1.2},{code:"LZYT",amount:25,totalCost:24.5,currentPrice:.98,change:.8},{code:"YYD",amount:75,totalCost:78.75,currentPrice:1.05,change:3.1}]}),G=Ae(()=>{const A=X();if(A.length>0){const E=A.reduce((b,F)=>b+(F.totalInvestment||0),0);return console.log("💰 PortfolioView: 所有资产总投资:",E),E}return D.value?I(D.value):254.25}),ye=Ae(()=>{const A=X();if(A.length>0){const E=A.reduce((b,F)=>b+F.amount*F.currentPrice,0);return console.log("📈 PortfolioView: 所有资产当前价值:",E),E}return D.value?U(D.value):267.75}),ie=Ae(()=>{const A=ye.value,E=G.value,b=A-E;return console.log("📊 PortfolioView: 所有资产总收益:",b,"(当前价值:",A,"- 总投资:",E,")"),b}),ve=Ae(()=>{const A=G.value,E=ie.value,b=A>0?E/A*100:0;return console.log("📈 PortfolioView: 所有资产ROI:",b.toFixed(2)+"%","(总收益:",E,"/ 总投资:",A,")"),b}),Te=Ae(()=>{if(!D.value)return te.value;const E=_(D.value).map(b=>b.code);return te.value.filter(b=>E.includes(b.code))});Ae(()=>{const A={low:1,medium:2,high:3},E=z.value.reduce((q,pe)=>{const Fe=te.value.find(pt=>pt.code===pe.code),ft=Fe&&A[Fe.risk]||2;return q+ft*pe.amount*pe.currentPrice},0),b=ye.value;if(b===0)return"Low";const F=E/b;return F<=1.5?"Low":F<=2.5?"Medium":"High"});const Ue=Ae(()=>{const A=z.value.length,E=te.value.length;return E>0?Math.min(A/E*100,100):0});Ae(()=>{const A=[];return Object.values(O.value).forEach(E=>{A.push(...E)}),A.length===0?[{id:1,type:"buy",projectCode:"TYMU",amount:100,price:1,timestamp:Date.now()-36e5},{id:2,type:"buy",projectCode:"SQNB",amount:50,price:1.02,timestamp:Date.now()-72e5},{id:3,type:"sell",projectCode:"LZYT",amount:25,price:.98,timestamp:Date.now()-108e5},{id:4,type:"buy",projectCode:"YYD",amount:75,price:1.05,timestamp:Date.now()-144e5}]:A});const Ge=Ae(()=>f.value.length===0?1:Math.max(...f.value.map(A=>A.cumulativeBuyValue+A.cumulativeSellValue))),Be=Ae(()=>{if(f.value.length===0)return[];const A=f.value,E=Ge.value,b=20,F=y.value-b*2,q=T.value-b*2;return A.map((pe,Fe)=>({x:A.length===1?b+F/2:b+Fe*F/(A.length-1),y:b+q-pe.cumulativeBuyValue/E*q,value:pe.cumulativeBuyValue,date:pe.date,count:pe.buy}))}),Rt=Ae(()=>{if(f.value.length===0)return[];const A=f.value,E=Ge.value,b=20,F=y.value-b*2,q=T.value-b*2;return A.map((pe,Fe)=>({x:A.length===1?b+F/2:b+Fe*F/(A.length-1),y:b+q-pe.cumulativeSellValue/E*q,value:pe.cumulativeSellValue,date:pe.date,count:pe.sell}))});Ae(()=>Be.value.map(A=>`${A.x},${A.y}`).join(" ")),Ae(()=>Rt.value.map(A=>`${A.x},${A.y}`).join(" ")),Ae(()=>{if(f.value.length===0)return console.log("📊 当天交易统计: 无交易数据"),{totalBuy:0,totalSell:0,totalTransactions:0,buyPercentage:0,sellPercentage:0};const A=f.value[f.value.length-1];console.log("📊 当天交易统计: 今天数据",A);const E=A.cumulativeBuyValue||0,b=A.cumulativeSellValue||0,F=E+b,q={totalBuy:E,totalSell:b,totalTransactions:F,buyPercentage:F>0?E/F*100:0,sellPercentage:F>0?b/F*100:0};return console.log("📊 当天交易统计: 计算结果",q),q});const Ot=Ae(()=>De.value.length),hs=Ae(()=>De.value.filter(A=>A.type==="buy").length),es=Ae(()=>De.value.filter(A=>A.type==="sell").length),ps=Ae(()=>De.value.reduce((A,E)=>A+parseFloat(E.amount||0),0)),er=Ae(()=>{if(De.value.length===0)return[];const A=new Date,E=De.value.filter(F=>{if(h.value==="all")return!0;const q=new Date(F.timestamp),pe=Math.floor((A-q)/(1e3*60*60*24));switch(h.value){case"7d":return pe<=7;case"30d":return pe<=30;case"90d":return pe<=90;case"1y":return pe<=365;default:return!0}}),b={};return E.forEach(F=>{const q=new Date(F.timestamp).toISOString().split("T")[0];b[q]||(b[q]=[]),b[q].push(F)}),Object.entries(b).map(([F,q])=>{const pe={};q.forEach(Dt=>{pe[Dt.type]||(pe[Dt.type]=[]),pe[Dt.type].push(Dt)});const Fe=Object.entries(pe).map(([Dt,Is])=>{const an={};Is.forEach(Mt=>{const jt=Mt.projectCode||"Unknown";an[jt]||(an[jt]=[]),an[jt].push(Mt)});const nt=Object.entries(an).map(([Mt,jt])=>{const xn=jt.reduce((wi,il)=>wi+parseFloat(il.amount||0),0);return{projectCode:Mt,projectName:jt[0].projectName||"Unknown Project",count:jt.length,totalAmount:xn}}),Bt=Is.reduce((Mt,jt)=>Mt+parseFloat(jt.amount||0),0),ts=Is.length>0?Bt/Is.length:0;return{type:Dt,count:Is.length,totalAmount:Bt,averageAmount:ts,projects:nt}}),ft=q.length,pt=q.reduce((Dt,Is)=>Dt+parseFloat(Is.amount||0),0);return{date:F,totalTransactions:ft,totalValue:pt,types:Fe}}).sort((F,q)=>new Date(q.date)-new Date(F.date))});Ae(()=>{const A=ye.value,E=G.value,b=A-E;return{totalBuy:Math.max(E,A*.8),totalSell:Math.max(0,b*.3),netValue:Math.max(E,A*.8)-Math.max(0,b*.3),buyPercentage:A>0?Math.max(E,A*.8)/A*100:0,sellPercentage:A>0?Math.max(0,b*.3)/A*100:0}}),Ae(()=>{const A=[];ie.value>0?A.push({id:1,icon:"📈",text:`Portfolio is up ${ve.value.toFixed(1)}%. Consider taking some profits.`}):A.push({id:1,icon:"📉",text:`Portfolio is down ${Math.abs(ve.value).toFixed(1)}%. Consider dollar-cost averaging.`}),Ue.value<50&&A.push({id:2,icon:"⚠️",text:"Low diversification. Consider spreading risk across more projects."});const E=z.value.reduce((b,F)=>F.change>b.change?F:b,z.value[0]||{change:0,code:""});return E.change>5&&A.push({id:3,icon:"🎯",text:`${E.code} is performing well (+${E.change.toFixed(1)}%). Consider increasing allocation.`}),A});const Ut=A=>{D.value=A},ms=()=>{alert("请在Wallet页面绑定新的钱包账户。Portfolio只显示已绑定的钱包。")},xr=()=>{Y.value=!Y.value},As=()=>{Y.value=!1},Nr=()=>{console.log("🔌 Handling wallet disconnect..."),D.value===s.value&&(D.value=null),$.value=$.value.filter(A=>A.address!==s.value),$.value.length>0||($.value=[{address:"0x1234567890123456789012345678901234567890",name:"Demo Account",balance:1.5}]),D.value=$.value[0].address,Ms(),console.log("✅ Wallet disconnect handled, current accounts:",$.value.length)},vi=()=>{console.log("🔌 Handling wallet reconnect..."),Xe();const A=$.value.find(E=>E.address===s.value);A?D.value=A.address:$.value.length>0&&(D.value=$.value[0].address),Et(),Ms(),console.log("✅ Wallet reconnect handled, selected account:",D.value)},tr=A=>{console.log("🔄 Handling wallet address change to:",A);const E=$.value.find(b=>b.address===s.value);E&&(E.address=A,D.value=A),Et(),Ms(),console.log("✅ Wallet address change handled")},Po=A=>A?`${A.slice(0,6)}...${A.slice(-4)}`:"—",sl=A=>{const E=$.value.find(b=>b.address===A);if(!E)return"0.0000";if(A===s.value&&n.value){const b=r.value;return parseFloat(b).toFixed(4)}return E.balance.toFixed(4)},ko=async()=>{await re()},So=async()=>{d.value=!0;try{console.log("🔄 PortfolioView: 刷新交易数据...");const E=v().filter(b=>b.type==="buy"||b.type==="sell");console.log("📊 PortfolioView: 获取到",E.length,"条交易记录")}catch(A){console.error("❌ PortfolioView: 刷新交易数据失败:",A)}finally{d.value=!1}},Ms=async()=>{d.value=!0;try{await R()}catch(A){console.error("Failed to refresh transaction data:",A)}finally{d.value=!1}},R=async()=>{console.log("📊 PortfolioView: 基于Current Assets生成交易图表数据");const A=z.value;console.log("📊 PortfolioView: 当前资产分布:",A);const E=S(u.value),b=new Date,F=new Date(b.getTime()-(E-1)*24*60*60*1e3);console.log("📅 PortfolioView: 日期范围设置:",{days:E,startDate:F.toISOString().split("T")[0],endDate:b.toISOString().split("T")[0]});const pe=v().filter(nt=>nt.type==="buy"||nt.type==="sell");console.log("📊 PortfolioView: 获取到真实交易数据",pe.length,"条记录");const Fe=new Map;for(let nt=0;nt<E;nt++){const Bt=new Date(F.getTime()+nt*24*60*60*1e3),ts=Bt.toISOString().split("T")[0];Fe.set(ts,{date:x(Bt),dateKey:ts,buy:0,sell:0,buyAmount:0,sellAmount:0,buyValue:0,sellValue:0})}if(pe.length>0&&pe.forEach(nt=>{const ts=new Date(nt.timestamp).toISOString().split("T")[0];if(Fe.has(ts)){const Mt=Fe.get(ts),jt=parseFloat(nt.amount)||0,xn=parseFloat(nt.price)||1,wi=jt*xn;nt.type==="buy"?(Mt.buy++,Mt.buyAmount+=jt,Mt.buyValue+=wi):nt.type==="sell"&&(Mt.sell++,Mt.sellAmount+=jt,Mt.sellValue+=wi)}}),pe.length===0&&A.length>0){console.log("📊 PortfolioView: 无真实交易数据，基于Current Assets生成模拟数据");const nt=A.reduce((Bt,ts)=>Bt+ts.amount*ts.currentPrice,0);A.forEach((Bt,ts)=>{const Mt=Bt.amount*Bt.currentPrice,jt=Mt/nt*100;for(let xn=0;xn<E;xn++){const il=new Date(F.getTime()+xn*24*60*60*1e3).toISOString().split("T")[0],sr=Fe.get(il);if(sr){const Yg=Math.max(.1,1-xn/E*.8),Gg=.5+Math.random()*1,ol=Mt*jt/100*Yg*Gg*.1;if(Math.random()>.3)sr.buy++,sr.buyAmount+=ol/Bt.currentPrice,sr.buyValue+=ol;else{const Tu=ol*.6;sr.sell++,sr.sellAmount+=Tu/Bt.currentPrice,sr.sellValue+=Tu}}}})}let ft=0,pt=0,Dt=0,Is=0;const an=Array.from(Fe.values()).sort((nt,Bt)=>new Date(nt.dateKey)-new Date(Bt.dateKey));f.value=an.map(nt=>(ft+=nt.buyValue,pt+=nt.sellValue,Dt+=nt.buyAmount,Is+=nt.sellAmount,{...nt,cumulativeBuyValue:ft,cumulativeSellValue:pt,cumulativeBuyAmount:Dt,cumulativeSellAmount:Is,netValue:ft-pt})),console.log("📊 PortfolioView: 交易图表数据生成完成，共",f.value.length,"个数据点"),console.log("📊 PortfolioView: 累计买入价值:",ft),console.log("📊 PortfolioView: 累计卖出价值:",pt),console.log("📊 PortfolioView: 净价值:",ft-pt),xe()},S=A=>{switch(A){case"3d":return 3;case"7d":return 7;case"30d":return 30;case"90d":return 90;case"1y":return 365;default:return 3}},x=A=>{const E=new Date,b=new Date(E.getFullYear(),E.getMonth(),E.getDate()),F=new Date(A.getFullYear(),A.getMonth(),A.getDate()),q=b-F,pe=Math.floor(q/(1e3*60*60*24));return pe===0?"Today":pe===1?"Yesterday":pe<=3?A.toLocaleDateString("en-US",{month:"short",day:"numeric",weekday:"short"}):pe<7?A.toLocaleDateString("en-US",{month:"short",day:"numeric",weekday:"short"}):pe<30?A.toLocaleDateString("en-US",{month:"short",day:"numeric"}):A.toLocaleDateString("en-US",{month:"short",year:"2-digit"})},xe=()=>{zi(()=>{const A=c.value;A&&(A.scrollLeft=A.scrollWidth-A.clientWidth)})},ut=A=>{const b=Date.now()-A,F=Math.floor(b/6e4),q=Math.floor(b/36e5),pe=Math.floor(b/864e5);return pe>0?`${pe}d ago`:q>0?`${q}h ago`:F>0?`${F}m ago`:"Just now"},Eu=A=>{if(!A)return"Unknown";const E=new Date(A),b=new Date,F=new Date(b);return F.setDate(F.getDate()-1),E.toDateString()===b.toDateString()?"Today":E.toDateString()===F.toDateString()?"Yesterday":E.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})},Qs=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16","#f97316"],Co=A=>Qs[A%Qs.length],bi=A=>ye.value===0?0:A.amount*A.currentPrice/ye.value*100,Mg=A=>{const E=bi(A),b=2*Math.PI*80;return`${E/100*b} ${b}`},Fg=A=>{let E=0;for(let b=0;b<A;b++){const F=z.value[b],q=bi(F),pe=2*Math.PI*80;E-=q/100*pe}return E},Lr=A=>{const E=z.value[A],b=bi(E);let F=0;for(let ts=0;ts<A;ts++){const Mt=z.value[ts],jt=bi(Mt);F+=jt/100*360}const pe=(F+b/100*360/2-90)*Math.PI/180,Fe=100,ft=100,pt=80,Dt=Fe+Math.cos(pe)*pt,Is=ft+Math.sin(pe)*pt,an=50,nt=Fe+Math.cos(pe)*(pt+an),Bt=ft+Math.sin(pe)*(pt+an);return{startX:Dt,startY:Is,endX:nt,endY:Bt,textX:nt,textY:Bt}},Vg=A=>{e.push({name:"detail",params:{code:A}})},$g=A=>{e.push({name:"tradeProject",params:{code:A},query:{type:"sell",interest:!0}})};let nl;mi(async()=>{await re(),ce(),await H(),jg(),Xe(),await R(),$.value.length>0&&(D.value=$.value[0].address),Ms(),nl=setInterval(ko,3e4),window.addEventListener("walletActivityUpdated",_u),window.addEventListener("walletConnected",vi),window.addEventListener("walletDisconnected",Nr),window.addEventListener("walletAddressChanged",b=>{console.log("🔄 Wallet address changed event received:",b.detail),tr(b.detail.newAddress)}),window.ethereum&&(window.ethereum.on("accountsChanged",b=>{console.log("🔄 Ethereum accounts changed:",b),b&&b.length>0?tr(b[0]):Nr()}),window.ethereum.on("chainChanged",b=>{console.log("🔄 Ethereum chain changed:",b),Ms()})),en(u,async()=>{console.log("📊 PortfolioView: 时间范围变化，重新生成图表数据:",u.value),await R()});const E=v().filter(b=>b.type==="buy"||b.type==="sell");console.log("🚀 PortfolioView初始化: 检测到WalletView交易活动数据:",E.length,"条"),E.length>0&&(console.log("📊 PortfolioView: 交易活动详情:",E),console.log("💰 PortfolioView: 计算的总投资:",I(D.value)),console.log("📈 PortfolioView: 计算的当前价值:",U(D.value)),console.log("📊 PortfolioView: 计算的总收益:",V(D.value)),console.log("📈 PortfolioView: 计算的ROI:",se(D.value))),en(()=>e.currentRoute.value.path,(b,F)=>{b==="/portfolio"&&b!==F&&(console.log("🔄 PortfolioView: 检测到portfolio页面访问，自动刷新数据..."),ko(),So())},{immediate:!1})});const jg=()=>{const{subscribeProducts:A,getLastRefreshTime:E}=Dr();W=A(F=>{console.log("📡 PortfolioView: 收到产品数据更新，共",F.length,"个项目"),te.value=F,Q.value.length>0&&we(F)});const b=E();b&&console.log("🕐 PortfolioView: 最后刷新时间:",b)},Hg=()=>{W&&W()},_u=A=>{console.log("🔄 PortfolioView: 检测到WalletView交易活动更新:",A.detail);const b=v().filter(F=>F.type==="buy"||F.type==="sell");console.log("📊 PortfolioView: 当前交易活动数据:",b.length,"条"),console.log("💰 PortfolioView: 计算的总投资:",I(D.value)),console.log("📈 PortfolioView: 计算的当前价值:",U(D.value)),console.log("📊 PortfolioView: 计算的总收益:",V(D.value)),console.log("📈 PortfolioView: 计算的ROI:",se(D.value))};Wc(()=>{nl&&clearInterval(nl),Hg(),window.removeEventListener("walletActivityUpdated",_u),window.removeEventListener("walletConnected",vi),window.removeEventListener("walletDisconnected",Nr),window.removeEventListener("walletAddressChanged",tr),window.ethereum&&(window.ethereum.removeListener("accountsChanged",tr),window.ethereum.removeListener("chainChanged",Ms)),window.removeEventListener("resize",rl)}),en(u,()=>{Ms()});const rl=()=>{const A=document.querySelector(".pf-line-chart-container");A&&(y.value=A.offsetWidth)};window.addEventListener("resize",rl),zi(()=>{rl()}),en(z,()=>{console.log("📊 PortfolioView: 资产分布变化，重新生成交易图表数据"),Ms()},{deep:!0}),en([s,r,n],(A,E)=>{const[b,F,q]=A,[pe,Fe,ft]=E||[null,null,null];console.log("🔄 Wallet state changed:",{connected:{from:ft,to:q},address:{from:pe,to:b},balance:{from:Fe,to:F}}),Et(),ft&&!q&&(console.log("🔌 Wallet disconnected, clearing dashboard data..."),Nr()),!ft&&q&&(console.log("🔌 Wallet reconnected, refreshing dashboard data..."),vi()),pe&&b&&pe!==b&&(console.log("🔄 Wallet address changed, updating selected account..."),tr(b))},{deep:!0});const Wg=A=>{console.log("📄 查看合约详情:",A),e.push({path:"/contract",query:{projectCode:A.projectCode,transactionId:A.id,type:A.type,amount:A.amount,timestamp:A.timestamp}})};return window.addEventListener("storage",A=>{A.key==="walletBoundAccounts"&&(console.log("🔄 Detected wallet bound accounts change, reloading..."),Xe(),$.value.length>0&&!$.value.find(E=>E.address===D.value)&&(D.value=$.value[0].address))}),(A,E)=>(m(),g("div",uP,[a("div",dP,[a("div",fP,[a("button",{class:"pf-mobile-menu-btn",onClick:xr},[...E[7]||(E[7]=[a("span",{class:"pf-menu-icon"},"☰",-1)])]),E[8]||(E[8]=a("h1",{class:"pf-mobile-title"},"Portfolio",-1)),a("div",hP,[a("button",{class:"pf-mobile-action-btn",onClick:E[0]||(E[0]=b=>w.value=!w.value)},"⚙️")])])]),Y.value?(m(),g("div",{key:0,class:"pf-mobile-overlay",onClick:As})):B("",!0),a("div",pP,[a("div",mP,[a("aside",{class:be(["pf-sidebar",{"pf-sidebar-mobile-open":Y.value}])},[a("div",gP,[E[9]||(E[9]=a("h2",null,"My Wallet",-1)),a("div",yP,[a("span",{class:"gear",onClick:E[1]||(E[1]=b=>w.value=!w.value)},"⚙️"),a("span",{class:"plus",onClick:ms,title:"Add wallets in Wallet page"},"＋")])]),a("div",vP,[a("button",{class:"pf-acc-title",onClick:E[2]||(E[2]=b=>L.value=!L.value)},[E[10]||(E[10]=a("span",null,"Decentralized",-1)),a("span",{class:be(["caret",{open:L.value}])},"▾",2)]),Pe(a("div",bP,[(m(!0),g(me,null,dt($.value,b=>(m(),g("div",{key:b.address,class:be(["pf-acc-item",{active:D.value===b.address}]),onClick:F=>Ut(b.address)},[E[11]||(E[11]=a("div",{class:"pf-avatar"},null,-1)),a("div",AP,[a("div",EP,p(b.name||"Account"),1),a("div",{class:"pf-addr",title:b.address},p(Po(b.address)),9,_P),a("div",TP,p(sl(b.address))+" "+p(Ke(i)),1)])],10,wP))),128))],512),[[X0,L.value]])]),D.value?(m(),g("div",PP,[E[19]||(E[19]=a("h3",null,"Account Overview",-1)),a("div",kP,[a("div",SP,[E[12]||(E[12]=a("div",{class:"pf-stat-label"},"Total Investment",-1)),a("div",CP,"AUD$"+p(I(D.value).toFixed(2)),1)]),a("div",IP,[E[13]||(E[13]=a("div",{class:"pf-stat-label"},"Interest Income",-1)),a("div",{class:be(["pf-stat-value",{positive:V(D.value)>=0,negative:V(D.value)<0}])},p(V(D.value)>=0?"+":"")+"AUD$"+p(V(D.value).toFixed(2)),3)]),a("div",RP,[E[14]||(E[14]=a("div",{class:"pf-stat-label"},"ROI",-1)),a("div",{class:be(["pf-stat-value",{positive:se(D.value)>=0,negative:se(D.value)<0}])},p(se(D.value)>=0?"+":"")+p(se(D.value).toFixed(2))+"% ",3)])]),a("div",DP,[E[17]||(E[17]=a("div",{class:"pf-chart-header"},[a("h4",null,"Current Assets Distribution")],-1)),E[18]||(E[18]=a("p",{class:"pf-chart-subtitle"},"All purchased assets across all wallets",-1)),a("div",xP,[a("div",NP,[(m(),g("svg",LP,[E[15]||(E[15]=a("circle",{cx:"100",cy:"100",r:"80",fill:"none",stroke:"#e5e7eb","stroke-width":"20"},null,-1)),(m(!0),g(me,null,dt(z.value,(b,F)=>(m(),g("circle",{key:b.code,cx:"100",cy:"100",r:"80",fill:"none",stroke:Co(F),"stroke-width":"20","stroke-dasharray":Mg(b),"stroke-dashoffset":Fg(F),transform:"rotate(-90 100 100)"},null,8,OP))),128)),(m(!0),g(me,null,dt(z.value,(b,F)=>(m(),g("g",{key:`label-${b.code}`},[a("line",{x1:Lr(F).startX,y1:Lr(F).startY,x2:Lr(F).endX,y2:Lr(F).endY,stroke:Co(F),"stroke-width":"2","stroke-linecap":"round"},null,8,UP),a("text",{x:Lr(F).textX,y:Lr(F).textY,fill:Co(F),"font-size":"20","font-weight":"600","text-anchor":"middle","dominant-baseline":"middle",class:"pf-pie-label-text"},p(bi(b).toFixed(2))+"% ",9,BP)]))),128))])),a("div",MP,[a("div",FP,"AUD$"+p(ye.value.toFixed(2)),1),E[16]||(E[16]=a("div",{class:"pf-pie-label"},"Total Value",-1))])]),a("div",VP,[(m(!0),g(me,null,dt(z.value,(b,F)=>(m(),g("div",{key:b.code,class:"pf-legend-item"},[a("div",$P,[a("div",{class:"pf-legend-color",style:xt({backgroundColor:Co(F)})},null,4),a("div",jP,p(b.code),1)]),a("div",HP,[a("div",WP,"AUD$"+p((b.amount*b.currentPrice).toFixed(2)),1)])]))),128))])])])])):B("",!0)],2),a("main",YP,[a("div",GP,[a("div",KP," AUD$"+p(I(D.value).toFixed(2)),1)]),a("nav",zP,[(m(),g(me,null,dt(o,b=>a("button",{key:b,class:be(["pf-tab",{active:l.value===b}]),onClick:F=>l.value=b},p(b),11,QP)),64))]),l.value==="Projects"?(m(),g("div",JP,[Te.value.length===0?(m(),g("div",qP,[E[20]||(E[20]=a("div",{class:"pf-empty-icon"},null,-1)),E[21]||(E[21]=a("h4",null,"No project available",-1)),E[22]||(E[22]=a("p",null,"Complete some trades in the Trade page to see your project dashboard",-1)),a("button",{class:"pf-btn pf-btn-primary",onClick:St}," Browse Projects ")])):(m(),g("div",ZP,[(m(!0),g(me,null,dt(Te.value,b=>(m(),g("div",{key:b.code,class:"pf-project-card"},[a("div",XP,[a("img",{src:b.image,alt:b.code,class:"pf-project-image"},null,8,ek),a("div",tk,[a("h4",null,p(b.code),1),a("p",null,p(b.subtitle),1)])]),a("div",sk,[a("div",nk,[E[23]||(E[23]=a("span",{class:"pf-metric-label"},"Target Yield",-1)),a("span",rk,p(b.targetYield)+"%",1)]),a("div",ik,[E[24]||(E[24]=a("span",{class:"pf-metric-label"},"Risk Level",-1)),a("span",{class:be(["pf-metric-value","risk-"+b.risk])},p(b.risk),3)]),M(b.code)?(m(),g("div",ok,[E[25]||(E[25]=a("span",{class:"pf-metric-label"},"Holding Amount",-1)),a("span",ak,p(M(b.code).currentValue.toFixed(2))+" tokens",1)])):B("",!0),M(b.code)?(m(),g("div",lk,[...E[26]||(E[26]=[a("span",{class:"pf-metric-label"},"Interest Received",-1)])])):B("",!0),M(b.code)?(m(),g("div",ck,[...E[27]||(E[27]=[a("span",{class:"pf-metric-label"},"Interest Accrued",-1)])])):B("",!0)]),a("div",uk,[a("button",{class:"pf-project-btn",onClick:F=>He(b.code)},"Buy",8,dk),a("button",{class:"pf-project-btn pf-project-btn-secondary",onClick:F=>Vg(b.code)},"Details",8,fk),a("button",{class:"pf-project-btn pf-project-btn-interest",onClick:F=>$g(b.code)},"Sell Interest",8,hk)])]))),128))]))])):B("",!0),l.value==="My Watchlist"?(m(),g("div",pk,[a("div",mk,[E[28]||(E[28]=a("h3",null,null,-1)),a("div",gk,[a("span",yk,p(J.value.length)+" Projects",1)])]),J.value.length===0?(m(),g("div",vk,[E[29]||(E[29]=a("div",{class:"pf-empty-icon"},null,-1)),E[30]||(E[30]=a("h4",null,"No projects in your watchlist",-1)),E[31]||(E[31]=a("p",null,"Add projects to your watchlist from the Projects page to track them here.",-1)),a("button",{class:"pf-btn pf-btn-primary",onClick:St}," Browse Projects ")])):(m(),g("div",bk,[(m(!0),g(me,null,dt(J.value,b=>(m(),g("div",{key:b.code,class:"pf-watchlist-card"},[a("div",wk,[a("img",{src:b.image||K(b.code),alt:b.code,class:"pf-watchlist-image"},null,8,Ak),a("div",Ek,[a("h4",null,p(b.code)+" • "+p(b.name),1),a("p",null,p(b.subtitle),1)]),a("div",_k,[a("button",{class:"pf-remove-btn",onClick:F=>Ce(b.code),title:"Remove from watchlist"}," ✕ ",8,Tk)])]),a("div",Pk,[a("div",kk,[E[32]||(E[32]=a("span",{class:"pf-watchlist-label"},"LOAN SIZE",-1)),a("span",Sk,"AUD$"+p(ge(b.loan_amount||0)),1)]),a("div",Ck,[E[33]||(E[33]=a("span",{class:"pf-watchlist-label"},"EST. YIELD",-1)),a("span",Ik,p(b.target_yield)+"%",1)]),a("div",Rk,[E[34]||(E[34]=a("span",{class:"pf-watchlist-label"},"STATUS",-1)),a("span",{class:"pf-watchlist-value",style:xt({color:Re(b.status)})},p(Ye(b.status)),5)])]),a("div",Dk,[a("div",xk,[a("div",{class:"pf-watchlist-progress-fill",style:xt({width:ae(b)+"%"})},null,4)]),a("div",Nk,p(ae(b))+"% Subscribed",1)]),a("div",Lk,[a("button",{class:"pf-watchlist-btn pf-watchlist-btn-primary",onClick:F=>je(b.code)}," View Details ",8,Ok),b.status==="active"?(m(),g("button",{key:0,class:"pf-watchlist-btn pf-watchlist-btn-secondary",onClick:F=>He(b.code)}," Trade ",8,Uk)):B("",!0)])]))),128))]))])):B("",!0),l.value==="Analysis"?(m(),g("div",Bk,[a("div",Mk,[a("div",Fk,[E[35]||(E[35]=a("h3",null,"Transaction Analysis",-1)),a("div",Vk,[a("button",{class:"pf-analysis-btn",onClick:Ms,disabled:d.value},[d.value?(m(),g("span",jk,"🔄")):(m(),g("span",Hk,"Refresh"))],8,$k)])]),a("div",Wk,[a("div",Yk,[a("div",Gk,[a("div",Kk,[E[36]||(E[36]=ne("Total Transactions: ",-1)),a("span",zk,p(Ot.value),1)])])]),a("div",Qk,[a("div",Jk,[a("div",qk,[E[37]||(E[37]=ne("Buy Orders: ",-1)),a("span",Zk,p(hs.value),1)])])]),a("div",Xk,[a("div",eS,[a("div",tS,[E[38]||(E[38]=ne("Sell Orders: ",-1)),a("span",sS,p(es.value),1)])])]),a("div",nS,[a("div",rS,[a("div",iS,[E[39]||(E[39]=ne("Total Value: ",-1)),a("span",oS,"AUD$"+p(ps.value.toFixed(2)),1)])])])])]),a("div",aS,[a("div",lS,[E[41]||(E[41]=a("h4",null,"Transaction Breakdown by Date & Type",-1)),a("div",cS,[Pe(a("select",{"onUpdate:modelValue":E[3]||(E[3]=b=>h.value=b),class:"pf-select"},[...E[40]||(E[40]=[Nt('<option value="7d" data-v-ad1c565a>Last 7 Days</option><option value="30d" data-v-ad1c565a>Last 30 Days</option><option value="90d" data-v-ad1c565a>Last 3 Months</option><option value="1y" data-v-ad1c565a>Last Year</option><option value="all" data-v-ad1c565a>All Time</option>',5)])],512),[[bs,h.value]])])]),a("div",uS,[d.value?(m(),g("div",dS,[...E[42]||(E[42]=[a("div",{class:"pf-spinner"},null,-1),a("span",null,"Loading transaction analysis...",-1)])])):er.value.length===0?(m(),g("div",fS,[...E[43]||(E[43]=[a("p",null,"No transaction data available",-1),a("p",{class:"pf-empty-hint"},"Complete some trades to see detailed analysis",-1)])])):(m(),g("div",hS,[(m(!0),g(me,null,dt(er.value,b=>(m(),g("div",{key:b.date,class:"pf-day-group"},[a("div",pS,[a("div",mS,p(Eu(b.date)),1),a("div",gS,[a("span",yS,p(b.totalTransactions)+" transactions",1),a("span",vS,"AUD$"+p(b.totalValue.toFixed(2)),1)])]),a("div",bS,[(m(!0),g(me,null,dt(b.types,F=>(m(),g("div",{key:F.type,class:"pf-type-group"},[a("div",wS,[a("div",{class:be(["pf-type-icon",F.type])},p(F.type==="buy"?"📈":"📉"),3),a("div",AS,[a("div",ES,p(F.type.toUpperCase()),1),a("div",_S,p(F.count)+" transactions",1)]),a("div",TS,[a("div",PS,"AUD$"+p(F.totalAmount.toFixed(2)),1),a("div",kS,"Avg: AUD$"+p(F.averageAmount.toFixed(2)),1)])]),a("div",SS,[(m(!0),g(me,null,dt(F.projects,q=>(m(),g("div",{key:q.projectCode,class:"pf-project-summary"},[a("div",CS,[a("div",IS,p(q.projectCode),1),a("div",RS,p(q.projectName),1)]),a("div",DS,[a("div",xS,p(q.count)+" txns",1),a("div",NS,"AUD$"+p(q.totalAmount.toFixed(2)),1)])]))),128))])]))),128))])]))),128))]))])])])):B("",!0),l.value==="Transactions"?(m(),g("div",LS,[a("div",OS,[a("div",US,[a("button",{class:"pf-filter-btn",onClick:E[4]||(E[4]=b=>k.value=!k.value)}," Filter "),a("button",{class:"pf-refresh-btn",onClick:So,disabled:d.value},[d.value?(m(),g("span",MS,"🔄")):(m(),g("span",FS,"Refresh"))],8,BS)])]),k.value?(m(),g("div",VS,[Pe(a("select",{"onUpdate:modelValue":E[5]||(E[5]=b=>C.value=b),class:"pf-filter-select"},[...E[44]||(E[44]=[a("option",{value:""},"All Types",-1),a("option",{value:"buy"},"Buy",-1),a("option",{value:"sell"},"Sell",-1)])],512),[[bs,C.value]]),Pe(a("select",{"onUpdate:modelValue":E[6]||(E[6]=b=>N.value=b),class:"pf-filter-select"},[E[45]||(E[45]=a("option",{value:""},"All Projects",-1)),(m(!0),g(me,null,dt(te.value,b=>(m(),g("option",{key:b.code,value:b.code},p(b.code),9,$S))),128))],512),[[bs,N.value]])])):B("",!0),a("div",jS,[De.value.length===0?(m(),g("div",HS,[...E[46]||(E[46]=[a("div",{class:"pf-empty-icon"},null,-1),a("p",null,"No transaction data available",-1),a("p",{class:"pf-empty-hint"},"Complete some trades in the Trade page to see your transaction history",-1)])])):(m(),g("div",WS,[(m(!0),g(me,null,dt(De.value,b=>(m(),g("div",{key:b.id,class:"pf-transaction-item",onClick:F=>Wg(b)},[a("div",{class:be(["pf-transaction-icon",b.type])},p(b.type==="buy"?"📈":"📉"),3),a("div",GS,[a("div",KS,p(b.type.toUpperCase())+" "+p(b.amount)+" "+p(b.projectCode),1),a("div",zS,p(b.projectName),1)]),a("div",QS,[a("div",JS,p(ut(b.timestamp)),1),a("div",qS,"AUD$"+p(b.amount),1)])],8,YS))),128))]))])])):B("",!0)])])])]))}},Dg=It(ZS,[["__scopeId","data-v-ad1c565a"]]),XS="/icons/signup-icon1.png",eC={name:"LoginView",emits:["notify","navigate"],data(){return{user_email:"",user_password:"",remember:!1,loginStatus:!1,loginStatusMessage:"",loginStatusClass:"",loading:!1}},mounted(){localStorage.getItem("isLoggedIn")==="true"&&(this.loginStatus=!0,this.loginStatusClass="status success")},methods:{async submitLogin(){if(!this.user_email||!this.user_password){this.$emit("notify","Please enter email and password");return}this.loading=!0,this.loginStatus=!0,this.loginStatusClass="status",this.loginStatusMessage="Logging in...";try{const e=await(await fetch("http://localhost:3000/user/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_email:this.user_email,user_password:this.user_password})})).json();e.status===0?(this.loginStatusClass="status success",this.loginStatusMessage="Login successful!",localStorage.setItem("isLoggedIn","true"),localStorage.setItem("token",e.token),this.remember&&localStorage.setItem("remember_email",this.user_email),this.saveUserInfo(e),window.dispatchEvent(new CustomEvent("auth-changed")),this.$emit("notify","Login successful!"),setTimeout(()=>{this.$router.push("/home")},1e3)):(this.loginStatusClass="status error",this.loginStatusMessage=`Login failed: ${e.message}`,this.$emit("notify",e.message))}catch(t){this.loginStatusClass="status error",this.loginStatusMessage=`Network error: ${t.message}`,this.$emit("notify",`Network error: ${t.message}`)}finally{this.loading=!1}},saveUserInfo(t){try{fg({user_email:this.user_email,user_name:t.user_name||"",...t}),console.log("User info saved from login:",this.user_email)}catch(e){console.error("Failed to save user info from login:",e)}}}},tC={class:"auth-card"},sC={class:"auth-row"},nC={class:"auth-check"},rC=["disabled"],iC={class:"auth-alt"};function oC(t,e,s,n,r,i){return m(),g("div",tC,[e[10]||(e[10]=a("div",{class:"auth-logo"},[a("img",{src:XS,alt:"Mortgage RWA"})],-1)),e[11]||(e[11]=a("h1",{class:"auth-title"},"Login Your Account",-1)),e[12]||(e[12]=a("p",{class:"auth-sub"},"Welcome to Mortgage RWA",-1)),r.loginStatus?(m(),g("div",{key:0,class:be(["status",r.loginStatusClass])},p(r.loginStatusMessage),3)):B("",!0),a("form",{class:"auth-form",onSubmit:e[5]||(e[5]=ue((...o)=>i.submitLogin&&i.submitLogin(...o),["prevent"]))},[e[8]||(e[8]=a("label",{for:"lemail",class:"auth-label"},"Email",-1)),Pe(a("input",{id:"lemail",type:"email",class:"input auth-input",placeholder:"Enter your email","onUpdate:modelValue":e[0]||(e[0]=o=>r.user_email=o),required:""},null,512),[[Ze,r.user_email,void 0,{trim:!0}]]),e[9]||(e[9]=a("label",{for:"lpass",class:"auth-label"},"Password",-1)),Pe(a("input",{id:"lpass",type:"password",class:"input auth-input",placeholder:"••••••••","onUpdate:modelValue":e[1]||(e[1]=o=>r.user_password=o),required:""},null,512),[[Ze,r.user_password]]),a("div",sC,[a("label",nC,[Pe(a("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=o=>r.remember=o)},null,512),[[Xl,r.remember]]),e[6]||(e[6]=a("span",null,"Remember for 30 days",-1))]),a("a",{href:"#",class:"auth-link",onClick:e[3]||(e[3]=ue(o=>t.$emit("navigate","forgot"),["prevent"]))},"Forgot password")]),a("button",{class:"btn orange auth-submit",type:"submit",disabled:r.loading},p(r.loading?"Logging in...":"Login"),9,rC),a("p",iC,[e[7]||(e[7]=ne(" Don't have an account? ",-1)),a("a",{href:"#",class:"auth-link",onClick:e[4]||(e[4]=ue(o=>t.$emit("navigate","signup"),["prevent"]))},"Sign up")])],32)])}const xg=It(eC,[["render",oC],["__scopeId","data-v-c6c4c79f"]]);function aC(){const t=Date.now(),e=Math.random().toString(36).slice(2,7);return`user${t}${e}`}const lC="/icons/RWA-logo.png",cC={name:"SignupView",emits:["notify","navigate"],data(){return{user_email:"",user_password:"",user_name:"",user_phone:"",agreeTerms:!1,agreeEmailUpdates:!1,signupStatus:!1,signupStatusMessage:"",signupStatusClass:"",loading:!1}},methods:{generateUserId(){return aC()},async submitSignup(){this.clearFieldErrors();const t={user_email:this.user_email?.trim(),user_password:this.user_password,user_name:this.user_name?.trim(),user_phone:this.user_phone?.trim(),user_id:this.generateUserId()};console.log("🔍 注册表单数据:",t);const e=this.validateForm(t);if(this.agreeTerms||e.push("Please agree to the terms and conditions"),e.length>0){this.$emit("notify",`Validation errors: ${e.join(", ")}`),this.showFieldErrors(t);return}this.loading=!0,this.signupStatus=!0,this.signupStatusClass="status",this.signupStatusMessage="Registering...";try{console.log("🚀 发送注册请求:",t);const n=await(await fetch("http://localhost:3000/user/reguser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();n.status===0?(this.signupStatusClass="status success",this.signupStatusMessage=`Registration successful! User: ${this.user_email}`,this.saveUserInfo(),console.log("✅ Registration successful!"),console.log("📧 Email:",this.user_email),console.log("👤 Name:",this.user_name),console.log("📱 Phone:",this.user_phone),console.log("💾 User data saved to MySQL user table"),this.$emit("notify",n.message||"Registration successful! Please login to continue."),setTimeout(()=>{this.$router.push("/login")},1500)):(this.signupStatusClass="status error",this.signupStatusMessage=`Registration failed: ${n.message}`,console.error("❌ Registration failed:",n.message),console.error("🔍 Error details: status=",n.status),this.$emit("notify",n.message))}catch(s){this.signupStatusClass="status error",this.signupStatusMessage=`Network error: ${s.message}`,console.error("🌐 Network error:",s.message),console.error("🔍 Error type:",s.name),s.name==="TypeError"&&s.message.includes("fetch")?(console.error("🔌 Check if backend server is running on localhost:3000"),this.$emit("notify","Network error: Please check if the server is running")):this.$emit("notify",`Network error: ${s.message}`)}finally{this.loading=!1}},saveUserInfo(){try{dg({user_name:this.user_name,user_email:this.user_email,user_phone:this.user_phone,agree_email_updates:this.agreeEmailUpdates}),console.log("User info saved:",this.user_name,this.user_email,this.user_phone),console.log("Email updates preference:",this.agreeEmailUpdates)}catch(t){console.error("Failed to save user info:",t)}},validateForm(t){const e=[];return t.user_email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.user_email)||e.push("Invalid email format"):e.push("Email is required"),t.user_password?t.user_password.length<6&&e.push("Password must be at least 6 characters"):e.push("Password is required"),t.user_name&&t.user_name.length<2&&e.push("Name must be at least 2 characters if provided"),t.user_phone?this.isValidPhone(t.user_phone)||e.push("Invalid phone number format"):e.push("Phone number is required"),e},showFieldErrors(t){(!t.user_email||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.user_email))&&this.showFieldError("semail","Invalid email format"),(!t.user_password||t.user_password.length<6)&&this.showFieldError("spass","Password must be at least 6 characters"),t.user_name&&t.user_name.length<2&&this.showFieldError("sname","Name must be at least 2 characters if provided"),(!t.user_phone||!this.isValidPhone(t.user_phone))&&this.showFieldError("sphone","Invalid phone number format")},showFieldError(t,e){const s=document.getElementById(t);if(s){s.classList.add("error");const n=document.createElement("div");n.className="error-message",n.textContent=e,s.parentNode.appendChild(n)}},clearFieldErrors(){document.querySelectorAll(".auth-input").forEach(t=>{t.classList.remove("error")}),document.querySelectorAll(".error-message").forEach(t=>{t.remove()})},isValidPhone(t){return/^[\+]?[1-9][\d]{0,15}$/.test(t.replace(/[\s\-\(\)]/g,""))},goToTerms(){this.$router.push("/terms")},goToPrivacy(){this.$router.push("/privacy")}}},uC={class:"auth-card"},dC={key:0,class:"modal-mask"},fC={class:"modal-wrapper"},hC={class:"modal-container"},pC={class:"auth-row"},mC={class:"auth-check"},gC={class:"auth-row"},yC={class:"auth-check"},vC=["disabled"],bC={class:"auth-alt"};function wC(t,e,s,n,r,i){return m(),g("div",uC,[t.showModal?(m(),g("div",dC,[a("div",fC,[a("div",hC,[a("h3",null,p(t.modalTitle),1),a("p",null,p(t.modalMessage),1),a("button",{class:"btn orange",onClick:e[0]||(e[0]=(...o)=>t.handleModalAction&&t.handleModalAction(...o))},p(t.modalButtonText),1)])])])):B("",!0),e[19]||(e[19]=a("div",{class:"auth-logo"},[a("img",{src:lC,alt:"Mortgage RWA"})],-1)),e[20]||(e[20]=a("h1",{class:"auth-title"},"Create an account",-1)),r.signupStatus?(m(),g("div",{key:1,class:be(["status",r.signupStatusClass])},p(r.signupStatusMessage),3)):B("",!0),a("form",{class:"auth-form",onSubmit:e[10]||(e[10]=ue((...o)=>i.submitSignup&&i.submitSignup(...o),["prevent"]))},[e[15]||(e[15]=a("label",{for:"semail",class:"auth-label"},"Email",-1)),Pe(a("input",{id:"semail","onUpdate:modelValue":e[1]||(e[1]=o=>r.user_email=o),type:"email",class:"input auth-input",placeholder:"Enter your email",required:""},null,512),[[Ze,r.user_email,void 0,{trim:!0}]]),e[16]||(e[16]=a("label",{for:"spass",class:"auth-label"},"Password",-1)),Pe(a("input",{id:"spass","onUpdate:modelValue":e[2]||(e[2]=o=>r.user_password=o),type:"password",class:"input auth-input",placeholder:"Enter your password",required:""},null,512),[[Ze,r.user_password]]),e[17]||(e[17]=a("label",{for:"sname",class:"auth-label"},"Full Name",-1)),Pe(a("input",{id:"sname","onUpdate:modelValue":e[3]||(e[3]=o=>r.user_name=o),type:"text",class:"input auth-input",placeholder:"Enter your name"},null,512),[[Ze,r.user_name,void 0,{trim:!0}]]),e[18]||(e[18]=a("label",{for:"sphone",class:"auth-label"},"Phone number",-1)),Pe(a("input",{id:"sphone","onUpdate:modelValue":e[4]||(e[4]=o=>r.user_phone=o),type:"tel",class:"input auth-input",placeholder:"Enter your phone number",required:""},null,512),[[Ze,r.user_phone,void 0,{trim:!0}]]),a("div",pC,[a("label",mC,[Pe(a("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=o=>r.agreeTerms=o)},null,512),[[Xl,r.agreeTerms]]),a("span",null,[e[11]||(e[11]=ne("I agree to the ",-1)),a("a",{href:"#",onClick:e[6]||(e[6]=ue((...o)=>i.goToTerms&&i.goToTerms(...o),["prevent"]))},"Terms"),e[12]||(e[12]=ne(" and ",-1)),a("a",{href:"#",onClick:e[7]||(e[7]=ue((...o)=>i.goToPrivacy&&i.goToPrivacy(...o),["prevent"]))},"Privacy Policy.")])])]),a("div",gC,[a("label",yC,[Pe(a("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=o=>r.agreeEmailUpdates=o)},null,512),[[Xl,r.agreeEmailUpdates]]),e[13]||(e[13]=a("span",null,"I want to receive e-mail updates from RWA. ",-1))])]),a("button",{class:"btn orange auth-submit",type:"submit",disabled:r.loading||!r.agreeTerms},p(r.loading?"registering...":"Sign up"),9,vC),a("p",bC,[e[14]||(e[14]=ne(" Already have an account? ",-1)),a("a",{href:"#",class:"auth-link",onClick:e[9]||(e[9]=ue(o=>t.go("/login"),["prevent"]))},"Log in")])],32)])}const Ng=It(cC,[["render",wC],["__scopeId","data-v-55e3b169"]]),Hf=["function kycLevel(address user) external view returns (uint8)","function blocked(address user) external view returns (bool)","function setKycLevel(address user, uint8 level) external","function setBlocked(address user, bool isBlocked) external","function setKycLevelBySig(address user, uint8 level, uint256 deadline, bytes32 nonce, bytes calldata signature) external","function setSigner(address signer) external","function kycSigner() external view returns (address)","function DOMAIN_SEPARATOR() external view returns (bytes32)","function usedNonce(bytes32 nonce) external view returns (bool)","event SetLevel(address indexed user, uint8 level, address indexed setter)","event Block(address indexed user, bool blocked, address indexed setter)","event SetSigner(address indexed signer)"],Wf=["function registry() external view returns (address)","function principalToken() external view returns (address)","function interestToken() external view returns (address)","function nextLoanId() external view returns (uint256)","function loans(uint256 loanId) external view returns (uint256 principal, uint256 annualRateBps, uint64 startDate, uint64 dueDate, string memory borrower, string memory lender, string memory collateral, string memory note, bool closed)","function loanHolder(uint256 loanId) external view returns (address)","function wireControllers() external","function createLoan((address holder, uint256 principalAmount, uint256 annualRateBps, uint64 startDate, uint64 dueDate, string memory borrower, string memory lender, string memory collateral, string memory note) calldata p) external returns (uint256 loanId)","function mintInterest(uint256 loanId, address to, uint256 amount) external","function redeem(uint256 loanId, uint256 principalAmt, uint256 interestAmt) external","function closeLoan(uint256 loanId) external","event CreateLoan(uint256 indexed loanId, address indexed holder, uint256 principal, uint256 rateBps)","event MintInterest(uint256 indexed loanId, address indexed to, uint256 amount)","event Redeem(uint256 indexed loanId, address indexed from, uint256 principalBurn, uint256 interestBurn)","event CloseLoan(uint256 indexed loanId)"],AC=["function whitelist(address user) external view returns (bool)","function blocked(address user) external view returns (bool)","function kycTier(address user) external view returns (uint8)","function kycExpireAt(address user) external view returns (uint64)","function setWhitelist(address user, bool allow) external","function setBlocked(address user, bool blocked) external","function setWhitelistBySig(address user, bool allow, uint8 tier, uint64 expireAt, uint256 nonce, uint256 deadline, uint8 v, bytes32 r, bytes32 s) external","function activateByProof(address user, bool allow, uint8 tier, uint64 expireAt, bytes32[] calldata proof) external","function canReceivePrincipal(address user) external view returns (bool)","function canReceiveInterest(address user) external view returns (bool)","function canRedeem(address user) external view returns (bool)","function checkPrincipal(address from, address to) external view","function checkInterest(address from, address to) external view","function minTierPrincipal() external view returns (uint8)","function minTierInterest() external view returns (uint8)","function minTierRedeem() external view returns (uint8)","function transfersPaused() external view returns (bool)","function nonces(address user) external view returns (uint256)","event WhitelistSet(address indexed user, bool allow)","event BlockedSet(address indexed user, bool blocked)","event KycStamped(address indexed user, bool allow, uint8 tier, uint64 expireAt)","event WhitelistBySig(address indexed user, bool allow, uint8 tier, uint64 expireAt, uint256 nonce, uint256 deadline, address indexed relayer)"],Ci=["function name() external view returns (string memory)","function symbol() external view returns (string memory)","function decimals() external pure returns (uint8)","function totalSupply() external view returns (uint256)","function balanceOf(address account) external view returns (uint256)","function allowance(address owner, address spender) external view returns (uint256)","function transfer(address to, uint256 amount) external returns (bool)","function approve(address spender, uint256 amount) external returns (bool)","function transferFrom(address from, address to, uint256 amount) external returns (bool)","function registry() external view returns (address)","function requiredKycLevel() external view returns (uint8)","function paused() external view returns (bool)","function setRequiredKycLevel(uint8 level) external","function setPaused(bool p) external","event Transfer(address indexed from, address indexed to, uint256 value)","event Approval(address indexed owner, address indexed spender, uint256 value)","event RequiredKycLevel(uint8 oldLevel, uint8 newLevel)","event Paused(bool status)"],EC=["function buyTokens(uint256 amount) external payable","function sellTokens(uint256 amount) external","function getTokenPrice() external view returns (uint256)","function getUserBalance(address user) external view returns (uint256)","function getTradeHistory(uint256 limit) external view returns (tuple(uint256 id, address user, uint8 tradeType, uint256 amount, uint256 price, uint256 timestamp)[])","event TradeExecuted(uint256 indexed id, address indexed user, uint8 tradeType, uint256 amount, uint256 price, uint256 timestamp)"];class _C{constructor(){this.provider=null,this.signer=null,this.contracts={kycRegistry:null,loanIssuer:null,principalToken:null,interestToken:null,trade:null,complianceGuard:null},this.isInitialized=!1}async initialize(){try{if(console.log("🚀 Initializing Unified Contract Service..."),typeof window.ethereum>"u")throw new Error("Web3钱包未检测到，请安装MetaMask或类似钱包");return this.validateContractAddresses(),await this.checkNetwork(),this.provider=new cs(window.ethereum),await window.ethereum.request({method:"eth_requestAccounts"}),this.signer=await this.provider.getSigner(),await this.initializeContracts(),this.isInitialized=!0,console.log("✅ Unified Contract Service initialized successfully!"),!0}catch(e){throw console.error("❌ Failed to initialize Unified Contract Service:",e),this.handleError(e)}}validateContractAddresses(){const e={"KYC Registry":ke.KYC_REGISTRY_ADDRESS,"Loan Issuer":ke.LOAN_ISSUER_ADDRESS,"Principal Token":ke.PRINCIPAL_TOKEN_ADDRESS,"Interest Token":ke.INTEREST_TOKEN_ADDRESS,"Trade Contract":ke.TRADE_CONTRACT_ADDRESS,"Compliance Guard":ke.COMPLIANCE_GUARD_ADDRESS};for(const[s,n]of Object.entries(e))this.validateContractAddress(n,s)}async checkNetwork(){const e=await window.ethereum.request({method:"eth_chainId"}),s="0x"+ke.NETWORK.chainId.toString(16),n=parseInt(e,16);if(console.log("🌐 Current chain ID:",n),console.log("🎯 Target chain ID:",ke.NETWORK.chainId),e!==s)throw new Error(`Please switch to ${ke.NETWORK.name} (Chain ID: ${ke.NETWORK.chainId})`)}async initializeContracts(){const e=[{name:"kycRegistry",address:ke.KYC_REGISTRY_ADDRESS,abi:Hf},{name:"loanIssuer",address:ke.LOAN_ISSUER_ADDRESS,abi:Wf},{name:"principalToken",address:ke.PRINCIPAL_TOKEN_ADDRESS,abi:Ci},{name:"interestToken",address:ke.INTEREST_TOKEN_ADDRESS,abi:Ci},{name:"trade",address:ke.TRADE_CONTRACT_ADDRESS,abi:EC},{name:"complianceGuard",address:ke.COMPLIANCE_GUARD_ADDRESS,abi:AC}];for(const s of e)try{this.contracts[s.name]=new Wt(s.address,s.abi,this.signer),console.log(`✅ ${s.name} contract initialized`)}catch(n){throw console.error(`❌ Failed to initialize ${s.name} contract:`,n),new Error(`Failed to initialize ${s.name} contract: ${n.message}`)}}validateContractAddress(e,s){if(!e||e==="#"||e==="0x...")throw new Error(`${s} contract address is not configured properly`);if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`${s} contract address format is invalid: ${e}`);return!0}async verifyContractExists(e){try{if(this.provider||await this.initialize(),!fa(e))throw new Error(`无效的合约地址格式: ${e}`);const s=await this.provider.getCode(e);return{exists:s!=="0x",codeLength:s.length,address:e}}catch(s){return console.error("❌ Failed to verify contract:",s),{exists:!1,error:s.message,address:e}}}async batchVerifyContracts(e){try{this.provider||await this.initialize(),console.log("🔍 Batch verifying contracts:",e);const s={};for(const[n,r]of Object.entries(e))r&&r!=="0x1234567890123456789012345678901234567890"?s[n]=await this.verifyContractExists(r):s[n]={exists:!1,error:"地址未配置或为默认地址",address:r};return console.log("✅ Batch verification completed:",s),s}catch(s){throw console.error("❌ Failed to batch verify contracts:",s),s}}async getNetworkInfo(){try{this.provider||await this.initialize();const e=await this.provider.getNetwork(),s=await this.provider.send("eth_chainId",[]);return{chainId:parseInt(s,16),name:e.name,ensAddress:e.ensAddress}}catch(e){throw console.error("❌ Failed to get network info:",e),e}}async switchNetwork(e){try{const s="0x"+e.toString(16);return await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:s}]}),console.log("✅ Network switched to:",e),!0}catch(s){throw console.error("❌ Failed to switch network:",s),s}}async getUserAddress(){try{if(console.log("🔍 Getting user address..."),this.signer)try{const e=await this.signer.getAddress();return console.log("✅ Address from signer:",e),e}catch(e){console.warn("⚠️ Signer getAddress failed:",e.message)}if(!this.signer&&(console.log("🔄 Signer not available, initializing..."),await this.initialize(),this.signer))try{const e=await this.signer.getAddress();return console.log("✅ Address after initialization:",e),e}catch(e){console.warn("⚠️ Signer still not working:",e.message)}if(typeof window.ethereum<"u"){console.log("🔄 Trying direct ethereum access...");try{const e=await window.ethereum.request({method:"eth_accounts"});if(e&&e.length>0)return console.log("✅ Address from ethereum:",e[0]),e[0]}catch(e){console.warn("⚠️ Ethereum access failed:",e.message)}}return console.error("❌ Unable to get user address from any source"),null}catch(e){return console.error("❌ Failed to get user address:",e),null}}async validateUserAddress(e=null){try{if(console.log("🔍 Validating user address..."),e||(e=await this.getUserAddress()),!e)throw new Error("无法获取用户钱包地址");if(!fa(e))throw new Error(`无效的钱包地址格式: ${e}`);if(e==="0x0000000000000000000000000000000000000000")throw new Error("钱包地址不能为零地址");return console.log("✅ User address validated:",e),{success:!0,address:e,isValid:!0}}catch(s){return console.error("❌ Address validation failed:",s),{success:!1,address:e,isValid:!1,error:s.message}}}async fetchTokenAddressesFromLoanIssuer(e){try{if(this.provider||await this.initialize(),console.log("🔍 Fetching token addresses from LoanIssuer:",e),!(await this.verifyContractExists(e)).exists)throw new Error(`LoanIssuer合约不存在: ${e}`);const n=new Wt(e,Wf,this.provider),[r,i,o,l]=await Promise.all([n.registry().catch(()=>"0x0000000000000000000000000000000000000000"),n.principalToken().catch(()=>"0x0000000000000000000000000000000000000000"),n.interestToken().catch(()=>"0x0000000000000000000000000000000000000000"),n.nextLoanId().catch(()=>0)]),c={loanIssuer:{address:e,registry:r,principalToken:i,interestToken:o,nextLoanId:l.toString()},tokenAddresses:{principalToken:i,interestToken:o}};return console.log("✅ Token addresses fetched:",c),c}catch(s){throw console.error("❌ Failed to fetch token addresses:",s),s}}async fetchTokenDetails(e){try{if(this.provider||await this.initialize(),console.log("🔍 Fetching token details:",e),!(await this.verifyContractExists(e)).exists)throw new Error(`代币合约不存在: ${e}`);const n=new Wt(e,Ci,this.provider),[r,i,o,l,c,u,d]=await Promise.all([n.name().catch(()=>"未知"),n.symbol().catch(()=>"未知"),n.decimals().catch(()=>18),n.totalSupply().catch(()=>0),n.registry().catch(()=>"0x0000000000000000000000000000000000000000"),n.requiredKycLevel().catch(()=>0),n.paused().catch(()=>!1)]),f={address:e,name:r,symbol:i,decimals:o.toString(),totalSupply:_t(l),registry:c,requiredKycLevel:u.toString(),paused:d};return console.log("✅ Token details fetched:",f),f}catch(s){throw console.error("❌ Failed to fetch token details:",s),s}}async fetchKycRegistryDetails(e){try{if(this.provider||await this.initialize(),console.log("🔍 Fetching KYC registry details:",e),!(await this.verifyContractExists(e)).exists)throw new Error(`KYC注册表合约不存在: ${e}`);const n=new Wt(e,Hf,this.provider),[r,i]=await Promise.all([n.kycSigner().catch(()=>"0x0000000000000000000000000000000000000000"),n.DOMAIN_SEPARATOR().catch(()=>"0x0000000000000000000000000000000000000000000000000000000000000000")]),o={address:e,kycSigner:r,domainSeparator:i};return console.log("✅ KYC registry details fetched:",o),o}catch(s){throw console.error("❌ Failed to fetch KYC registry details:",s),s}}async fetchAllContractInfo(e){try{this.provider||await this.initialize(),console.log("🔍 Fetching all contract information:",e);const s={network:await this.getNetworkInfo(),verification:{},tokenAddresses:{},tokenDetails:{},kycRegistry:{}};if(s.verification=await this.batchVerifyContracts(e),s.verification.LOAN_ISSUER_ADDRESS?.exists)try{const n=await this.fetchTokenAddressesFromLoanIssuer(e.LOAN_ISSUER_ADDRESS);s.tokenAddresses=n.tokenAddresses,s.loanIssuer=n.loanIssuer}catch(n){console.warn("⚠️ Failed to fetch token addresses from LoanIssuer:",n.message)}if(s.tokenAddresses.principalToken&&s.verification.PRINCIPAL_TOKEN_ADDRESS?.exists)try{s.tokenDetails.principalToken=await this.fetchTokenDetails(s.tokenAddresses.principalToken)}catch(n){console.warn("⚠️ Failed to fetch principal token details:",n.message)}if(s.tokenAddresses.interestToken&&s.verification.INTEREST_TOKEN_ADDRESS?.exists)try{s.tokenDetails.interestToken=await this.fetchTokenDetails(s.tokenAddresses.interestToken)}catch(n){console.warn("⚠️ Failed to fetch interest token details:",n.message)}if(s.verification.KYC_REGISTRY_ADDRESS?.exists)try{s.kycRegistry=await this.fetchKycRegistryDetails(e.KYC_REGISTRY_ADDRESS)}catch(n){console.warn("⚠️ Failed to fetch KYC registry details:",n.message)}return console.log("✅ All contract information fetched:",s),s}catch(s){throw console.error("❌ Failed to fetch all contract info:",s),s}}async applyForKYC(e){try{this.contracts.kycRegistry||await this.initialize();const s=await this.getUserAddress();if(await this.contracts.kycRegistry.blocked(s))throw new Error("User is blocked from KYC verification");const r=await this.contracts.kycRegistry.kycLevel(s);if(r>=2)return{success:!0,message:"User already has sufficient KYC level",currentLevel:r};const i=wt(Zn.defaultAbiCoder().encode(["string","string","string","string","string"],[e.firstName,e.lastName,e.dob,e.country,e.docType]));return console.log("KYC Data Hash:",i),console.log("KYC Data:",e),{success:!0,message:"KYC application submitted successfully",kycHash:i,userAddress:s}}catch(s){return console.error("KYC application failed:",s),{success:!1,error:s.message}}}async getKycLevel(e=null){try{return this.contracts.kycRegistry||await this.initialize(),e||(e=await this.getUserAddress()),await this.contracts.kycRegistry.kycLevel(e)}catch(s){return console.error("Failed to check KYC level:",s),0}}async isBlocked(e=null){try{return this.contracts.kycRegistry||await this.initialize(),e||(e=await this.getUserAddress()),await this.contracts.kycRegistry.blocked(e)}catch(s){return console.error("Failed to check block status:",s),!1}}async getTokenBalance(e,s=null){try{return s||(s=await this.getUserAddress()),await new Wt(e,Ci,this.signer).balanceOf(s)}catch(n){return console.error("Failed to get token balance:",n),0n}}async getTokenInfo(e){try{const s=new Wt(e,Ci,this.signer),[n,r,i,o]=await Promise.all([s.name(),s.symbol(),s.decimals(),s.totalSupply()]);return{name:n,symbol:r,decimals:i,totalSupply:o,address:e}}catch(s){return console.error("Failed to get token info:",s),null}}async buyTokens(e){try{this.contracts.trade||await this.initialize();const s=await this.getUserAddress();if(!s)throw new Error("无法获取用户钱包地址，请确保钱包已连接");if(console.log("💰 购买代币:",{amount:e,userAddress:s}),!ke.TRADE_CONTRACT_ADDRESS||ke.TRADE_CONTRACT_ADDRESS==="0x1234567890123456789012345678901234567890"){console.warn("⚠️ Trade contract address is not configured, simulating successful transaction");const l="0x"+Math.random().toString(16).substr(2,64),c=Math.floor(Math.random()*1e6)+1e6;return{success:!0,transactionHash:l,blockNumber:c,tokenPrice:"1.0",totalCost:e.toString(),userAddress:s}}let n,r;try{n=await this.contracts.trade.getTokenPrice(),r=n*BigInt(e),console.log("💰 获取到代币价格:",n.toString())}catch(l){console.warn("⚠️ 无法获取代币价格，使用默认价格:",l.message),n=si("1.0"),r=n*BigInt(e)}console.log("💰 购买代币:",{amount:e,userAddress:s,tokenPrice:n.toString(),totalCost:r.toString()});const o=await(await this.contracts.trade.buyTokens(e,{value:r})).wait();return{success:!0,transactionHash:o.transactionHash,blockNumber:o.blockNumber,tokenPrice:_t(n),totalCost:_t(r),userAddress:s}}catch(s){return console.error("❌ Failed to buy tokens:",s),{success:!1,error:s.message}}}async sellTokens(e){try{this.contracts.trade||await this.initialize();const s=await this.getUserAddress();if(!s)throw new Error("无法获取用户钱包地址，请确保钱包已连接");if(console.log("💸 出售代币:",{amount:e,userAddress:s}),!ke.TRADE_CONTRACT_ADDRESS||ke.TRADE_CONTRACT_ADDRESS==="0x1234567890123456789012345678901234567890"){console.warn("⚠️ Trade contract address is not configured, simulating successful transaction");const l="0x"+Math.random().toString(16).substr(2,64),c=Math.floor(Math.random()*1e6)+1e6;return{success:!0,transactionHash:l,blockNumber:c,tokenPrice:"1.0",totalCost:e.toString(),userAddress:s}}let n,r;try{n=await this.contracts.trade.getTokenPrice(),r=n*BigInt(e),console.log("💰 获取到代币价格:",n.toString())}catch(l){console.warn("⚠️ 无法获取代币价格，使用默认价格:",l.message),n=si("1.0"),r=n*BigInt(e)}console.log("💸 出售代币:",{amount:e,userAddress:s,tokenPrice:n.toString(),totalRevenue:r.toString()});const o=await(await this.contracts.trade.sellTokens(e)).wait();return{success:!0,transactionHash:o.transactionHash,blockNumber:o.blockNumber,tokenPrice:_t(n),totalCost:_t(r),userAddress:s}}catch(s){return console.error("Failed to sell tokens:",s),{success:!1,error:s.message}}}async getTokenPrice(){try{if(this.contracts.trade||await this.initialize(),console.log("🔍 Attempting to get token price from contract:",ke.TRADE_CONTRACT_ADDRESS),!ke.TRADE_CONTRACT_ADDRESS||ke.TRADE_CONTRACT_ADDRESS==="0x1234567890123456789012345678901234567890")return console.warn("⚠️ Trade contract address is not configured, returning default price"),"1.0";const e=await this.contracts.trade.getTokenPrice();return console.log("✅ Token price retrieved:",_t(e)),_t(e)}catch(e){return console.error("❌ Failed to get token price:",e),e.message.includes("BAD_DATA")||e.message.includes("UNSUPPORTED_OPERATION")?(console.warn("⚠️ Contract method not available, using default price"),"1.0"):"0"}}async isWhitelisted(e){try{this.contracts.complianceGuard||await this.initialize(),console.log("🔍 Checking whitelist status for:",e);const s=await this.contracts.complianceGuard.whitelist(e);return console.log("✅ Whitelist status:",s),s}catch(s){return console.error("❌ Failed to check whitelist status:",s),!1}}async getKycLevel(e){try{this.contracts.complianceGuard||await this.initialize(),console.log("🔍 Getting KYC level for:",e);const s=await this.contracts.complianceGuard.kycTier(e);return console.log("✅ KYC level:",s.toString()),parseInt(s.toString())}catch(s){return console.error("❌ Failed to get KYC level:",s),0}}async getWhitelistStatus(e){try{console.log("🔍 Getting comprehensive whitelist status for:",e);const[s,n,r,i]=await Promise.all([this.isWhitelisted(e),this.isBlocked(e),this.getKycLevel(e),this.getKycExpireAt(e)]),o=Math.floor(Date.now()/1e3),l=i>0&&o>i;let c="none";return n?c="rejected":s&&r>=2&&!l||s&&r>=2?c="approved":s&&r>=1&&(c="pending"),console.log("✅ Whitelist status:",c),{status:c,isWhitelisted:s,isBlocked:n,kycLevel:r,kycExpireAt:i,isKycExpired:l}}catch(s){return console.error("❌ Failed to get whitelist status:",s),{status:"none",isWhitelisted:!1,isBlocked:!1,kycLevel:0,kycExpireAt:0,isKycExpired:!1}}}async getKycExpireAt(e){try{this.contracts.complianceGuard||await this.initialize(),console.log("🔍 Getting KYC expire time for:",e);const s=await this.contracts.complianceGuard.kycExpireAt(e);return console.log("✅ KYC expire time:",s.toString()),parseInt(s.toString())}catch(s){return console.error("❌ Failed to get KYC expire time:",s),0}}async getLoanInfo(e){try{this.contracts.loanIssuer||await this.initialize();const s=await this.contracts.loanIssuer.loans(e),n=await this.contracts.loanIssuer.loanHolder(e);return{loanId:e,principal:s.principal,annualRateBps:s.annualRateBps,startDate:s.startDate,dueDate:s.dueDate,borrower:s.borrower,lender:s.lender,collateral:s.collateral,note:s.note,closed:s.closed,holder:n}}catch(s){return console.error("Failed to get loan info:",s),null}}async getNextLoanId(){try{return this.contracts.loanIssuer||await this.initialize(),await this.contracts.loanIssuer.nextLoanId()}catch(e){return console.error("Failed to get next loan ID:",e),0n}}handleError(e){return e.message.includes("UNSUPPORTED_OPERATION")?new Error("Contract address format is invalid. Please check your configuration."):e.message.includes("network")?new Error(`Network error: ${e.message}`):e.message.includes("wallet")?new Error("Wallet connection failed. Please check your MetaMask connection."):new Error(`Service error: ${e.message}`)}}const ns=new _C,TC={name:"WhitelistApplication",props:{isKycVerified:{type:Boolean,default:!1},userInfo:{type:Object,default:()=>({})}},data(){return{whitelistStatus:"none",showApplicationModal:!1,showProcessingModal:!1,showResultModal:!1,loading:!1,processingTitle:"Applying for Whitelist...",processingMessage:"Please wait while we process your whitelist application.",processingSubMessage:"Connecting to blockchain and submitting your application...",resultType:"success",resultTitle:"",resultMessage:"",showValidationErrorModal:!1,validationErrorTitle:"",validationErrorMessage:"",contractService:ns}},computed:{statusClass(){switch(this.whitelistStatus){case"approved":return"green";case"pending":return"orange";case"rejected":return"red";default:return"gray"}}},async mounted(){try{await this.loadWhitelistStatus()}catch(t){console.error("Failed to initialize contract service:",t)}},methods:{async loadWhitelistStatus(){try{const t=Ls();if(this.isKycVerified&&t>=Se.LEVEL_2){this.whitelistStatus="approved",localStorage.setItem("whitelistStatus","approved"),console.log("✅ KYC Level 2用户，白名单状态自动设置为approved");return}if(!this.contractService)return;const s=await this.getUserWalletAddress();if(!s){console.warn("No wallet address available for whitelist status check");return}const n=await this.contractService.getWhitelistStatus(s);this.whitelistStatus=n.status,console.log("✅ Whitelist status loaded:",n)}catch(t){console.error("Failed to load whitelist status:",t);const e=localStorage.getItem("whitelistStatus");e&&(this.whitelistStatus=e)}},async applyWhitelist(){if(console.log("🔍 开始验证白名单申请条件..."),!mr()){this.showValidationError("请先登录账户","您需要先登录才能申请白名单");return}if(!this.isKycVerified){this.showValidationError("KYC验证未完成","请先完成KYC身份验证才能申请白名单");return}const t=Ls();t<Se.LEVEL_2&&(console.log(`🔧 KYC验证成功，自动设置级别为 ${Se.LEVEL_2}`),Yn(Se.LEVEL_2),console.log("✅ KYC级别已设置为Level 2"));const e=await this.getUserWalletAddress();if(!e){this.showValidationError("钱包未连接","请先连接MetaMask钱包才能申请白名单");return}if(t>=Se.LEVEL_2){console.log("✅ KYC Level 2用户，直接通过白名单申请"),this.whitelistStatus="approved",localStorage.setItem("whitelistStatus","approved"),this.showSuccessResult("Whitelist Approved!","Congratulations! Your KYC Level 2 status automatically qualifies you for whitelist. You can now start trading assets."),this.$emit("success","Whitelist automatically approved due to KYC Level 2 status!");return}const s=await this.checkCurrentWhitelistStatus(e);if(s==="approved"){this.showValidationError("已在白名单中","您的钱包地址已经在白名单中，无需重复申请");return}if(s==="pending"){this.showValidationError("申请审核中","您的白名单申请正在审核中，请耐心等待");return}console.log("✅ 所有条件验证通过，可以申请白名单"),this.showApplicationModal=!0},async submitApplication(){this.loading=!0,this.showApplicationModal=!1,this.showProcessingModal=!0;try{console.log("🚀 开始提交白名单申请...");const t=await this.getUserWalletAddress();if(!t)throw new Error("无法获取钱包地址");this.processingTitle="正在提交白名单申请...",this.processingMessage="正在连接区块链并提交您的申请",this.processingSubMessage="请稍候，不要关闭页面...";let e;if(this.contractService){console.log("📝 通过合约服务申请白名单...");const s={userAddress:t,kycLevel:Ls(),timestamp:Date.now(),userInfo:this.userInfo};e=await this.contractService.applyForWhitelist(s)}else console.log("⚠️ 合约服务未初始化，使用模拟申请..."),await this.delay(2e3),e={success:!0,transactionHash:"0x"+Math.random().toString(16).substr(2,40),blockNumber:Math.floor(Math.random()*1e6)+1e6,message:"白名单申请已提交（模拟）"};e.success?(console.log("✅ 白名单申请提交成功:",e),this.whitelistStatus="pending",localStorage.setItem("whitelistStatus","pending"),e.transactionHash&&localStorage.setItem("whitelistTransactionHash",e.transactionHash),this.showProcessingModal=!1,console.log("🎉 白名单申请提交成功！"),console.log(`交易哈希: ${e.transactionHash||"N/A"}`),console.log("我们将在24小时内审核您的申请"),this.$emit("success","白名单申请提交成功！"),setTimeout(()=>{this.checkWhitelistStatus()},5e3)):(console.error("❌ 白名单申请失败:",e.error),this.showProcessingModal=!1,console.error("申请失败:",e.error||"白名单申请提交失败，请稍后重试。"),this.$emit("error","白名单申请失败，请稍后重试。"))}catch(t){console.error("❌ 白名单申请错误:",t),this.showProcessingModal=!1,console.error("申请错误:",t.message||"提交申请时发生错误，请检查网络连接后重试。"),this.$emit("error","提交申请时发生错误，请检查网络连接后重试。")}finally{this.loading=!1}},async checkWhitelistStatus(){this.loading=!0,this.showProcessingModal=!0,this.processingTitle="Checking Status...",this.processingMessage="Please wait while we check your whitelist status.",this.processingSubMessage="Querying blockchain for latest status...";try{await this.delay(1e3),await this.loadWhitelistStatus(),this.showProcessingModal=!1,this.whitelistStatus==="approved"?(this.showSuccessResult("Application Approved!","Congratulations! Your whitelist application has been approved. You can now start trading assets."),this.$emit("success","Whitelist application approved!")):this.whitelistStatus==="rejected"?(this.showErrorResult("Application Rejected","Your whitelist application was rejected. Please contact support for more information."),this.$emit("error","Whitelist application rejected.")):(this.showWarningResult("Still Pending","Your application is still under review. Please check again later."),this.$emit("info","Application still pending."))}catch(t){console.error("Failed to check whitelist status:",t),this.showProcessingModal=!1,this.showErrorResult("Check Failed","Failed to check whitelist status. Please try again."),this.$emit("error","Failed to check whitelist status.")}finally{this.loading=!1,this.resetProcessingModal()}},async reapplyWhitelist(){this.whitelistStatus="none",localStorage.setItem("whitelistStatus","none"),await this.applyWhitelist()},goToProjects(){this.$router.push("/listedprojects")},showSuccessResult(t,e){this.resultType="success",this.resultTitle=t,this.resultMessage=e,this.showResultModal=!0},showErrorResult(t,e){this.resultType="error",this.resultTitle=t,this.resultMessage=e,this.showResultModal=!0},showWarningResult(t,e){this.resultType="warning",this.resultTitle=t,this.resultMessage=e,this.showResultModal=!0},closeResultModal(){this.showResultModal=!1},resetProcessingModal(){this.processingTitle="Applying for Whitelist...",this.processingMessage="Please wait while we process your whitelist application.",this.processingSubMessage="Connecting to blockchain and submitting your application..."},delay(t){return new Promise(e=>setTimeout(e,t))},showValidationError(t,e){this.validationErrorTitle=t,this.validationErrorMessage=e,this.showValidationErrorModal=!0},async getUserWalletAddress(){try{return typeof window.ethereum<"u"&&(await window.ethereum.request({method:"eth_accounts"}))[0]||null}catch(t){return console.error("获取用户钱包地址失败:",t),null}},async checkCurrentWhitelistStatus(t){try{return this.contractService?(await this.contractService.getWhitelistStatus(t)).status:localStorage.getItem("whitelistStatus")||"none"}catch(e){return console.error("检查白名单状态失败:",e),localStorage.getItem("whitelistStatus")||"none"}}},watch:{isKycVerified(t){!t&&this.whitelistStatus!=="none"&&(this.whitelistStatus="none",localStorage.removeItem("whitelistStatus"))}}},PC={class:"whitelist-application"},kC={class:"field"},SC={key:0,class:"verified"},CC={key:1},IC={key:2},RC={key:3},DC=["disabled"],xC=["disabled"],NC=["disabled"],LC={key:0,class:"modal-mask"},OC={class:"modal-wrapper"},UC={class:"modal-container"},BC={style:{"margin-top":"18px",display:"flex",gap:"12px","justify-content":"flex-end"}},MC=["disabled"],FC=["disabled"],VC={key:0},$C={key:1},jC={key:1,class:"modal-mask"},HC={class:"modal-wrapper"},WC={class:"modal-container"},YC={style:{"text-align":"center",padding:"20px"}},GC={style:{"margin-bottom":"8px"}},KC={style:{color:"#64748b","font-size":"14px","margin-top":"8px"}},zC={key:2,class:"modal-mask"},QC={class:"modal-wrapper"},JC={class:"modal-container"},qC={style:{"text-align":"center",padding:"20px"}},ZC={key:0},XC={key:1},eI={style:{"margin-bottom":"8px"}},tI={style:{"margin-top":"18px",display:"flex",gap:"12px","justify-content":"center"}},sI={key:3,class:"modal-mask"},nI={class:"modal-wrapper"},rI={class:"modal-container"},iI={style:{"text-align":"center",padding:"20px"}},oI={style:{"margin-bottom":"8px",color:"#dc2626"}},aI={style:{color:"#6b7280","margin-bottom":"20px"}},lI={style:{"margin-top":"18px",display:"flex",gap:"12px","justify-content":"center"}};function cI(t,e,s,n,r,i){const o=Zy('else"');return m(),g("div",PC,[a("div",kC,[e[11]||(e[11]=a("label",{class:"label"},"Whitelist Status",-1)),a("div",{class:be(["whitelist-banner",i.statusClass]),role:"status"},[e[10]||(e[10]=a("span",{class:"icon"},[a("svg",{viewBox:"0 0 24 24",class:"i"},[a("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})])],-1)),r.whitelistStatus==="approved"?(m(),g("span",SC,[...e[9]||(e[9]=[a("svg",{viewBox:"0 0 24 24",class:"i"},[a("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"})],-1),ne(" Whitelist Approved ",-1)])])):r.whitelistStatus==="pending"?(m(),g("span",CC,"Whitelist Application Pending")):r.whitelistStatus==="rejected"?(m(),g("span",IC,"Not Qualified for Transaction")):(m(),g("span",RC,"Apply for Whitelist")),r.whitelistStatus==="none"?(m(),g("button",{key:4,class:"link",type:"button",onClick:e[0]||(e[0]=(...l)=>i.applyWhitelist&&i.applyWhitelist(...l)),disabled:r.loading},"Apply Now",8,DC)):r.whitelistStatus==="pending"?(m(),g("button",{key:5,class:"link",type:"button",onClick:e[1]||(e[1]=(...l)=>i.checkWhitelistStatus&&i.checkWhitelistStatus(...l)),disabled:r.loading},"Check Status",8,xC)):r.whitelistStatus==="approved"?(m(),g("button",{key:6,class:"link",type:"button",onClick:e[2]||(e[2]=(...l)=>i.goToProjects&&i.goToProjects(...l))},"Start Trading")):r.whitelistStatus==="rejected"?(m(),g("button",{key:7,class:"link",type:"button",onClick:e[3]||(e[3]=(...l)=>i.reapplyWhitelist&&i.reapplyWhitelist(...l)),disabled:r.loading},"Reapply",8,NC)):B("",!0)],2)]),r.showApplicationModal?(m(),g("div",LC,[a("div",OC,[a("div",UC,[e[12]||(e[12]=a("h2",{style:{"margin-bottom":"8px"}},"Apply for Whitelist",-1)),e[13]||(e[13]=a("p",null,"You are about to apply for the whitelist to start trading assets.",-1)),e[14]||(e[14]=a("p",null,[a("strong",null,"Requirements:")],-1)),e[15]||(e[15]=a("ul",{style:{margin:"8px 0","padding-left":"20px"}},[a("li",null,"KYC verification completed ✅"),a("li",null,"Valid wallet connection"),a("li",null,"Agreement to terms and conditions")],-1)),a("div",BC,[a("button",{class:"btn light",onClick:e[4]||(e[4]=l=>r.showApplicationModal=!1),disabled:r.loading},"Cancel",8,MC),a("button",{class:"btn orange",onClick:e[5]||(e[5]=(...l)=>i.submitApplication&&i.submitApplication(...l)),disabled:r.loading},[r.loading?(m(),g("span",VC,"Applying...")):(m(),g("span",$C,"Apply Now"))],8,FC)])])])])):B("",!0),r.showProcessingModal?(m(),g("div",jC,[a("div",HC,[a("div",WC,[a("div",YC,[e[16]||(e[16]=a("div",{class:"spinner"},null,-1)),a("h2",GC,p(r.processingTitle),1),a("p",null,p(r.processingMessage),1),a("p",KC,p(r.processingSubMessage),1)])])])])):B("",!0),r.showResultModal?(m(),g("div",zC,[a("div",QC,[a("div",JC,[a("div",qC,[a("div",{class:be(["result-icon",r.resultType])},[r.resultType==="success"?(m(),g("span",ZC,"✓")):r.resultType==="error"?(m(),g("span",XC,"✗")):B("",!0),Pe((m(),g("span",null,[...e[17]||(e[17]=[ne("⚠",-1)])])),[[o]])],2),a("h2",eI,p(r.resultTitle),1),a("p",null,p(r.resultMessage),1),a("div",tI,[r.resultType==="success"?(m(),g("button",{key:0,class:"btn orange",onClick:e[6]||(e[6]=(...l)=>i.goToProjects&&i.goToProjects(...l))},"Start Trading")):B("",!0),a("button",{class:"btn light",onClick:e[7]||(e[7]=(...l)=>i.closeResultModal&&i.closeResultModal(...l))},"Close")])])])])])):B("",!0),r.showValidationErrorModal?(m(),g("div",sI,[a("div",nI,[a("div",rI,[a("div",iI,[e[18]||(e[18]=a("div",{class:"result-icon error",style:{"background-color":"#fee2e2",color:"#dc2626"}},[a("span",null,"⚠")],-1)),a("h2",oI,p(r.validationErrorTitle),1),a("p",aI,p(r.validationErrorMessage),1),a("div",lI,[a("button",{class:"btn orange",onClick:e[8]||(e[8]=l=>r.showValidationErrorModal=!1)},"确认")])])])])])):B("",!0)])}const uI=It(TC,[["render",cI],["__scopeId","data-v-e8aaa622"]]),dI={name:"ProfileView",components:{WhitelistApplication:uI},emits:["navigate","notify"],data(){return{kycStatus:Wn(),form:{twoFA:"off",email:"",walletAction:""},emailCode:"",emailCodeSent:!1,emailVerified:!1,generatedCode:"",_offVis:null,_offStorage:null,_offAfterEach:null,showEmailModal:!1,userInfo:Ct(),whitelistStatus:"none",kycLevel:Ls(),apiUserData:null,userLoading:!1,userError:null}},computed:{isVerified(){return this.kycStatus===Jt.VERIFIED},isPending(){return this.kycStatus===Jt.PENDING},userName(){return this.apiUserData?.name?this.apiUserData.name:_a()},userInitial(){return this.apiUserData?.name?this.apiUserData.name.charAt(0).toUpperCase():p2()},userEmail(){if(this.apiUserData?.email)return this.apiUserData.email;const t=cg();if(t)return t;const e=localStorage.getItem("remember_email");return e||""},userPhone(){if(this.apiUserData?.phone)return this.apiUserData.phone;const t=Ct();return t.phone?t.phone:""},emailVerificationText(){return this.emailVerified?"Verified":this.emailCodeSent?"Verification Sent":"Not Verified"},emailVerificationIcon(){return this.emailVerified?"✅":this.emailCodeSent?"📧":"❌"},emailVerificationClass(){return this.emailVerified?"email-verified":this.emailCodeSent?"email-pending":"email-unverified"},kycLevelText(){switch(this.kycLevel){case Se.LEVEL_0:return"Level 0 (Unverified)";case Se.LEVEL_1:return"Level 1 (Basic)";case Se.LEVEL_2:return"Level 2 (Advanced)";case Se.LEVEL_3:return"Level 3 (Premium)";default:return"Unknown"}},kycLevelClass(){switch(this.kycLevel){case Se.LEVEL_0:return"level-0";case Se.LEVEL_1:return"level-1";case Se.LEVEL_2:return"level-2";case Se.LEVEL_3:return"level-3";default:return"level-unknown"}},whitelistStatusText(){switch(this.whitelistStatus){case"approved":return"Approved";case"pending":return"Pending Review";case"rejected":return"Not Qualified for Transaction";case"none":return"Not Applied";default:return"Unknown"}},whitelistStatusClass(){switch(this.whitelistStatus){case"approved":return"status-approved";case"pending":return"status-pending";case"rejected":return"status-rejected";case"none":return"status-none";default:return"status-unknown"}},tradingPermissionText(){return this.kycLevel>=Se.LEVEL_2&&this.whitelistStatus==="approved"?"Full Access":this.kycLevel>=Se.LEVEL_2?"Limited Access":"No Access"},tradingPermissionClass(){return this.kycLevel>=Se.LEVEL_2&&this.whitelistStatus==="approved"?"permission-full":this.kycLevel>=Se.LEVEL_2?"permission-limited":"permission-none"},tradingPermissionDescription(){return this.kycLevel>=Se.LEVEL_2&&this.whitelistStatus==="approved"?"Complete trading access to all RWA products and features":this.kycLevel>=Se.LEVEL_2?"Limited trading access - whitelist approval required for full access":"Trading access requires KYC verification and whitelist approval"},tradingPermissionRequirements(){const t=[];return this.kycLevel<Se.LEVEL_2&&t.push("Complete KYC verification (Level 2+)"),this.whitelistStatus!=="approved"&&(this.whitelistStatus==="none"?t.push("Apply for whitelist approval"):this.whitelistStatus==="pending"?t.push("Wait for whitelist approval"):this.whitelistStatus==="rejected"&&t.push("Reapply for whitelist approval")),this.kycLevel>=Se.LEVEL_2&&this.whitelistStatus==="approved"&&t.push("All requirements met"),t}},watch:{kycStatus:{handler(t,e){console.log("🔄 KYC状态变化:",e,"->",t),t===Jt.VERIFIED&&e!==Jt.VERIFIED&&(console.log("✅ KYC验证成功，自动更新Account Status"),this.kycLevel=Ls(),this.kycLevel<Se.LEVEL_2&&(Yn(Se.LEVEL_2),this.kycLevel=Se.LEVEL_2,console.log("🔧 自动设置KYC等级为Level 2")),this.loadStatusInfo())},immediate:!1},kycLevel:{handler(t,e){console.log("🔄 KYC等级变化:",e,"->",t),t>=Se.LEVEL_2&&this.isVerified&&(console.log("✅ KYC等级达到Level 2，自动更新白名单状态"),this.loadStatusInfo())},immediate:!1}},async mounted(){const t=()=>{this.kycStatus=Wn(),this.kycLevel=Ls(),this.loadStatusInfo()},e=()=>{this.userInfo=Ct()},s=()=>{this.loadStatusInfo()};t(),e(),s(),this.initializeUserDisplay(),await this.loadUserFromAPI();const n=()=>{console.log("🔄 ProfileView: 检测到登录状态变化，重新加载用户信息"),this.loadUserFromAPI()};window.addEventListener("auth-changed",n),this._offAuthChange=()=>window.removeEventListener("auth-changed",n);const r=()=>document.visibilityState==="visible"&&(t(),e(),s());document.addEventListener("visibilitychange",r),this._offVis=()=>document.removeEventListener("visibilitychange",r);const i=c=>{c.key==="kycStatus"&&t(),c.key==="kycLevel"&&t(),c.key==="userInfo"&&e(),c.key==="whitelistStatus"&&s()};window.addEventListener("storage",i),this._offStorage=()=>window.removeEventListener("storage",i),this._offAfterEach=this.$router.afterEach(c=>{c.path==="/profile"&&(t(),e(),s())});const o=()=>{e(),this.$forceUpdate()};window.addEventListener(Pf,o),this._offUserInfo=()=>window.removeEventListener(Pf,o);const l=()=>{console.log("🎉 收到KYC验证成功事件，更新Account Status"),t()};window.addEventListener("kyc-verification-success",l),this._offKycSuccess=()=>window.removeEventListener("kyc-verification-success",l)},activated(){this.kycStatus=Wn()},beforeUnmount(){this._offVis&&this._offVis(),this._offStorage&&this._offStorage(),this._offAfterEach&&this._offAfterEach(),this._offUserInfo&&this._offUserInfo(),this._offKycSuccess&&this._offKycSuccess(),this._offAuthChange&&this._offAuthChange()},methods:{initializeUserDisplay(){console.log("🚀 ProfileView: 初始化用户信息显示");const t=Ct(),e=localStorage.getItem("remember_email");(t.name||t.email||e)&&(this.apiUserData={name:t.name||(e?e.split("@")[0]:""),email:t.email||e||"",phone:t.phone||"",firstName:t.firstName||"",lastName:t.lastName||""},console.log("✅ ProfileView: 立即显示本地用户信息:",this.apiUserData))},async loadUserFromAPI(){try{this.userLoading=!0,this.userError=null,console.log("🔄 ProfileView: 开始获取用户信息...");const t=localStorage.getItem("isLoggedIn"),e=localStorage.getItem("token"),s=localStorage.getItem("remember_email");if(console.log("📊 ProfileView: 登录状态检查:",{isLoggedIn:t,hasToken:!!e,rememberEmail:s}),!t||!e){console.log("⚠️ ProfileView: 用户未登录，使用本地存储信息");const l=Ct();if(l.name||l.email){this.apiUserData={name:l.name,email:l.email,phone:l.phone,firstName:l.firstName,lastName:l.lastName},console.log("✅ ProfileView: 使用本地存储用户信息:",this.apiUserData);return}if(s){this.apiUserData={email:s,name:s.split("@")[0]},console.log("✅ ProfileView: 使用记住的邮箱信息:",this.apiUserData);return}this.userError="用户未登录，请先登录";return}const n={"Content-Type":"application/json",Authorization:`Bearer ${e}`};console.log("🔑 ProfileView: 使用token进行API请求");const r=["http://localhost:3000/user/login","http://localhost:3000/user/userinfo","http://localhost:3000/api/user","http://localhost:3000/user"];let i=null,o=null;for(const l of r)try{console.log(`🔍 ProfileView: 尝试API端点: ${l}`);const c=await fetch(l,{method:"GET",headers:n});if(console.log(`📡 ProfileView: ${l} 响应状态:`,c.status),c.ok){const u=await c.json();if(console.log(`✅ ProfileView: ${l} 返回数据:`,u),u.status===0&&u.data?i=u.data:(u.user_email||u.name||u.email)&&(i=u),i){console.log(`✅ ProfileView: 从 ${l} 成功获取用户数据`);break}}else c.status===401?(console.warn(`⚠️ ProfileView: ${l} 认证失败`),o="认证失败，token可能已过期"):(console.warn(`⚠️ ProfileView: ${l} 返回错误:`,c.status),o=`API请求失败: ${c.status} ${c.statusText}`)}catch(c){console.warn(`❌ ProfileView: ${l} 请求失败:`,c.message),o=c.message}if(i){console.log("✅ ProfileView: 成功获取用户数据:",i),this.apiUserData=i;const l={email:i.user_email||i.email||i.userEmail,name:i.user_name||i.name||i.userName,phone:i.user_phone||i.phone||i.userPhone,firstName:i.firstName||i.first_name,lastName:i.lastName||i.last_name,id:i.user_id||i.id||i.userId},c=Object.fromEntries(Object.entries(l).filter(([u,d])=>d));if(Object.keys(c).length>0){const u={...Ct(),...c};wr(u),this.userInfo=u,console.log("✅ ProfileView: 本地用户信息已更新:",u)}}else{console.warn("⚠️ ProfileView: 所有API端点都失败，使用本地存储信息");const l=Ct();l.name||l.email?(this.apiUserData={name:l.name,email:l.email,phone:l.phone},console.log("✅ ProfileView: 使用本地存储作为fallback:",this.apiUserData)):this.userError=o||"无法获取用户信息"}}catch(t){if(console.error("❌ ProfileView: 获取用户信息失败:",t),t.name==="TypeError"&&t.message.includes("fetch")){this.userError="网络连接失败，使用本地存储信息";const e=Ct();(e.name||e.email)&&(this.apiUserData={name:e.name,email:e.email,phone:e.phone},console.log("✅ ProfileView: 网络失败，使用本地存储:",this.apiUserData))}else this.userError=`获取用户信息失败: ${t.message}`}finally{this.userLoading=!1,console.log("🏁 ProfileView: 用户信息加载完成")}},isRequirementMet(t){return t.includes("KYC verification")?this.kycLevel>=Se.LEVEL_2:t.includes("whitelist approval")?this.whitelistStatus==="approved":t.includes("All requirements met")?this.kycLevel>=Se.LEVEL_2&&this.whitelistStatus==="approved":!1},async loadStatusInfo(){try{if(console.log("🔄 开始加载状态信息..."),this.kycLevel=Ls(),console.log("📊 当前KYC等级:",this.kycLevel),console.log("📊 当前KYC状态:",this.kycStatus),this.isVerified){if(console.log("✅ 用户已通过KYC验证"),this.kycLevel>=Se.LEVEL_2){this.whitelistStatus="approved",localStorage.setItem("whitelistStatus","approved"),console.log("✅ KYC Level 2用户，白名单状态自动设置为approved"),console.log("📊 更新后的状态 - KYC Level:",this.kycLevel,"Whitelist:",this.whitelistStatus);return}const t=localStorage.getItem("whitelistStatus");t&&(this.whitelistStatus=t,console.log("📊 从本地存储加载白名单状态:",t))}else this.whitelistStatus="none",console.log("❌ 用户未通过KYC验证，设置默认状态");console.log("📊 最终状态 - KYC Level:",this.kycLevel,"Whitelist:",this.whitelistStatus)}catch(t){console.error("Failed to load status info:",t)}},isValidEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)},async sendEmailVerification(){const t=this.userEmail;if(!t||!this.isValidEmail(t)){this.$emit("notify","Please provide a valid email address");return}try{console.log("📧 发送邮箱验证到:",t);const e=await fetch("http://localhost:3000/api/email/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_email:t})});e.ok?(this.emailCodeSent=!0,this.$emit("notify","Verification email sent successfully"),console.log("✅ 邮箱验证邮件发送成功")):(this.$emit("notify","Failed to send verification email"),console.error("❌ 邮箱验证邮件发送失败:",e.status))}catch(e){console.error("❌ 发送邮箱验证失败:",e),this.$emit("notify","Network error, please try again")}},async sendEmailCode(){if(!this.isValidEmail(this.form.email)){this.$emit("notify","Please enter a valid email.");return}try{const e=await(await fetch(void 0,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_email:this.form.email})})).json();e.status===0?(this.emailCodeSent=!0,this.generatedCode=e.code,this.showEmailModal=!0,this.$emit("notify",e.message||"验证码已发送到您的邮箱")):this.$emit("notify",e.message||"Failed to send email.")}catch{this.$emit("notify","Network error, please try again.")}},async verifyEmailCode(){try{const e=await(await fetch(void 0,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_email:this.form.email,verification_code:this.form.emailCode})})).json();e.status===0?(this.emailVerified=!0,this.emailCodeSent=!1,this.form.emailCode="",this.$emit("notify",e.message||"Email verified and bound to account.")):this.$emit("notify",e.message||"Incorrect verification code.")}catch{this.$emit("notify","Network error, please try again.")}},verifyKYC(){this.$router.push("/kycService")},cancelKYC(){confirm("Are you sure you want to cancel KYC verification?")&&(Ta(Jt.UNVERIFIED),this.kycStatus=Jt.UNVERIFIED,Yn(Se.LEVEL_0),this.$emit("notify","KYC verification has been cancelled."))},onCancel(){this.$emit("navigate","home")},onSave(){if(!this.isVerified)return this.$emit("notify","Please complete KYC first.");if(this.form.email&&!this.isValidEmail(this.form.email))return this.$emit("notify","Please enter a valid email.");if(this.form.email&&!this.emailVerified)return this.$emit("notify","Please verify your email before saving.");this.$emit("notify","Profile saved (demo)")},logout(){localStorage.removeItem("token"),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("remember_email"),window.dispatchEvent(new CustomEvent("auth-changed")),this.$emit("notify","You have logged out."),this.$router.push("/login")},handleWhitelistSuccess(t){console.log("✅ Whitelist application successful:",t),this.$emit("notify",t),this.whitelistStatus="pending",localStorage.setItem("whitelistStatus","pending"),this.loadStatusInfo(),console.log("🔄 Trading Permission updated after whitelist application")},handleWhitelistError(t){console.log("❌ Whitelist application error:",t),this.$emit("notify",t)},handleWhitelistInfo(t){console.log("ℹ️ Whitelist application info:",t),this.$emit("notify",t),this.loadStatusInfo(),console.log("🔄 Trading Permission updated after whitelist info update")}}},fI={class:"profile-page"},hI={class:"topbar container"},pI={class:"breadcrumb","aria-label":"Breadcrumb"},mI={class:"container head"},gI={class:"avatar"},yI={class:"avatar-initial"},vI={class:"title"},bI={class:"user-contact-info"},wI={class:"contact-item"},AI={class:"contact-value"},EI={class:"contact-item"},_I={class:"contact-value"},TI={key:0,class:"contact-item loading-item"},PI={key:1,class:"contact-item error-item"},kI={class:"contact-value"},SI={key:0,class:"modal-mask"},CI={class:"modal-wrapper"},II={class:"modal-container"},RI={style:{"margin-top":"18px","text-align":"right"}},DI={class:"status-section"},xI={class:"field"},NI={key:0},LI={key:1,class:"verified"},OI={class:"field"},UI={class:"permission-text"},BI={class:"requirement-icon"},MI={class:"actions bottom"};function FI(t,e,s,n,r,i){const o=Bi("WhitelistApplication");return m(),g("section",fI,[a("header",hI,[a("nav",pI,[a("button",{class:"crumb-back",onClick:e[0]||(e[0]=l=>t.$emit("navigate","home")),"aria-label":"Back to Home"},[...e[10]||(e[10]=[a("svg",{viewBox:"0 0 24 24",class:"i"},[a("path",{d:"M10 19a1 1 0 0 1-.7-.3l-7-7a1 1 0 0 1 0-1.4l7-7a1 1 0 1 1 1.4 1.4L4.41 11H21a1 1 0 1 1 0 2H4.41l6.3 6.3A1 1 0 0 1 10 19z"})],-1)])]),e[11]||(e[11]=a("span",{class:"sep"},"/",-1)),e[12]||(e[12]=a("span",{class:"crumb-current"},"Profile",-1))])]),a("div",mI,[a("div",gI,[a("span",yI,p(i.userInitial),1)]),a("div",null,[a("h1",vI,p(i.userName),1)])]),a("form",{class:"container form",onSubmit:e[9]||(e[9]=ue((...l)=>i.onSave&&i.onSave(...l),["prevent"]))},[a("div",bI,[a("div",null,[e[19]||(e[19]=a("label",{class:"label"},[ne("Personal Information "),a("span",{class:"req"})],-1)),a("div",wI,[e[13]||(e[13]=a("span",{class:"contact-label"},"Email:",-1)),a("span",AI,p(i.userEmail||"Not provided"),1),a("span",{class:be(["email-status",i.emailVerificationClass])},"   "+p(i.emailVerificationText),3),r.emailVerified?B("",!0):(m(),g("button",{key:0,class:"btn-small",type:"button",onClick:e[1]||(e[1]=(...l)=>i.sendEmailVerification&&i.sendEmailVerification(...l))}," Verify Email "))]),a("div",EI,[e[14]||(e[14]=a("span",{class:"contact-label"},"Phone:",-1)),a("span",_I,p(i.userPhone||"Not provided"),1),e[15]||(e[15]=a("button",{class:"btn-small",type:"button"},"Change my phone number",-1))]),e[20]||(e[20]=a("div",{class:"contact-item"},[a("span",{class:"contact-label"},"Password:"),a("button",{class:"btn-small",type:"button"},"Change my password")],-1)),r.userLoading?(m(),g("div",TI,[...e[16]||(e[16]=[a("span",{class:"contact-icon"},"🔄",-1),a("span",{class:"contact-label"},"Status:",-1),a("span",{class:"contact-value"},"Loading user information...",-1)])])):B("",!0),r.userError&&!r.userLoading?(m(),g("div",PI,[e[17]||(e[17]=a("span",{class:"contact-icon"},"⚠️",-1)),e[18]||(e[18]=a("span",{class:"contact-label"},"Status:",-1)),a("span",kI,p(r.userError),1)])):B("",!0)]),r.showEmailModal?(m(),g("div",SI,[a("div",CI,[a("div",II,[e[21]||(e[21]=Nt('<h2 style="margin-bottom:8px;" data-v-44895082>Check Your Email</h2><p data-v-44895082>Verify your email address to use your account.<br data-v-44895082> We sent an email with a button to verify your email address.<br data-v-44895082> Did you receive the email? If not, check your spam folder or request a new verification email for up to 3 days.<br data-v-44895082> If you do not verify your email address within 3 days, you will need to create a new account.<br data-v-44895082> If you are having trouble, see Account Help.</p><div style="margin-top:12px;display:flex;flex-wrap:wrap;gap:10px;" data-v-44895082><a href="#" style="color:#ea7a2e;text-decoration:underline;" data-v-44895082>Account Help</a><a href="#" style="color:#ea7a2e;text-decoration:underline;" data-v-44895082>Subscriptions</a><a href="#" style="color:#ea7a2e;text-decoration:underline;" data-v-44895082>Unsubscribe</a><a href="#" style="color:#ea7a2e;text-decoration:underline;" data-v-44895082>Privacy / Do Not Sell My Info</a><a href="#" style="color:#ea7a2e;text-decoration:underline;" data-v-44895082>Cookie Preferences</a></div>',3)),a("div",RI,[a("button",{class:"btn orange",onClick:e[2]||(e[2]=l=>r.showEmailModal=!1)},"OK")])])])])):B("",!0)]),a("div",DI,[e[27]||(e[27]=a("h3",{class:"status-title"},"Account Status",-1)),a("div",xI,[e[24]||(e[24]=a("label",{class:"label"},[ne("KYC verification "),a("span",{class:"req"},"*")],-1)),a("div",{class:be(["kyc-banner",i.isVerified?"green":"orange"]),role:"status"},[e[23]||(e[23]=a("span",{class:"icon"},[a("svg",{viewBox:"0 0 24 24",class:"i"},[a("path",{d:"M12 2 2 7l10 5 10-5-10-5Zm0 7L2 4v13l10 5 10-5V4L12 9Zm0 9.5-7-3.5V9l7 3.5V20.5Z"})])],-1)),i.isVerified?(m(),g("span",LI,[e[22]||(e[22]=a("svg",{viewBox:"0 0 24 24",class:"i"},[a("path",{d:"M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"})],-1)),ne(" "+p(i.kycLevelText),1)])):(m(),g("span",NI,"Verify now")),i.isVerified?(m(),g("button",{key:3,class:"link danger",type:"button",onClick:e[4]||(e[4]=(...l)=>i.cancelKYC&&i.cancelKYC(...l))},"Cancel verification")):(m(),g("button",{key:2,class:"link",type:"button",onClick:e[3]||(e[3]=(...l)=>i.verifyKYC&&i.verifyKYC(...l))},"Start"))],2)]),i.isVerified?(m(),ia(o,{key:0,"is-kyc-verified":i.isVerified,"user-info":r.userInfo,onSuccess:i.handleWhitelistSuccess,onError:i.handleWhitelistError,onInfo:i.handleWhitelistInfo},null,8,["is-kyc-verified","user-info","onSuccess","onError","onInfo"])):B("",!0),a("div",OI,[e[26]||(e[26]=a("label",{class:"label"},[ne("Trading Permission "),a("span",{class:"req"})],-1)),a("div",{class:be(["kyc-banner",i.isVerified?"green":"orange"]),role:"status"},[e[25]||(e[25]=a("span",{class:"icon"},[a("svg",{viewBox:"0 0 24 24",class:"i"},[a("path",{d:"M16 17.01V10h-2v7.01h-3L15 21l4-3.99h-3zM9 3L5 6.99h3V14h2V6.99h3L9 3z"})])],-1)),a("span",UI,[(m(!0),g(me,null,dt(i.tradingPermissionRequirements,l=>(m(),g("li",{key:l,class:be({"requirement-met":i.isRequirementMet(l)})},[a("span",BI,p((i.isRequirementMet(l),"")),1),ne(" "+p(l),1)],2))),128))]),a("span",{class:be(["permission-badge",i.tradingPermissionClass])},p(i.tradingPermissionText),3),i.isVerified?(m(),g("button",{key:1,class:"link danger",type:"button",onClick:e[6]||(e[6]=(...l)=>i.cancelKYC&&i.cancelKYC(...l))},"Cancel verification")):(m(),g("button",{key:0,class:"link",type:"button",onClick:e[5]||(e[5]=(...l)=>i.verifyKYC&&i.verifyKYC(...l))},"Start"))],2)])]),a("div",MI,[a("button",{class:"btn light",type:"button",onClick:e[7]||(e[7]=(...l)=>i.onCancel&&i.onCancel(...l))},"Cancel"),e[28]||(e[28]=a("button",{class:"btn orange",type:"submit"},"Save",-1)),a("button",{class:"btn light",type:"button",onClick:e[8]||(e[8]=(...l)=>i.logout&&i.logout(...l)),style:{"margin-left":"auto"}},"Log out")])],32)])}const Lg=It(dI,[["render",FI],["__scopeId","data-v-44895082"]]),VI={key:0,class:"modal-mask"},$I={class:"modal-wrapper"},jI={class:"modal-container"},HI={style:{margin:"16px 0"}},WI={style:{display:"block","font-size":"15px",padding:"8px 0",color:"#ffffff",background:"#2a2a4a","border-radius":"8px"}},YI={style:{"text-align":"right"}},GI={key:1,class:"modal-mask"},KI={class:"modal-wrapper"},zI={class:"modal-container"},QI={style:{color:"#ffffff"}},JI={style:{"text-align":"right"}},qI={class:"mm-page"},ZI={class:"mm-account-section"},XI={class:"mm-topbar"},eR={class:"mm-account"},tR={class:"mm-account-meta"},sR={class:"mm-account-title",style:{display:"flex","align-items":"center",gap:"12px"}},nR={key:0,class:"mm-status"},rR={class:"mm-account-line"},iR=["title"],oR={key:1,class:"mm-addr",style:{color:"#b45309"}},aR={key:0,class:"mm-dashboard-section"},lR={class:"mm-hero"},cR={class:"mm-card"},uR={class:"mm-card-title"},dR={class:"mm-card-sub"},fR={class:"mm-balance"},hR={class:"mm-subline"},pR={class:"mm-custom"},mR=["disabled"],gR={key:0,class:"mm-warning"},yR={class:"mm-warning-text"},vR={class:"mm-tabs"},bR={key:0,class:"mm-tokenlist",style:{background:"#1d1d36"}},wR={class:"mm-token"},AR={class:"mm-token-left"},ER={class:"mm-token-title"},_R={class:"mm-token-right"},TR={class:"mm-token-sub"},PR={class:"mm-token-amount"},kR=["onClick"],SR={class:"mm-token-left"},CR={class:"mm-token-icon"},IR={class:"mm-token-sub"},RR={class:"mm-token-right"},DR={class:"mm-token-sub"},xR={key:1,class:"mm-activity-section"},NR={class:"mm-activity-header"},LR={class:"mm-activity-actions"},OR=["disabled"],UR={key:0},BR={key:1},MR={key:0,class:"mm-activity-filters"},FR={class:"mm-filter-row"},VR={class:"mm-filter-group"},$R={class:"mm-filter-group"},jR=["value"],HR={key:1,class:"mm-loading"},WR={key:2,class:"mm-no-activity"},YR={key:3,class:"mm-activity-list"},GR={key:0,class:"mm-filter-results"},KR={class:"mm-results-count"},zR={class:"mm-activity-columns"},QR={class:"mm-activity-left"},JR={class:"mm-activity-header-item"},qR={class:"mm-activity-icon"},ZR={class:"mm-activity-title"},XR={class:"mm-activity-time"},eD={class:"mm-activity-details"},tD={key:0,class:"mm-activity-project"},sD={class:"mm-activity-value"},nD={key:1,class:"mm-activity-project-name"},rD={class:"mm-activity-value"},iD={key:2,class:"mm-activity-amount"},oD={class:"mm-activity-value"},aD={key:3,class:"mm-activity-trade-type"},lD={key:4,class:"mm-activity-timestamp"},cD={class:"mm-activity-value"},uD={key:5,class:"mm-activity-wallet"},dD={class:"mm-activity-value"},fD={key:6,class:"mm-activity-network"},hD={class:"mm-activity-value"},pD={key:7,class:"mm-activity-network-id"},mD={class:"mm-activity-value"},gD={key:8,class:"mm-activity-metamask"},yD={key:9,class:"mm-activity-chain"},vD={class:"mm-activity-value"},bD={key:10,class:"mm-activity-error"},wD={class:"mm-activity-value"},AD={key:11,class:"mm-activity-transaction"},ED={class:"mm-activity-transaction-hash"},_D={class:"mm-activity-value"},TD={class:"mm-activity-transaction-status"},PD={class:"mm-activity-transaction-from"},kD={class:"mm-activity-value"},SD={class:"mm-activity-transaction-to"},CD={class:"mm-activity-value"},ID={class:"mm-activity-transaction-nonce"},RD={class:"mm-activity-value"},DD={class:"mm-activity-transaction-token-amount"},xD={class:"mm-activity-value"},ND={class:"mm-activity-transaction-value"},LD={class:"mm-activity-value"},OD={class:"mm-activity-transaction-block"},UD={class:"mm-activity-value"},BD={class:"mm-activity-transaction-fee"},MD={class:"mm-activity-value"},FD={class:"mm-activity-transaction-gas"},VD={class:"mm-activity-value"},$D={key:12,class:"mm-activity-status"},jD={key:13,class:"mm-activity-wallet"},HD={class:"mm-activity-value"},WD={key:14,class:"mm-activity-message"},YD={class:"mm-activity-value"},GD={key:15,class:"mm-activity-message-text"},KD={class:"mm-activity-value"},zD={key:16,class:"mm-activity-etherscan"},QD={class:"mm-activity-etherscan-info"},JD={class:"mm-activity-value"},qD={class:"mm-activity-etherscan-info"},ZD={class:"mm-activity-etherscan-info"},XD={class:"mm-activity-value"},ex={class:"mm-activity-etherscan-info"},tx={class:"mm-activity-value"},sx={class:"mm-activity-etherscan-info"},nx={class:"mm-activity-value"},rx={class:"mm-activity-etherscan-info"},ix={class:"mm-activity-value"},ox={class:"mm-activity-etherscan-info"},ax={class:"mm-activity-value"},lx={class:"mm-activity-etherscan-info"},cx={class:"mm-activity-value"},ux={class:"mm-activity-etherscan-info"},dx={class:"mm-activity-value"},fx={class:"mm-activity-etherscan-info"},hx={class:"mm-activity-value"},px={key:0,class:"mm-activity-footer"},mx=["href"],gx={key:0,class:"mm-transaction-pagination"},yx={class:"mm-pagination-info"},vx={class:"mm-pagination-text"},bx={class:"mm-pagination-count"},wx={class:"mm-pagination-controls"},Ax=["disabled"],Ex={class:"mm-pagination-pages"},_x=["onClick"],Tx=["disabled"],Px={key:2,class:"mm-warn"},kx={key:3,class:"mm-error"},Sx={key:0,class:"mm-toast"},Vl=3,$l=5,Cx={__name:"WalletView",setup(t){fe(!1);const e=fe(!1),s=fe(!1);fe("");const n=fe(""),r=fe(""),{connected:i,address:o,fullAddress:l,chainId:c,networkLabel:u,nativeSymbol:d,nativeBalanceDisplay:f,nativeToAudDisplay:h,tokens:y,warning:T,error:w,activeTab:k,disconnect:C,refreshTokens:N,copyAddress:L,addCustomToken:D,audPrice:Y,priceChange24h:W}=zt(),$=fe([l.value]),Q=fe(l.value);fe("");const J=fe([]),re=fe(!1),ce=fe(!1),H=fe({type:"",projectCode:"",startDate:"",endDate:""}),we=fe(1),Ce=fe(1);fe("SepoliaETH"),fe([{value:"SepoliaETH",label:"SepoliaETH",chainId:11155111},{value:"Ethereum",label:"Ethereum",chainId:1}]);const K=Ae(()=>{let R=J.value;if(H.value.type&&(R=R.filter(S=>S.type===H.value.type)),H.value.projectCode&&(R=R.filter(S=>S.project_code===H.value.projectCode)),H.value.startDate){const S=new Date(H.value.startDate);R=R.filter(x=>new Date(x.timestamp)>=S)}if(H.value.endDate){const S=new Date(H.value.endDate);S.setHours(23,59,59,999),R=R.filter(x=>new Date(x.timestamp)<=S)}return R}),ee=Ae(()=>{const R=new Set;return J.value.forEach(S=>{S.project_code&&R.add(S.project_code)}),Array.from(R).sort()}),ae=Ae(()=>H.value.type!==""||H.value.projectCode!==""||H.value.startDate!==""||H.value.endDate!==""),ge=Ae(()=>K.value.filter(R=>R.type==="buy"||R.type==="sell"||R.type==="wallet_disconnect"||R.type==="metamask_connect"||R.type==="metamask_disconnect"||R.type==="metamask_message"||R.type==="metamask_transaction")),Re=Ae(()=>K.value.filter(R=>R.type==="wallet_connect"||R.type==="wallet_status_check"||R.type==="wallet_focus_check"||R.type==="network_change"));Ae(()=>{const R=(we.value-1)*Vl,S=R+Vl;return Re.value.slice(R,S)});const Ye=Ae(()=>Math.ceil(Re.value.length/Vl));Ae(()=>{const R=Ye.value,S=we.value;if(R<=5)return Array.from({length:R},(xe,ut)=>ut+1);const x=[];if(x.push(1),S<=3)for(let xe=2;xe<=Math.min(3,R-1);xe++)x.push(xe);else if(S>=R-2)for(let xe=Math.max(2,R-2);xe<=R-1;xe++)x.push(xe);else x.push(S-1),x.push(S),x.push(S+1);return R>1&&x.push(R),[...new Set(x)].sort((xe,ut)=>xe-ut)});const je=Ae(()=>Math.ceil(ge.value.length/$l)),He=Ae(()=>{const R=(Ce.value-1)*$l,S=R+$l;return ge.value.slice(R,S)});en(l,R=>{R&&!$.value.includes(R)&&($.value.push(R),Q.value=R)});function St(){if(n.value){const R=$.value.indexOf(n.value);R!==-1&&($.value.splice(R,1),Q.value===n.value&&(Q.value="",o.value="",T.value=""),e.value=!1,r.value=`Wallet ${n.value} disconnected.`,s.value=!0)}}let Xe=null,Et=!1,st=null;const O=fe(!1);function te(){try{L()}finally{O.value=!0,setTimeout(()=>{O.value=!1},3e3)}}async function Z(){i.value&&(await le(),await De(),await N())}async function le(){const R=await Xe.getNetwork();c.value=Number(R.chainId),u.value=R.name&&R.name!=="unknown"?V(R.name):`Chain ${c.value}`,d.value=c.value===1?"ETH":c.value===137?"MATIC":(c.value===42161||c.value===10,"ETH"),M()}async function De(){nativeBalance.value=await Xe.getBalance(o.value)}function v(){window.ethereum&&(window.ethereum.on("accountsChanged",I),window.ethereum.on("chainChanged",U),Xe&&!Et&&(st=async()=>{try{await De()}catch{}},Xe.on("block",st),Et=!0))}function _(){window.ethereum&&(window.ethereum.removeListener("accountsChanged",I),window.ethereum.removeListener("chainChanged",U)),Xe&&Et&&st&&(Xe.removeListener("block",st),Et=!1,st=null)}async function I(R){!R||R.length===0?C():(o.value=R[0],Q.value=R[0],Z(),k.value="tokens")}async function U(){await Z()}function V(R){return R&&R[0].toUpperCase()+R.slice(1)}async function M(){try{const R=d.value==="MATIC"?"matic-network":"ethereum",x=await(await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${R}&vs_currencies=aud`)).json();Y.value=x?.[R]?.aud||null}catch{Y.value=null}}mi(async()=>{if(!window.ethereum){T.value="MetaMask not detected.";return}Xe=new cs(window.ethereum,"any");const R=await Xe.send("eth_accounts",[]);R&&R.length>0&&(await Xe.getSigner(),o.value=R[0],i.value=!0,await Z(),v()),await ps(),window.addEventListener("walletActivityUpdated",Ut),ms(),Nr(),vi()}),Na(()=>{_(),window.removeEventListener("walletActivityUpdated",Ut)});const se=fe(""),X=fe("");async function z(){await D(se.value.trim(),X.value.trim())&&(se.value="",X.value="",await N())}fe(!1);const G=fe("desc");function ye(R){if(R==null)return 0;if(typeof R=="number")return R;const S=parseFloat(String(R).replace(/,/g,""));return isNaN(S)?0:S}const ie=Ae(()=>{const R=Array.from(y),S=(xe,ut)=>ye(ut.displayBalance)-ye(xe.displayBalance),x=(xe,ut)=>ye(xe.displayBalance)-ye(ut.displayBalance);return R.sort(G.value==="desc"?S:x)});fe("");const ve=Ae(()=>{if(W.value===null||W.value===void 0)return"+0.00%";const R=W.value;return`${R>=0?"+":""}${R.toFixed(2)}%`}),Te=Ae(()=>W.value===null||W.value===void 0||W.value>=0?"mm-rise":"mm-fall");function Ue(R){return new Date(R).toLocaleString()}function Ge(R){return new Date(R).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}function Be(R){return R?`${R.slice(0,6)}...${R.slice(-4)}`:""}function Rt(R){return R?(parseInt(R,16)/Math.pow(10,18)).toFixed(6):"0"}function Ot(R){return{buy:"📈",sell:"📉",wallet_connect:"🔗",wallet_disconnect:"❌",network_change:"🌐",metamask_connect:"🦊",metamask_disconnect:"🦊❌",wallet_status_check:"👁️",wallet_focus_check:"🎯",metamask_message:"💬",metamask_transaction:"💰"}[R]||"📋"}function hs(R){return{buy:"BUY TOKEN",sell:"SELL TOKEN",wallet_connect:"WALLET CONNECTED",wallet_disconnect:"WALLET DISCONNECTED",network_change:"NETWORK CHANGED",metamask_connect:"METAMASK CONNECTED",metamask_disconnect:"METAMASK DISCONNECTED",wallet_status_check:"STATUS CHECKED",wallet_focus_check:"FOCUS CHECKED",metamask_message:"METAMASK MESSAGE",metamask_transaction:"METAMASK TRANSACTION"}[R]||R.toUpperCase()}async function es(R){try{console.log("🔍 正在从Etherscan获取交易详情:",R);const S=`https://api-sepolia.etherscan.io/api?module=proxy&action=eth_getTransactionByHash&txhash=${R}`,xe=await(await fetch(S)).json();if(xe.result){console.log("✅ 成功获取交易详情:",xe.result);const ut=`https://api-sepolia.etherscan.io/api?module=proxy&action=eth_getTransactionReceipt&txhash=${R}`,Qs=await(await fetch(ut)).json();return{success:!0,transaction:xe.result,receipt:Qs.result,hash:R,from:xe.result.from,to:xe.result.to,value:xe.result.value,nonce:xe.result.nonce,gasUsed:Qs.result?Qs.result.gasUsed:null,gasPrice:xe.result.gasPrice,blockNumber:xe.result.blockNumber,blockHash:xe.result.blockHash,status:Qs.result?Qs.result.status:null,transactionFee:Qs.result?parseInt(Qs.result.gasUsed,16)*parseInt(xe.result.gasPrice,16)/Math.pow(10,18):null,etherscanUrl:`https://sepolia.etherscan.io/tx/${R}`}}else return console.warn("⚠️ 交易详情获取失败:",xe.message),{success:!1,error:xe.message||"Failed to fetch transaction details"}}catch(S){return console.error("❌ 获取交易详情时发生错误:",S),{success:!1,error:S.message}}}async function ps(){try{re.value=!0,console.log("🔄 正在加载钱包活动记录...");const R=localStorage.getItem("walletActivity");if(R){const S=JSON.parse(R);console.log("📂 从localStorage加载活动记录:",S.length,"条");const x=[];for(const xe of S){if(xe.transactionHash&&xe.type!=="wallet_connect"&&xe.type!=="wallet_disconnect"){const ut=await es(xe.transactionHash);ut.success&&(xe.etherscan={hash:ut.hash,from:ut.from,to:ut.to,value:ut.value,nonce:ut.nonce,gasUsed:ut.gasUsed,gasPrice:ut.gasPrice,blockNumber:ut.blockNumber,blockHash:ut.blockHash,status:ut.status,transactionFee:ut.transactionFee,etherscanUrl:ut.etherscanUrl})}x.push(xe)}J.value=x}else{J.value=[{id:Date.now()-36e5,type:"buy",amount:100,project_code:"TYMU",project_name:"St Ives NSW Residential Project",timestamp:Date.now()-36e5,transactionHash:"0xabc123def45678901234567890123456789012345678901234567890123456789012"},{id:Date.now()-18e5,type:"sell",amount:50,project_code:"SQNB",project_name:"SQNB Property Loan",timestamp:Date.now()-18e5,transactionHash:"0xdef456abc12378901234567890123456789012345678901234567890123456789012"},{id:Date.now()-9e5,type:"wallet_connect",message:"Wallet connected to MetaMask",wallet_address:l.value,timestamp:Date.now()-9e5}];for(const S of J.value)if(S.transactionHash){const x=await es(S.transactionHash);x.success&&(S.etherscan={from:x.from,to:x.to,value:x.value,gasUsed:x.gasUsed,gasPrice:x.gasPrice,blockNumber:x.blockNumber,blockHash:x.blockHash,status:x.status,etherscanUrl:`https://sepolia.etherscan.io/tx/${S.transactionHash}`})}}console.log("✅ 钱包活动记录加载完成:",J.value.length,"条")}catch(R){console.error("❌ 加载钱包活动记录失败:",R),T.value="Failed to load wallet activity"}finally{re.value=!1}}async function er(){await ps()}function Ut(R){console.log("📨 收到WalletView活动更新通知:",R.detail),ps()}function ms(){console.log("🎧 设置MetaMask活动监听器..."),window.ethereum&&(window.ethereum.on("accountsChanged",R=>{console.log("📱 账户变化检测到:",R),R.length>0?As({type:"wallet_connect",message:"Wallet account connected",wallet_address:R[0],timestamp:Date.now()}):As({type:"wallet_disconnect",message:"Wallet account disconnected",wallet_address:l.value,timestamp:Date.now()})}),window.ethereum.on("chainChanged",R=>{console.log("🌐 网络变化检测到:",R);const S=xr(R);As({type:"network_change",message:`Network changed to ${S}`,network_id:R,network_name:S,timestamp:Date.now()})}),window.ethereum.on("connect",R=>{console.log("🔗 MetaMask连接检测到:",R),As({type:"metamask_connect",message:"MetaMask extension connected",chain_id:R.chainId,timestamp:Date.now()})}),window.ethereum.on("disconnect",R=>{console.log("❌ MetaMask断开连接:",R),As({type:"metamask_disconnect",message:"MetaMask extension disconnected",error:R.message||"Unknown error",timestamp:Date.now()})}),window.ethereum.on("message",R=>{console.log("💬 MetaMask消息:",R),As({type:"metamask_message",message:"MetaMask message received",message_type:R.type,data:R.data,timestamp:Date.now()})}))}function xr(R){return{"0x1":"Ethereum Mainnet","0x3":"Ropsten Testnet","0x4":"Rinkeby Testnet","0x5":"Goerli Testnet","0xaa36a7":"Sepolia Testnet","0x89":"Polygon Mainnet","0x13881":"Polygon Mumbai","0x38":"BSC Mainnet","0x61":"BSC Testnet"}[R]||`Unknown Network (${R})`}function As(R){try{console.log("📝 记录钱包活动:",R),J.value.unshift(R);const S=JSON.parse(localStorage.getItem("walletActivity")||"[]");S.unshift(R),S.length>100&&S.splice(100),localStorage.setItem("walletActivity",JSON.stringify(S)),console.log("✅ 钱包活动记录已保存")}catch(S){console.error("❌ 记录钱包活动失败:",S)}}function Nr(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&(console.log("👁️ 页面重新可见，刷新钱包状态和活动记录"),ps(),window.ethereum&&window.ethereum.request({method:"eth_accounts"}).then(R=>{R.length>0&&R[0]!==l.value&&As({type:"wallet_status_check",message:"Wallet status checked on page visibility",wallet_address:R[0],timestamp:Date.now()})}).catch(R=>{console.error("检查钱包状态失败:",R)}))})}function vi(){window.addEventListener("focus",()=>{console.log("🎯 窗口获得焦点，检查钱包状态和刷新活动记录"),ps(),window.ethereum&&window.ethereum.request({method:"eth_accounts"}).then(R=>{R.length>0&&As({type:"wallet_focus_check",message:"Wallet status checked on window focus",wallet_address:R[0],timestamp:Date.now()})}).catch(R=>{console.error("检查钱包状态失败:",R)})})}function tr(){ce.value=!ce.value}function Po(){H.value={type:"",projectCode:"",startDate:"",endDate:""}}async function sl(){k.value="activity",console.log("🔄 切换到Activity tab，刷新活动记录"),await ps()}function ko(R){R>=1&&R<=je.value&&(Ce.value=R,console.log(`📄 切换到交易活动第 ${R} 页`))}function So(){Ce.value<je.value&&(Ce.value++,console.log(`📄 交易活动下一页: ${Ce.value}`))}function Ms(){Ce.value>1&&(Ce.value--,console.log(`📄 交易活动上一页: ${Ce.value}`))}return(R,S)=>(m(),g(me,null,[e.value?(m(),g("div",VI,[a("div",$I,[a("div",jI,[S[9]||(S[9]=a("h2",{style:{"margin-bottom":"8px",color:"#ffffff"}},"Disconnect Wallet",-1)),S[10]||(S[10]=a("p",{style:{color:"#ffffff"}},"Select the wallet account you want to disconnect:",-1)),a("div",HI,[a("span",WI,p(Q.value),1)]),a("div",YI,[a("button",{class:"mm-btn mm-outline",onClick:S[0]||(S[0]=x=>e.value=!1)},"Cancel"),a("button",{class:"mm-btn mm-outline",style:{"margin-left":"8px"},onClick:St},"Confirm")])])])])):B("",!0),s.value?(m(),g("div",GI,[a("div",KI,[a("div",zI,[S[11]||(S[11]=a("h2",{style:{"margin-bottom":"8px",color:"#ffffff"}},"Wallet Disconnected",-1)),a("p",QI,p(r.value),1),a("div",JI,[a("button",{class:"mm-btn mm-outline",onClick:S[1]||(S[1]=x=>s.value=!1)},"Confirm")])])])])):B("",!0),a("div",qI,[a("section",ZI,[a("header",XI,[a("div",eR,[S[14]||(S[14]=a("div",{class:"mm-avatar"},null,-1)),a("div",tR,[a("div",sR,[S[13]||(S[13]=a("span",null,"Account",-1)),Ke(i)?(m(),g("div",nR,[...S[12]||(S[12]=[a("span",{class:"mm-dot"},null,-1),a("span",{class:"mm-status-text"},"Connected",-1)])])):B("",!0)]),a("div",rR,[Q.value?(m(),g(me,{key:0},[a("span",{class:"mm-addr",title:Q.value},p(Q.value),9,iR),Ke(i)?(m(),g("button",{key:0,class:"mm-btn mm-outline mm-copy",onClick:te},"Copy")):B("",!0)],64)):(m(),g("span",oR,"please connect your wallet in wallet management"))])])])])]),Ke(i)&&Q.value?(m(),g("section",aR,[a("div",lR,[a("div",cR,[S[15]||(S[15]=a("div",{class:"mm-card-label"},"Current Network",-1)),a("div",uR,p(Ke(u)),1),a("div",dR,"Chain ID: "+p(Ke(c)),1)]),a("div",fR,p(Ke(f))+" "+p(Ke(d)),1),a("div",hR,[a("span",null,"AUD$"+p(Ke(h)||0),1),a("a",{href:"#",onClick:S[2]||(S[2]=ue(x=>R.$router.push("/portfolio"),["prevent"])),class:"mm-link"},"Portfolio ↗")])]),a("div",pR,[S[17]||(S[17]=a("span",{class:"mm-net-left"},"Insert your contract address here:",-1)),a("form",{class:"mm-custom-form",onSubmit:ue(z,["prevent"])},[Pe(a("input",{"onUpdate:modelValue":S[3]||(S[3]=x=>se.value=x),class:"mm-input",placeholder:"Paste ERC20 contract address"},null,512),[[Ze,se.value]]),Pe(a("input",{"onUpdate:modelValue":S[4]||(S[4]=x=>X.value=x),class:"mm-input",placeholder:"Label (optional)"},null,512),[[Ze,X.value]]),a("button",{class:"mm-btn mm-outline",type:"submit",disabled:!se.value},"Add Token",8,mR),a("button",{class:"mm-btn mm-outline",type:"button",onClick:S[5]||(S[5]=(...x)=>Ke(N)&&Ke(N)(...x))},"Refresh")],32),Ke(T)?(m(),g("div",gR,[S[16]||(S[16]=a("span",{class:"mm-warning-icon"},"⚠️",-1)),a("span",yR,p(Ke(T)),1)])):B("",!0)]),a("nav",vR,[a("button",{class:be(["mm-tab",{"is-active":Ke(k)==="tokens"}]),onClick:S[6]||(S[6]=x=>k.value="tokens")},"Tokens",2),a("button",{class:be(["mm-tab",{"is-active":Ke(k)==="activity"}]),onClick:sl},"Activity",2)]),Ke(k)==="tokens"?(m(),g("div",bR,[a("div",wR,[a("div",AR,[S[18]||(S[18]=a("div",{class:"mm-token-icon mm-eth"},null,-1)),a("div",null,[a("div",ER,p(Ke(u)),1),a("div",{class:be(Te.value)},p(ve.value),3)])]),a("div",_R,[a("div",TR,p(Ke(f))+" "+p(Ke(d)),1),a("div",PR,"AUD$"+p(Ke(h)||0),1)])]),(m(!0),g(me,null,dt(ie.value,x=>(m(),g("div",{key:x.address,class:"mm-token",onClick:xe=>R.$router.push({name:"tokenDetail",params:{address:x.address}})},[a("div",SR,[a("div",CR,p((x.symbol||"T").slice(0,1)),1),a("div",null,[a("div",IR,p(x.name),1),S[19]||(S[19]=a("div",{style:{"font-size":"10px",color:"#FFFFFF"}},"此处添加产品名称",-1)),S[20]||(S[20]=a("div",{style:{"font-size":"10px",color:"#FFFFFF"}},"点击可查看详情",-1))])]),a("div",RR,[a("div",DR,p(x.displayBalance),1)])],8,kR))),128))])):B("",!0)])):B("",!0),Ke(k)==="activity"?(m(),g("div",xR,[a("div",NR,[S[21]||(S[21]=a("h3",null,"Wallet Activity Log",-1)),a("div",LR,[a("button",{class:be(["mm-btn mm-outline",{active:ce.value}]),onClick:tr}," Filter ",2),a("button",{class:"mm-btn mm-outline",onClick:er,disabled:re.value},[re.value?(m(),g("span",UR,"🔄")):(m(),g("span",BR,"Refresh"))],8,OR)])]),ce.value?(m(),g("div",MR,[a("div",FR,[a("div",VR,[S[23]||(S[23]=a("label",{class:"mm-filter-label"},"Type",-1)),Pe(a("select",{"onUpdate:modelValue":S[7]||(S[7]=x=>H.value.type=x),class:"mm-filter-select"},[...S[22]||(S[22]=[a("option",{value:""},"All Types",-1),a("option",{value:"buy"},"Buy",-1),a("option",{value:"sell"},"Sell",-1)])],512),[[bs,H.value.type]])]),a("div",$R,[S[25]||(S[25]=a("label",{class:"mm-filter-label"},"Project Code",-1)),Pe(a("select",{"onUpdate:modelValue":S[8]||(S[8]=x=>H.value.projectCode=x),class:"mm-filter-select"},[S[24]||(S[24]=a("option",{value:""},"All Projects",-1)),(m(!0),g(me,null,dt(ee.value,x=>(m(),g("option",{key:x,value:x},p(x),9,jR))),128))],512),[[bs,H.value.projectCode]])]),a("div",{class:"mm-filter-actions"},[a("button",{class:"mm-btn mm-outline",onClick:Po}," Clear ")])])])):B("",!0),re.value?(m(),g("div",HR,[...S[26]||(S[26]=[a("div",{class:"mm-spinner"},null,-1),a("span",null,"Loading activity...",-1)])])):J.value.length===0?(m(),g("div",WR,[...S[27]||(S[27]=[a("div",{class:"mm-no-activity-icon"},null,-1),a("p",null,"No transaction activity found",-1),a("p",{class:"mm-no-activity-sub"},"Your recent transactions will appear here",-1)])])):(m(),g("div",YR,[ce.value?(m(),g("div",GR,[a("span",KR," Showing "+p(K.value.length)+" of "+p(J.value.length)+" activities ",1),ae.value?(m(),g("button",{key:0,class:"mm-clear-filters-btn",onClick:Po}," Clear all filters ")):B("",!0)])):B("",!0),a("div",zR,[a("div",QR,[S[63]||(S[63]=a("div",{class:"mm-activity-section-header"},[a("h4",{class:"mm-activity-section-title"},"Transaction Activity")],-1)),(m(!0),g(me,null,dt(He.value,x=>(m(),g("div",{key:x.id,class:"mm-activity-item"},[a("div",JR,[a("div",{class:be(["mm-activity-type",x.type])},[a("span",qR,p(Ot(x.type)),1),a("span",ZR,p(hs(x.type)),1)],2),a("div",XR,p(Ue(x.timestamp)),1)]),a("div",eD,[x.type==="buy"||x.type==="sell"?(m(),g("div",tD,[S[28]||(S[28]=a("span",{class:"mm-activity-label"},"Project Code:",-1)),a("span",sD,p(x.project_code),1)])):B("",!0),x.type==="buy"||x.type==="sell"?(m(),g("div",nD,[S[29]||(S[29]=a("span",{class:"mm-activity-label"},"Project Name:",-1)),a("span",rD,p(x.project_name),1)])):B("",!0),x.type==="buy"||x.type==="sell"?(m(),g("div",iD,[S[30]||(S[30]=a("span",{class:"mm-activity-label"},"Token Amount:",-1)),a("span",oD,p(x.amount)+" tokens",1)])):B("",!0),x.type==="buy"||x.type==="sell"?(m(),g("div",aD,[S[31]||(S[31]=a("span",{class:"mm-activity-label"},"Trade Type:",-1)),a("span",{class:be(["mm-activity-value",x.type==="buy"?"mm-trade-buy":"mm-trade-sell"])},p(x.type.toUpperCase()),3)])):B("",!0),x.type==="buy"||x.type==="sell"?(m(),g("div",lD,[S[32]||(S[32]=a("span",{class:"mm-activity-label"},"Trade Time:",-1)),a("span",cD,p(Ge(x.timestamp)),1)])):B("",!0),x.type==="wallet_connect"||x.type==="wallet_disconnect"?(m(),g("div",uD,[S[33]||(S[33]=a("span",{class:"mm-activity-label"},"Wallet Address:",-1)),a("span",dD,p(Be(x.wallet_address)),1)])):B("",!0),x.type==="network_change"?(m(),g("div",fD,[S[34]||(S[34]=a("span",{class:"mm-activity-label"},"Network:",-1)),a("span",hD,p(x.network_name),1)])):B("",!0),x.type==="network_change"?(m(),g("div",pD,[S[35]||(S[35]=a("span",{class:"mm-activity-label"},"Chain ID:",-1)),a("span",mD,p(x.network_id),1)])):B("",!0),x.type==="metamask_connect"||x.type==="metamask_disconnect"?(m(),g("div",gD,[...S[36]||(S[36]=[a("span",{class:"mm-activity-label"},"Extension:",-1),a("span",{class:"mm-activity-value"},"MetaMask",-1)])])):B("",!0),x.type==="metamask_connect"&&x.chain_id?(m(),g("div",yD,[S[37]||(S[37]=a("span",{class:"mm-activity-label"},"Chain ID:",-1)),a("span",vD,p(x.chain_id),1)])):B("",!0),x.type==="metamask_disconnect"&&x.error?(m(),g("div",bD,[S[38]||(S[38]=a("span",{class:"mm-activity-label"},"Error:",-1)),a("span",wD,p(x.error),1)])):B("",!0),x.type==="metamask_transaction"?(m(),g("div",AD,[a("div",ED,[S[39]||(S[39]=a("span",{class:"mm-activity-label"},"Transaction Hash:",-1)),a("span",_D,p(x.etherscan?.hash||x.transactionHash||"N/A"),1)]),a("div",TD,[S[40]||(S[40]=a("span",{class:"mm-activity-label"},"Status:",-1)),a("span",{class:be(["mm-activity-value",{"mm-status-success":x.etherscan?.status==="0x1","mm-status-failed":x.etherscan?.status==="0x0"}])},p(x.etherscan?.status==="0x1"?"Success":x.etherscan?.status==="0x0"?"Failed":"Pending"),3)]),a("div",PD,[S[41]||(S[41]=a("span",{class:"mm-activity-label"},"From:",-1)),a("span",kD,p(Be(x.etherscan?.from)),1)]),a("div",SD,[S[42]||(S[42]=a("span",{class:"mm-activity-label"},"To:",-1)),a("span",CD,p(Be(x.etherscan?.to)),1)]),a("div",ID,[S[43]||(S[43]=a("span",{class:"mm-activity-label"},"Nonce:",-1)),a("span",RD,p(x.etherscan?.nonce?parseInt(x.etherscan.nonce,16):"N/A"),1)]),a("div",DD,[S[44]||(S[44]=a("span",{class:"mm-activity-label"},"Token Amount:",-1)),a("span",xD,p(x.amount||"N/A")+" "+p(x.project_code||"tokens"),1)]),a("div",ND,[S[45]||(S[45]=a("span",{class:"mm-activity-label"},"Value:",-1)),a("span",LD,p(Rt(x.etherscan?.value))+" ETH",1)]),a("div",OD,[S[46]||(S[46]=a("span",{class:"mm-activity-label"},"Block:",-1)),a("span",UD,p(x.etherscan?.blockNumber?parseInt(x.etherscan.blockNumber,16).toLocaleString():"N/A"),1)]),a("div",BD,[S[47]||(S[47]=a("span",{class:"mm-activity-label"},"Transaction Fee:",-1)),a("span",MD,p(x.etherscan?.transactionFee?x.etherscan.transactionFee.toFixed(6):"N/A")+" ETH",1)]),a("div",FD,[S[48]||(S[48]=a("span",{class:"mm-activity-label"},"Gas Price:",-1)),a("span",VD,p(x.etherscan?.gasPrice?parseInt(x.etherscan.gasPrice,16).toLocaleString():"N/A")+" Gwei",1)])])):B("",!0),x.type==="wallet_status_check"||x.type==="wallet_focus_check"?(m(),g("div",$D,[...S[49]||(S[49]=[a("span",{class:"mm-activity-label"},"Status:",-1),a("span",{class:"mm-activity-value"},"Checked",-1)])])):B("",!0),x.type==="wallet_status_check"||x.type==="wallet_focus_check"?(m(),g("div",jD,[S[50]||(S[50]=a("span",{class:"mm-activity-label"},"Wallet:",-1)),a("span",HD,p(Be(x.wallet_address)),1)])):B("",!0),x.type==="metamask_message"?(m(),g("div",WD,[S[51]||(S[51]=a("span",{class:"mm-activity-label"},"Message Type:",-1)),a("span",YD,p(x.message_type),1)])):B("",!0),x.message?(m(),g("div",GD,[S[52]||(S[52]=a("span",{class:"mm-activity-label"},"Message:",-1)),a("span",KD,p(x.message),1)])):B("",!0),x.etherscan?(m(),g("div",zD,[a("div",QD,[S[53]||(S[53]=a("span",{class:"mm-activity-label"},"Transaction Hash:",-1)),a("span",JD,p(x.etherscan.hash||x.transactionHash||"N/A"),1)]),a("div",qD,[S[54]||(S[54]=a("span",{class:"mm-activity-label"},"Status:",-1)),a("span",{class:be(["mm-activity-value",{"mm-status-success":x.etherscan.status==="0x1","mm-status-failed":x.etherscan.status==="0x0"}])},p(x.etherscan.status==="0x1"?"Success":x.etherscan.status==="0x0"?"Failed":"Pending"),3)]),a("div",ZD,[S[55]||(S[55]=a("span",{class:"mm-activity-label"},"From:",-1)),a("span",XD,p(Be(x.etherscan.from)),1)]),a("div",ex,[S[56]||(S[56]=a("span",{class:"mm-activity-label"},"To:",-1)),a("span",tx,p(Be(x.etherscan.to)),1)]),a("div",sx,[S[57]||(S[57]=a("span",{class:"mm-activity-label"},"Nonce:",-1)),a("span",nx,p(x.etherscan.nonce?parseInt(x.etherscan.nonce,16):"N/A"),1)]),a("div",rx,[S[58]||(S[58]=a("span",{class:"mm-activity-label"},"Token Amount:",-1)),a("span",ix,p(x.amount||"N/A")+" "+p(x.project_code||"tokens"),1)]),a("div",ox,[S[59]||(S[59]=a("span",{class:"mm-activity-label"},"Value:",-1)),a("span",ax,p(Rt(x.etherscan.value))+" ETH",1)]),a("div",lx,[S[60]||(S[60]=a("span",{class:"mm-activity-label"},"Gas Used:",-1)),a("span",cx,p(x.etherscan.gasUsed?parseInt(x.etherscan.gasUsed,16).toLocaleString():"N/A"),1)]),a("div",ux,[S[61]||(S[61]=a("span",{class:"mm-activity-label"},"Block:",-1)),a("span",dx,p(x.etherscan.blockNumber?parseInt(x.etherscan.blockNumber,16).toLocaleString():"N/A"),1)]),a("div",fx,[S[62]||(S[62]=a("span",{class:"mm-activity-label"},"Transaction Fee:",-1)),a("span",hx,p(x.etherscan.transactionFee?x.etherscan.transactionFee.toFixed(6):"N/A")+" ETH",1)])])):B("",!0)]),x.etherscan&&x.etherscan.etherscanUrl?(m(),g("div",px,[a("a",{href:x.etherscan.etherscanUrl,target:"_blank",class:"mm-etherscan-link"}," 🔗 View on Etherscan ",8,mx)])):B("",!0)]))),128)),je.value>1?(m(),g("div",gx,[a("div",yx,[a("span",vx," Transaction Page "+p(Ce.value)+" of "+p(je.value),1),a("span",bx," ("+p(ge.value.length)+" records) ",1)]),a("div",wx,[a("button",{class:"mm-pagination-btn",onClick:Ms,disabled:Ce.value<=1}," ← ",8,Ax),a("div",Ex,[(m(!0),g(me,null,dt(je.value,x=>(m(),g("button",{key:x,class:be(["mm-pagination-page",{active:x===Ce.value}]),onClick:xe=>ko(x)},p(x),11,_x))),128))]),a("button",{class:"mm-pagination-btn",onClick:So,disabled:Ce.value>=je.value}," → ",8,Tx)])])):B("",!0)])])]))])):B("",!0)]),Ke(T)?(m(),g("p",Px,p(Ke(T)),1)):B("",!0),Ke(w)?(m(),g("p",kx,p(Ke(w)),1)):B("",!0),Me(K0,{name:"fade"},{default:ot(()=>[O.value?(m(),g("div",Sx,"Copied")):B("",!0)]),_:1})],64))}},Og=It(Cx,[["__scopeId","data-v-082b58bd"]]),Ix={name:"KycServicePage",data(){return{step:1,form:{firstName:"",lastName:"",dob:"",email:"",phone:"",country:"",docType:"",docNumber:"",fileFront:null,fileBack:null},cameraEnabled:!1,camError:"",livenessDetecting:!1,livenessStatus:"正在检测...",showWhitelistEligibility:!1,showWhitelistApplication:!1,showWhitelistSuccess:!1,loadingMessage:"Processing...",showCancelConfirm:!1}},computed:{needsBack(){return this.form.docType==="driver"||this.form.docType==="idcard"},readyExtract(){return!!(this.form.firstName&&this.form.lastName&&this.form.dob)}},methods:{goProfile(){this.$router.push("/profile")},prev(){this.step=Math.max(1,this.step-1)},cancelKYC(){this.showCancelConfirm=!0},hideCancelConfirm(){this.showCancelConfirm=!1},confirmCancelKYC(){this.showCancelConfirm=!1,Ta(Jt.UNVERIFIED),this.$router.push("/profile")},goDoc(){this.step=3},onFile(t,e){const s=t.target.files?.[0];s&&(e==="front"?this.form.fileFront=s:this.form.fileBack=s)},async extractFromId(){try{const t=(this.form.fileFront?.name||"").toLowerCase();t.includes("john")&&(this.form.firstName="John"),t.includes("doe")&&(this.form.lastName="Doe"),t.match(/1990|90/)&&(this.form.dob="1990-01-01"),this.form.firstName||(this.form.firstName="GivenName"),this.form.lastName||(this.form.lastName="FamilyName"),this.form.dob||(this.form.dob="1990-01-01")}catch{}},complete(){Ta(Jt.VERIFIED),this.step=4,this.disableCamera(),setTimeout(()=>{this.showWhitelistEligibility=!0},1500)},async enableCamera(){this.camError="";try{const t=await navigator.mediaDevices.getUserMedia({video:!0});this.cameraEnabled=!0,this.$nextTick(()=>{this.$refs.videoEl&&(this.$refs.videoEl.srcObject=t)}),this.startLivenessDetection()}catch{this.camError="无法访问摄像头，请检查浏览器权限设置。"}},async startLivenessDetection(){this.livenessDetecting=!0,this.livenessStatus="正在检测...",setTimeout(()=>{this.livenessStatus="验证成功，进入下一步",setTimeout(()=>{this.complete()},1e3)},3e3)},cancelLiveness(){this.cameraEnabled=!1,this.livenessDetecting=!1,this.livenessStatus="正在检测...",this.$refs.videoEl&&this.$refs.videoEl.srcObject&&(this.$refs.videoEl.srcObject.getTracks().forEach(e=>e.stop()),this.$refs.videoEl.srcObject=null),this.prev()},disableCamera(){console.log("🔒 KYC验证完成，禁用镜头功能"),this.cameraEnabled=!1,this.livenessDetecting=!1,this.livenessStatus="验证已完成",this.$refs.videoEl&&this.$refs.videoEl.srcObject&&(this.$refs.videoEl.srcObject.getTracks().forEach(e=>{e.stop(),console.log("📹 摄像头流已停止")}),this.$refs.videoEl.srcObject=null),this.camError="",console.log("✅ 镜头功能已完全禁用")},async applyWhitelist(){this.showWhitelistEligibility=!1,this.showWhitelistApplication=!0;try{this.loadingMessage="Connecting to blockchain...",await this.delay(1e3),this.loadingMessage="Submitting whitelist application...",await this.delay(1e3),this.loadingMessage="Processing transaction...",await this.delay(1500);const t=await this.submitWhitelistToContract();if(t.success)this.loadingMessage="Whitelist application successful!",await this.delay(1e3),this.showWhitelistApplication=!1,this.showWhitelistSuccess=!0;else throw new Error(t.error||"Whitelist application failed")}catch(t){console.error("Whitelist application error:",t),this.loadingMessage="Application failed. Please try again.",await this.delay(2e3),this.showWhitelistApplication=!1,this.showWhitelistEligibility=!0}},async submitWhitelistToContract(){try{console.log("Calling whitelist contract...");const t={firstName:this.form.firstName,lastName:this.form.lastName,dob:this.form.dob,country:this.form.country,docType:this.form.docType,docNumber:this.form.docNumber},e=await ns.applyForKYC(t);if(e.success)return console.log("Whitelist application successful:",e.transactionHash),e;throw new Error(e.error||"Whitelist application failed")}catch(t){return console.error("Contract call failed:",t),{success:!1,error:t.message}}},delay(t){return new Promise(e=>setTimeout(e,t))},goToProjects(){this.showWhitelistSuccess=!1,this.$router.push("/listedprojects")}}},Rx={class:"kyc-page container"},Dx={class:"topbar"},xx={class:"steps"},Nx={key:0,class:"modal"},Lx={class:"card"},Ox={class:"grid"},Ux={class:"actions",style:{"justify-content":"flex-start",gap:"10px"}},Bx=["disabled"],Mx={class:"grid",style:{"margin-top":"12px"}},Fx={class:"actions"},Vx=["disabled"],$x={key:1,class:"modal"},jx={class:"card"},Hx={class:"camera-block"},Wx={key:0,ref:"videoEl",autoplay:"",playsinline:"",class:"cam-preview"},Yx={key:2,class:"cam-error"},Gx={key:3,class:"liveness-status"},Kx={class:"detection-text"},zx={class:"actions"},Qx={key:2,class:"modal"},Jx={class:"card success"},qx={class:"actions"},Zx={key:3,class:"modal"},Xx={class:"card"},e3={class:"actions"},t3={key:4,class:"modal"},s3={class:"card"},n3={class:"loading-text"},r3={key:5,class:"modal"},i3={key:6,class:"modal"},o3={class:"card"},a3={class:"actions"};function l3(t,e,s,n,r,i){return m(),g("section",Rx,[a("header",Dx,[a("button",{class:"back",onClick:e[0]||(e[0]=(...o)=>i.goProfile&&i.goProfile(...o))},"← Back"),e[21]||(e[21]=a("h1",{class:"title"},"KYC Verification",-1)),a("button",{class:"btn light danger",onClick:e[1]||(e[1]=(...o)=>i.cancelKYC&&i.cancelKYC(...o))},"Cancel Verification")]),a("ol",xx,[a("li",{class:be({active:r.step===1,done:r.step>1})},"1. Upload ID & auto-read",2),a("li",{class:be({active:r.step===3,done:r.step>3})},"2. Liveness",2),a("li",{class:be({active:r.step===4,done:r.step>4})},"3. Complete",2)]),r.step===1?(m(),g("div",Nx,[a("div",Lx,[e[33]||(e[33]=a("h2",null,"Upload your ID and auto-read info",-1)),a("form",{onSubmit:e[12]||(e[12]=ue((...o)=>i.goDoc&&i.goDoc(...o),["prevent"]))},[a("div",Ox,[a("label",null,[e[22]||(e[22]=ne("Upload front image* ",-1)),a("input",{type:"file",accept:"image/*",onChange:e[2]||(e[2]=o=>i.onFile(o,"front")),required:""},null,32)]),a("label",null,[e[23]||(e[23]=ne("Upload back image ",-1)),a("input",{type:"file",accept:"image/*",onChange:e[3]||(e[3]=o=>i.onFile(o,"back"))},null,32)]),a("label",null,[e[25]||(e[25]=ne("Issuing country* ",-1)),Pe(a("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>r.form.country=o),required:""},[...e[24]||(e[24]=[a("option",{value:"",disabled:""},"Select…",-1),a("option",{value:"AU"},"Australia",-1),a("option",{value:"US"},"United States",-1),a("option",{value:"AR"},"Argentina",-1)])],512),[[bs,r.form.country]])]),a("label",null,[e[27]||(e[27]=ne("ID type* ",-1)),Pe(a("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>r.form.docType=o),required:""},[...e[26]||(e[26]=[Nt('<option value="" disabled data-v-73148871>Select…</option><option value="passport" data-v-73148871>Passport</option><option value="driver" data-v-73148871>Driver&#39;s license</option><option value="idcard" data-v-73148871>ID card</option><option value="residence" data-v-73148871>Residence permit</option>',5)])],512),[[bs,r.form.docType]])])]),a("div",Ux,[a("button",{type:"button",class:"btn light",onClick:e[6]||(e[6]=(...o)=>i.extractFromId&&i.extractFromId(...o)),disabled:!r.form.fileFront},"Auto-read from ID",8,Bx),e[28]||(e[28]=a("small",{class:"hint"},"将使用 OCR/解析服务读取 first name, last name, DOB 等信息。",-1))]),a("div",Mx,[a("label",null,[e[29]||(e[29]=ne("First name* ",-1)),Pe(a("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>r.form.firstName=o),required:"",readonly:""},null,512),[[Ze,r.form.firstName,void 0,{trim:!0}]])]),a("label",null,[e[30]||(e[30]=ne("Last name* ",-1)),Pe(a("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>r.form.lastName=o),required:"",readonly:""},null,512),[[Ze,r.form.lastName,void 0,{trim:!0}]])]),a("label",null,[e[31]||(e[31]=ne("Date of birth* ",-1)),Pe(a("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>r.form.dob=o),required:"",readonly:""},null,512),[[Ze,r.form.dob,void 0,{trim:!0}]])]),a("label",null,[e[32]||(e[32]=ne("ID number ",-1)),Pe(a("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>r.form.docNumber=o),readonly:""},null,512),[[Ze,r.form.docNumber,void 0,{trim:!0}]])])]),a("div",Fx,[a("button",{type:"button",class:"btn light",onClick:e[11]||(e[11]=(...o)=>i.cancelKYC&&i.cancelKYC(...o))},"Cancel"),a("button",{type:"submit",class:"btn orange",disabled:!i.readyExtract},"Continue",8,Vx)])],32)])])):B("",!0),r.step===3?(m(),g("div",$x,[a("div",jx,[e[35]||(e[35]=a("h2",null,"Liveness detection",-1)),e[36]||(e[36]=a("p",null,"Center your face in the frame and follow the instruction.",-1)),a("div",Hx,[r.cameraEnabled?(m(),g("video",Wx,null,512)):(m(),g("button",{key:1,class:"btn orange",onClick:e[13]||(e[13]=(...o)=>i.enableCamera&&i.enableCamera(...o))},"Enable Camera")),r.camError?(m(),g("p",Yx,p(r.camError),1)):B("",!0),r.livenessDetecting?(m(),g("div",Gx,[e[34]||(e[34]=a("div",{class:"detection-spinner"},null,-1)),a("p",Kx,p(r.livenessStatus),1)])):B("",!0)]),e[37]||(e[37]=a("small",{class:"hint"},[ne("接入 Sumsub/Persona/Onfido 时，把此区域替换为他们的组件，并在成功回调里调用 "),a("code",null,"complete()"),ne("。")],-1)),a("div",zx,[a("button",{type:"button",class:"btn light",onClick:e[14]||(e[14]=(...o)=>i.prev&&i.prev(...o))},"Back"),r.cameraEnabled?B("",!0):(m(),g("button",{key:0,class:"btn light danger",onClick:e[15]||(e[15]=(...o)=>i.cancelLiveness&&i.cancelLiveness(...o))},"Cancel"))])])])):B("",!0),r.step===4?(m(),g("div",Qx,[a("div",Jx,[e[38]||(e[38]=a("div",{class:"bigcheck"},"✓",-1)),e[39]||(e[39]=a("h2",null,"Your profile has been verified",-1)),e[40]||(e[40]=a("p",null,"Please wait for the whitelist application...",-1)),a("div",qx,[a("button",{class:"btn orange",onClick:e[16]||(e[16]=(...o)=>i.goProfile&&i.goProfile(...o))},"Back to Profile")])])])):B("",!0),r.showWhitelistEligibility?(m(),g("div",Zx,[a("div",Xx,[e[41]||(e[41]=a("div",{class:"success-icon"},"🎉",-1)),e[42]||(e[42]=a("h2",{style:{color:"#16a34a"}},"Congratulations!",-1)),e[43]||(e[43]=a("p",{style:{"font-weight":"bold",color:"#000"}},"Your KYC verification has been completed successfully.",-1)),e[44]||(e[44]=a("p",{style:{"font-weight":"bold",color:"#000"}},"Now you are eligible to apply for the whitelist and start trading!",-1)),a("div",e3,[a("button",{class:"btn light",onClick:e[17]||(e[17]=(...o)=>i.goProfile&&i.goProfile(...o))},"Maybe Later"),a("button",{class:"btn orange",onClick:e[18]||(e[18]=(...o)=>i.applyWhitelist&&i.applyWhitelist(...o))},"Apply for Whitelist")])])])):B("",!0),r.showWhitelistApplication?(m(),g("div",t3,[a("div",s3,[e[45]||(e[45]=a("div",{class:"loading-icon"},[a("div",{class:"spinner"})],-1)),e[46]||(e[46]=a("h2",null,"Applying for Whitelist...",-1)),e[47]||(e[47]=a("p",null,"Please wait while we process your whitelist application.",-1)),a("div",n3,p(r.loadingMessage),1)])])):B("",!0),r.showWhitelistSuccess?(m(),g("div",r3,[...e[48]||(e[48]=[a("div",{class:"card success"},[a("div",{class:"bigcheck"},"✓"),a("h2",null,"Welcome to the Whitelist!"),a("p",null,"You have successfully joined the whitelist."),a("p",null,[a("strong",null,"Now you can go to the Projects page to subscribe to your preferred assets!")])],-1)])])):B("",!0),r.showCancelConfirm?(m(),g("div",i3,[a("div",o3,[e[49]||(e[49]=a("div",{class:"warning-icon"},"⚠️",-1)),e[50]||(e[50]=a("h2",null,"Cancel KYC Verification",-1)),e[51]||(e[51]=a("p",null,"Canceling KYC will revoke your subscription eligibility.",-1)),e[52]||(e[52]=a("p",null,[a("strong",null,"Are you sure you want to cancel KYC verification?")],-1)),a("div",a3,[a("button",{class:"btn light",onClick:e[19]||(e[19]=(...o)=>i.hideCancelConfirm&&i.hideCancelConfirm(...o))},"Continue KYC"),a("button",{class:"btn danger",onClick:e[20]||(e[20]=(...o)=>i.confirmCancelKYC&&i.confirmCancelKYC(...o))},"Yes, Cancel KYC")])])])):B("",!0)])}const Ug=It(Ix,[["render",l3],["__scopeId","data-v-73148871"]]),c3="/icons/X-logo.png",u3="/icons/Linkedin-logo.png",d3="/icons/facebook-logo.png",f3="/icons/github-logo.png",h3={name:"AppFooter"},p3={class:"footer"},m3={class:"container footer-top"},g3={class:"footer-links"};function y3(t,e,s,n,r,i){const o=Bi("router-link");return m(),g("footer",p3,[a("div",m3,[e[29]||(e[29]=a("div",{class:"footer-brand"},[a("img",{src:lg,alt:"Mortgage RWA Logo",class:"footer-logo"}),a("p",{class:"footer-tagline"},"Design amazing digital experiences that create more happy in the world.")],-1)),a("div",g3,[a("div",null,[e[6]||(e[6]=a("h4",null,"Product",-1)),a("ul",null,[a("li",null,[Me(o,{to:"/overview"},{default:ot(()=>[...e[0]||(e[0]=[ne("Overview",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/features"},{default:ot(()=>[...e[1]||(e[1]=[ne("Features",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/solutions"},{default:ot(()=>[...e[2]||(e[2]=[ne("Solutions ",-1),a("span",{class:"new"},"New",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/tutorials"},{default:ot(()=>[...e[3]||(e[3]=[ne("Tutorials",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/pricing"},{default:ot(()=>[...e[4]||(e[4]=[ne("Pricing",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/releases"},{default:ot(()=>[...e[5]||(e[5]=[ne("Releases",-1)])]),_:1})])])]),a("div",null,[e[13]||(e[13]=a("h4",null,"Company",-1)),a("ul",null,[a("li",null,[Me(o,{to:"/about"},{default:ot(()=>[...e[7]||(e[7]=[ne("About us",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/careers"},{default:ot(()=>[...e[8]||(e[8]=[ne("Careers",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/press"},{default:ot(()=>[...e[9]||(e[9]=[ne("Press",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/news"},{default:ot(()=>[...e[10]||(e[10]=[ne("News",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/media-kit"},{default:ot(()=>[...e[11]||(e[11]=[ne("Media kit",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/contact"},{default:ot(()=>[...e[12]||(e[12]=[ne("Contact",-1)])]),_:1})])])]),a("div",null,[e[20]||(e[20]=a("h4",null,"Resources",-1)),a("ul",null,[a("li",null,[Me(o,{to:"/blog"},{default:ot(()=>[...e[14]||(e[14]=[ne("Blog",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/newsletter"},{default:ot(()=>[...e[15]||(e[15]=[ne("Newsletter",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/events"},{default:ot(()=>[...e[16]||(e[16]=[ne("Events",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/help"},{default:ot(()=>[...e[17]||(e[17]=[ne("Help centre",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/tutorials"},{default:ot(()=>[...e[18]||(e[18]=[ne("Tutorials",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/support"},{default:ot(()=>[...e[19]||(e[19]=[ne("Support",-1)])]),_:1})])])]),e[28]||(e[28]=Nt('<div data-v-b26c06e1><h4 data-v-b26c06e1>Social</h4><ul data-v-b26c06e1><li data-v-b26c06e1><a href="https://twitter.com" target="_blank" data-v-b26c06e1>Twitter</a></li><li data-v-b26c06e1><a href="https://linkedin.com" target="_blank" data-v-b26c06e1>LinkedIn</a></li><li data-v-b26c06e1><a href="https://facebook.com" target="_blank" data-v-b26c06e1>Facebook</a></li><li data-v-b26c06e1><a href="https://github.com" target="_blank" data-v-b26c06e1>GitHub</a></li><li data-v-b26c06e1><a href="https://angel.co" target="_blank" data-v-b26c06e1>AngelList</a></li><li data-v-b26c06e1><a href="https://dribbble.com" target="_blank" data-v-b26c06e1>Dribbble</a></li></ul></div>',1)),a("div",null,[e[27]||(e[27]=a("h4",null,"Legal",-1)),a("ul",null,[a("li",null,[Me(o,{to:"/terms"},{default:ot(()=>[...e[21]||(e[21]=[ne("Terms",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/privacy"},{default:ot(()=>[...e[22]||(e[22]=[ne("Privacy",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/cookies"},{default:ot(()=>[...e[23]||(e[23]=[ne("Cookies",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/licenses"},{default:ot(()=>[...e[24]||(e[24]=[ne("Licenses",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/settings"},{default:ot(()=>[...e[25]||(e[25]=[ne("Settings",-1)])]),_:1})]),a("li",null,[Me(o,{to:"/contact"},{default:ot(()=>[...e[26]||(e[26]=[ne("Contact",-1)])]),_:1})])])])])]),e[30]||(e[30]=Nt('<div class="container footer-bottom" data-v-b26c06e1><p data-v-b26c06e1>© 2025 Mortgage RWA. All rights reserved.</p><div class="social-icons" data-v-b26c06e1><a href="#" data-v-b26c06e1><img src="'+c3+'" alt="X" data-v-b26c06e1></a><a href="#" data-v-b26c06e1><img src="'+u3+'" alt="LinkedIn" data-v-b26c06e1></a><a href="#" data-v-b26c06e1><img src="'+d3+'" alt="Facebook" data-v-b26c06e1></a><a href="#" data-v-b26c06e1><img src="'+f3+'" alt="GitHub" data-v-b26c06e1></a></div></div>',1))])}const v3=It(h3,[["render",y3],["__scopeId","data-v-b26c06e1"]]),b3={name:"DetailPage",props:{id:{type:String,default:null}},data(){return{currentProduct:null,loading:!0,error:null,refreshInterval:null,lastRefreshTime:null,showRawData:!1,unsubscribeProducts:null,unsubscribeNewProjects:null}},async mounted(){await this.loadProjectData(),this.setupDatabaseSync(),this.startAutoRefresh()},beforeUnmount(){this.stopAutoRefresh(),this.cleanupDatabaseSync()},watch:{$route(t,e){t.params.id!==e.params.id&&(this.id=t.params.id,this.loadProjectData())},id:{handler(t){t&&this.loadProjectData()},immediate:!0}},methods:{async loadProjectData(){try{this.loading=!0,this.error=null;const t=this.id||this.$route.params.id||this.$route.query.id;if(!t){this.error="No project ID provided";return}console.log("🔄 DetailPage: Loading project data for ID:",t);let e=null;if(t&&typeof t=="string"&&t.length>0)try{e=await Kt.getProductByCode(t),console.log("📡 DetailPage: API response via code:",e)}catch(s){console.warn("⚠️ DetailPage: Failed to get by code, trying other methods:",s)}if(!e||e.status!==0)try{e=await Kt.getProductById(t),console.log("📡 DetailPage: API response via ID:",e)}catch(s){console.warn("⚠️ DetailPage: Failed to get by ID:",s)}if(e&&e.status===0){const s=e.data;this.currentProduct={...s,totalOffering:s.total_token||s.totalOffering,subscribed:s.current_subscribed_token||s.subscribed,targetYield:s.target_yield||s.targetYield,ltv:s.LTV||s.ltv,annualInterestRate:s.annual_interest_rate||s.annualInterestRate,loanAmount:s.loan_amount||s.loanAmount,valuation:s.valuation,loanTerm:s.loan_term||s.loanTerm,address:s.property_address||s.address,type:s.property_type||s.type,...s},this.lastRefreshTime=new Date,console.log("✅ DetailPage: Project data loaded successfully:",this.currentProduct)}else this.error=e?.message||"Failed to load project data",console.error("❌ DetailPage: API returned error:",e)}catch(t){this.error="Network error, unable to load project data",console.error("❌ DetailPage: Failed to load project data:",t)}finally{this.loading=!1}},setupDatabaseSync(){const{subscribeProducts:t,subscribeNewProjects:e}=Dr();this.unsubscribeProducts=t(s=>{console.log("📡 DetailPage: Received product data update, total:",s.length);const n=this.id||this.$route.params.id;if(n){const r=s.find(i=>i.id===n||i.code===n);r&&(console.log("🔄 DetailPage: Found updated product data, refreshing..."),this.currentProduct={...r,totalOffering:r.total_token||r.totalOffering,subscribed:r.current_subscribed_token||r.subscribed,targetYield:r.target_yield||r.targetYield,ltv:r.LTV||r.ltv,annualInterestRate:r.annual_interest_rate||r.annualInterestRate,loanAmount:r.loan_amount||r.loanAmount,valuation:r.valuation,loanTerm:r.loan_term||r.loanTerm,address:r.property_address||r.address,type:r.property_type||r.type,...r},this.lastRefreshTime=new Date)}}),this.unsubscribeNewProjects=e(s=>{console.log("🆕 DetailPage: New projects detected:",s.length)})},cleanupDatabaseSync(){this.unsubscribeProducts&&(this.unsubscribeProducts(),this.unsubscribeProducts=null),this.unsubscribeNewProjects&&(this.unsubscribeNewProjects(),this.unsubscribeNewProjects=null)},startAutoRefresh(){this.refreshInterval=setInterval(()=>{this.loadProjectData()},3e4)},stopAutoRefresh(){this.refreshInterval&&(clearInterval(this.refreshInterval),this.refreshInterval=null)},handleInvest(){this.currentProduct&&(console.log("💰 DetailPage: Invest button clicked for project:",this.currentProduct.code),this.$router.push(`/trade/${this.currentProduct.code}`))},handleDetail(){this.currentProduct&&console.log("📊 DetailPage: Detail button clicked for project:",this.currentProduct.code)},toggleRawData(){this.showRawData=!this.showRawData},getStatusText(t){return{INCOMING:"Incoming",ACTIVE:"Active",PERFORMING:"Performing",COMPLETED:"Completed",COMPLETE:"Completed",DEFAULT:"Default"}[t]||t},getSubscriptionProgress(){if(!this.currentProduct)return 0;const t=parseFloat(this.currentProduct.totalOffering||this.currentProduct.total_token||0),e=parseFloat(this.currentProduct.subscribed||this.currentProduct.current_subscribed_token||0);if(t===0)return 0;const s=e/t*100;return Math.min(Math.round(s*100)/100,100)},getAvailableAmount(){if(!this.currentProduct)return 0;const t=parseFloat(this.currentProduct.totalOffering||this.currentProduct.total_token||0),e=parseFloat(this.currentProduct.subscribed||this.currentProduct.current_subscribed_token||0);return Math.max(0,t-e)},formatNumber(t){if(!t)return"0";const e=parseFloat(t);return isNaN(e)?t:e.toLocaleString()},formatTime(t){return t?new Date(t).toLocaleString():"N/A"},formatDate(t){return t?new Date(t).toLocaleDateString():"N/A"}}},w3={class:"container"},A3={class:"project-container"},E3={class:"doc-header"},_3={class:"headline"},T3={class:"subline"},P3={key:0,class:"loading-container"},k3={key:1,class:"error-container"},S3={class:"error-message"},C3={key:2,class:"detail-content"},I3={class:"info-card"},R3={class:"card-header"},D3={class:"info-grid"},x3={class:"info-item"},N3={class:"info-value"},L3={class:"info-item"},O3={class:"info-value"},U3={class:"info-item"},B3={class:"info-value"},M3={class:"info-item"},F3={class:"info-value"},V3={class:"info-item"},$3={class:"info-value"},j3={class:"info-item"},H3={class:"info-value"},W3={class:"info-card"},Y3={class:"card-header"},G3={class:"investment-actions"},K3={class:"info-grid"},z3={class:"info-item"},Q3={class:"info-value"},J3={class:"info-item"},q3={class:"info-value"},Z3={class:"info-item"},X3={class:"info-value"},e4={class:"info-item"},t4={class:"info-value"},s4={class:"info-item"},n4={class:"info-value"},r4={class:"info-item"},i4={class:"info-value"},o4={class:"progress-section"},a4={class:"progress-bar"},l4={class:"progress-text"},c4={class:"info-card"},u4={class:"info-grid"},d4={class:"info-item"},f4={class:"info-value"},h4={class:"info-item"},p4={class:"info-value"},m4={class:"info-item"},g4={class:"info-value"},y4={class:"info-item"},v4={class:"info-value"},b4={class:"info-item"},w4={class:"info-value"},A4={class:"info-item"},E4={class:"info-value"},_4={class:"info-card"},T4={class:"info-grid"},P4={class:"info-item full-width"},k4={class:"info-value"},S4={class:"info-item"},C4={class:"info-value"},I4={class:"info-item"},R4={class:"info-value"},D4={class:"info-item"},x4={class:"info-value"},N4={class:"info-card"},L4={class:"card-header"},O4={key:0,class:"raw-data-container"},U4={class:"raw-data"},B4={key:3,class:"no-project"},M4={class:"no-project-content"};function F4(t,e,s,n,r,i){return m(),g("div",w3,[a("div",A3,[a("header",E3,[a("h1",_3,[r.currentProduct?(m(),g(me,{key:0},[ne(p(r.currentProduct.name)+" - "+p(r.currentProduct.code),1)],64)):(m(),g(me,{key:1},[ne(" Project Details ")],64))]),a("p",T3,[r.currentProduct?(m(),g(me,{key:0},[ne(p(r.currentProduct.subtitle),1)],64)):B("",!0)])]),r.loading?(m(),g("div",P3,[...e[5]||(e[5]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Loading project details...",-1)])])):r.error?(m(),g("div",k3,[a("div",S3,[e[6]||(e[6]=a("h3",null,"Load Failed",-1)),a("p",null,p(r.error),1),a("button",{onClick:e[0]||(e[0]=(...o)=>i.loadProjectData&&i.loadProjectData(...o)),class:"btn retry-btn"},"Retry")])])):r.currentProduct?(m(),g("div",C3,[a("section",I3,[a("div",R3,[e[7]||(e[7]=a("h2",null,"Project Information",-1)),a("div",{class:be(["status-badge","status-"+r.currentProduct.status])},p(i.getStatusText(r.currentProduct.status)),3)]),a("div",D3,[a("div",x3,[e[8]||(e[8]=a("div",{class:"info-label"},"Project Code",-1)),a("div",N3,p(r.currentProduct.code),1)]),a("div",L3,[e[9]||(e[9]=a("div",{class:"info-label"},"Project Name",-1)),a("div",O3,p(r.currentProduct.name),1)]),a("div",U3,[e[10]||(e[10]=a("div",{class:"info-label"},"Type",-1)),a("div",B3,p(r.currentProduct.type||r.currentProduct.property_type),1)]),a("div",M3,[e[11]||(e[11]=a("div",{class:"info-label"},"Subtitle",-1)),a("div",F3,p(r.currentProduct.subtitle||"N/A"),1)]),a("div",V3,[e[12]||(e[12]=a("div",{class:"info-label"},"Risk Level",-1)),a("div",$3,p(r.currentProduct.risk||"N/A"),1)]),a("div",j3,[e[13]||(e[13]=a("div",{class:"info-label"},"Target Yield",-1)),a("div",H3,p(r.currentProduct.targetYield||r.currentProduct.target_yield||"N/A")+"% p.a.",1)])])]),a("section",W3,[a("div",Y3,[e[16]||(e[16]=a("h2",null,"Investment Information",-1)),a("div",G3,[r.currentProduct.status==="ACTIVE"?(m(),g("button",{key:0,class:"btn primary",onClick:e[1]||(e[1]=(...o)=>i.handleInvest&&i.handleInvest(...o))},[...e[14]||(e[14]=[a("span",{class:"btn-icon"},"💰",-1),ne(" Invest Now ",-1)])])):B("",!0),a("button",{class:"btn secondary",onClick:e[2]||(e[2]=(...o)=>i.handleDetail&&i.handleDetail(...o))},[...e[15]||(e[15]=[a("span",{class:"btn-icon"},"📊",-1),ne(" View Details ",-1)])])])]),a("div",K3,[a("div",z3,[e[17]||(e[17]=a("div",{class:"info-label"},"Total Offering",-1)),a("div",Q3,"AUD$"+p(i.formatNumber(r.currentProduct.totalOffering||r.currentProduct.total_token)),1)]),a("div",J3,[e[18]||(e[18]=a("div",{class:"info-label"},"Subscribed",-1)),a("div",q3,"AUD$"+p(i.formatNumber(r.currentProduct.subscribed||r.currentProduct.current_subscribed_token)),1)]),a("div",Z3,[e[19]||(e[19]=a("div",{class:"info-label"},"Total Subscription Tokens",-1)),a("div",X3,p(i.formatNumber(r.currentProduct.totalSubscriptionTokens||r.currentProduct.total_token)),1)]),a("div",e4,[e[20]||(e[20]=a("div",{class:"info-label"},"Subscribed Tokens",-1)),a("div",t4,p(i.formatNumber(r.currentProduct.subscribedTokens||r.currentProduct.current_subscribed_token)),1)]),a("div",s4,[e[21]||(e[21]=a("div",{class:"info-label"},"Subscription Progress",-1)),a("div",n4,p(i.getSubscriptionProgress())+"%",1)]),a("div",r4,[e[22]||(e[22]=a("div",{class:"info-label"},"Available for Investment",-1)),a("div",i4,"AUD$"+p(i.formatNumber(i.getAvailableAmount())),1)])]),a("div",o4,[a("div",a4,[a("div",{class:"progress-fill",style:xt({width:i.getSubscriptionProgress()+"%"})},null,4)]),a("div",l4,p(i.getSubscriptionProgress())+"% Subscribed",1)])]),a("section",c4,[e[29]||(e[29]=a("div",{class:"card-header"},[a("h2",null,"Loan Information")],-1)),a("div",u4,[a("div",d4,[e[23]||(e[23]=a("div",{class:"info-label"},"Loan Amount",-1)),a("div",f4,"AUD$"+p(i.formatNumber(r.currentProduct.loanAmount||r.currentProduct.loan_amount)),1)]),a("div",h4,[e[24]||(e[24]=a("div",{class:"info-label"},"LTV (Loan-to-Value)",-1)),a("div",p4,p(r.currentProduct.ltv||r.currentProduct.LTV||"N/A")+"%",1)]),a("div",m4,[e[25]||(e[25]=a("div",{class:"info-label"},"Annual Interest Rate",-1)),a("div",g4,p(r.currentProduct.annualInterestRate||r.currentProduct.annual_interest_rate||"N/A")+"%",1)]),a("div",y4,[e[26]||(e[26]=a("div",{class:"info-label"},"Loan Term",-1)),a("div",v4,p(r.currentProduct.loanTerm||r.currentProduct.loan_term||"N/A")+" months",1)]),a("div",b4,[e[27]||(e[27]=a("div",{class:"info-label"},"Valuation",-1)),a("div",w4,"AUD$"+p(i.formatNumber(r.currentProduct.valuation)),1)]),a("div",A4,[e[28]||(e[28]=a("div",{class:"info-label"},"Property Address",-1)),a("div",E4,p(r.currentProduct.address||r.currentProduct.property_address||"N/A"),1)])])]),a("section",_4,[e[34]||(e[34]=a("div",{class:"card-header"},[a("h2",null,"Project Details")],-1)),a("div",T4,[a("div",P4,[e[30]||(e[30]=a("div",{class:"info-label"},"Summary",-1)),a("div",k4,p(r.currentProduct.summary||"No summary available"),1)]),a("div",S4,[e[31]||(e[31]=a("div",{class:"info-label"},"Created Date",-1)),a("div",C4,p(i.formatDate(r.currentProduct.created_at||r.currentProduct.createdAt)),1)]),a("div",I4,[e[32]||(e[32]=a("div",{class:"info-label"},"Updated Date",-1)),a("div",R4,p(i.formatDate(r.currentProduct.updated_at||r.currentProduct.updatedAt)),1)]),a("div",D4,[e[33]||(e[33]=a("div",{class:"info-label"},"Last Refresh",-1)),a("div",x4,p(i.formatTime(r.lastRefreshTime)),1)])])]),a("section",N4,[a("div",L4,[e[35]||(e[35]=a("h2",null,"Raw Database Data",-1)),a("button",{class:"btn secondary",onClick:e[3]||(e[3]=(...o)=>i.toggleRawData&&i.toggleRawData(...o))},p(r.showRawData?"Hide":"Show")+" Raw Data ",1)]),r.showRawData?(m(),g("div",O4,[a("pre",U4,p(JSON.stringify(r.currentProduct,null,2)),1)])):B("",!0)])])):(m(),g("div",B4,[a("div",M4,[e[36]||(e[36]=a("h3",null,"Project Not Found",-1)),e[37]||(e[37]=a("p",null,"The requested project could not be found.",-1)),a("button",{class:"btn primary",onClick:e[4]||(e[4]=o=>t.$router.push("/listedprojects"))}," Back to Projects ")])]))])])}const Bg=It(b3,[["render",F4],["__scopeId","data-v-6baec5bf"]]),V4={name:"App",components:{AppHeader:u2,AppFooter:v3,HomeView:yg,ListedProjectsView:Sc,LoginView:xg,SignupView:Ng,ProfileView:Lg,WalletView:Og,PortfolioView:Dg,kycService:Ug,DetailPage:Bg},data(){return{user:null}},computed:{isAuthPage(){const t=this.$route.path;return t==="/login"||t==="/signup"},isIntroPage(){return this.$route.path==="/intro"}},methods:{alertMsg(t){alert(t)},handleSearch(t){const e=(t||"").toLowerCase().trim();e&&(e.includes("project")?this.$router.push({name:"projects"}):e.includes("login")?this.$router.push({name:"login"}):e.includes("signup")||e.includes("register")?this.$router.push({name:"signup"}):alert("No matching page found."))}}},$4={id:"app"},j4={class:"page-wrap"};function H4(t,e,s,n,r,i){const o=Bi("AppHeader"),l=Bi("router-view"),c=Bi("AppFooter");return m(),g("div",$4,[i.isIntroPage?B("",!0):(m(),ia(o,{key:0,onSearch:i.handleSearch},null,8,["onSearch"])),a("main",j4,[Me(l)]),!i.isAuthPage&&!i.isIntroPage?(m(),ia(c,{key:1})):B("",!0)])}const W4=It(V4,[["render",H4]]),Y4={name:"ProjectsView",props:{code:{type:String,default:null}},data(){return{filters:{q:"",type:"",status:"",minYield:0,maxYield:20},products:[],currentProduct:null,loading:!0,error:null,refreshInterval:null,lastRefreshTime:null,isDetailView:!1}},async mounted(){this.isDetailView=!!this.code,this.isDetailView?await this.loadSingleProduct():await this.loadProducts(),this.setupDatabaseSync()},beforeUnmount(){this.cleanupDatabaseSync()},watch:{$route(t,e){t.params.code!==e.params.code&&(this.code=t.params.code,this.isDetailView=!!this.code,this.isDetailView?this.loadSingleProduct():this.loadProducts())},code:{handler(t){this.isDetailView=!!t,this.isDetailView?this.loadSingleProduct():this.loadProducts()},immediate:!0}},methods:{async loadSingleProduct(){try{this.loading=!0,this.error=null,console.log("🔄 ProjectsView: 从数据库加载单个产品数据...",this.code);const t=await Kt.getProductByCode(this.code);if(t.status===0){const e=t.data,s={...e,totalOffering:e.total_token,subscribed:e.current_subscribed_token,targetYield:e.target_yield,ltv:e.LTV,annualInterestRate:e.annual_interest_rate,loanAmount:e.loan_amount,valuation:e.valuation,image:e.image||this.getProductImage(e.code),totalOfferingRaw:e.total_token||0,subscribedRaw:e.current_subscribed_token||0};this.currentProduct={code:s.code,name:s.name,image:s.image,subtitle:s.subtitle,type:s.type,risk:s.risk,targetYield:s.targetYield,status:s.status,summary:s.summary,totalOffering:s.totalOffering,subscribed:s.subscribed,totalSubscriptionTokens:s.totalSubscriptionTokens,subscribedTokens:s.subscribedTokens,metrics:{currentElaraPrice:this.calculateTokenPrice(s),collateralPropertyValue:s.valuation||"TBA",rentalIncome:this.calculateRentalIncome(s),targetLoanYield:`${s.targetYield}% p.a.`},loanAmount:s.loanAmount,annualInterestRate:s.annualInterestRate,loanTerm:s.loanTerm,ltv:s.ltv,drawdownDate:s.drawdownDate,earlyRepayment:s.earlyRepayment,repaymentArrangement:s.repaymentArrangement,issuer:s.issuer,pwShareholders:s.pwShareholders,lender:s.lender,borrower:s.borrower,guarantor:s.guarantor,disbursementMethod:s.disbursementMethod,interest:s.interest,earlyRepaymentDetails:s.earlyRepaymentDetails,maturityDate:s.maturityDate,propertyAddress:s.propertyAddress,valuation:s.valuation,securityRank:s.securityRank,defaultInterestRate:s.defaultInterestRate,defaultTriggers:s.defaultTriggers,defaultProcess:s.defaultProcess,issuerToken:s.issuerToken,loanToken:s.loanToken,valuationReport:s.valuationReport,mortgageDeed:s.mortgageDeed},this.lastRefreshTime=new Date,console.log("✅ ProjectsView: 单个产品数据加载成功:",this.currentProduct)}else this.error=t.message||"获取产品数据失败",console.error("❌ ProjectsView: API返回错误:",t)}catch(t){this.error="网络错误，无法获取产品数据",console.error("❌ ProjectsView: 获取单个产品数据失败:",t)}finally{this.loading=!1}},async loadProducts(){try{this.loading=!0,this.error=null,console.log("🔄 从数据库加载产品数据...");const t=await Kt.getAllProducts();t.status===0?(this.products=(t.data||[]).map(e=>{const s={id:e.id,code:e.code,name:e.name,status:e.status,totalOffering:e.total_offering_token?`AUD$${e.total_offering_token.toLocaleString()}`:"AUD$0",subscribed:e.subscribe_token?`AUD$${e.subscribe_token.toLocaleString()}`:"AUD$0",totalOfferingRaw:e.total_offering_token||0,subscribedRaw:e.subscribe_token||0,property_location:e.propertyLocation,property_state:e.propertyState,property_type:e.propertyType,property_value:e.propertyValue,property_summary:e.propertySummary,loan_type:e.loanType,loan_product:e.loanProduct,loan_amount:e.loanAmount,loan_purpose:e.loanPurpose,loan_term_months:e.loanTermMonths,lvr:e.lvr,interest_rate:e.interestRate,default_rate:e.defaultRate,commencement_date:e.commencementDate,expiry_date:e.expiryDate,expected_recovery_date:e.expectedRecoveryDate,subtitle:`${e.loanProduct} - ${e.propertyType}`,loanAmount:e.loanAmount?`AUD$${e.loanAmount.toLocaleString()}`:"AUD$0",loanTerm:`${e.loanTermMonths} months`,targetYield:e.interestRate,image:e.image||this.getProductImage(e.code)};return s.metrics={currentElaraPrice:this.calculateTokenPrice(s),collateralPropertyValue:e.propertyValue?`AUD$${e.propertyValue.toLocaleString()}`:"TBA",rentalIncome:this.calculateRentalIncome(s),targetLoanYield:`${e.interestRate}% p.a.`},s}),this.lastRefreshTime=new Date,console.log("✅ 产品数据加载成功，共",this.products.length,"个项目")):(this.error=t.message||"获取产品数据失败",console.error("❌ API返回错误:",t))}catch(t){this.error="网络错误，无法获取产品数据",console.error("❌ 加载产品数据失败:",t)}finally{this.loading=!1}},async refreshProducts(){console.log("🔄 手动刷新产品数据..."),this.isDetailView?await this.loadSingleProduct():await this.loadProducts()},setupDatabaseSync(){const{subscribeProducts:t,subscribeNewProjects:e,getLastRefreshTime:s}=Dr();this.unsubscribeProducts=t(r=>{console.log("📡 ProjectsView: 收到产品数据更新，共",r.length,"个项目"),this.products=r.map(i=>({...i,totalOffering:i.total_token,subscribed:i.current_subscribed_token,targetYield:i.target_yield,ltv:i.LTV,annualInterestRate:i.annual_interest_rate,totalOfferingRaw:i.total_token||0,subscribedRaw:i.current_subscribed_token||0,loanAmount:i.loan_amount,valuation:i.valuation,image:i.image||this.getProductImage(i.code)})),this.lastRefreshTime=new Date}),this.unsubscribeNewProjects=e(r=>{console.log("🆕 ProjectsView: 发现",r.length,"个新项目"),this.showNewProjectsNotification(r)});const n=s();n&&(this.lastRefreshTime=n)},cleanupDatabaseSync(){this.unsubscribeProducts&&this.unsubscribeProducts(),this.unsubscribeNewProjects&&this.unsubscribeNewProjects()},showNewProjectsNotification(t){if(t.length>0){const e=t.map(s=>s.name).join(", ");console.log("🆕 发现新项目:",e)}},startAutoRefresh(){this.refreshInterval=setInterval(()=>{console.log("🔄 自动刷新产品数据..."),this.loadProducts()},3e4)},stopAutoRefresh(){this.refreshInterval&&(clearInterval(this.refreshInterval),this.refreshInterval=null,console.log("⏹️ 停止自动刷新"))},formatCurrency(t){if(!t)return null;const e=parseFloat(t);return isNaN(e)?t:`AUD$${e.toLocaleString()}`},resetFilters(){this.filters={q:"",type:"",risk:"",status:"",minYield:0,maxYield:20}},onFilterChange(){console.log("筛选器变化:",this.filters),this.$forceUpdate()},openDetail(t){const e=this.products.find(n=>n.code===t);try{sessionStorage.setItem("lastProduct",JSON.stringify(e))}catch{}const s=e.project_id||t;this.$router.push({name:"detail",params:{id:s}})},openTrade(t){const e=this.products.find(s=>s.code===t);try{sessionStorage.setItem("lastProduct",JSON.stringify(e))}catch{}this.$router.push({name:"tradeProject",params:{code:t}})},getProgressPercentage(t){if(!t)return 0;const e=t.totalOfferingRaw||0,s=t.subscribedRaw||0;if(e===0)return 0;const n=s/e*100;return Math.min(Math.round(n),100)},getStatusText(t){return{INCOMING:"Incoming",ACTIVE:"Active",PERFORMING:"Performing",DEFAULT:"Default",COMPLETED:"Completed"}[t]||"Unknown"},joinWaitlist(t){this.addToWatchlist(t)},registerInterest(t){this.addToWatchlist(t)},addToWatchlist(t){try{let e=[];const s=localStorage.getItem("projectWatchlist");if(s&&(e=JSON.parse(s)),e.includes(t)){alert("This Project is already in your watchlist!");return}e.push(t),localStorage.setItem("projectWatchlist",JSON.stringify(e));const n=this.products.find(r=>r.code===t);alert(`Added ${n.name} to your watchlist!`),console.log("Added to watchlist:",t)}catch(e){console.error("❌ Projects: Failed to add to watchlist:",e),alert("Failed to add to watchlist, please try again")}},formatTime(t){if(!t)return"";const s=new Date-t,n=Math.floor(s/6e4);if(n<1)return"Just now";if(n<60)return`${n} minutes ago`;const r=Math.floor(n/60);return r<24?`${r} hours ago`:`${Math.floor(r/24)} days ago`},getProductImage(t){return{RWA001:"/pics/TYMU.png",RWA002:"/pics/SQNB.png",RWA003:"/pics/LZYT.png",YYD:"/pics/YYD.png",COMP:"/pics/TYMU.png"}[t]||"/pics/TYMU.png"},calculateTokenPrice(t){return`AUD$${(1*((t.targetYield||6)/6)).toFixed(2)}`},calculateRentalIncome(t){if(!t.valuation)return"TBA";const e=t.valuation.replace(/[AUD$,]/g,""),s=parseFloat(e),n=(t.targetYield||6)/12/100;return`AUD$${(s*n).toLocaleString("en-AU",{maximumFractionDigits:0})} / month`},getSubscriptionProgress(t){if(!t)return 0;const e=t.totalOfferingRaw||0,s=t.subscribedRaw||0;if(e===0)return 0;const n=s/e*100;return Math.round(n*100)/100},formatNumber(t){if(!t)return"0";const e=parseFloat(t);return isNaN(e)?t:e.toLocaleString()}},computed:{filteredProducts(){const t=this.filters.q.trim().toLowerCase();return this.products.filter(e=>{if(e.status!=="INCOMING")return!1;const s=!t||e.code.toLowerCase().includes(t)||(e.name||"").toLowerCase().includes(t)||(e.subtitle||"").toLowerCase().includes(t),n=!this.filters.type||e.property_type===this.filters.type,r=!this.filters.status||e.status===this.filters.status,i=parseFloat(e.targetYield)||0,o=i>=this.filters.minYield&&i<=this.filters.maxYield;return s&&n&&r&&o}).sort((e,s)=>e.code.localeCompare(s.code))},hasActiveFilters(){return this.filters.q.trim()!==""||this.filters.type!==""||this.filters.status!==""||this.filters.minYield>0||this.filters.maxYield<20},projectData(){const t=this.project;if(t)return console.log("TradeProjectView: Retrieve project data from database:",t),{code:t.code,name:t.name,image:t.image||this.getProductImage(t.code),subtitle:t.subtitle,type:t.type,risk:t.risk,targetYield:t.targetYield,status:t.status,summary:t.summary,totalOffering:t.totalOffering,subscribed:t.subscribed,totalSubscriptionTokens:t.totalSubscriptionTokens,subscribedTokens:t.subscribedTokens,metrics:{currentElaraPrice:this.calculateTokenPrice(t),collateralPropertyValue:t.valuation||"TBA",rentalIncome:this.calculateRentalIncome(t),targetLoanYield:`${t.targetYield}% p.a.`},loanAmount:t.loanAmount,annualInterestRate:t.annualInterestRate,loanTerm:t.loanTerm,ltv:t.ltv,drawdownDate:t.drawdownDate,earlyRepayment:t.earlyRepayment,repaymentArrangement:t.repaymentArrangement,issuer:t.issuer,pwShareholders:t.pwShareholders,lender:t.lender,borrower:t.borrower,guarantor:t.guarantor,disbursementMethod:t.disbursementMethod,interest:t.interest,earlyRepaymentDetails:t.earlyRepaymentDetails,maturityDate:t.maturityDate,propertyAddress:t.propertyAddress,valuation:t.valuation,securityRank:t.securityRank,defaultInterestRate:t.defaultInterestRate,defaultTriggers:t.defaultTriggers,defaultProcess:t.defaultProcess,issuerToken:t.issuerToken,loanToken:t.loanToken,valuationReport:t.valuationReport,mortgageDeed:t.mortgageDeed}}}},G4={class:"container"},K4={class:"project-container"},z4={class:"doc-header"},Q4={class:"headline"},J4={class:"subline"},q4={key:0,class:"filters",style:{display:"flex",gap:"10px","flex-wrap":"wrap","align-items":"center",margin:"8px 0 6px"}},Z4={class:"yield-range-filter"},X4={class:"yield-range-container"},e6={class:"yield-range-slider"},t6=["max"],s6=["min"],n6={class:"yield-range-display"},r6={key:1,class:"filter-stats",style:{margin:"8px 0",color:"var(--muted)","font-size":"14px",display:"flex","justify-content":"space-between","align-items":"center","flex-wrap":"wrap",gap:"8px"}},i6={key:0,style:{"margin-left":"12px"}},o6={style:{display:"flex","align-items":"center",gap:"12px"}},a6={key:0,style:{"font-size":"12px",color:"#6b7280"}},l6=["disabled"],c6={key:2,class:"loading-container"},u6={key:3,class:"error-container"},d6={class:"error-message"},f6={key:4,class:"doc-list"},h6={class:"doc-card","aria-labelledby":"'title-' + currentProduct.code"},p6={class:"main-content"},m6={class:"left-content"},g6={class:"title-section"},y6={class:"title-header"},v6=["id"],b6={class:"doc-code"},w6={class:"doc-name"},A6={class:"doc-subtitle"},E6={class:"project-basic-info"},_6={class:"info-item"},T6={class:"info-value"},P6={class:"progress-actions-row"},k6={class:"progress-container"},S6={class:"progress-bar"},C6={class:"progress-text"},I6={class:"doc-actions"},R6={key:5,class:"doc-list"},D6={class:"pf-project-header"},x6=["src","alt"],N6={class:"pf-project-info"},L6=["id"],O6={class:"pf-project-metrics"},U6={class:"pf-project-metric"},B6={class:"pf-metric-value"},M6={class:"pf-project-metric"},F6={class:"pf-metric-value",style:{color:"#16a34a"}},V6={class:"pf-project-metric"},$6={class:"pf-metric-value"},j6={class:"pf-investment-progress"},H6={class:"pf-progress-metrics"},W6={class:"pf-progress-metric"},Y6={class:"pf-progress-value"},G6={class:"pf-progress-metric"},K6={class:"pf-progress-value"},z6={class:"pf-progress-bar-container"},Q6={class:"pf-progress-bar"},J6={class:"pf-progress-text"},q6={class:"pf-project-actions"},Z6=["onClick"],X6=["onClick"],eN=["onClick"],tN=["onClick"],sN=["onClick"],nN=["onClick"],rN=["onClick"],iN=["onClick"],oN=["onClick"];function aN(t,e,s,n,r,i){return m(),g("div",G4,[a("div",K4,[a("header",z4,[a("h1",Q4,[r.isDetailView&&r.currentProduct?(m(),g(me,{key:0},[ne(p(r.currentProduct.name)+" - "+p(r.currentProduct.code),1)],64)):(m(),g(me,{key:1},[ne(" To Be Listed ")],64))]),a("p",J4,[r.isDetailView&&r.currentProduct?(m(),g(me,{key:0},[ne(p(r.currentProduct.subtitle),1)],64)):B("",!0)])]),r.isDetailView?B("",!0):(m(),g("div",q4,[Pe(a("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.filters.q=o),class:"input",placeholder:"Search code/name/subtitle",style:{"max-width":"240px",height:"38px"}},null,512),[[Ze,r.filters.q]]),Pe(a("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.filters.type=o),class:"input",style:{"max-width":"160px",height:"38px"}},[...e[20]||(e[20]=[Nt('<option value="" data-v-0a3cbb69>All Types</option><option value="Single House" data-v-0a3cbb69>Single House</option><option value="Commercial Building" data-v-0a3cbb69>Commercial Building</option><option value="Unit Development" data-v-0a3cbb69>Unit Development</option><option value="Residential Land" data-v-0a3cbb69>Residential Land</option><option value="Mixed Use" data-v-0a3cbb69>Mixed Use</option><option value="Retail" data-v-0a3cbb69>Retail</option><option value="Office" data-v-0a3cbb69>Office</option><option value="Industrial" data-v-0a3cbb69>Industrial</option><option value="Student Accommodation" data-v-0a3cbb69>Student Accommodation</option>',10)])],512),[[bs,r.filters.type]]),Pe(a("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>r.filters.status=o),class:"input",style:{"max-width":"160px",height:"38px"}},[...e[21]||(e[21]=[Nt('<option value="" data-v-0a3cbb69>All Status</option><option value="INCOMING" data-v-0a3cbb69>Incoming</option><option value="PERFORMING" data-v-0a3cbb69>Performing</option><option value="COMPLETED" data-v-0a3cbb69>Completed</option><option value="COMPLETE" data-v-0a3cbb69>Completed</option><option value="DEFAULT" data-v-0a3cbb69>Default</option>',6)])],512),[[bs,r.filters.status]]),a("div",Z4,[e[22]||(e[22]=a("label",{class:"yield-range-label"},"EST. YIELD (IRR) Range:",-1)),a("div",X4,[a("div",e6,[Pe(a("input",{type:"range","onUpdate:modelValue":e[3]||(e[3]=o=>r.filters.minYield=o),min:0,max:r.filters.maxYield-.5,step:.5,onInput:e[4]||(e[4]=(...o)=>i.onFilterChange&&i.onFilterChange(...o)),class:"yield-slider yield-slider-min"},null,40,t6),[[Ze,r.filters.minYield,void 0,{number:!0}]]),Pe(a("input",{type:"range","onUpdate:modelValue":e[5]||(e[5]=o=>r.filters.maxYield=o),min:r.filters.minYield+.5,max:20,step:.5,onInput:e[6]||(e[6]=(...o)=>i.onFilterChange&&i.onFilterChange(...o)),class:"yield-slider yield-slider-max"},null,40,s6),[[Ze,r.filters.maxYield,void 0,{number:!0}]])]),a("div",n6,p(r.filters.minYield)+"% - "+p(r.filters.maxYield)+"% ",1)])]),a("button",{class:"btn",onClick:e[7]||(e[7]=(...o)=>i.resetFilters&&i.resetFilters(...o))},"Reset")])),r.isDetailView?B("",!0):(m(),g("div",r6,[a("div",null,[ne(" Showing "+p(i.filteredProducts.length)+" of "+p(r.products.length)+" projects ",1),i.hasActiveFilters?(m(),g("span",i6,[a("button",{onClick:e[8]||(e[8]=(...o)=>i.resetFilters&&i.resetFilters(...o)),style:{background:"none",border:"none",color:"#3b82f6","text-decoration":"underline",cursor:"pointer"}}," Clear filters ")])):B("",!0)]),a("div",o6,[r.lastRefreshTime?(m(),g("span",a6," Last Updated: "+p(i.formatTime(r.lastRefreshTime)),1)):B("",!0),a("button",{onClick:e[9]||(e[9]=(...o)=>i.refreshProducts&&i.refreshProducts(...o)),disabled:r.loading,class:"refresh-btn",style:xt([{background:"#374151",border:"1px solid #4b5563",color:"#ffffff",padding:"6px 12px","border-radius":"6px","font-size":"12px",cursor:"pointer",transition:"all 0.2s ease"},{opacity:r.loading?.6:1,cursor:r.loading?"not-allowed":"pointer"}])},p(r.loading?"Refreshing...":"Refresh Data"),13,l6)])])),r.loading?(m(),g("div",c6,[...e[23]||(e[23]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Loading product data...",-1)])])):r.error?(m(),g("div",u6,[a("div",d6,[e[24]||(e[24]=a("h3",null,"Load Failed",-1)),a("button",{onClick:e[10]||(e[10]=(...o)=>i.loadProducts&&i.loadProducts(...o)),class:"btn retry-btn"},"Retry")])])):r.isDetailView&&r.currentProduct?(m(),g("section",f6,[a("article",h6,[a("div",p6,[a("div",m6,[a("section",g6,[a("div",y6,[a("h2",{id:"title-"+r.currentProduct.code},[a("span",b6,p(r.currentProduct.code),1),a("span",w6,p(r.currentProduct.name),1)],8,v6),a("div",{class:be(["status-badge","status-"+r.currentProduct.status])},p(i.getStatusText(r.currentProduct.status)),3)]),a("p",A6,p(r.currentProduct.subtitle),1),a("div",E6,[a("div",_6,[e[25]||(e[25]=a("span",{class:"info-label"},"Type:",-1)),a("span",T6,p(r.currentProduct.type),1)])])]),e[26]||(e[26]=a("hr",{class:"sep"},null,-1))])]),a("div",P6,[a("div",k6,[a("div",S6,[a("div",{class:"progress-fill",style:xt({width:i.getProgressPercentage(r.currentProduct)+"%"})},null,4),a("div",{class:"progress-empty",style:xt({width:100-i.getProgressPercentage(r.currentProduct)+"%"})},null,4)]),a("span",C6,p(i.getProgressPercentage(r.currentProduct))+"%",1)]),a("div",I6,[r.currentProduct.status==="ACTIVE"?(m(),g(me,{key:0},[a("a",{href:"#",class:"btn small orange",onClick:e[11]||(e[11]=ue(o=>i.openTrade(r.currentProduct.code),["prevent"]))},"Buy"),a("a",{href:"#",class:"btn small",onClick:e[12]||(e[12]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"Detail")],64)):r.currentProduct.status==="INCOMING"?(m(),g(me,{key:1},[a("a",{href:"#",class:"btn small",onClick:e[13]||(e[13]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"Preview"),a("a",{href:"#",class:"btn small",onClick:e[14]||(e[14]=ue(o=>i.joinWaitlist(r.currentProduct.code),["prevent"]))},"Join Waitlist")],64)):r.currentProduct.status==="PERFORMING"?(m(),g("a",{key:2,href:"#",class:"btn small",onClick:e[15]||(e[15]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):r.currentProduct.status==="COMPLETED"?(m(),g("a",{key:3,href:"#",class:"btn small",onClick:e[16]||(e[16]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):r.currentProduct.status==="COMPLETE"?(m(),g("a",{key:4,href:"#",class:"btn small",onClick:e[17]||(e[17]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):r.currentProduct.status==="DEFAULT"?(m(),g("a",{key:5,href:"#",class:"btn small",onClick:e[18]||(e[18]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):(m(),g("a",{key:6,href:"#",class:"btn small",onClick:e[19]||(e[19]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"Learn More"))])])])])):(m(),g("section",R6,[(m(!0),g(me,null,dt(i.filteredProducts,o=>(m(),g("article",{key:o.code,class:"pf-project-card","aria-labelledby":"'title-' + p.code"},[a("div",D6,[a("img",{src:o.image,class:"pf-project-image",alt:o.code},null,8,x6),a("div",N6,[a("h4",{id:"title-"+o.code},p(o.code)+" • "+p(o.name),9,L6),a("p",null,p(o.subtitle),1)]),a("div",{class:be(["status-badge","status-"+o.status])},p(i.getStatusText(o.status)),3)]),a("div",O6,[a("div",U6,[e[27]||(e[27]=a("span",{class:"pf-metric-label"},"LOAN SIZE",-1)),a("span",B6,p(o.loanAmount),1)]),a("div",M6,[e[28]||(e[28]=a("span",{class:"pf-metric-label"},"EST. YIELD (IRR)",-1)),a("span",F6,p(o.metrics.targetLoanYield),1)]),a("div",V6,[e[29]||(e[29]=a("span",{class:"pf-metric-label"},"TERM",-1)),a("span",$6,p(o.loanTerm),1)])]),a("div",j6,[a("div",H6,[a("div",W6,[e[30]||(e[30]=a("span",{class:"pf-progress-label"},"SUBSCRIBED",-1)),a("span",Y6,p(i.formatNumber(o.subscribed||0)),1)]),a("div",G6,[e[31]||(e[31]=a("span",{class:"pf-progress-label"},"TOTAL OFFERING",-1)),a("span",K6,p(i.formatNumber(o.totalOffering||0)),1)])]),a("div",z6,[a("div",Q6,[a("div",{class:"pf-progress-fill",style:xt({width:i.getSubscriptionProgress(o)+"%"})},null,4)]),a("div",J6,p(i.getSubscriptionProgress(o))+"% Subscribed",1)])]),a("div",q6,[o.status==="ACTIVE"?(m(),g(me,{key:0},[a("button",{class:"pf-project-btn pf-project-btn-secondary",onClick:l=>i.openTrade(o.code)},"BUY",8,Z6),a("button",{class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,X6)],64)):o.status==="INCOMING"?(m(),g(me,{key:1},[a("button",{class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,eN),a("button",{class:"pf-project-btn",onClick:l=>i.joinWaitlist(o.code)},"ADD TO WATCHLIST",8,tN)],64)):o.status==="PERFORMING"?(m(),g("button",{key:2,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,sN)):o.status==="COMPLETED"?(m(),g("button",{key:3,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,nN)):o.status==="COMPLETE"?(m(),g("button",{key:4,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,rN)):o.status==="DEFAULT"?(m(),g("button",{key:5,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,iN)):(m(),g("button",{key:6,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,oN))])]))),128))]))])])}const Yf=It(Y4,[["render",aN],["__scopeId","data-v-0a3cbb69"]]),lN={name:"AdminProjectsView",props:{code:{type:String,default:null}},data(){return{filters:{q:"",type:"",status:"",minYield:0,maxYield:20},products:[],currentProduct:null,loading:!0,error:null,refreshInterval:null,lastRefreshTime:null,isDetailView:!1}},async mounted(){this.isDetailView=!!this.code,this.isDetailView?await this.loadSingleProduct():await this.loadProducts(),this.setupDatabaseSync()},beforeUnmount(){this.cleanupDatabaseSync()},watch:{$route(t,e){t.params.code!==e.params.code&&(this.code=t.params.code,this.isDetailView=!!this.code,this.isDetailView?this.loadSingleProduct():this.loadProducts())},code:{handler(t){this.isDetailView=!!t,this.isDetailView?this.loadSingleProduct():this.loadProducts()},immediate:!0}},methods:{async loadSingleProduct(){try{this.loading=!0,this.error=null,console.log("🔄 ProjectsView: 从数据库加载单个产品数据...",this.code);const t=await Kt.getProductByCode(this.code);if(t.status===0){const e=t.data,s={...e,totalOffering:e.total_token,subscribed:e.current_subscribed_token,targetYield:e.target_yield,ltv:e.LTV,annualInterestRate:e.annual_interest_rate,loanAmount:e.loan_amount,valuation:e.valuation,image:e.image||this.getProductImage(e.code),totalOfferingRaw:e.total_token||0,subscribedRaw:e.current_subscribed_token||0};this.currentProduct={code:s.code,name:s.name,image:s.image,subtitle:s.subtitle,type:s.type,risk:s.risk,targetYield:s.targetYield,status:s.status,summary:s.summary,totalOffering:s.totalOffering,subscribed:s.subscribed,totalSubscriptionTokens:s.totalSubscriptionTokens,subscribedTokens:s.subscribedTokens,metrics:{currentElaraPrice:this.calculateTokenPrice(s),collateralPropertyValue:s.valuation||"TBA",rentalIncome:this.calculateRentalIncome(s),targetLoanYield:`${s.targetYield}% p.a.`},loanAmount:s.loanAmount,annualInterestRate:s.annualInterestRate,loanTerm:s.loanTerm,ltv:s.ltv,drawdownDate:s.drawdownDate,earlyRepayment:s.earlyRepayment,repaymentArrangement:s.repaymentArrangement,issuer:s.issuer,pwShareholders:s.pwShareholders,lender:s.lender,borrower:s.borrower,guarantor:s.guarantor,disbursementMethod:s.disbursementMethod,interest:s.interest,earlyRepaymentDetails:s.earlyRepaymentDetails,maturityDate:s.maturityDate,propertyAddress:s.propertyAddress,valuation:s.valuation,securityRank:s.securityRank,defaultInterestRate:s.defaultInterestRate,defaultTriggers:s.defaultTriggers,defaultProcess:s.defaultProcess,issuerToken:s.issuerToken,loanToken:s.loanToken,valuationReport:s.valuationReport,mortgageDeed:s.mortgageDeed},this.lastRefreshTime=new Date,console.log("✅ ProjectsView: 单个产品数据加载成功:",this.currentProduct)}else this.error=t.message||"获取产品数据失败",console.error("❌ ProjectsView: API返回错误:",t)}catch(t){this.error="网络错误，无法获取产品数据",console.error("❌ ProjectsView: 获取单个产品数据失败:",t)}finally{this.loading=!1}},async loadProducts(){try{this.loading=!0,this.error=null,console.log("🔄 从数据库加载产品数据...");const t=await Kt.getAllProducts();t.status===0?(this.products=(t.data||[]).map(e=>{const s={id:e.id,code:e.code,name:e.name,status:e.status,totalOffering:e.total_offering_token?`AUD$${e.total_offering_token.toLocaleString()}`:"AUD$0",subscribed:e.subscribe_token?`AUD$${e.subscribe_token.toLocaleString()}`:"AUD$0",totalOfferingRaw:e.total_offering_token||0,subscribedRaw:e.subscribe_token||0,property_location:e.propertyLocation,property_state:e.propertyState,property_type:e.propertyType,property_value:e.propertyValue,property_summary:e.propertySummary,loan_type:e.loanType,loan_product:e.loanProduct,loan_amount:e.loanAmount,loan_purpose:e.loanPurpose,loan_term_months:e.loanTermMonths,lvr:e.lvr,interest_rate:e.interestRate,default_rate:e.defaultRate,commencement_date:e.commencementDate,expiry_date:e.expiryDate,expected_recovery_date:e.expectedRecoveryDate,subtitle:`${e.loanProduct} - ${e.propertyType}`,loanAmount:e.loanAmount?`AUD$${e.loanAmount.toLocaleString()}`:"AUD$0",loanTerm:`${e.loanTermMonths} months`,targetYield:e.interestRate,image:e.image||this.getProductImage(e.code)};return s.metrics={currentElaraPrice:this.calculateTokenPrice(s),collateralPropertyValue:e.propertyValue?`AUD$${e.propertyValue.toLocaleString()}`:"TBA",rentalIncome:this.calculateRentalIncome(s),targetLoanYield:`${e.interestRate}% p.a.`},s}),this.lastRefreshTime=new Date,console.log("✅ 产品数据加载成功，共",this.products.length,"个项目")):(this.error=t.message||"获取产品数据失败",console.error("❌ API返回错误:",t))}catch(t){this.error="网络错误，无法获取产品数据",console.error("❌ 加载产品数据失败:",t)}finally{this.loading=!1}},async refreshProducts(){console.log("🔄 手动刷新产品数据..."),this.isDetailView?await this.loadSingleProduct():await this.loadProducts()},setupDatabaseSync(){const{subscribeProducts:t,subscribeNewProjects:e,getLastRefreshTime:s}=Dr();this.unsubscribeProducts=t(r=>{console.log("📡 ProjectsView: 收到产品数据更新，共",r.length,"个项目"),this.products=r.map(i=>({...i,totalOffering:i.total_token,subscribed:i.current_subscribed_token,targetYield:i.target_yield,ltv:i.LTV,annualInterestRate:i.annual_interest_rate,totalOfferingRaw:i.total_token||0,subscribedRaw:i.current_subscribed_token||0,loanAmount:i.loan_amount,valuation:i.valuation,image:i.image||this.getProductImage(i.code)})),this.lastRefreshTime=new Date}),this.unsubscribeNewProjects=e(r=>{console.log("🆕 ProjectsView: 发现",r.length,"个新项目"),this.showNewProjectsNotification(r)});const n=s();n&&(this.lastRefreshTime=n)},cleanupDatabaseSync(){this.unsubscribeProducts&&this.unsubscribeProducts(),this.unsubscribeNewProjects&&this.unsubscribeNewProjects()},showNewProjectsNotification(t){if(t.length>0){const e=t.map(s=>s.name).join(", ");console.log("🆕 发现新项目:",e)}},startAutoRefresh(){this.refreshInterval=setInterval(()=>{console.log("🔄 自动刷新产品数据..."),this.loadProducts()},3e4)},stopAutoRefresh(){this.refreshInterval&&(clearInterval(this.refreshInterval),this.refreshInterval=null,console.log("⏹️ 停止自动刷新"))},formatCurrency(t){if(!t)return null;const e=parseFloat(t);return isNaN(e)?t:`AUD$${e.toLocaleString()}`},resetFilters(){this.filters={q:"",type:"",risk:"",status:"",minYield:0,maxYield:20}},onFilterChange(){console.log("筛选器变化:",this.filters),this.$forceUpdate()},openDetail(t){const e=this.products.find(n=>n.code===t);try{sessionStorage.setItem("lastProduct",JSON.stringify(e))}catch{}const s=e.project_id||t;this.$router.push({name:"detail",params:{id:s}})},openTrade(t){const e=this.products.find(s=>s.code===t);try{sessionStorage.setItem("lastProduct",JSON.stringify(e))}catch{}this.$router.push({name:"tradeProject",params:{code:t}})},getProgressPercentage(t){if(!t)return 0;const e=t.totalOfferingRaw||0,s=t.subscribedRaw||0;if(e===0)return 0;const n=s/e*100;return Math.min(Math.round(n),100)},getStatusText(t){return{INCOMING:"Incoming",ACTIVE:"Active",PERFORMING:"Performing",DEFAULT:"Default",COMPLETED:"Completed"}[t]||"Unknown"},joinWaitlist(t){this.addToWatchlist(t)},registerInterest(t){this.addToWatchlist(t)},addToWatchlist(t){try{let e=[];const s=localStorage.getItem("projectWatchlist");if(s&&(e=JSON.parse(s)),e.includes(t)){alert("This Project is already in your watchlist!");return}e.push(t),localStorage.setItem("projectWatchlist",JSON.stringify(e));const n=this.products.find(r=>r.code===t);alert(`Added ${n.name} to your watchlist!`),console.log("Added to watchlist:",t)}catch(e){console.error("❌ Projects: Failed to add to watchlist:",e),alert("Failed to add to watchlist, please try again")}},formatTime(t){if(!t)return"";const s=new Date-t,n=Math.floor(s/6e4);if(n<1)return"Just now";if(n<60)return`${n} minutes ago`;const r=Math.floor(n/60);return r<24?`${r} hours ago`:`${Math.floor(r/24)} days ago`},getProductImage(t){return{RWA001:"/pics/TYMU.png",RWA002:"/pics/SQNB.png",RWA003:"/pics/LZYT.png",YYD:"/pics/YYD.png",COMP:"/pics/TYMU.png"}[t]||"/pics/TYMU.png"},calculateTokenPrice(t){return`AUD$${(1*((t.targetYield||6)/6)).toFixed(2)}`},calculateRentalIncome(t){if(!t.valuation)return"TBA";const e=t.valuation.replace(/[AUD$,]/g,""),s=parseFloat(e),n=(t.targetYield||6)/12/100;return`AUD$${(s*n).toLocaleString("en-AU",{maximumFractionDigits:0})} / month`},getSubscriptionProgress(t){if(!t)return 0;const e=t.totalOfferingRaw||0,s=t.subscribedRaw||0;if(e===0)return 0;const n=s/e*100;return Math.round(n*100)/100},formatNumber(t){if(!t)return"0";const e=parseFloat(t);return isNaN(e)?t:e.toLocaleString()}},computed:{filteredProducts(){const t=this.filters.q.trim().toLowerCase();return this.products.filter(e=>{if(e.status==="ACTIVE"||e.status==="INCOMING")return!1;const s=!t||e.code.toLowerCase().includes(t)||(e.name||"").toLowerCase().includes(t)||(e.subtitle||"").toLowerCase().includes(t),n=!this.filters.type||e.property_type===this.filters.type,r=!this.filters.status||e.status===this.filters.status,i=parseFloat(e.targetYield)||0,o=i>=this.filters.minYield&&i<=this.filters.maxYield;return s&&n&&r&&o}).sort((e,s)=>e.code.localeCompare(s.code))},hasActiveFilters(){return this.filters.q.trim()!==""||this.filters.type!==""||this.filters.status!==""||this.filters.minYield>0||this.filters.maxYield<20},projectData(){const t=this.project;if(t)return console.log("TradeProjectView: Retrieve project data from database:",t),{code:t.code,name:t.name,image:t.image||this.getProductImage(t.code),subtitle:t.subtitle,type:t.type,risk:t.risk,targetYield:t.targetYield,status:t.status,summary:t.summary,totalOffering:t.totalOffering,subscribed:t.subscribed,totalSubscriptionTokens:t.totalSubscriptionTokens,subscribedTokens:t.subscribedTokens,metrics:{currentElaraPrice:this.calculateTokenPrice(t),collateralPropertyValue:t.valuation||"TBA",rentalIncome:this.calculateRentalIncome(t),targetLoanYield:`${t.targetYield}% p.a.`},loanAmount:t.loanAmount,annualInterestRate:t.annualInterestRate,loanTerm:t.loanTerm,ltv:t.ltv,drawdownDate:t.drawdownDate,earlyRepayment:t.earlyRepayment,repaymentArrangement:t.repaymentArrangement,issuer:t.issuer,pwShareholders:t.pwShareholders,lender:t.lender,borrower:t.borrower,guarantor:t.guarantor,disbursementMethod:t.disbursementMethod,interest:t.interest,earlyRepaymentDetails:t.earlyRepaymentDetails,maturityDate:t.maturityDate,propertyAddress:t.propertyAddress,valuation:t.valuation,securityRank:t.securityRank,defaultInterestRate:t.defaultInterestRate,defaultTriggers:t.defaultTriggers,defaultProcess:t.defaultProcess,issuerToken:t.issuerToken,loanToken:t.loanToken,valuationReport:t.valuationReport,mortgageDeed:t.mortgageDeed}}}},cN={class:"container"},uN={class:"project-container"},dN={class:"doc-header"},fN={class:"headline"},hN={class:"subline"},pN={key:0,class:"filters",style:{display:"flex",gap:"10px","flex-wrap":"wrap","align-items":"center",margin:"8px 0 6px"}},mN={class:"yield-range-filter"},gN={class:"yield-range-container"},yN={class:"yield-range-slider"},vN=["max"],bN=["min"],wN={class:"yield-range-display"},AN={key:1,class:"filter-stats",style:{margin:"8px 0",color:"var(--muted)","font-size":"14px",display:"flex","justify-content":"space-between","align-items":"center","flex-wrap":"wrap",gap:"8px"}},EN={key:0,style:{"margin-left":"12px"}},_N={style:{display:"flex","align-items":"center",gap:"12px"}},TN={key:0,style:{"font-size":"12px",color:"#6b7280"}},PN=["disabled"],kN={key:2,class:"loading-container"},SN={key:3,class:"error-container"},CN={class:"error-message"},IN={key:4,class:"doc-list"},RN={class:"doc-card","aria-labelledby":"'title-' + currentProduct.code"},DN={class:"main-content"},xN={class:"left-content"},NN={class:"title-section"},LN={class:"title-header"},ON=["id"],UN={class:"doc-code"},BN={class:"doc-name"},MN={class:"doc-subtitle"},FN={class:"project-basic-info"},VN={class:"info-item"},$N={class:"info-value"},jN={class:"progress-actions-row"},HN={class:"progress-container"},WN={class:"progress-bar"},YN={class:"progress-text"},GN={class:"doc-actions"},KN={key:5,class:"doc-list"},zN={class:"pf-project-header"},QN=["src","alt"],JN={class:"pf-project-info"},qN=["id"],ZN={class:"pf-project-metrics"},XN={class:"pf-project-metric"},eL={class:"pf-metric-value"},tL={class:"pf-project-metric"},sL={class:"pf-metric-value",style:{color:"#16a34a"}},nL={class:"pf-project-metric"},rL={class:"pf-metric-value"},iL={class:"pf-investment-progress"},oL={class:"pf-progress-metrics"},aL={class:"pf-progress-metric"},lL={class:"pf-progress-value"},cL={class:"pf-progress-metric"},uL={class:"pf-progress-value"},dL={class:"pf-progress-bar-container"},fL={class:"pf-progress-bar"},hL={class:"pf-progress-text"},pL={class:"pf-project-actions"},mL=["onClick"],gL=["onClick"],yL=["onClick"],vL=["onClick"],bL=["onClick"],wL=["onClick"],AL=["onClick"],EL=["onClick"],_L=["onClick"];function TL(t,e,s,n,r,i){return m(),g("div",cN,[a("div",uN,[a("header",dN,[a("h1",fN,[r.isDetailView&&r.currentProduct?(m(),g(me,{key:0},[ne(p(r.currentProduct.name)+" - "+p(r.currentProduct.code),1)],64)):(m(),g(me,{key:1},[ne(" Admin Projects ")],64))]),a("p",hN,[r.isDetailView&&r.currentProduct?(m(),g(me,{key:0},[ne(p(r.currentProduct.subtitle),1)],64)):B("",!0)])]),r.isDetailView?B("",!0):(m(),g("div",pN,[Pe(a("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>r.filters.q=o),class:"input",placeholder:"Search code/name/subtitle",style:{"max-width":"240px",height:"38px"}},null,512),[[Ze,r.filters.q]]),Pe(a("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>r.filters.type=o),class:"input",style:{"max-width":"160px",height:"38px"}},[...e[20]||(e[20]=[Nt('<option value="" data-v-5fbdd8f8>All Types</option><option value="Single House" data-v-5fbdd8f8>Single House</option><option value="Commercial Building" data-v-5fbdd8f8>Commercial Building</option><option value="Unit Development" data-v-5fbdd8f8>Unit Development</option><option value="Residential Land" data-v-5fbdd8f8>Residential Land</option><option value="Mixed Use" data-v-5fbdd8f8>Mixed Use</option><option value="Retail" data-v-5fbdd8f8>Retail</option><option value="Office" data-v-5fbdd8f8>Office</option><option value="Industrial" data-v-5fbdd8f8>Industrial</option><option value="Student Accommodation" data-v-5fbdd8f8>Student Accommodation</option>',10)])],512),[[bs,r.filters.type]]),Pe(a("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>r.filters.status=o),class:"input",style:{"max-width":"160px",height:"38px"}},[...e[21]||(e[21]=[Nt('<option value="" data-v-5fbdd8f8>All Status</option><option value="INCOMING" data-v-5fbdd8f8>Incoming</option><option value="ACTIVE" data-v-5fbdd8f8>Active</option><option value="PERFORMING" data-v-5fbdd8f8>Performing</option><option value="COMPLETED" data-v-5fbdd8f8>Completed</option><option value="COMPLETE" data-v-5fbdd8f8>Completed</option><option value="DEFAULT" data-v-5fbdd8f8>Default</option>',7)])],512),[[bs,r.filters.status]]),a("div",mN,[e[22]||(e[22]=a("label",{class:"yield-range-label"},"EST. YIELD (IRR) Range:",-1)),a("div",gN,[a("div",yN,[Pe(a("input",{type:"range","onUpdate:modelValue":e[3]||(e[3]=o=>r.filters.minYield=o),min:0,max:r.filters.maxYield-.5,step:.5,onInput:e[4]||(e[4]=(...o)=>i.onFilterChange&&i.onFilterChange(...o)),class:"yield-slider yield-slider-min"},null,40,vN),[[Ze,r.filters.minYield,void 0,{number:!0}]]),Pe(a("input",{type:"range","onUpdate:modelValue":e[5]||(e[5]=o=>r.filters.maxYield=o),min:r.filters.minYield+.5,max:20,step:.5,onInput:e[6]||(e[6]=(...o)=>i.onFilterChange&&i.onFilterChange(...o)),class:"yield-slider yield-slider-max"},null,40,bN),[[Ze,r.filters.maxYield,void 0,{number:!0}]])]),a("div",wN,p(r.filters.minYield)+"% - "+p(r.filters.maxYield)+"% ",1)])]),a("button",{class:"btn",onClick:e[7]||(e[7]=(...o)=>i.resetFilters&&i.resetFilters(...o))},"Reset")])),r.isDetailView?B("",!0):(m(),g("div",AN,[a("div",null,[ne(" Showing "+p(i.filteredProducts.length)+" of "+p(r.products.length)+" projects ",1),i.hasActiveFilters?(m(),g("span",EN,[a("button",{onClick:e[8]||(e[8]=(...o)=>i.resetFilters&&i.resetFilters(...o)),style:{background:"none",border:"none",color:"#3b82f6","text-decoration":"underline",cursor:"pointer"}}," Clear filters ")])):B("",!0)]),a("div",_N,[r.lastRefreshTime?(m(),g("span",TN," Last Updated: "+p(i.formatTime(r.lastRefreshTime)),1)):B("",!0),a("button",{onClick:e[9]||(e[9]=(...o)=>i.refreshProducts&&i.refreshProducts(...o)),disabled:r.loading,class:"refresh-btn",style:xt([{background:"#374151",border:"1px solid #4b5563",color:"#ffffff",padding:"6px 12px","border-radius":"6px","font-size":"12px",cursor:"pointer",transition:"all 0.2s ease"},{opacity:r.loading?.6:1,cursor:r.loading?"not-allowed":"pointer"}])},p(r.loading?"Refreshing...":"Refresh Data"),13,PN)])])),r.loading?(m(),g("div",kN,[...e[23]||(e[23]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Loading product data...",-1)])])):r.error?(m(),g("div",SN,[a("div",CN,[e[24]||(e[24]=a("h3",null,"Load Failed",-1)),a("button",{onClick:e[10]||(e[10]=(...o)=>i.loadProducts&&i.loadProducts(...o)),class:"btn retry-btn"},"Retry")])])):r.isDetailView&&r.currentProduct?(m(),g("section",IN,[a("article",RN,[a("div",DN,[a("div",xN,[a("section",NN,[a("div",LN,[a("h2",{id:"title-"+r.currentProduct.code},[a("span",UN,p(r.currentProduct.code),1),a("span",BN,p(r.currentProduct.name),1)],8,ON),a("div",{class:be(["status-badge","status-"+r.currentProduct.status])},p(i.getStatusText(r.currentProduct.status)),3)]),a("p",MN,p(r.currentProduct.subtitle),1),a("div",FN,[a("div",VN,[e[25]||(e[25]=a("span",{class:"info-label"},"Type:",-1)),a("span",$N,p(r.currentProduct.type),1)])])]),e[26]||(e[26]=a("hr",{class:"sep"},null,-1))])]),a("div",jN,[a("div",HN,[a("div",WN,[a("div",{class:"progress-fill",style:xt({width:i.getProgressPercentage(r.currentProduct)+"%"})},null,4),a("div",{class:"progress-empty",style:xt({width:100-i.getProgressPercentage(r.currentProduct)+"%"})},null,4)]),a("span",YN,p(i.getProgressPercentage(r.currentProduct))+"%",1)]),a("div",GN,[r.currentProduct.status==="ACTIVE"?(m(),g(me,{key:0},[a("a",{href:"#",class:"btn small orange",onClick:e[11]||(e[11]=ue(o=>i.openTrade(r.currentProduct.code),["prevent"]))},"Buy"),a("a",{href:"#",class:"btn small",onClick:e[12]||(e[12]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"Detail")],64)):r.currentProduct.status==="INCOMING"?(m(),g(me,{key:1},[a("a",{href:"#",class:"btn small",onClick:e[13]||(e[13]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"Preview"),a("a",{href:"#",class:"btn small",onClick:e[14]||(e[14]=ue(o=>i.joinWaitlist(r.currentProduct.code),["prevent"]))},"Join Waitlist")],64)):r.currentProduct.status==="PERFORMING"?(m(),g("a",{key:2,href:"#",class:"btn small",onClick:e[15]||(e[15]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):r.currentProduct.status==="COMPLETED"?(m(),g("a",{key:3,href:"#",class:"btn small",onClick:e[16]||(e[16]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):r.currentProduct.status==="COMPLETE"?(m(),g("a",{key:4,href:"#",class:"btn small",onClick:e[17]||(e[17]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):r.currentProduct.status==="DEFAULT"?(m(),g("a",{key:5,href:"#",class:"btn small",onClick:e[18]||(e[18]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"View Details")):(m(),g("a",{key:6,href:"#",class:"btn small",onClick:e[19]||(e[19]=ue(o=>i.openDetail(r.currentProduct.code),["prevent"]))},"Learn More"))])])])])):(m(),g("section",KN,[(m(!0),g(me,null,dt(i.filteredProducts,o=>(m(),g("article",{key:o.code,class:"pf-project-card","aria-labelledby":"'title-' + p.code"},[a("div",zN,[a("img",{src:o.image,class:"pf-project-image",alt:o.code},null,8,QN),a("div",JN,[a("h4",{id:"title-"+o.code},p(o.code)+" • "+p(o.name),9,qN),a("p",null,p(o.subtitle),1)]),a("div",{class:be(["status-badge","status-"+o.status])},p(i.getStatusText(o.status)),3)]),a("div",ZN,[a("div",XN,[e[27]||(e[27]=a("span",{class:"pf-metric-label"},"LOAN SIZE",-1)),a("span",eL,p(o.loanAmount),1)]),a("div",tL,[e[28]||(e[28]=a("span",{class:"pf-metric-label"},"EST. YIELD (IRR)",-1)),a("span",sL,p(o.metrics.targetLoanYield),1)]),a("div",nL,[e[29]||(e[29]=a("span",{class:"pf-metric-label"},"TERM",-1)),a("span",rL,p(o.loanTerm),1)])]),a("div",iL,[a("div",oL,[a("div",aL,[e[30]||(e[30]=a("span",{class:"pf-progress-label"},"SUBSCRIBED",-1)),a("span",lL,p(i.formatNumber(o.subscribed||0)),1)]),a("div",cL,[e[31]||(e[31]=a("span",{class:"pf-progress-label"},"TOTAL OFFERING",-1)),a("span",uL,p(i.formatNumber(o.totalOffering||0)),1)])]),a("div",dL,[a("div",fL,[a("div",{class:"pf-progress-fill",style:xt({width:i.getSubscriptionProgress(o)+"%"})},null,4)]),a("div",hL,p(i.getSubscriptionProgress(o))+"% Subscribed",1)])]),a("div",pL,[o.status==="ACTIVE"?(m(),g(me,{key:0},[a("button",{class:"pf-project-btn pf-project-btn-secondary",onClick:l=>i.openTrade(o.code)},"BUY",8,mL),a("button",{class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,gL)],64)):o.status==="INCOMING"?(m(),g(me,{key:1},[a("button",{class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,yL),a("button",{class:"pf-project-btn",onClick:l=>i.joinWaitlist(o.code)},"ADD TO WATCHLIST",8,vL)],64)):o.status==="PERFORMING"?(m(),g("button",{key:2,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,bL)):o.status==="COMPLETED"?(m(),g("button",{key:3,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,wL)):o.status==="COMPLETE"?(m(),g("button",{key:4,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,AL)):o.status==="DEFAULT"?(m(),g("button",{key:5,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,EL)):(m(),g("button",{key:6,class:"pf-project-btn",onClick:l=>i.openDetail(o.code)},"DETAILS",8,_L))])]))),128))]))])])}const Gf=It(lN,[["render",TL],["__scopeId","data-v-5fbdd8f8"]]),PL={name:"ContactUsView",data(){return{form:{name:"",email:"",phone:"",subject:"",message:""},errors:{},isSubmitting:!1,submitSuccess:!1}},methods:{async submitForm(){if(this.errors={},!!this.validateForm()){this.isSubmitting=!0;try{await this.sendContactForm(),this.submitSuccess=!0,this.form={name:"",email:"",phone:"",subject:"",message:""},setTimeout(()=>{this.submitSuccess=!1},5e3)}catch(t){console.error("Failed to submit form:",t),alert("Failed to send message. Please try again or contact us directly.")}finally{this.isSubmitting=!1}}},validateForm(){let t=!0;this.form.name.trim()?this.form.name.trim().length<2&&(this.errors.name="Name must be at least 2 characters",t=!1):(this.errors.name="Name is required",t=!1);const e=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return this.form.email.trim()?e.test(this.form.email)||(this.errors.email="Please enter a valid email address",t=!1):(this.errors.email="Email is required",t=!1),this.form.subject||(this.errors.subject="Please select a subject",t=!1),this.form.message.trim()?this.form.message.trim().length<10?(this.errors.message="Message must be at least 10 characters",t=!1):this.form.message.length>1e3&&(this.errors.message="Message must be less than 1000 characters",t=!1):(this.errors.message="Message is required",t=!1),t},async sendContactForm(){return new Promise((t,e)=>{setTimeout(()=>{console.log("Contact form submitted:",this.form),t()},2e3)})}}},kL={class:"container"},SL={class:"contact-page"},CL={class:"contact-content"},IL={class:"contact-grid"},RL={class:"contact-form"},DL={class:"form-fields"},xL={class:"form-row"},NL={class:"form-group"},LL={key:0,class:"error-message"},OL={class:"form-group"},UL={key:0,class:"error-message"},BL={class:"form-row"},ML={class:"form-group"},FL={class:"form-group"},VL={key:0,class:"error-message"},$L={class:"form-group"},jL={key:0,class:"error-message"},HL={class:"character-count"},WL={class:"form-submit"},YL=["disabled"],GL={key:0,class:"loading-spinner"},KL={key:0,class:"success-message"};function zL(t,e,s,n,r,i){return m(),g("div",kL,[a("div",SL,[e[18]||(e[18]=a("header",{class:"page-header"},[a("h1",{class:"headline"},"Contact Us"),a("p",{class:"subline"},"We are here to help you with your RWA investment journey")],-1)),a("div",CL,[a("div",IL,[e[16]||(e[16]=Nt('<div class="contact-info" data-v-a36fad51><h2 data-v-a36fad51>Get in Touch</h2><p class="info-description" data-v-a36fad51>Choose your preferred way to reach us</p><div class="contact-methods" data-v-a36fad51><div class="contact-method" data-v-a36fad51><div class="method-icon" data-v-a36fad51>📧</div><div class="method-details" data-v-a36fad51><h4 data-v-a36fad51>Email Support</h4><p data-v-a36fad51>support@mortgagerwa.com</p><p data-v-a36fad51>business@mortgagerwa.com</p><span class="response-time" data-v-a36fad51>Response within 24 hours</span></div></div><div class="contact-method" data-v-a36fad51><div class="method-icon" data-v-a36fad51>📞</div><div class="method-details" data-v-a36fad51><h4 data-v-a36fad51>Phone Support</h4><p data-v-a36fad51>+61 2 1234 5678</p><p data-v-a36fad51>Monday to Friday 9:00-18:00 (AEST)</p><span class="response-time" data-v-a36fad51>Immediate assistance</span></div></div><div class="contact-method" data-v-a36fad51><div class="method-icon" data-v-a36fad51>📍</div><div class="method-details" data-v-a36fad51><h4 data-v-a36fad51>Office Address</h4><p data-v-a36fad51>Level 15, 123 George Street</p><p data-v-a36fad51>Sydney NSW 2000, Australia</p><span class="response-time" data-v-a36fad51>Visit by appointment</span></div></div><div class="contact-method" data-v-a36fad51><div class="method-icon" data-v-a36fad51>💬</div><div class="method-details" data-v-a36fad51><h4 data-v-a36fad51>Live Chat</h4><p data-v-a36fad51>24/7 Online Support</p><p data-v-a36fad51>Average Response Time &lt; 5 minutes</p><span class="response-time" data-v-a36fad51>Real-time support</span></div></div></div><div class="social-section" data-v-a36fad51><h3 data-v-a36fad51>Follow Us</h3><p data-v-a36fad51>Stay updated with our latest news and updates</p><div class="social-links" data-v-a36fad51><a href="#" class="social-link" title="Twitter" data-v-a36fad51><span class="social-icon" data-v-a36fad51>🐦</span><span class="social-label" data-v-a36fad51>Twitter</span></a><a href="#" class="social-link" title="LinkedIn" data-v-a36fad51><span class="social-icon" data-v-a36fad51>💼</span><span class="social-label" data-v-a36fad51>LinkedIn</span></a><a href="#" class="social-link" title="Facebook" data-v-a36fad51><span class="social-icon" data-v-a36fad51>📘</span><span class="social-label" data-v-a36fad51>Facebook</span></a><a href="#" class="social-link" title="GitHub" data-v-a36fad51><span class="social-icon" data-v-a36fad51>🐙</span><span class="social-label" data-v-a36fad51>GitHub</span></a></div></div></div>',1)),a("div",RL,[e[14]||(e[14]=a("h2",null,"Send us a Message",-1)),e[15]||(e[15]=a("p",{class:"form-description"},"Fill out the form below and we'll get back to you as soon as possible",-1)),a("form",{onSubmit:e[5]||(e[5]=ue((...o)=>i.submitForm&&i.submitForm(...o),["prevent"])),class:"form-container"},[a("div",DL,[a("div",xL,[a("div",NL,[e[6]||(e[6]=a("label",{for:"name"},"Full Name *",-1)),Pe(a("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=o=>r.form.name=o),required:"",placeholder:"Enter your full name",class:be({error:r.errors.name})},null,2),[[Ze,r.form.name]]),r.errors.name?(m(),g("span",LL,p(r.errors.name),1)):B("",!0)]),a("div",OL,[e[7]||(e[7]=a("label",{for:"email"},"Email Address *",-1)),Pe(a("input",{type:"email",id:"email","onUpdate:modelValue":e[1]||(e[1]=o=>r.form.email=o),required:"",placeholder:"Enter your email address",class:be({error:r.errors.email})},null,2),[[Ze,r.form.email]]),r.errors.email?(m(),g("span",UL,p(r.errors.email),1)):B("",!0)])]),a("div",BL,[a("div",ML,[e[8]||(e[8]=a("label",{for:"phone"},"Phone Number",-1)),Pe(a("input",{type:"tel",id:"phone","onUpdate:modelValue":e[2]||(e[2]=o=>r.form.phone=o),placeholder:"Enter your phone number"},null,512),[[Ze,r.form.phone]])]),a("div",FL,[e[10]||(e[10]=a("label",{for:"subject"},"Subject *",-1)),Pe(a("select",{id:"subject","onUpdate:modelValue":e[3]||(e[3]=o=>r.form.subject=o),required:"",class:be({error:r.errors.subject})},[...e[9]||(e[9]=[Nt('<option value="" data-v-a36fad51>Please select a subject</option><option value="investor" data-v-a36fad51>I am an Investor / Interested in Investing</option><option value="asset_holder" data-v-a36fad51>I am an Asset Holder / Property Owner</option><option value="general" data-v-a36fad51>General Consultation</option><option value="technical" data-v-a36fad51>Technical Support</option><option value="business" data-v-a36fad51>Business Partnership</option><option value="media" data-v-a36fad51>Media Inquiry</option><option value="other" data-v-a36fad51>Other</option>',8)])],2),[[bs,r.form.subject]]),r.errors.subject?(m(),g("span",VL,p(r.errors.subject),1)):B("",!0)])]),a("div",$L,[e[11]||(e[11]=a("label",{for:"message"},"Message *",-1)),Pe(a("textarea",{id:"message","onUpdate:modelValue":e[4]||(e[4]=o=>r.form.message=o),rows:"6",required:"",placeholder:"Please describe your inquiry in detail...",class:be({error:r.errors.message})},null,2),[[Ze,r.form.message]]),r.errors.message?(m(),g("span",jL,p(r.errors.message),1)):B("",!0),a("div",HL,p(r.form.message.length)+"/1000",1)])]),a("div",WL,[a("button",{type:"submit",class:"btn primary",disabled:r.isSubmitting},[r.isSubmitting?(m(),g("span",GL)):B("",!0),ne(" "+p(r.isSubmitting?"Sending Message...":"Send Message"),1)],8,YL),e[12]||(e[12]=a("p",{class:"form-note"},[ne(" By submitting this form, you agree to our "),a("a",{href:"/terms",target:"_blank"},"Terms of Service"),ne(" and "),a("a",{href:"/privacy",target:"_blank"},"Privacy Policy")],-1))])],32),r.submitSuccess?(m(),g("div",KL,[...e[13]||(e[13]=[a("div",{class:"success-icon"},"✅",-1),a("h3",null,"Message Sent Successfully!",-1),a("p",null,"Thank you for contacting us. We'll get back to you within 24 hours.",-1)])])):B("",!0)])]),e[17]||(e[17]=Nt('<div class="faq-section" data-v-a36fad51><h2 data-v-a36fad51>Frequently Asked Questions</h2><div class="faq-grid" data-v-a36fad51><div class="faq-item" data-v-a36fad51><h4 data-v-a36fad51>How do I start investing?</h4><p data-v-a36fad51>Simply connect your wallet, complete KYC verification, and browse our available projects. You can start with as little as $100 AUD.</p></div><div class="faq-item" data-v-a36fad51><h4 data-v-a36fad51>What are the investment returns?</h4><p data-v-a36fad51>Our RWA projects typically offer 8-15% annual returns with monthly interest payments. Returns vary by project risk and duration.</p></div><div class="faq-item" data-v-a36fad51><h4 data-v-a36fad51>Is my investment secure?</h4><p data-v-a36fad51>Yes, all investments are backed by real estate assets and protected by smart contracts. We also provide comprehensive insurance coverage.</p></div><div class="faq-item" data-v-a36fad51><h4 data-v-a36fad51>How do I withdraw my funds?</h4><p data-v-a36fad51>You can withdraw your funds at any time through our platform. Withdrawals are processed within 1-3 business days.</p></div></div></div>',1))])])])}const QL=It(PL,[["render",zL],["__scopeId","data-v-a36fad51"]]);class JL{constructor(){this.baseUrl="/api/contract-test",this.realTokenAddresses={sepolia:{lpt:"0x45b1eCb3D9af651244eC656ed15B86404924c354",lit:"0xE6aeE4a898c6d99033ee5380Df407C5DD470fb17",kycRegistry:"0x4533f47BE0ce8b80F7bbdF02939f81F4A15b7A45",loanIssuer:"0x13159e6417D98528C220b12Ec4950D5A343E5eAA"},ethereum:{lpt:"0x45b1eCb3D9af651244eC656ed15B86404924c354",lit:"0xE6aeE4a898c6d99033ee5380Df407C5DD470fb17",kycRegistry:"0x4533f47BE0ce8b80F7bbdF02939f81F4A15b7A45",loanIssuer:"0x13159e6417D98528C220b12Ec4950D5A343E5eAA"}}}async deployContracts(e,s){try{return await this.delay(2e3),{success:!0,contracts:{kycRegistry:this.generateMockAddress(),lpt:this.generateMockAddress(),lit:this.generateMockAddress(),loanIssuer:this.generateMockAddress()},transactionHash:this.generateMockTxHash(),gasUsed:"2,500,000",blockNumber:Math.floor(Math.random()*1e6)+1e6}}catch(n){throw new Error(`部署失败: ${n.message}`)}}async deployContractsWithSubscription(e){try{if(!e.chainId)throw new Error("链ID未提供");if(!e.walletAddress)throw new Error("钱包地址未提供");await this.delay(2e3);const s=this.getNetworkInfo(e.chainId),n=this.getRealContractAddresses(e.chainId),r={kycRegistry:n.kycRegistry,lpt:n.lpt,lit:n.lit,loanIssuer:n.loanIssuer},i=Math.floor(Math.random()*1e3)+1;return{success:!0,contracts:r,loanId:i,transactionHash:this.generateMockTxHash(),gasUsed:"3,200,000",blockNumber:Math.floor(Math.random()*1e6)+1e6,networkInfo:s,subscriptionData:{amount:e.subscriptionAmount,rate:e.annualRate,term:e.loanTerm,projectCode:e.projectCode,projectName:e.projectName}}}catch(s){throw new Error(`认购部署失败: ${s.message}`)}}async testContractInteraction(e,s){try{return await this.delay(1500),{success:!0,results:{initialBalances:{lpt:"0.0",lit:"0.0",eth:"1.5"},loanCreated:{loanId:1,principalAmount:"1000.0",annualRate:"5.0%",borrower:"Alice",lender:"Bank"},interestMinted:{amount:"50.0",recipient:s},redemption:{lptAmount:"200.0",litAmount:"10.0"},finalBalances:{lpt:"800.0",lit:"40.0",eth:"1.5"},loanClosed:!0},transactions:[{type:"createLoan",hash:this.generateMockTxHash()},{type:"mintInterest",hash:this.generateMockTxHash()},{type:"redeem",hash:this.generateMockTxHash()},{type:"closeLoan",hash:this.generateMockTxHash()}]}}catch(n){throw new Error(`交互测试失败: ${n.message}`)}}async getBalances(e,s){try{return await this.delay(500),{success:!0,balances:{lpt:(Math.random()*1e3).toFixed(2),lit:(Math.random()*100).toFixed(2),eth:(Math.random()*5).toFixed(4)},lastUpdated:new Date().toISOString()}}catch(n){throw new Error(`余额查询失败: ${n.message}`)}}async validateContractAddresses(e){try{await this.delay(300);const s={lpt:this.isValidAddress(e.lpt),lit:this.isValidAddress(e.lit),issuer:this.isValidAddress(e.issuer)},n=Object.values(s).every(r=>r);return{success:n,validation:s,message:n?"所有地址格式正确":"部分地址格式不正确"}}catch(s){throw new Error(`地址验证失败: ${s.message}`)}}async getNetworkInfo(){try{return await this.delay(200),{success:!0,network:{name:"Sepolia Testnet",chainId:11155111,rpcUrl:"https://sepolia.infura.io/v3/your-api-key",blockExplorer:"https://sepolia.etherscan.io"}}}catch(e){throw new Error(`网络信息获取失败: ${e.message}`)}}async getContractABI(e){try{return await this.delay(300),{success:!0,abi:{kycRegistry:this.getMockKYCRegistryABI(),certificateToken:this.getMockCertificateTokenABI(),loanIssuer:this.getMockLoanIssuerABI()}[e]||[]}}catch(s){throw new Error(`ABI获取失败: ${s.message}`)}}async getContractTerms(){try{return await this.delay(200),{success:!0,terms:{annualRate:5.5,loanTerm:365,minSubscription:100,maxSubscription:1e4}}}catch(e){throw new Error(`合约条款获取失败: ${e.message}`)}}async getAvailableProjects(){try{return await this.delay(300),{success:!0,projects:[{code:"RWA001",name:"悉尼住宅项目",description:"位于悉尼市中心的优质住宅项目",status:"active"},{code:"RWA002",name:"墨尔本商业地产",description:"墨尔本CBD核心商业地产项目",status:"active"},{code:"RWA003",name:"布里斯班物流仓储",description:"布里斯班港口物流仓储设施",status:"active"},{code:"RWA004",name:"珀斯写字楼项目",description:"珀斯金融区甲级写字楼",status:"active"},{code:"RWA005",name:"阿德莱德工业地产",description:"阿德莱德工业园制造设施",status:"active"}]}}catch(e){throw new Error(`项目列表获取失败: ${e.message}`)}}getNetworkInfo(e){return{1:{name:"Ethereum Mainnet",shortName:"ETH",networkKey:"ethereum"},11155111:{name:"Sepolia Testnet",shortName:"Sepolia",networkKey:"sepolia"}}[e]||{name:`Unknown Network (${e})`,shortName:`Chain ${e}`,networkKey:"sepolia"}}getRealContractAddresses(e){const n=this.getNetworkInfo(e).networkKey||"sepolia";return this.realTokenAddresses[n]||this.realTokenAddresses.sepolia}delay(e){return new Promise(s=>setTimeout(s,e))}generateMockAddress(){const e="0123456789abcdef";let s="0x";for(let n=0;n<40;n++)s+=e[Math.floor(Math.random()*e.length)];return s}generateMockTxHash(){const e="0123456789abcdef";let s="0x";for(let n=0;n<64;n++)s+=e[Math.floor(Math.random()*e.length)];return s}isValidAddress(e){return e&&e.startsWith("0x")&&e.length===42&&/^0x[0-9a-fA-F]{40}$/.test(e)}getMockKYCRegistryABI(){return[{inputs:[{name:"user",type:"address"},{name:"level",type:"uint8"}],name:"setKycLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"user",type:"address"}],name:"getKycLevel",outputs:[{name:"",type:"uint8"}],stateMutability:"view",type:"function"}]}getMockCertificateTokenABI(){return[{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{name:"",type:"string"}],stateMutability:"view",type:"function"}]}getMockLoanIssuerABI(){return[{inputs:[{name:"holder",type:"address"},{name:"principalAmount",type:"uint256"},{name:"annualRateBps",type:"uint256"},{name:"startDate",type:"uint256"},{name:"dueDate",type:"uint256"},{name:"borrower",type:"string"},{name:"lender",type:"string"},{name:"collateral",type:"string"},{name:"note",type:"string"}],name:"createLoan",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"loanId",type:"uint256"},{name:"to",type:"address"},{name:"amount",type:"uint256"}],name:"mintInterest",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"loanId",type:"uint256"},{name:"lptAmount",type:"uint256"},{name:"litAmount",type:"uint256"}],name:"redeem",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"loanId",type:"uint256"}],name:"closeLoan",outputs:[],stateMutability:"nonpayable",type:"function"}]}}const Kf=new JL;zt();const qL={name:"TradeProjectView",props:{code:{type:String,required:!1,default:null}},data(){return{tradeType:"buy",tradeAmount:"",walletActivity:[],loading:!1,error:null,errorType:null,isInterestTrade:!1,showSuccessModal:!1,showInsufficientBalanceModal:!1,showLoadingModal:!1,loadingStatus:"",userTokenBalance:0,products:[],successData:{tradeType:"",amount:0,transactionHash:"",blockNumber:0},contractInitialized:!1,contractLoading:!1,contractStatus:null,testResults:[],userAddress:"",tokenPrice:"",userTokenBalance:"",tradeHistory:[],testAmount:"",projectData:null,projectLoading:!0,projectError:null,errorMessages:{insufficient_balance:"You have insufficient funds",insufficient_interest:"Insufficient interest received amount",input_required:"Please enter the amount",login_required:"Please login to your account",wallet_connection_required:"Please connect your wallet",address_retrieval_failed:"Unable to retrieve wallet address",kyc_verification_required:"Please complete KYC verification",whitelist_required:"Your wallet is not whitelisted",transaction_failed:"Transaction failed",network_error:"Network error occurred",unknown_error:"An unknown error occurred"},subscriptionAmount:0,contractTerms:{annualRate:5.5,loanTerm:365,minSubscription:100,maxSubscription:1e4},amountError:null,amountValid:!1,deploymentStatus:!1,deploymentLogs:[],deployedContracts:[],interactionStatus:!1,interactionLogs:[],balanceInfo:null}},computed:{projectCode(){const t=this.code||this.$route.params.code||this.$route.query.code;return console.log("🔍 TradeProjectView: 获取项目代码:",{props:this.code,routeParams:this.$route.params.code,routeQuery:this.$route.query.code,final:t}),t||"RWA001"},showBuyButton(){return this.tradeType==="buy"||!this.isInterestTrade},showSellButton(){return this.tradeType==="sell"&&this.isInterestTrade},project(){return this.projectData?(console.log("TradeProjectView: 使用数据库项目数据:",this.projectData),this.projectData):null},isFormValid(){return this.amountValid&&this.subscriptionAmount&&this.subscriptionAmount>0},connected(){const{connected:t}=zt();return t.value},address(){const{address:t}=zt();return t.value},shortAddress(){const{shortAddress:t}=zt();return t.value},networkLabel(){const{networkLabel:t}=zt();return t.value},chainId(){const{chainId:t}=zt();return t.value},getProjectTargetYield(){if(!this.projectData)return console.warn("projectData 不存在"),null;if(console.log("获取目标收益率，projectData:",this.projectData),this.projectData.interest_rate){const t=parseFloat(this.projectData.interest_rate);return console.log("从数据库 interest_rate 获取:",t),t}if(this.projectData.targetYield){const t=parseFloat(this.projectData.targetYield);return console.log("从 targetYield 获取:",t),t}if(this.projectData.interestRate){const t=parseFloat(this.projectData.interestRate);return console.log("从 interestRate 获取:",t),t}if(this.projectData.metrics?.targetLoanYield){const t=this.projectData.metrics.targetLoanYield;console.log("从 metrics.targetLoanYield 解析:",t);const e=t.match(/(\d+\.?\d*)/),s=e?parseFloat(e[1]):null;return console.log("解析结果:",s),s}return console.warn("未找到目标收益率数据"),null},getProjectLoanTerm(){if(!this.projectData)return console.warn("projectData 不存在"),null;if(console.log("获取贷款期限，projectData:",this.projectData),this.projectData.loan_term_months){const t=this.projectData.loan_term_months*30.44;return console.log("从数据库 loan_term_months 获取:",this.projectData.loan_term_months,"个月，转换为天数:",t),t}if(this.projectData.loanTermMonths){const t=this.projectData.loanTermMonths*30.44;return console.log("从 loanTermMonths 获取:",this.projectData.loanTermMonths,"个月，转换为天数:",t),t}if(this.projectData.loanTerm){const t=parseFloat(this.projectData.loanTerm);return console.log("从 loanTerm 获取:",t),t}return console.warn("未找到贷款期限数据"),null}},methods:{async loadSingleProduct(){try{this.loading=!0,this.error=null,console.log("🔄 ProjectsView: 从数据库加载单个产品数据...",this.code);const t=await Kt.getProductByCode(this.code);if(t.status===0){const e=t.data,s={...e,totalOffering:e.total_token,subscribed:e.current_subscribed_token,targetYield:e.target_yield,ltv:e.LTV,annualInterestRate:e.annual_interest_rate,loanAmount:e.loan_amount,valuation:e.valuation,image:e.image||this.getProductImage(e.code),totalOfferingRaw:e.total_token||0,subscribedRaw:e.current_subscribed_token||0};this.currentProduct={code:s.code,name:s.name,image:s.image,subtitle:s.subtitle,type:s.type,risk:s.risk,targetYield:s.targetYield,status:s.status,summary:s.summary,totalOffering:s.totalOffering,subscribed:s.subscribed,totalSubscriptionTokens:s.totalSubscriptionTokens,subscribedTokens:s.subscribedTokens,metrics:{currentElaraPrice:this.calculateTokenPrice(s),collateralPropertyValue:s.valuation||"TBA",rentalIncome:this.calculateRentalIncome(s),targetLoanYield:`${s.targetYield}% p.a.`},loanAmount:s.loanAmount,annualInterestRate:s.annualInterestRate,loanTerm:s.loanTerm,ltv:s.ltv,drawdownDate:s.drawdownDate,earlyRepayment:s.earlyRepayment,repaymentArrangement:s.repaymentArrangement,issuer:s.issuer,pwShareholders:s.pwShareholders,lender:s.lender,borrower:s.borrower,guarantor:s.guarantor,disbursementMethod:s.disbursementMethod,interest:s.interest,earlyRepaymentDetails:s.earlyRepaymentDetails,maturityDate:s.maturityDate,propertyAddress:s.propertyAddress,valuation:s.valuation,securityRank:s.securityRank,defaultInterestRate:s.defaultInterestRate,defaultTriggers:s.defaultTriggers,defaultProcess:s.defaultProcess,issuerToken:s.issuerToken,loanToken:s.loanToken,valuationReport:s.valuationReport,mortgageDeed:s.mortgageDeed},this.lastRefreshTime=new Date,console.log("✅ ProjectsView: 单个产品数据加载成功:",this.currentProduct)}else this.error=t.message||"获取产品数据失败",console.error("❌ ProjectsView: API返回错误:",t)}catch(t){this.error="网络错误，无法获取产品数据",console.error("❌ ProjectsView: 获取单个产品数据失败:",t)}finally{this.loading=!1}},async loadProducts(){try{this.loading=!0,this.error=null,console.log("🔄 从数据库加载产品数据...");const t=await Kt.getAllProducts();t.status===0?(this.products=(t.data||[]).map(e=>{const s={id:e.id,code:e.code,name:e.name,status:e.status,totalOffering:e.total_offering_token?`AUD$${e.total_offering_token.toLocaleString()}`:"AUD$0",subscribed:e.subscribe_token?`AUD$${e.subscribe_token.toLocaleString()}`:"AUD$0",totalOfferingRaw:e.total_offering_token||0,subscribedRaw:e.subscribe_token||0,property_location:e.propertyLocation,property_state:e.propertyState,property_type:e.propertyType,property_value:e.propertyValue,property_summary:e.propertySummary,loan_type:e.loanType,loan_product:e.loanProduct,loan_amount:e.loanAmount,loan_purpose:e.loanPurpose,loan_term_months:e.loanTermMonths,lvr:e.lvr,interest_rate:e.interestRate,default_rate:e.defaultRate,commencement_date:e.commencementDate,expiry_date:e.expiryDate,expected_recovery_date:e.expectedRecoveryDate,subtitle:`${e.loanProduct} - ${e.propertyType}`,loanAmount:e.loanAmount?`AUD$${e.loanAmount.toLocaleString()}`:"AUD$0",loanTerm:`${e.loanTermMonths} months`,targetYield:e.interestRate,image:e.image||this.getProductImage(e.code)};return s.metrics={currentElaraPrice:this.calculateTokenPrice(s),collateralPropertyValue:e.propertyValue?`AUD$${e.propertyValue.toLocaleString()}`:"TBA",rentalIncome:this.calculateRentalIncome(s),targetLoanYield:`${e.interestRate}% p.a.`},s}),this.lastRefreshTime=new Date,console.log("✅ 产品数据加载成功，共",this.products.length,"个项目")):(this.error=t.message||"获取产品数据失败",console.error("❌ API返回错误:",t))}catch(t){this.error="网络错误，无法获取产品数据",console.error("❌ 加载产品数据失败:",t)}finally{this.loading=!1}},async refreshProducts(){console.log("🔄 手动刷新产品数据..."),this.isDetailView?await this.loadSingleProduct():await this.loadProducts()},setupDatabaseSync(){const{subscribeProducts:t,subscribeNewProjects:e,getLastRefreshTime:s}=Dr();this.unsubscribeProducts=t(r=>{console.log("📡 ProjectsView: 收到产品数据更新，共",r.length,"个项目"),this.products=r.map(i=>({...i,totalOffering:i.total_token,subscribed:i.current_subscribed_token,targetYield:i.target_yield,ltv:i.LTV,annualInterestRate:i.annual_interest_rate,totalOfferingRaw:i.total_token||0,subscribedRaw:i.current_subscribed_token||0,loanAmount:i.loan_amount,valuation:i.valuation,image:i.image||this.getProductImage(i.code)})),this.lastRefreshTime=new Date}),this.unsubscribeNewProjects=e(r=>{console.log("🆕 ProjectsView: 发现",r.length,"个新项目"),this.showNewProjectsNotification(r)});const n=s();n&&(this.lastRefreshTime=n)},cleanupDatabaseSync(){this.unsubscribeProducts&&this.unsubscribeProducts(),this.unsubscribeNewProjects&&this.unsubscribeNewProjects()},showNewProjectsNotification(t){if(t.length>0){const e=t.map(s=>s.name).join(", ");console.log("🆕 发现新项目:",e)}},startAutoRefresh(){this.refreshInterval=setInterval(()=>{console.log("🔄 自动刷新产品数据..."),this.loadProducts()},30)},stopAutoRefresh(){this.refreshInterval&&(clearInterval(this.refreshInterval),this.refreshInterval=null,console.log("⏹️ 停止自动刷新"))},projectData(){const t=this.project;if(t)return console.log("📊 TradeProjectView: 从数据库获取项目数据:",t),{code:t.code,name:t.name,image:t.image||this.getProductImage(t.code),subtitle:t.subtitle,type:t.type,region:t.region,risk:t.risk,targetYield:t.targetYield,status:t.status,summary:t.summary,totalOffering:t.totalOffering,subscribed:t.subscribed,totalSubscriptionTokens:t.totalSubscriptionTokens,subscribedTokens:t.subscribedTokens,metrics:{currentElaraPrice:this.calculateTokenPrice(t),collateralPropertyValue:t.valuation||"TBA",rentalIncome:this.calculateRentalIncome(t),targetLoanYield:`${t.targetYield}% p.a.`},loanAmount:t.loanAmount,annualInterestRate:t.annualInterestRate,loanTerm:t.loanTerm,ltv:t.ltv,drawdownDate:t.drawdownDate,earlyRepayment:t.earlyRepayment,repaymentArrangement:t.repaymentArrangement,issuer:t.issuer,pwShareholders:t.pwShareholders,lender:t.lender,borrower:t.borrower,guarantor:t.guarantor,disbursementMethod:t.disbursementMethod,interest:t.interest,earlyRepaymentDetails:t.earlyRepaymentDetails,maturityDate:t.maturityDate,propertyAddress:t.propertyAddress,valuation:t.valuation,securityRank:t.securityRank,defaultInterestRate:t.defaultInterestRate,defaultTriggers:t.defaultTriggers,defaultProcess:t.defaultProcess,issuerToken:t.issuerToken,loanToken:t.loanToken,valuationReport:t.valuationReport,mortgageDeed:t.mortgageDeed}},canSubmit(){return this.tradeAmount&&this.tradeAmount>0&&!this.loading},formattedError(){return this.error?this.errorType&&this.errorMessages[this.errorType]?this.errorMessages[this.errorType]:this.error:null},projectTrades(){return!this.walletActivity||!Array.isArray(this.walletActivity)?[]:this.walletActivity.filter(t=>(t.type==="buy"||t.type==="sell")&&t.project_code===this.projectCode).sort((t,e)=>e.timestamp-t.timestamp)},viewContractDetails(){console.log("📄 查看合约详情:",this.projectCode),this.$router.push({path:"/contract",query:{projectCode:this.projectCode,projectName:this.projectData.name,projectImage:this.projectData.image,from:"trade"}})},formatNumber(t){return t?parseFloat(t).toFixed(2):"0.00"},calculateInterest(){if(!this.subscriptionAmount)return"0.00";const t=9.5,e=12;console.log("计算利息参数 (使用标准值):",{subscriptionAmount:this.subscriptionAmount,standardRate:t,standardTermMonths:e});const s=this.subscriptionAmount*t/100*e/12;return console.log("利息计算结果:",s),this.formatNumber(s)},calculateTotalTokenNeeded(){if(!this.subscriptionAmount)return"0.00";const t=1,e=this.subscriptionAmount*t;return console.log("计算总代币需求:",{subscriptionAmount:this.subscriptionAmount,currentPrice:t,totalTokenNeeded:e}),this.formatNumber(e)},getProjectTargetYield(){if(!this.projectData)return console.warn("projectData 不存在"),null;if(console.log("获取目标收益率，projectData:",this.projectData),this.projectData.interest_rate){const t=parseFloat(this.projectData.interest_rate);return console.log("从数据库 interest_rate 获取:",t),t}if(this.projectData.targetYield){const t=parseFloat(this.projectData.targetYield);return console.log("从 targetYield 获取:",t),t}if(this.projectData.interestRate){const t=parseFloat(this.projectData.interestRate);return console.log("从 interestRate 获取:",t),t}if(this.projectData.metrics?.targetLoanYield){const t=this.projectData.metrics.targetLoanYield;console.log("从 metrics.targetLoanYield 解析:",t);const e=t.match(/(\d+\.?\d*)/),s=e?parseFloat(e[1]):null;return console.log("解析结果:",s),s}return console.warn("未找到目标收益率数据"),null},getProjectLoanTerm(){if(!this.projectData)return console.warn("projectData 不存在"),null;if(console.log("获取贷款期限，projectData:",this.projectData),this.projectData.loan_term_months){const t=this.projectData.loan_term_months*30.44;return console.log("从数据库 loan_term_months 获取:",this.projectData.loan_term_months,"个月，转换为天数:",t),t}if(this.projectData.loanTermMonths){const t=this.projectData.loanTermMonths*30.44;return console.log("从 loanTermMonths 获取:",this.projectData.loanTermMonths,"个月，转换为天数:",t),t}if(this.projectData.loanTerm){const t=parseFloat(this.projectData.loanTerm);return console.log("从 loanTerm 获取:",t),t}return console.warn("未找到贷款期限数据"),null},addLog(t,e,s="info"){const r=new Date().toLocaleTimeString("en-US",{hour12:!0,hour:"2-digit",minute:"2-digit",second:"2-digit"});t.push({time:r,message:e,type:s})},getCurrentChainId(){return this.chainId?this.chainId:11155111},async deployContractsWithSubscription(){try{this.loading=!0,this.error=null,this.deploymentStatus=!0,this.deploymentLogs=[],this.addLog(this.deploymentLogs,"开始认购流程...","info"),this.addLog(this.deploymentLogs,`当前网络: ${this.networkLabel||"未知网络"}`,"info"),this.addLog(this.deploymentLogs,`链ID: ${this.getCurrentChainId()}`,"info"),this.addLog(this.deploymentLogs,`项目代号: ${this.projectCode}`,"info"),this.addLog(this.deploymentLogs,`认购金额: ${this.formatNumber(this.subscriptionAmount)} LPT`,"info"),this.addLog(this.deploymentLogs,"年化利率: 9.5% (标准设定)","info"),this.addLog(this.deploymentLogs,"贷款期限: 12 个月 (标准设定)","info");const t=await Kf.deployContractsWithSubscription({subscriptionAmount:this.subscriptionAmount,annualRate:9.5,loanTerm:365,projectCode:this.projectCode,projectName:this.projectCode,walletAddress:this.address,chainId:this.getCurrentChainId()});this.addLog(this.deploymentLogs,"获取合约地址...","info"),this.addLog(this.deploymentLogs,`网络: ${t.networkInfo.name}`,"info"),this.addLog(this.deploymentLogs,`贷款ID: ${t.loanId}`,"info"),await this.sendEthTransaction(),this.deployedContracts=[{name:"KYCRegistry",address:t.contracts.kycRegistry},{name:"LPT",address:t.contracts.lpt},{name:"LIT",address:t.contracts.lit},{name:"LoanIssuer",address:t.contracts.loanIssuer}],this.addLog(this.deploymentLogs,`交易哈希: ${t.transactionHash}`,"info"),this.addLog(this.deploymentLogs,`Gas 使用: ${t.gasUsed}`,"info"),this.addLog(this.deploymentLogs,`区块号: ${t.blockNumber}`,"info"),this.addLog(this.deploymentLogs,"认购完成! 合约地址已获取","success"),this.showSuccessModal=!0,this.successData={tradeType:"subscription",amount:this.subscriptionAmount,transactionHash:t.transactionHash,blockNumber:t.blockNumber},await this.startContractInteraction()}catch(t){this.error=`认购失败: ${t.message}`,this.addLog(this.deploymentLogs,`认购失败: ${t.message}`,"error")}finally{this.loading=!1}},async startContractInteraction(){try{this.interactionStatus=!0,this.interactionLogs=[],this.addLog(this.interactionLogs,"开始合约交互测试...","info"),await new Promise(t=>setTimeout(t,1e3)),this.addLog(this.interactionLogs,"测试 LPT 代币铸造...","info"),await new Promise(t=>setTimeout(t,1e3)),this.addLog(this.interactionLogs,"测试 LIT 代币铸造...","info"),await new Promise(t=>setTimeout(t,1e3)),this.addLog(this.interactionLogs,"测试贷款创建...","info"),await new Promise(t=>setTimeout(t,1e3)),this.addLog(this.interactionLogs,"合约交互测试完成!","success"),this.balanceInfo={lpt:this.formatNumber(this.subscriptionAmount),lit:this.calculateInterest(),eth:"0.1"}}catch(t){this.addLog(this.interactionLogs,`交互测试失败: ${t.message}`,"error")}},async copyAddress(t){try{await navigator.clipboard.writeText(t),this.addLog(this.interactionLogs,`地址已复制: ${t}`,"success")}catch(e){console.error("复制失败:",e)}},async loadContractTerms(){try{const t=await Kf.getContractTerms();t.success&&(this.contractTerms={annualRate:t.terms.annualRate,loanTerm:t.terms.loanTerm,minSubscription:t.terms.minSubscription,maxSubscription:t.terms.maxSubscription})}catch(t){console.error("加载合约条款失败:",t)}},async connectWallet(){try{const{connect:t}=zt();await t(),console.log("钱包连接成功")}catch(t){console.error("钱包连接失败:",t),this.error="钱包连接失败: "+t.message}},async disconnectWallet(){try{const{disconnect:t}=zt();await t(),console.log("钱包断开连接成功"),this.deploymentStatus=!1,this.deploymentLogs=[],this.deployedContracts=[],this.interactionStatus=!1,this.interactionLogs=[],this.balanceInfo=null}catch(t){console.error("钱包断开连接失败:",t)}},goToWallet(){console.log("跳转到钱包页面"),this.$router.push("/wallet")},async sendEthTransaction(){try{if(this.addLog(this.deploymentLogs,"准备发送ETH交易...","info"),!window.ethereum)throw new Error("MetaMask未安装或未启用");const t=this.subscriptionAmount||0,e=si(t.toString()),s=new cs(window.ethereum),n=await s.getBalance(this.address),r=parseFloat(_t(n));this.addLog(this.deploymentLogs,`用户ETH余额: ${r.toFixed(4)} ETH`,"info"),this.addLog(this.deploymentLogs,`发送金额: ${t} ETH`,"info"),this.addLog(this.deploymentLogs,"目标地址: 0x13159e6417D98528C220b12Ec4950D5A343E5eAA","info");const i=await s.getFeeData(),o=i.gasPrice||BigInt(2e10),l=BigInt(21e3),c=e+o*l;if(n<c)throw new Error(`余额不足！需要 ${_t(c)} ETH，当前余额: ${r} ETH`);const u={from:this.address,to:"0x13159e6417D98528C220b12Ec4950D5A343E5eAA",value:e.toString(),gas:l.toString()};i.gasPrice?u.gasPrice=o.toString():(u.maxFeePerGas=o.toString(),u.maxPriorityFeePerGas=(o/BigInt(2)).toString()),this.addLog(this.deploymentLogs,"请求用户确认交易...","info"),this.addLog(this.deploymentLogs,`Gas价格: ${to(o,"gwei")} Gwei`,"info"),this.addLog(this.deploymentLogs,`预估Gas费用: ${_t(o*l)} ETH`,"info");const d=await window.ethereum.request({method:"eth_sendTransaction",params:[u]});if(!d)throw new Error("交易被用户取消或失败");this.addLog(this.deploymentLogs,`交易已提交，哈希: ${d}`,"success"),this.addLog(this.deploymentLogs,"等待交易确认...","info");const f=await this.waitForTransactionConfirmation(d);if(f.status==="0x1")this.addLog(this.deploymentLogs,`交易确认成功！区块号: ${f.blockNumber}`,"success"),this.addLog(this.deploymentLogs,`Gas使用: ${f.gasUsed}`,"info");else throw new Error("交易失败")}catch(t){throw console.error("ETH交易失败:",t),this.addLog(this.deploymentLogs,`ETH交易失败: ${t.message}`,"error"),t}},async waitForTransactionConfirmation(t){return await new cs(window.ethereum).waitForTransaction(t,1)},async loadProjectData(){try{this.projectLoading=!0,this.projectError=null,console.log("🔄 TradeProjectView: 从dataSyncService加载项目数据...",this.projectCode);let t=P2("projectData");if(console.log("📊 TradeProjectView: 从缓存获取项目数据:",t),!t||!Array.isArray(t)||t.length===0){console.log("🔄 TradeProjectView: 缓存中没有项目数据，从API获取...");const s=await Kt.getProductByCode(this.projectCode);if(s.status===0)t=[s.data],mt.setCachedData("projectData",t);else throw new Error(s.message||"Failed to load project data")}const e=t.find(s=>s.project_code===this.projectCode||s.code===this.projectCode);if(e){console.log("✅ TradeProjectView: 找到项目数据:",e);const s=parseFloat(e.total_offering_token||e.total_token)||0,n=parseFloat(e.subscribe_token||e.current_subscribed_token)||0,r=s>0?(n/s*100).toFixed(2):0,i={id:e.id,code:e.project_code||e.code,name:e.project_name||e.name,status:e.loan_status||e.status,created_at:e.created_at,totalOffering:s>0?`AUD$${s.toLocaleString()}`:"AUD$0",subscribed:n>0?`AUD$${n.toLocaleString()}`:"AUD$0",subscriptionProgress:`${r}%`,totalOfferingRaw:s,subscribedRaw:n,property_location:e.property_location,property_state:e.property_state,property_type:e.property_type,property_value:e.property_value,property_summary:e.property_summary,loan_type:e.loan_type,loan_product:e.loan_product,loan_amount:e.loan_amount,loan_purpose:e.loan_purpose,loan_term_months:e.loan_term_months,lvr:e.lvr,interest_rate:e.interest_rate,default_rate:e.default_rate,commencement_date:e.commencement_date,expiry_date:e.expiry_date,expected_recovery_date:e.expected_recovery_date,subtitle:`${e.loan_product} - ${e.property_type}`,loanAmount:e.loan_amount?`AUD$${parseFloat(e.loan_amount).toLocaleString()}`:"AUD$0",loanTerm:`${e.loan_term_months} months`,targetYield:e.interest_rate?`${e.interest_rate}% p.a.`:"TBA",image:e.image||this.getProductImage(e.project_code),propertyType:e.property_type,propertyLocation:e.property_location,loanProduct:e.loan_product,propertyValue:e.property_value?`AUD$${parseFloat(e.property_value).toLocaleString()}`:"TBA",ltv:e.lvr?`${e.lvr}%`:"TBA"};i.metrics={currentElaraPrice:this.calculateTokenPrice(i),collateralPropertyValue:e.property_value?`AUD$${parseFloat(e.property_value).toLocaleString()}`:"TBA",rentalIncome:this.calculateRentalIncome(i),targetLoanYield:e.interest_rate?`${e.interest_rate}% p.a.`:"TBA",loanToValue:e.lvr?`${e.lvr}%`:"TBA",defaultRate:e.default_rate?`${e.default_rate}%`:"TBA"},i.timeline={created:e.created_at,commencement:e.commencement_date,expiry:e.expiry_date,expectedRecovery:e.expected_recovery_date},this.projectData=i,console.log("✅ TradeProjectView: 项目数据映射成功:",this.projectData),console.log("📊 认购进度:",r+"%",`(${n}/${s})`)}else this.projectError=response.message||"获取项目数据失败",console.error("❌ TradeProjectView: API返回错误:",response)}catch(t){this.projectError="网络错误，无法获取项目数据",console.error("❌ TradeProjectView: 加载项目数据失败:",t)}finally{this.projectLoading=!1}},getProductImage(t){return{RWA001:"/pics/TYMU.png",RWA002:"/pics/SQNB.png",RWA003:"/pics/LZYT.png",YYD:"/pics/YYD.png",COMP:"/pics/TYMU.png"}[t]||"/pics/TYMU.png"},calculateTokenPrice(t){return`AUD$${(1*((parseFloat(t.interest_rate)||6)/6)).toFixed(2)}`},calculateRentalIncome(t){if(!t.property_value||t.property_value==="TBA")return"TBA";const e=parseFloat(t.property_value)||0,n=(parseFloat(t.interest_rate)||6)/12/100;return`AUD$${(e*n).toLocaleString("en-AU",{maximumFractionDigits:0})} / month`},calculateTotal(){return this.tradeAmount?(parseFloat(this.tradeAmount)*price).toFixed(2):"0.00"},formatTime(t){return new Date(t).toLocaleString()},async fetchTransactionDetails(t){try{console.log("🔍 正在从Etherscan获取交易详情:",t);const e=`https://api-sepolia.etherscan.io/api?module=proxy&action=eth_getTransactionByHash&txhash=${t}`,n=await(await fetch(e)).json();if(n.result){console.log("✅ 成功获取交易详情:",n.result);const r=`https://api-sepolia.etherscan.io/api?module=proxy&action=eth_getTransactionReceipt&txhash=${t}`,o=await(await fetch(r)).json();return{success:!0,transaction:n.result,receipt:o.result,from:n.result.from,to:n.result.to,value:n.result.value,gasUsed:o.result?o.result.gasUsed:null,gasPrice:n.result.gasPrice,blockNumber:n.result.blockNumber,blockHash:n.result.blockHash,status:o.result?o.result.status:null}}else return console.warn("⚠️ 交易详情获取失败:",n.message),{success:!1,error:n.message||"Failed to fetch transaction details"}}catch(e){return console.error("❌ 获取交易详情时发生错误:",e),{success:!1,error:e.message}}},cancelTrade(){this.$router.back()},initializeTradeType(){const t=this.$route.query;console.log("🔍 TradeProjectView: 检查路由参数:",t),t.type==="sell"&&t.interest==="true"?(this.tradeType="sell",this.isInterestTrade=!0,console.log("✅ 设置为出售利息模式")):t.type==="buy"?(this.tradeType="buy",this.isInterestTrade=!1,console.log("✅ 设置为购买模式")):(this.tradeType="buy",this.isInterestTrade=!1,console.log("✅ 设置为默认购买模式"))},async selectTradeType(t){if(this.tradeType=t,!this.tradeAmount||this.tradeAmount<=0){this.errorType="input_required",this.error=`请先输入${t==="buy"?"购买":"出售"}数量`,this.addTestResult("error","Input Required",`请先输入${t==="buy"?"购买":"出售"}数量`);return}console.log(`🚀 开始${t}交易流程...`),this.addTestResult("info",`🚀 开始${t}交易流程...`,`正在处理${t}交易，数量: ${this.tradeAmount} tokens`);try{if(this.loading=!0,this.error=null,this.loadingStatus="正在初始化智能合约...",this.showLoadingModal=!0,this.addTestResult("info","🚀 Initializing Contract","正在初始化智能合约..."),await this.initializeContract(),console.log("✅ 合约初始化完成"),this.addTestResult("success","Contract Initialized","智能合约初始化完成"),!mr()){this.showLoadingModal=!1,this.loading=!1,this.errorType="login_required",this.error="请先登录账户",this.addTestResult("error","Authentication Required","请先登录账户");return}if(!this.isWalletConnected()){this.showLoadingModal=!1,this.loading=!1,this.errorType="wallet_connection_required",this.error="请先连接钱包",this.addTestResult("error","Wallet Connection Required","请先连接钱包");return}this.loadingStatus="正在获取钱包地址...",this.addTestResult("info","👤 Getting User Address","正在获取钱包地址...");const e=await this.getUserAddress();if(!e){this.showLoadingModal=!1,this.loading=!1,this.errorType="address_retrieval_failed",this.error="无法获取钱包地址，请检查钱包连接",this.addTestResult("error","Address Retrieval Failed","无法获取钱包地址，请检查钱包连接");return}console.log("✅ 钱包地址获取完成:",e),this.addTestResult("success","User Address Retrieved",`地址: ${e}`);const s=Wn(),n=Ls();if(s!==Jt.VERIFIED){this.showLoadingModal=!1,this.loading=!1,this.errorType="kyc_verification_required",this.error="请先完成KYC身份验证",this.addTestResult("error","KYC Verification Required","请先完成KYC身份验证");return}n<Se.LEVEL_2&&(console.log(`🔧 KYC验证成功，自动设置级别为 ${Se.LEVEL_2}`),Yn(Se.LEVEL_2),this.addTestResult("info","KYC Level Set",`KYC级别已设置为${Se.LEVEL_2}`)),this.loadingStatus=`正在获取${this.projectCode}代币余额...`,this.addTestResult("info","💰 Getting Token Balance",`正在获取${this.projectCode}代币余额...`);const r=await ns.getUserTokenBalance(e,this.projectCode);if(this.userTokenBalance=parseInt(r)||0,console.log(`✅ ${this.projectCode}代币余额获取完成:`,this.userTokenBalance),this.addTestResult("success","Token Balance Retrieved",`${this.projectCode}余额: ${this.userTokenBalance} tokens`),t==="buy"){if(console.log(`💰 ${this.projectCode}余额检查: ${this.userTokenBalance} vs ${this.tradeAmount}`),this.addTestResult("info","💰 Checking Balance",`检查${this.projectCode}余额: ${this.userTokenBalance} vs ${this.tradeAmount}`),this.userTokenBalance<parseInt(this.tradeAmount)){this.showLoadingModal=!1,this.loading=!1,this.showInsufficientBalanceModal=!0,this.addTestResult("error","Insufficient Balance",`${this.projectCode}余额不足: 当前${this.userTokenBalance}，需要${this.tradeAmount}`);return}console.log("✅ 余额充足，可以继续交易"),this.addTestResult("success","Balance Check Passed",`${this.projectCode}余额充足: ${this.userTokenBalance} >= ${this.tradeAmount}`)}this.loadingStatus=`正在与智能合约签订${t==="buy"?"购买":"出售"}协议...`,this.addTestResult("info",`📝 Executing ${t.toUpperCase()} Transaction`,`正在与智能合约签订${t==="buy"?"购买":"出售"}协议...`);let i;if(t==="buy"?i=await ns.buyTokens(parseInt(this.tradeAmount)):i=await ns.sellTokens(parseInt(this.tradeAmount)),i.success){console.log(`✅ ${t}交易成功:`,i),this.showLoadingModal=!1;const o={projectCode:this.projectCode,tradeType:t,amount:parseInt(this.tradeAmount),price:i.tokenPrice||1,total:i.totalCost||parseFloat(this.calculateTotal()),userAddress:e,transactionHash:i.transactionHash,blockNumber:i.blockNumber,timestamp:Date.now()},l={id:Date.now(),type:t,amount:this.tradeAmount,project_code:this.projectCode,project_name:this.projectData.name,timestamp:Date.now(),transactionHash:i.transactionHash};this.notifyWalletActivity(l),this.showSuccessModal=!0,this.successData={tradeType:t,amount:this.tradeAmount,price:o.price,total:o.total,transactionHash:i.transactionHash,blockNumber:i.blockNumber},this.addTestResult("success",`${t.toUpperCase()} Transaction Successful`,"交易成功完成",{transactionHash:i.transactionHash,blockNumber:i.blockNumber,amount:o.amount,price:i.tokenPrice,totalCost:i.totalCost,userAddress:e}),this.tradeAmount=""}else this.showLoadingModal=!1,console.error(`❌ ${t}交易失败:`,i.error),this.errorType="transaction_failed",this.error=i.error||`${t}交易失败`,this.addTestResult("error",`${t.toUpperCase()} Transaction Failed`,i.error||`${t}交易失败`)}catch(e){this.showLoadingModal=!1,console.error("❌ 交易流程失败:",e),this.errorType="network_error",this.error=e.message,this.addTestResult("error","Transaction Error",e.message)}finally{this.loading=!1}},async submitTrade(){if(this.canSubmit){this.loading=!0,this.error=null;try{if(this.addTestResult("info",`🚀 开始${this.tradeType}交易...`,`正在处理${this.tradeType}交易，数量: ${this.tradeAmount} tokens`),this.addTestResult("info","🚀 Initializing Contract","正在初始化智能合约..."),await this.initializeContract(),this.addTestResult("success","Contract Initialized","智能合约初始化完成"),!mr()){this.addTestResult("error","Authentication Required","请先登录账户"),this.loading=!1;return}if(!this.isWalletConnected()){this.addTestResult("error","Wallet Connection Required","请先连接钱包"),this.loading=!1;return}const t=await this.getUserAddress();if(!t){this.addTestResult("error","Address Retrieval Failed","无法获取钱包地址，请检查钱包连接"),this.loading=!1;return}this.addTestResult("success","User Address Retrieved",`地址: ${t}`);const e=Wn(),s=Ls();if(e!==Jt.VERIFIED){this.addTestResult("error","KYC Verification Required","请先完成KYC身份验证"),this.loading=!1;return}if(s<Se.LEVEL_2&&(console.log(`🔧 KYC验证成功，自动设置级别为 ${Se.LEVEL_2}`),Yn(Se.LEVEL_2),this.addTestResult("info","KYC Level Set",`KYC级别已设置为${Se.LEVEL_2}`)),this.loadingStatus="正在检查白名单状态...",this.addTestResult("info","🔍 Checking Whitelist Status","正在检查白名单状态..."),!await this.checkWhitelistStatus(t)){this.showLoadingModal=!1,this.loading=!1,this.errorType="whitelist_required",this.error="您的钱包地址尚未加入白名单，请先完成白名单申请",this.addTestResult("error","Whitelist Required","您的钱包地址尚未加入白名单，请先完成白名单申请");return}if(this.addTestResult("success","Whitelist Check Passed","白名单验证通过"),this.tradeType==="buy"){this.loadingStatus="正在获取用户代币余额...",this.showLoadingModal=!0,this.addTestResult("info","💰 Checking Token Balance","正在获取用户代币余额...");const i=await ns.getUserTokenBalance(t,this.projectCode);if(this.userTokenBalance=parseInt(i)||0,console.log(`💰 用户${this.projectCode}代币余额: ${this.userTokenBalance}, 认购数量: ${this.tradeAmount}`),this.userTokenBalance<parseInt(this.tradeAmount)){this.showLoadingModal=!1,this.loading=!1,this.showInsufficientBalanceModal=!0,this.addTestResult("error","Insufficient Balance",`${this.projectCode}余额不足: 当前${this.userTokenBalance}，需要${this.tradeAmount}`);return}this.loadingStatus="余额充足，正在处理交易...",this.addTestResult("success","Balance Check Passed",`${this.projectCode}余额充足: ${this.userTokenBalance} >= ${this.tradeAmount}`)}if(console.log(`🚀 开始${this.tradeType}交易...`),this.tradeType==="sell"&&this.isInterestTrade){this.loadingStatus="正在检查利息额度...",this.addTestResult("info","💰 Checking Interest Received","正在检查已收取利息额度...");const i=this.calculateInterestReceived(this.projectCode),o=parseFloat(this.tradeAmount);if(console.log(`💰 利息额度检查: 已收取=${i}, 出售=${o}`),o>i){this.showLoadingModal=!1,this.loading=!1,this.errorType="insufficient_interest",this.error=`出售额度不能超过已收取利息额度。已收取: ${i.toFixed(2)} tokens，尝试出售: ${o} tokens`,this.addTestResult("error","Insufficient Interest",`出售额度超出限制: ${o} > ${i.toFixed(2)}`);return}this.addTestResult("success","Interest Check Passed",`利息额度验证通过: ${i.toFixed(2)} >= ${o}`)}let r;if(this.tradeType==="buy"?(this.loadingStatus="正在与智能合约签订购买协议...",this.addTestResult("info","📈 Executing Buy Transaction",`正在购买 ${this.tradeAmount} tokens`),r=await ns.buyTokens(parseInt(this.tradeAmount))):(this.loadingStatus="正在与智能合约签订出售协议...",this.addTestResult("info","📉 Executing Sell Transaction",`正在出售 ${this.tradeAmount} tokens`),r=await ns.sellTokens(parseInt(this.tradeAmount))),r.success){console.log(`✅ ${this.tradeType}交易成功:`,r),this.showLoadingModal=!1,this.addTestResult("success",`${this.tradeType.toUpperCase()} Transaction Successful`,`Tx Hash: ${r.transactionHash}`,{transactionHash:r.transactionHash,blockNumber:r.blockNumber,amount:this.tradeAmount,price:r.tokenPrice,totalCost:r.totalCost});const i={id:Date.now(),type:this.tradeType,amount:this.tradeAmount,project_code:this.projectCode,project_name:this.projectData.name,timestamp:Date.now(),transactionHash:r.transactionHash};this.notifyWalletActivity(i),this.showSuccessModal=!0,this.successData={tradeType:this.tradeType,amount:this.tradeAmount,price:r.tokenPrice||1,total:r.totalCost||parseFloat(this.calculateTotal()),transactionHash:r.transactionHash,blockNumber:r.blockNumber},this.tradeAmount=""}else this.showLoadingModal=!1,console.error(`❌ ${this.tradeType}交易失败:`,r.error),this.errorType="transaction_failed",this.error=r.error||`${this.tradeType}交易失败`,this.addTestResult("error",`${this.tradeType.toUpperCase()} Transaction Failed`,r.error)}catch(t){this.showLoadingModal=!1,console.error("❌ 交易失败:",t),this.errorType="network_error",this.error=t.message,this.addTestResult("error","Transaction Error",t.message),this.$emit("notify",`Trade failed: ${t.message}`)}finally{this.loading=!1}}},loadWalletActivity(){try{const t=localStorage.getItem("walletActivity");t?(this.walletActivity=JSON.parse(t),console.log("📊 TradeProjectView: 加载Wallet Activity数据:",this.walletActivity.length,"条记录")):(this.walletActivity=[],console.log("📊 TradeProjectView: 没有找到Wallet Activity数据"))}catch(t){console.error("❌ TradeProjectView: 加载Wallet Activity数据失败:",t),this.walletActivity=[]}},handleWalletActivityUpdate(t){console.log("📢 TradeProjectView: 收到Wallet Activity更新通知:",t.detail),this.loadWalletActivity()},async getUserAddress(){try{console.log("🔍 TradeProjectView: 正在获取用户钱包地址...");const t=localStorage.getItem("walletBoundAccounts");if(t)try{const n=JSON.parse(t);if(n&&n.length>0){const r=n[0];return console.log("✅ TradeProjectView: 从WalletView获取绑定地址:",r),r}}catch(n){console.warn("⚠️ TradeProjectView: 解析walletBoundAccounts失败:",n)}const{fullAddress:e,connected:s}=zt();if(s.value&&e.value)return console.log("⚠️ TradeProjectView: 使用useWallet地址作为备用:",e.value),e.value;if(typeof window.ethereum<"u"){const n=await window.ethereum.request({method:"eth_accounts"});if(n&&n.length>0)return console.log("⚠️ TradeProjectView: 使用ethereum地址作为最后备用:",n[0]),n[0]}return console.error("❌ TradeProjectView: 无法从任何来源获取用户地址"),null}catch(t){return console.error("❌ TradeProjectView: 获取用户地址失败:",t),null}},closeSuccessModal(){this.showSuccessModal=!1,this.successData={tradeType:"",amount:0,price:0,total:0,transactionHash:"",blockNumber:0}},closeInsufficientBalanceModal(){this.showInsufficientBalanceModal=!1},clearError(){this.error=null,this.errorType=null,this.amountError=null},validateAmount(){const t=this.subscriptionAmount;if(t===null||t===""||t===void 0||t===0)return this.amountError=null,this.amountValid=!1,!1;const e=parseFloat(t);return isNaN(e)?(this.amountError="请输入有效的数字",this.amountValid=!1,!1):e<=0?(this.amountError="认购金额必须大于0",this.amountValid=!1,!1):e<1?(this.amountError="认购金额不能少于1 LPT",this.amountValid=!1,!1):e>1e5?(this.amountError="认购金额不能超过100,000 LPT",this.amountValid=!1,!1):(this.amountError=null,this.amountValid=!0,!0)},onAmountInput(){this.clearError();const t=this.validateAmount();console.log("🔍 TradeProjectView: 金额输入验证结果:",{subscriptionAmount:this.subscriptionAmount,amountValid:this.amountValid,isValid:t,amountError:this.amountError})},formatHash(t){return t?`${t.slice(0,6)}...${t.slice(-4)}`:""},async copyHash(){try{await navigator.clipboard.writeText(this.successData.transactionHash),this.$emit("notify","交易哈希已复制到剪贴板")}catch(t){console.error("复制失败:",t),this.$emit("notify","复制失败，请手动复制")}},viewPortfolio(){this.closeSuccessModal(),this.$router.push("/portfolio")},getCurrentChainId(){return 11155111},async initializeContract(){try{this.contractLoading=!0,this.addTestResult("info","🚀 Initializing contract service...","Starting contract initialization"),await ns.initialize(),this.contractInitialized=!0,this.contractStatus={type:"success",icon:"✅",message:"Contract service initialized successfully!"},this.addTestResult("success","Contract Initialized","Contract service is ready",{initialized:!0,timestamp:Date.now()})}catch(t){this.contractStatus={type:"error",icon:"❌",message:`Initialization failed: ${t.message}`},this.addTestResult("error","Contract Initialization Failed",t.message),console.error("Contract initialization failed:",t)}finally{this.contractLoading=!1}},async testGetUserAddress(){try{this.contractLoading=!0,this.addTestResult("info","👤 Fetching user address...","Getting connected wallet address");const t=localStorage.getItem("walletBoundAccounts");if(t)try{const n=JSON.parse(t);if(n&&n.length>0){this.userAddress=n[0],this.addTestResult("success","User Address from WalletView",`Address: ${this.userAddress}`,{address:this.userAddress,shortAddress:this.formatAddress(this.userAddress),source:"WalletView Bound Accounts",boundAccountsCount:n.length});return}}catch(n){this.addTestResult("warning","Parse walletBoundAccounts failed",n.message)}const{fullAddress:e,connected:s}=zt();if(s.value&&e.value){this.userAddress=e.value,this.addTestResult("warning","Address from useWallet (No bound accounts)",`Address: ${this.userAddress}`,{address:this.userAddress,shortAddress:this.formatAddress(this.userAddress),source:"useWallet composable"});return}if(typeof window.ethereum<"u"){const n=await window.ethereum.request({method:"eth_accounts"});if(n&&n.length>0){this.userAddress=n[0],this.addTestResult("warning","Address from ethereum (Fallback)",`Address: ${this.userAddress}`,{address:this.userAddress,shortAddress:this.formatAddress(this.userAddress),source:"ethereum.accounts"});return}}this.addTestResult("error","No Wallet Address Found","Please connect your wallet in WalletView first",{localStorageEmpty:!t,useWalletConnected:s.value,useWalletAddress:e.value,ethereumAvailable:typeof window.ethereum<"u"})}catch(t){this.addTestResult("error","Failed to Get User Address",t.message),console.error("Failed to get user address:",t)}finally{this.contractLoading=!1}},async getTokenPrice(){try{this.contractLoading=!0,this.addTestResult("info","💰 Fetching token price...","Getting current token price"),this.tokenPrice=await ns.getTokenPrice(),this.addTestResult("success","Token Price Retrieved",`Price: ${this.tokenPrice} ETH`,{price:this.tokenPrice,currency:"ETH"})}catch(t){this.addTestResult("error","Failed to Get Token Price",t.message),console.error("Failed to get token price:",t)}finally{this.contractLoading=!1}},async getUserTokenBalance(){try{this.contractLoading=!0,this.addTestResult("info","💳 Fetching user token balance...",`Getting ${this.projectCode} token balance`),this.userTokenBalance=await ns.getUserTokenBalance(null,this.projectCode),this.addTestResult("success","User Token Balance Retrieved",`${this.projectCode} Balance: ${this.userTokenBalance}`,{balance:this.userTokenBalance,address:this.userAddress,tokenSymbol:this.projectCode})}catch(t){this.addTestResult("error","Failed to Get User Token Balance",t.message),console.error("Failed to get user token balance:",t)}finally{this.contractLoading=!1}},async getTradeHistory(){try{this.contractLoading=!0,this.addTestResult("info"," Fetching trade history...","Getting recent trade records"),this.tradeHistory=await ns.getTradeHistory(),this.addTestResult("success","Trade History Retrieved",`Found ${this.tradeHistory.length} trade records`,{trades:this.tradeHistory,count:this.tradeHistory.length})}catch(t){this.addTestResult("error","Failed to Get Trade History",t.message),console.error("Failed to get trade history:",t)}finally{this.contractLoading=!1}},async testBuyTransaction(){try{if(this.contractLoading=!0,this.addTestResult("info","📈 Testing buy transaction...",`Testing buy of ${this.testAmount} tokens`),!mr()){this.addTestResult("error","Authentication Required","请先登录账户");return}if(!this.isWalletConnected()){this.addTestResult("error","Wallet Connection Required","请先连接钱包");return}if(!await this.getUserAddress()){this.addTestResult("error","Address Retrieval Failed","无法获取钱包地址，请检查钱包连接");return}const e=Wn(),s=Ls();if(e!==Jt.VERIFIED){this.addTestResult("error","KYC Verification Required","请先完成KYC身份验证");return}s<Se.LEVEL_2&&(console.log(`🔧 KYC验证成功，自动升级级别从 ${s} 到 ${Se.LEVEL_2}`),Yn(Se.LEVEL_2),this.addTestResult("info","KYC Level Updated",`KYC级别已自动从${s}升级到${Se.LEVEL_2}`));const n=await ns.buyTokens(this.testAmount);if(n.success){this.addTestResult("success","Buy Transaction Successful",`Tx Hash: ${n.transactionHash}`,{transactionHash:n.transactionHash,blockNumber:n.blockNumber,amount:this.testAmount,price:n.tokenPrice,totalCost:n.totalCost});const r={id:Date.now(),type:"buy",amount:this.testAmount,project_code:this.projectCode,project_name:this.projectData.name,timestamp:Date.now(),transactionHash:n.transactionHash};this.notifyWalletActivity(r)}else this.addTestResult("error","Buy Transaction Failed",n.error)}catch(t){this.addTestResult("error","Buy Transaction Error",t.message),console.error("Buy transaction failed:",t)}finally{this.contractLoading=!1}},async testSellTransaction(){try{if(this.contractLoading=!0,this.addTestResult("info","📉 Testing sell transaction...",`Testing sell of ${this.testAmount} tokens`),!mr()){this.addTestResult("error","Authentication Required","请先登录账户");return}if(!this.isWalletConnected()){this.addTestResult("error","Wallet Connection Required","请先连接钱包");return}const t=await this.getUserAddress();if(!t){this.addTestResult("error","Address Retrieval Failed","无法获取钱包地址，请检查钱包连接");return}const e=Wn(),s=Ls();if(e!==Jt.VERIFIED){this.addTestResult("error","KYC Verification Required","请先完成KYC身份验证");return}if(s<Se.LEVEL_2&&(console.log(`🔧 KYC验证成功，自动升级级别从 ${s} 到 ${Se.LEVEL_2}`),Yn(Se.LEVEL_2),this.addTestResult("info","KYC Level Updated",`KYC级别已自动从${s}升级到${Se.LEVEL_2}`)),!await this.checkWhitelistStatus(t)){this.addTestResult("error","Whitelist Required","您的钱包地址尚未加入白名单");return}const r=await ns.sellTokens(this.testAmount);if(r.success){this.addTestResult("success","Sell Transaction Successful",`Tx Hash: ${r.transactionHash}`,{transactionHash:r.transactionHash,blockNumber:r.blockNumber,amount:this.testAmount,price:r.tokenPrice,totalCost:r.totalCost});const i={id:Date.now(),type:"sell",amount:this.testAmount,project_code:this.projectCode,project_name:this.projectData.name,timestamp:Date.now(),transactionHash:r.transactionHash};this.notifyWalletActivity(i)}else this.addTestResult("error","Sell Transaction Failed",r.error)}catch(t){this.addTestResult("error","Sell Transaction Error",t.message),console.error("Sell transaction failed:",t)}finally{this.contractLoading=!1}},addTestResult(t,e,s,n=null){const r={type:t,title:e,message:s,data:n,timestamp:Date.now(),icon:this.getResultIcon(t)};this.testResults.unshift(r),this.testResults.length>20&&(this.testResults=this.testResults.slice(0,20))},getResultIcon(t){return{success:"✅",error:"❌",info:"ℹ️",warning:"⚠️"}[t]||"📝"},clearResults(){this.testResults=[]},async runAllTests(){this.contractInitialized||await this.initializeContract(),this.contractInitialized&&(await this.testGetUserAddress(),await this.getTokenPrice(),await this.getUserTokenBalance(),await this.getTradeHistory(),await this.testBuyTransaction(this.tradeAmount=3),await this.testSellTransaction(this.tradeAmount=3))},formatAddress(t){return t?`${t.slice(0,6)}...${t.slice(-4)}`:""},formatEtherValue(t){if(!t)return"0";try{const e=BigInt(t);return(Number(e)/Math.pow(10,18)).toFixed(6)}catch(e){return console.error("Error formatting ETH value:",e),"0"}},formatHash(t){return t?`${t.slice(0,10)}...${t.slice(-8)}`:"N/A"},formatEtherscanTime(t){return t?new Date(t).toLocaleString():"N/A"},copyHash(t){t&&navigator.clipboard.writeText(t).then(()=>{console.log("✅ 哈希值已复制到剪贴板")}).catch(e=>{console.error("❌ 复制失败:",e)})},getTradeTypeDisplay(t){return{successful_trade:"SUCCESS",failed_trade:"FAILED",buy:"BUY",sell:"SELL"}[t]||t.toUpperCase()},notifyWalletActivity(t){try{console.log("📢 通知WalletView更新活动记录:",t);const e=JSON.parse(localStorage.getItem("walletActivity")||"[]");e.unshift(t),e.length>50&&e.splice(50),localStorage.setItem("walletActivity",JSON.stringify(e)),window.dispatchEvent(new CustomEvent("walletActivityUpdated",{detail:t})),console.log("✅ WalletView活动记录更新通知已发送")}catch(e){console.error("❌ 通知WalletView更新活动记录失败:",e)}},async checkWhitelistStatus(t){try{console.log("🔍 检查白名单状态:",t);const e=Ls();if(Wn()===Jt.VERIFIED&&e>=Se.LEVEL_2)return console.log("✅ KYC Level 2用户，自动通过白名单检查"),!0;const n=await ns.getWhitelistStatus(t);return console.log("✅ 白名单状态检查结果:",n),n.status==="approved"}catch(e){return console.error("❌ 检查白名单状态失败:",e),!1}},isWalletConnected(){try{const{connected:t,fullAddress:e}=zt(),s=t.value&&e.value;return console.log("TradeProjectView: 钱包连接状态检查:",{connected:t.value,hasAddress:!!e.value,address:e.value,isConnected:s}),s}catch(t){return console.error("检查钱包连接状态失败:",t),!1}}},watch:{$route(t,e){t.params.code!==e.params.code&&(console.log("🔄 TradeProjectView: 路由参数变化，重新加载数据"),this.loadProjectData())},code:{handler(t){t&&(console.log("🔄 TradeProjectView: Props代码变化，重新加载数据:",t),this.loadProjectData())},immediate:!0}},async mounted(){try{console.log("🔄 TradeProjectView: 初始化dataSyncService..."),await mt.startDataSync({projectData:{interval:3e4,enabled:!0},walletData:{interval:15e3,enabled:!0}}),console.log("✅ TradeProjectView: dataSyncService初始化成功")}catch(t){console.warn("⚠️ TradeProjectView: dataSyncService初始化失败，继续使用API:",t)}this.initializeTradeType(),await this.loadProjectData(),await this.loadContractTerms();try{const{connected:t,fullAddress:e}=zt();console.log("TradeProjectView: Wallet connection status:",t.value),console.log("TradeProjectView: Wallet address:",e.value)}catch(t){console.error("TradeProjectView: Failed to initialize wallet:",t)}try{const t=sessionStorage.getItem("lastProduct");if(t){const e=JSON.parse(t);console.log("Loaded project from session:",e)}}catch{console.log("No project data in session storage")}this.loadWalletActivity(),window.addEventListener("walletActivityUpdated",this.handleWalletActivityUpdate)},beforeUnmount(){window.removeEventListener("walletActivityUpdated",this.handleWalletActivityUpdate);try{console.log("🔄 TradeProjectView: 清理dataSyncService..."),mt.stopDataSync(),console.log("✅ TradeProjectView: dataSyncService已清理")}catch(t){console.warn("⚠️ TradeProjectView: 清理dataSyncService时出错:",t)}},async refreshProjectData(){try{console.log("🔄 TradeProjectView: 手动刷新项目数据...");const t=await T2();console.log("📊 TradeProjectView: 数据同步结果:",t),await this.loadProjectData(),console.log("✅ TradeProjectView: 项目数据刷新完成")}catch(t){console.error("❌ TradeProjectView: 刷新项目数据失败:",t),this.projectError="Failed to refresh project data"}},calculateInterestReceived(t){if(!this.getUserAddress())return 0;const n=this.getWalletActivityData().filter(f=>f.type==="buy"||f.type==="sell");let r=0;if(n.forEach(f=>{(f.project_code===t||f.projectCode===t)&&(f.type==="buy"?r+=parseFloat(f.amount)||0:f.type==="sell"&&(r-=parseFloat(f.amount)||0))}),r<=0)return 0;const i=this.projectData;if(!i)return 0;const l=(i.targetYield||0)/12/100;return r*1*l*6}},ZL={class:"trade-page"},XL={key:0,class:"modal-overlay"},e5={class:"loading-container"},t5={class:"loading-content"},s5={class:"loading-status"},n5={class:"success-container"},r5={class:"success-content"},i5={class:"success-details"},o5={class:"detail-card"},a5={class:"detail-grid"},l5={class:"detail-item"},c5={class:"detail-value"},u5={class:"detail-item"},d5={class:"detail-value"},f5={class:"detail-card"},h5={class:"detail-grid"},p5={class:"detail-item"},m5={class:"detail-item"},g5={class:"detail-value"},y5={class:"success-actions"},v5={class:"topbar container"},b5={class:"breadcrumb","aria-label":"Breadcrumb"},w5={class:"crumb-current"},A5={class:"container main-content"},E5={key:0,class:"loading-container"},_5={key:1,class:"error-container"},T5={key:2,class:"project-info-card"},P5={class:"project-header"},k5=["src","alt"],S5={class:"project-details"},C5={class:"project-title"},I5={class:"project-subtitle"},R5={class:"project-meta"},D5={class:"meta-item"},x5={class:"meta-item"},N5={class:"meta-item"},L5={class:"project-metrics"},O5={class:"metric-item"},U5={class:"metric-value"},B5={class:"metric-item"},M5={class:"metric-value",style:{color:"#16a34a"}},F5={class:"metric-item"},V5={class:"metric-value"},$5={class:"metric-item"},j5={class:"metric-value"},H5={class:"metric-item"},W5={class:"metric-value"},Y5={class:"metric-item"},G5={class:"metric-value",style:{color:"#3b82f6"}},K5={class:"metric-item"},z5={class:"metric-value"},Q5={class:"metric-item"},J5={class:"metric-value"},q5={class:"metric-item"},Z5={class:"metric-value"},X5={class:"trade-form-card"},eO={class:"form-header"},tO={class:"form-title"},sO={class:"wallet-status-inline"},nO={class:"wallet-status-item"},rO={key:0,class:"wallet-status-item"},iO={class:"status-value"},oO={key:1,class:"wallet-status-item"},aO={class:"status-value"},lO={key:2,class:"wallet-status-item"},cO={class:"status-value"},uO={key:3,class:"wallet-status-item"},dO={class:"status-value"},fO={class:"form-section"},hO={class:"amount-input-group"},pO={key:0,class:"subscription-summary"},mO={class:"summary-item"},gO={class:"summary-value"},yO={class:"summary-item"},vO={class:"summary-value"},bO={class:"summary-item"},wO={class:"summary-value"},AO={class:"summary-item"},EO={class:"summary-value"},_O={class:"summary-item"},TO={class:"summary-value"},PO={class:"summary-item"},kO={class:"summary-value"},SO={key:0,class:"button-hint"},CO={key:1,class:"button-hint"},IO={class:"form-section"},RO={class:"trade-type-buttons"},DO=["disabled"],xO={class:"btn-text"},NO={class:"deployment-status-card"},LO={class:"status-log"},OO={class:"log-time"},UO={class:"log-message"},BO={class:"deployed-contracts-card"},MO={class:"contract-list"},FO={class:"contract-name"},VO={class:"contract-address"},$O=["onClick"],jO={class:"interaction-status-card"},HO={class:"status-log"},WO={class:"log-time"},YO={class:"log-message"},GO={class:"balance-info-card"},KO={class:"balance-list"},zO={class:"balance-item"},QO={class:"balance-value"},JO={class:"balance-item"},qO={class:"balance-value"},ZO={class:"balance-item"},XO={class:"balance-value"},e8={key:3,class:"error-message"},t8={class:"error-text"},s8={class:"trade-history-card"},n8={key:0,class:"loading-message"},r8={key:1,class:"no-trades"},i8={key:2,class:"trade-list"},o8={class:"trade-header"},a8={class:"trade-time"},l8={class:"trade-info"},c8={class:"trade-project-section"},u8={class:"value"},d8={class:"trade-amount-section"},f8={class:"value"},h8={key:0,class:"trade-etherscan-section"},p8={class:"etherscan-info"},m8=["onClick"],g8={class:"etherscan-info"},y8={class:"etherscan-info"},v8={class:"value"},b8={class:"etherscan-info"},w8={class:"value"},A8={class:"etherscan-info"},E8={class:"value"},_8={class:"etherscan-info"},T8={class:"value"},P8={class:"etherscan-info"},k8={class:"value"},S8={class:"etherscan-info"},C8={class:"value"},I8={class:"etherscan-info"},R8={class:"value"},D8={key:0,class:"trade-footer"},x8=["href"];function N8(t,e,s,n,r,i){return m(),g("div",ZL,[r.showLoadingModal?(m(),g("div",XL,[a("div",{class:"modal-content loading-modal",onClick:e[0]||(e[0]=ue(()=>{},["stop"]))},[a("div",e5,[e[15]||(e[15]=a("div",{class:"loading-icon"},[a("div",{class:"spinner"})],-1)),a("div",t5,[e[13]||(e[13]=a("h2",{class:"loading-title"},"Processing...",-1)),e[14]||(e[14]=a("p",{class:"loading-description"},"We are processing your transaction request, please wait...",-1)),a("div",s5,[e[12]||(e[12]=a("div",{class:"status-indicator"},null,-1)),a("span",null,p(r.loadingStatus),1)])])])])])):B("",!0),r.showSuccessModal?(m(),g("div",{key:1,class:"modal-overlay",onClick:e[5]||(e[5]=(...o)=>i.closeSuccessModal&&i.closeSuccessModal(...o))},[a("div",{class:"modal-content success-modal",onClick:e[4]||(e[4]=ue(()=>{},["stop"]))},[a("div",n5,[e[24]||(e[24]=a("div",{class:"success-icon"},[a("div",{class:"checkmark"},[a("div",{class:"checkmark-stem"}),a("div",{class:"checkmark-kick"})])],-1)),a("div",r5,[e[22]||(e[22]=a("h2",{class:"success-title"},"Transaction Successful!",-1)),e[23]||(e[23]=a("p",{class:"success-description"},"Your transaction has been completed successfully",-1)),a("div",i5,[a("div",o5,[e[18]||(e[18]=a("div",{class:"detail-header"},[a("span",{class:"detail-label"},"Transaction Details")],-1)),a("div",a5,[a("div",l5,[e[16]||(e[16]=a("span",{class:"detail-key"},"Type:",-1)),a("span",c5,p(r.successData.tradeType==="buy"?"Buy":"Sell"),1)]),a("div",u5,[e[17]||(e[17]=a("span",{class:"detail-key"},"Amount:",-1)),a("span",d5,p(r.successData.amount)+" Tokens",1)])])]),a("div",f5,[e[21]||(e[21]=a("div",{class:"detail-header"},[a("span",{class:"detail-label"},"Blockchain Info")],-1)),a("div",h5,[a("div",p5,[e[19]||(e[19]=a("span",{class:"detail-key"},"Hash:",-1)),a("span",{class:"detail-value hash-value",onClick:e[1]||(e[1]=(...o)=>i.copyHash&&i.copyHash(...o))},p(i.formatHash(r.successData.transactionHash)),1)]),a("div",m5,[e[20]||(e[20]=a("span",{class:"detail-key"},"Block:",-1)),a("span",g5,p(r.successData.blockNumber),1)])])])])]),a("div",y5,[a("button",{class:"btn secondary",onClick:e[2]||(e[2]=(...o)=>i.closeSuccessModal&&i.closeSuccessModal(...o))},"Close"),a("button",{class:"btn primary",onClick:e[3]||(e[3]=(...o)=>i.viewPortfolio&&i.viewPortfolio(...o))},"View Portfolio")])])])])):B("",!0),a("header",v5,[a("nav",b5,[a("button",{class:"crumb-back",onClick:e[6]||(e[6]=o=>t.$router.back()),"aria-label":"Back"},[...e[25]||(e[25]=[a("svg",{viewBox:"0 0 24 24",class:"i"},[a("path",{d:"M10 19a1 1 0 0 1-.7-.3l-7-7a1 1 0 0 1 0-1.4l7-7a1 1 0 1 1 1.4 1.4L4.41 11H21a1 1 0 1 1 0 2H4.41l6.3 6.3A1 1 0 0 1 10 19z"})],-1)])]),e[26]||(e[26]=a("span",{class:"sep"},"/",-1)),e[27]||(e[27]=a("span",{class:"crumb"},"Projects",-1)),e[28]||(e[28]=a("span",{class:"sep"},"/",-1)),a("span",w5,"Trade "+p(i.projectCode),1)])]),a("div",A5,[r.projectLoading?(m(),g("div",E5,[...e[29]||(e[29]=[a("div",{class:"loading-spinner"},null,-1),a("h2",null,"Loading Project Data...",-1),a("p",null,"Please wait while we load the project information.",-1)])])):r.projectError?(m(),g("div",_5,[e[30]||(e[30]=a("div",{class:"error-icon"},"⚠️",-1)),e[31]||(e[31]=a("h2",null,"Failed to Load Project",-1)),a("p",null,p(r.projectError),1),a("button",{class:"btn primary",onClick:e[7]||(e[7]=(...o)=>i.loadProjectData&&i.loadProjectData(...o))},"Retry")])):i.projectData?(m(),g("div",T5,[a("div",P5,[a("img",{src:i.projectData.image,alt:i.projectCode,class:"project-image"},null,8,k5),a("div",S5,[a("h1",C5,p(t.currentProduct.code)+" • "+p(t.currentProduct.name),1),a("p",I5,p(t.currentProduct.subtitle),1),a("div",R5,[a("span",D5,p(t.currentProduct.type),1),a("span",x5,p(t.currentProduct.region),1),a("span",N5,p(t.currentProduct.loanProduct||"Loan Product"),1)])])]),a("div",L5,[a("div",O5,[e[32]||(e[32]=a("span",{class:"metric-label"},"LOAN SIZE",-1)),a("span",U5,p(t.currentProduct.loanAmount||"AUD$0"),1)]),a("div",B5,[e[33]||(e[33]=a("span",{class:"metric-label"},"EST. YIELD (IRR)",-1)),a("span",M5,p(t.currentProduct.metrics.targetLoanYield),1)]),a("div",F5,[e[34]||(e[34]=a("span",{class:"metric-label"},"TERM",-1)),a("span",V5,p(t.currentProduct.loanTerm||"12 months"),1)]),a("div",$5,[e[35]||(e[35]=a("span",{class:"metric-label"},"PROPERTY VALUE",-1)),a("span",j5,p(t.currentProduct.metrics.collateralPropertyValue),1)]),a("div",H5,[e[36]||(e[36]=a("span",{class:"metric-label"},"LTV",-1)),a("span",W5,p(t.currentProduct.metrics.loanToValue),1)]),a("div",Y5,[e[37]||(e[37]=a("span",{class:"metric-label"},"SUBSCRIPTION PROGRESS",-1)),a("span",G5,p(t.currentProduct.subscriptionProgress),1)]),a("div",K5,[e[38]||(e[38]=a("span",{class:"metric-label"},"TOTAL OFFERING",-1)),a("span",z5,p(t.currentProduct.totalOffering),1)]),a("div",Q5,[e[39]||(e[39]=a("span",{class:"metric-label"},"SUBSCRIBED",-1)),a("span",J5,p(t.currentProduct.subscribed),1)]),a("div",q5,[e[40]||(e[40]=a("span",{class:"metric-label"},"DEFAULT RATE",-1)),a("span",Z5,p(t.currentProduct.metrics.defaultRate),1)])])])):B("",!0),a("div",X5,[a("div",eO,[a("h2",tO,"认购 "+p(t.currentProduct.code),1),a("div",sO,[a("div",nO,[e[41]||(e[41]=a("span",{class:"status-label"},"钱包:",-1)),a("span",{class:be(["status-value",i.connected?"connected":"disconnected"])},p(i.connected?"Connected":"Disconnected"),3)]),i.connected?(m(),g("div",rO,[e[42]||(e[42]=a("span",{class:"status-label"},"地址:",-1)),a("span",iO,p(i.shortAddress),1)])):B("",!0),i.connected?(m(),g("div",oO,[e[43]||(e[43]=a("span",{class:"status-label"},"网络:",-1)),a("span",aO,p(i.networkLabel),1)])):B("",!0),i.connected?(m(),g("div",lO,[e[44]||(e[44]=a("span",{class:"status-label"},"链ID:",-1)),a("span",cO,p(i.getCurrentChainId()),1)])):B("",!0),i.connected?(m(),g("div",uO,[e[45]||(e[45]=a("span",{class:"status-label"},"代币余额:",-1)),a("span",dO,p(t.nativeBalanceDisplay)+" LPT",1)])):B("",!0)])]),a("div",fO,[e[47]||(e[47]=a("h3",{class:"section-title"},"Purchase Amount",-1)),a("div",hO,[Pe(a("input",{type:"number","onUpdate:modelValue":e[8]||(e[8]=o=>r.subscriptionAmount=o),class:be(["amount-input",{error:r.amountError}]),placeholder:"Please enter the purchase amount",min:"100",max:"10000",step:"0.01",onInput:e[9]||(e[9]=(...o)=>i.onAmountInput&&i.onAmountInput(...o)),onBlur:e[10]||(e[10]=(...o)=>i.validateAmount&&i.validateAmount(...o))},null,34),[[Ze,r.subscriptionAmount]]),e[46]||(e[46]=a("span",{class:"amount-unit"},"LPT",-1))])]),r.subscriptionAmount&&r.subscriptionAmount>0&&r.amountValid?(m(),g("div",pO,[e[54]||(e[54]=a("h3",null,"Purchase Summary",-1)),a("div",mO,[e[48]||(e[48]=a("span",{class:"summary-label"},"Project:",-1)),a("span",gO,p(t.p.code)+" • "+p(t.p.name),1)]),a("div",yO,[e[49]||(e[49]=a("span",{class:"summary-label"},"Purchase Amount:",-1)),a("span",vO,p(i.formatNumber(r.subscriptionAmount))+" LPT",1)]),a("div",bO,[e[50]||(e[50]=a("span",{class:"summary-label"},"Annual Rate:",-1)),a("span",wO,p(t.p.metrics.targetLoanYield)+" (标准利率)",1)]),a("div",AO,[e[51]||(e[51]=a("span",{class:"summary-label"},"Loan Term:",-1)),a("span",EO,p(t.p.loanTerm)+"(标准期限)",1)]),a("div",_O,[e[52]||(e[52]=a("span",{class:"summary-label"},"Estimated Interest:",-1)),a("span",TO,p(i.calculateInterest())+" LIT",1)]),a("div",PO,[e[53]||(e[53]=a("span",{class:"summary-label"},"Total Token Needed:",-1)),a("span",kO,p(i.formatNumber(r.subscriptionAmount))+" LPT",1)]),i.connected?i.isFormValid?B("",!0):(m(),g("div",CO," Please fill in the complete subscription information ")):(m(),g("div",SO," Please connect your wallet "))])):B("",!0),a("div",IO,[a("div",RO,[a("button",{class:"trade-type-btn buy-btn",onClick:e[11]||(e[11]=(...o)=>i.deployContractsWithSubscription&&i.deployContractsWithSubscription(...o)),disabled:!i.connected||!i.isFormValid||r.loading},[a("span",xO,p(r.loading?"Processing...":"BUY"),1)],8,DO)])])]),a("div",NO,[e[61]||(e[61]=a("h3",null,"部署状态",-1)),a("div",LO,[(m(!0),g(me,null,dt(r.deploymentLogs,(o,l)=>(m(),g("div",{key:l,class:be(["log-item",o.type])},[a("span",OO,p(o.time),1),a("span",UO,p(o.message),1)],2))),128))]),a("div",BO,[e[55]||(e[55]=a("h3",null,"已部署合约",-1)),a("div",MO,[(m(!0),g(me,null,dt(r.deployedContracts,o=>(m(),g("div",{key:o.name,class:"contract-item"},[a("div",FO,p(o.name),1),a("div",VO,p(o.address),1),a("button",{onClick:l=>i.copyAddress(o.address),class:"btn small"}," 复制地址 ",8,$O)]))),128))])]),a("div",jO,[e[56]||(e[56]=a("h3",null,"合约交互状态",-1)),a("div",HO,[(m(!0),g(me,null,dt(r.interactionLogs,(o,l)=>(m(),g("div",{key:l,class:be(["log-item",o.type])},[a("span",WO,p(o.time),1),a("span",YO,p(o.message),1)],2))),128))])]),a("div",GO,[e[60]||(e[60]=a("h3",null,"余额信息",-1)),a("div",KO,[a("div",zO,[e[57]||(e[57]=a("span",{class:"balance-label"},"LPT 余额:",-1)),a("span",QO,p(r.balanceInfo.lpt)+" LPT",1)]),a("div",JO,[e[58]||(e[58]=a("span",{class:"balance-label"},"LIT 余额:",-1)),a("span",qO,p(r.balanceInfo.lit)+" LIT",1)]),a("div",ZO,[e[59]||(e[59]=a("span",{class:"balance-label"},"ETH 余额:",-1)),a("span",XO,p(r.balanceInfo.eth)+" ETH",1)])])])]),e[63]||(e[63]=a("div",null,null,-1)),i.formattedError?(m(),g("div",e8,[e[62]||(e[62]=a("div",{class:"error-icon"},"⚠️",-1)),a("div",t8,p(i.formattedError),1)])):B("",!0)]),a("div",s8,[e[75]||(e[75]=a("div",{class:"card-header"},[a("h2",{class:"card-title"},"Recent Trades")],-1)),r.loading?(m(),g("div",n8,"Loading trades...")):i.projectTrades.length===0?(m(),g("div",r8,"No trades found for this project")):(m(),g("div",i8,[(m(!0),g(me,null,dt(i.projectTrades,o=>(m(),g("div",{key:o.id,class:"trade-item"},[a("div",o8,[a("span",{class:be(["trade-type",o.type])},p(i.getTradeTypeDisplay(o.type)),3),a("span",a8,p(i.formatTime(o.timestamp)),1)]),a("div",l8,[a("div",c8,[e[64]||(e[64]=a("span",{class:"label"},"Project:",-1)),a("span",u8,p(o.project_code)+" - "+p(o.project_name),1)]),a("div",d8,[e[65]||(e[65]=a("span",{class:"label"},"Token Amount:",-1)),a("span",f8,p(o.amount)+" tokens",1)]),o.etherscan?(m(),g("div",h8,[a("div",p8,[e[66]||(e[66]=a("span",{class:"label"},"Transaction Hash:",-1)),a("span",{class:"value hash-value",onClick:l=>i.copyHash(o.etherscan.hash)},p(i.formatHash(o.etherscan.hash)),9,m8)]),a("div",g8,[e[67]||(e[67]=a("span",{class:"label"},"Status:",-1)),a("span",{class:be(["value",{"status-success":o.etherscan.status==="0x1","status-failed":o.etherscan.status==="0x0"}])},p(o.etherscan.status==="0x1"?"Success":o.etherscan.status==="0x0"?"Failed":"Pending"),3)]),a("div",y8,[e[68]||(e[68]=a("span",{class:"label"},"Block:",-1)),a("span",v8,p(o.etherscan.blockNumber?parseInt(o.etherscan.blockNumber,16).toLocaleString():"N/A"),1)]),a("div",b8,[e[69]||(e[69]=a("span",{class:"label"},"Timestamp:",-1)),a("span",w8,p(i.formatEtherscanTime(o.etherscan.timestamp)),1)]),a("div",A8,[e[70]||(e[70]=a("span",{class:"label"},"From:",-1)),a("span",E8,p(i.formatAddress(o.etherscan.from)),1)]),a("div",_8,[e[71]||(e[71]=a("span",{class:"label"},"To:",-1)),a("span",T8,p(i.formatAddress(o.etherscan.to)),1)]),a("div",P8,[e[72]||(e[72]=a("span",{class:"label"},"Value:",-1)),a("span",k8,p(i.formatEtherValue(o.etherscan.value))+" ETH",1)]),a("div",S8,[e[73]||(e[73]=a("span",{class:"label"},"Transaction Fee:",-1)),a("span",C8,p(o.etherscan.transactionFee?o.etherscan.transactionFee.toFixed(6):"N/A")+" ETH",1)]),a("div",I8,[e[74]||(e[74]=a("span",{class:"label"},"Gas Price:",-1)),a("span",R8,p(o.etherscan.gasPrice?parseInt(o.etherscan.gasPrice,16).toLocaleString():"N/A")+" Gwei",1)])])):B("",!0)]),o.etherscan&&o.etherscan.hash?(m(),g("div",D8,[a("a",{href:`https://sepolia.etherscan.io/tx/${o.etherscan.hash}`,target:"_blank",class:"tx-link"}," 🔗 View on Sepolia Etherscan ",8,x8)])):B("",!0)]))),128))]))])])}const L8=It(qL,[["render",N8],["__scopeId","data-v-b5355890"]]),O8={name:"TokenDetailView",props:{address:{type:String,required:!0}},setup(t){const{chainId:e,networkLabel:s}=zt(),n=fe(""),r=fe(""),i=fe(null),o=fe(!1),l=new cs(window.ethereum,"any"),c=["function decimals() view returns (uint8)","function symbol() view returns (string)","function name() view returns (string)"];mi(async()=>{try{const T=new Wt(t.address,c,l);i.value=await T.decimals(),n.value=await T.symbol(),r.value=await T.name()}catch{}try{const T=sessionStorage.getItem(`customTokens:${e.value}`),w=T?JSON.parse(T):[],k=Array.isArray(w)?w.find(C=>(C.address||"").toLowerCase()===t.address.toLowerCase()):null;k&&k.addedAt&&(h.value=new Date(k.addedAt).toLocaleString(),y.value=k.source||"ImportFromUs")}catch{}});function u(){const T=Number(e.value),w=T===1?"https://etherscan.io":T===11155111?"https://sepolia.etherscan.io":"",k=w?`${w}/token/${t.address}`:`https://etherscan.io/token/${t.address}`;window.open(k,"_blank")}function d(){try{const T=`hiddenTokens:${e.value}`,w=sessionStorage.getItem(T),k=w?JSON.parse(w):[],C=new Set((Array.isArray(k)?k:[]).map(N=>String(N).toLowerCase()));C.add(t.address.toLowerCase()),sessionStorage.setItem(T,JSON.stringify(Array.from(C))),alert("Hidden successfully"),window.history.back()}catch{alert("Hide failed")}}function f(){try{const T=`customTokens:${e.value}`,w=sessionStorage.getItem(T),k=w?JSON.parse(w):[],C=Array.isArray(k)?k.filter(N=>(N.address||"").toLowerCase()!==t.address.toLowerCase()):[];sessionStorage.setItem(T,JSON.stringify(C)),alert("Deleted from custom tokens"),window.history.back()}catch{alert("Delete failed")}}const h=fe(""),y=fe("");return{networkLabel:s,address:t.address,symbol:n,name:r,decimals:i,importDate:h,importSource:y,menuOpen:o,openInExplorer:u,hideToken:d,deleteToken:f}}},U8={class:"container"},B8={class:"td-top"},M8={class:"td-actions"},F8={key:0,class:"td-menu"},V8={class:"td-grid"},$8={class:"card"},j8={class:"kv"},H8={class:"v"},W8={class:"kv"},Y8={class:"v addr"},G8={class:"kv"},K8={class:"v"},z8={class:"kv"},Q8={class:"v"},J8={class:"kv"},q8={class:"v"};function Z8(t,e,s,n,r,i){return m(),g("section",U8,[a("header",B8,[e[4]||(e[4]=a("h1",{class:"headline"},"Token details",-1)),a("div",M8,[a("button",{class:"btn",onClick:e[0]||(e[0]=o=>n.menuOpen=!n.menuOpen)},"⋮"),n.menuOpen?(m(),g("div",F8,[a("button",{class:"td-item",onClick:e[1]||(e[1]=(...o)=>n.openInExplorer&&n.openInExplorer(...o))},"View Asset in explorer"),a("button",{class:"td-item",onClick:e[2]||(e[2]=(...o)=>n.hideToken&&n.hideToken(...o))},"Hide "+p(n.symbol),1),a("button",{class:"td-item danger",onClick:e[3]||(e[3]=(...o)=>n.deleteToken&&n.deleteToken(...o))},"Delete from my wallet")])):B("",!0)])]),a("div",V8,[a("article",$8,[e[10]||(e[10]=a("h3",null,"Overview",-1)),a("div",j8,[e[5]||(e[5]=a("span",{class:"k"},"Network name",-1)),a("span",H8,p(n.networkLabel),1)]),a("div",W8,[e[6]||(e[6]=a("span",{class:"k"},"Contract address",-1)),a("span",Y8,p(n.address),1)]),a("div",G8,[e[7]||(e[7]=a("span",{class:"k"},"Token decimal",-1)),a("span",K8,p(n.decimals??"-"),1)]),e[11]||(e[11]=a("div",{class:"kv"},[a("span",{class:"k"},"Spending caps"),a("span",{class:"v"},"—")],-1)),a("div",z8,[e[8]||(e[8]=a("span",{class:"k"},"Token import date",-1)),a("span",Q8,p(n.importDate||"-"),1)]),a("div",J8,[e[9]||(e[9]=a("span",{class:"k"},"Token import source",-1)),a("span",q8,p(n.importSource||"metamask"),1)])]),e[12]||(e[12]=a("article",{class:"card"},[a("h3",null,"Your activity"),a("p",{class:"muted"},"Activity list placeholder.")],-1))])])}const X8=It(O8,[["render",Z8],["__scopeId","data-v-28606b53"]]),eU={name:"OverviewView"},tU={class:"container"};function sU(t,e,s,n,r,i){return m(),g("div",tU,[...e[0]||(e[0]=[Nt('<div class="page-header" data-v-1a3591db><h1 data-v-1a3591db>Product Overview</h1><p class="page-subtitle" data-v-1a3591db>Know our real estate tokenization investment platform</p></div><div class="overview-content" data-v-1a3591db><div class="feature-grid" data-v-1a3591db><div class="feature-card" data-v-1a3591db><div class="feature-icon" data-v-1a3591db>🏠</div><h3 data-v-1a3591db>Real Estate Tokenization</h3><p data-v-1a3591db>Convert traditional real estate investments into tradable digital tokens, reducing investment门槛, and improving liquidity.</p></div><div class="feature-card" data-v-1a3591db><div class="feature-icon" data-v-1a3591db>💰</div><h3 data-v-1a3591db>Stable Income</h3><p data-v-1a3591db>Based on high-quality real estate mortgage loans, providing stable rental income and capital appreciation potential.</p></div><div class="feature-card" data-v-1a3591db><div class="feature-icon" data-v-1a3591db>🔒</div><h3 data-v-1a3591db>Secure and Transparent</h3><p data-v-1a3591db>Based on blockchain technology, all transaction records are transparent and smart contracts are automatically executed.</p></div><div class="feature-card" data-v-1a3591db><div class="feature-icon" data-v-1a3591db>📊</div><h3 data-v-1a3591db>Real-Time Data</h3><p data-v-1a3591db>Provide real-time market data, project information and investment performance, helping you make wise decisions.</p></div></div><div class="stats-section" data-v-1a3591db><h2 data-v-1a3591db>Platform Data</h2><div class="stats-grid" data-v-1a3591db><div class="stat-item" data-v-1a3591db><div class="stat-number" data-v-1a3591db>$50M+</div><div class="stat-label" data-v-1a3591db>Managed Assets</div></div><div class="stat-item" data-v-1a3591db><div class="stat-number" data-v-1a3591db>1,200+</div><div class="stat-label" data-v-1a3591db>Active Investors</div></div><div class="stat-item" data-v-1a3591db><div class="stat-number" data-v-1a3591db>25+</div><div class="stat-label" data-v-1a3591db>Investment Projects</div></div><div class="stat-item" data-v-1a3591db><div class="stat-number" data-v-1a3591db>6.5%</div><div class="stat-label" data-v-1a3591db>Average Annual Return</div></div></div></div></div>',2)])])}const nU=It(eU,[["render",sU],["__scopeId","data-v-1a3591db"]]),rU={name:"AboutUsView"},iU={class:"container"};function oU(t,e,s,n,r,i){return m(),g("div",iU,[...e[0]||(e[0]=[Nt('<div class="page-header" data-v-26dedfb2><h1 data-v-26dedfb2>About Us</h1><p class="page-subtitle" data-v-26dedfb2>Innovative technology company dedicated to revolutionizing real estate investment</p></div><div class="about-content" data-v-26dedfb2><div class="background-vision-section" data-v-26dedfb2><h2 data-v-26dedfb2>Background</h2><div class="vision-text" data-v-26dedfb2><p class="vision-intro" data-v-26dedfb2><strong data-v-26dedfb2>RWAT dealmaker</strong> (stand for Real World Assets Tokenization deal maker) is the creator of the real world assets tokenization project, meaning that this platform is committed to protecting the investment safety of RWAT investors, organizing legally compliant, low-risk, high-return and high-quality asset. For example, residential mortgage loans with a mortgage rate of less than 70% and a rate of approximately 9% in Australia. This platform aims to promote the transaction between investors and asset holders. </p><p class="vision-intro" data-v-26dedfb2> The underlying assets displayed on this platform are protected by the laws of the country where they are located, and the funds can freely enter and exit that country. If investors require, the project transaction structure can be isolated and entrusted by a third-party institution to hold the underlying assets and funds. </p><p class="vision-intro" data-v-26dedfb2> In addition to facilitating transactions between investors and RWAT underlying asset holders, this platform can also integrate the cooperation of all institutions in the RWA tokenization chain, including professional RWA tokenization technology service companies and licensed issuers and exchanges of RWAT in various countries, to achieve the successful issuance of RWA tokenization legally, efficiently, at low cost, and publicly or privately. </p></div></div><div class="mission-section" data-v-26dedfb2><div class="mission-text" data-v-26dedfb2><h2 data-v-26dedfb2>Our Mission</h2><p data-v-26dedfb2>We are committed to revolutionizing traditional real estate investment through blockchain technology, allowing everyone to participate in high-quality real estate investment, and share the growth红利 of the real estate market.</p><p data-v-26dedfb2>Through tokenization technology, we will break down traditional real estate investment that requires a large amount of capital into small, tradable units, allowing ordinary investors to enjoy stable returns from real estate investment.</p></div><div class="mission-image" data-v-26dedfb2><div class="image-placeholder" data-v-26dedfb2>🏢</div></div></div><div class="values-section" data-v-26dedfb2><h2 data-v-26dedfb2>Core Values</h2><div class="values-grid" data-v-26dedfb2><div class="value-card" data-v-26dedfb2><div class="value-icon" data-v-26dedfb2>🔒</div><h3 data-v-26dedfb2>Security First</h3><p data-v-26dedfb2>Use the most advanced encryption technology and multiple security measures to ensure the security of user assets and transactions.</p></div><div class="value-card" data-v-26dedfb2><div class="value-icon" data-v-26dedfb2>🌐</div><h3 data-v-26dedfb2>Transparent and Open</h3><p data-v-26dedfb2>All transaction records are stored on the chain, project information is completely transparent, allowing investors to invest clearly and clearly.</p></div><div class="value-card" data-v-26dedfb2><div class="value-icon" data-v-26dedfb2>🚀</div><h3 data-v-26dedfb2>Continuous Innovation</h3><p data-v-26dedfb2>Continuously explore new technologies, optimize user experience, and provide better services for investors.</p></div><div class="value-card" data-v-26dedfb2><div class="value-icon" data-v-26dedfb2>🤝</div><h3 data-v-26dedfb2>User-Centered</h3><p data-v-26dedfb2>Provide professional,贴心 services, helping users achieve wealth增值。</p></div></div></div><div class="team-section" data-v-26dedfb2><h2 data-v-26dedfb2>Core Team</h2><div class="team-grid" data-v-26dedfb2><div class="team-member" data-v-26dedfb2><div class="member-avatar" data-v-26dedfb2>👨‍💼</div><h4 data-v-26dedfb2>张明</h4><p class="member-title" data-v-26dedfb2></p><p class="member-bio" data-v-26dedfb2>拥有15年金融科技经验，曾在多家知名金融机构担任高管职务。</p></div><div class="team-member" data-v-26dedfb2><div class="member-avatar" data-v-26dedfb2>👩‍💻</div><h4 data-v-26dedfb2>李华</h4><p class="member-title" data-v-26dedfb2>CFO</p><p class="member-bio" data-v-26dedfb2>区块链技术专家，在分布式系统和智能合约开发方面有丰富经验。</p></div><div class="team-member" data-v-26dedfb2><div class="member-avatar" data-v-26dedfb2>👨‍💼</div><h4 data-v-26dedfb2>王强</h4><p class="member-title" data-v-26dedfb2>CMO</p><p class="member-bio" data-v-26dedfb2>房地产行业资深专家，对市场趋势和投资机会有深刻洞察。</p></div></div></div><div class="stats-section" data-v-26dedfb2><h2 data-v-26dedfb2>Company Data</h2><div class="stats-grid" data-v-26dedfb2><div class="stat-item" data-v-26dedfb2><div class="stat-number" data-v-26dedfb2>2023</div><div class="stat-label" data-v-26dedfb2>Year of Establishment</div></div><div class="stat-item" data-v-26dedfb2><div class="stat-number" data-v-26dedfb2>50+</div><div class="stat-label" data-v-26dedfb2>Team Members</div></div><div class="stat-item" data-v-26dedfb2><div class="stat-number" data-v-26dedfb2>$50M+</div><div class="stat-label" data-v-26dedfb2>Managed Assets</div></div><div class="stat-item" data-v-26dedfb2><div class="stat-number" data-v-26dedfb2>1,200+</div><div class="stat-label" data-v-26dedfb2>Active Users</div></div></div></div></div>',2)])])}const aU=It(rU,[["render",oU],["__scopeId","data-v-26dedfb2"]]),lU=aP({history:UT(),routes:[{path:"/",redirect:"/home"},{path:"/home",name:"home",component:yg},{path:"/wallet",name:"wallet",component:Og},{path:"/portfolio",name:"portfolio",component:Dg},{path:"/listedprojects",name:"listedprojects",component:Sc},{path:"/listedprojects/:code",name:"listedProjectDetail",component:Sc,props:!0},{path:"/to-be-listed",name:"toBeListed",component:Yf},{path:"/to-be-listed/:code",name:"toBeListedDetail",component:Yf,props:!0},{path:"/admin-projects",name:"adminProjects",component:Gf},{path:"/admin-projects/:code",name:"adminProjectDetail",component:Gf,props:!0},{path:"/contact",name:"contact",component:QL},{path:"/detail/:id?",name:"detail",component:Bg,props:!0},{path:"/token/:address",name:"tokenDetail",component:X8,props:!0},{path:"/profile",name:"profile",component:Lg},{path:"/login",name:"login",component:xg},{path:"/signup",name:"signup",component:Ng},{path:"/trade/:code",name:"tradeProject",component:L8,props:!0},{path:"/kycService",component:Ug},{path:"/overview",name:"overview",component:nU},{path:"/about",name:"about",component:aU}]});vv(W4).use(lU).mount("#app");
