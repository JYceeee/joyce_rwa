<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeProjectView å­—æ®µæ˜ å°„æ›´æ–°æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        .warning { background-color: #fff3cd; border-color: #ffeaa7; }
        .btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            text-decoration: none;
            display: inline-block;
        }
        .btn:hover { background-color: #0056b3; }
        .btn-success { background-color: #28a745; }
        .btn-success:hover { background-color: #1e7e34; }
        .mapping-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .mapping-panel {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
        }
        .field-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .field-item:last-child {
            border-bottom: none;
        }
        .field-label {
            font-weight: bold;
            color: #333;
        }
        .field-value {
            color: #666;
            font-family: monospace;
            font-size: 12px;
        }
        .match { background-color: #d4edda; }
        .updated { background-color: #fff3cd; }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 14px;
            overflow-x: auto;
        }
        .field-mapping-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .mapping-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
        }
        .mapping-title {
            font-weight: bold;
            color: #495057;
            margin-bottom: 10px;
            font-size: 14px;
        }
        .mapping-fields {
            font-size: 12px;
            color: #6c757d;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ TradeProjectView å­—æ®µæ˜ å°„æ›´æ–°æµ‹è¯•</h1>
        
        <div class="test-section info">
            <h3>ğŸ“‹ æ›´æ–°æ¦‚è¿°</h3>
            <p><strong>ç›®æ ‡:</strong> æŒ‰ç…§ç°æœ‰loadProductsæ˜ å°„å­—æ®µæ›´æ–°TradeProjectViewå†…çš„é¡¹ç›®ä¿¡æ¯å¡ç‰‡</p>
            <p><strong>ä¸»è¦æ”¹è¿›:</strong></p>
            <ul>
                <li>âœ… æ¢å¤å¹¶æ›´æ–°loadProjectDataæ–¹æ³•</li>
                <li>âœ… ä½¿ç”¨ä¸loadProductså®Œå…¨ç›¸åŒçš„å­—æ®µæ˜ å°„é€»è¾‘</li>
                <li>âœ… ä¿æŒæ•°æ®ç»“æ„å’Œå‘½åçš„ä¸€è‡´æ€§</li>
                <li>âœ… æ·»åŠ å…¼å®¹å­—æ®µç”¨äºæ¨¡æ¿æ˜¾ç¤º</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>ğŸ”„ å­—æ®µæ˜ å°„å¯¹æ¯”</h3>
            <div class="mapping-comparison">
                <div class="mapping-panel">
                    <h4>loadProducts æ˜ å°„æ–¹å¼</h4>
                    <div class="field-item match">
                        <span class="field-label">ç‰©ä¸šä¿¡æ¯</span>
                        <span class="field-value">property_location, property_type</span>
                    </div>
                    <div class="field-item match">
                        <span class="field-label">è´·æ¬¾ä¿¡æ¯</span>
                        <span class="field-value">loan_product, loan_amount</span>
                    </div>
                    <div class="field-item match">
                        <span class="field-label">æ”¶ç›Šç‡</span>
                        <span class="field-value">interest_rate</span>
                    </div>
                    <div class="field-item match">
                        <span class="field-label">æ˜¾ç¤ºå­—æ®µ</span>
                        <span class="field-value">loanAmount, loanTerm</span>
                    </div>
                </div>
                
                <div class="mapping-panel">
                    <h4>loadProjectData æ˜ å°„æ–¹å¼ï¼ˆæ›´æ–°åï¼‰</h4>
                    <div class="field-item match">
                        <span class="field-label">ç‰©ä¸šä¿¡æ¯</span>
                        <span class="field-value">property_location, property_type</span>
                    </div>
                    <div class="field-item match">
                        <span class="field-label">è´·æ¬¾ä¿¡æ¯</span>
                        <span class="field-value">loan_product, loan_amount</span>
                    </div>
                    <div class="field-item match">
                        <span class="field-label">æ”¶ç›Šç‡</span>
                        <span class="field-value">interest_rate</span>
                    </div>
                    <div class="field-item updated">
                        <span class="field-label">å…¼å®¹å­—æ®µ</span>
                        <span class="field-value">propertyType, propertyLocation</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š å­—æ®µæ˜ å°„è¯¦æƒ…</h3>
            <div class="field-mapping-grid">
                <div class="mapping-card">
                    <div class="mapping-title">åŸºç¡€ä¿¡æ¯</div>
                    <div class="mapping-fields">
                        id: project.id<br>
                        code: project.code<br>
                        name: project.name<br>
                        status: project.status
                    </div>
                </div>
                
                <div class="mapping-card">
                    <div class="mapping-title">è®¤è´­ä¿¡æ¯</div>
                    <div class="mapping-fields">
                        totalOffering: AUD$format(project.total_offering_token)<br>
                        subscribed: AUD$format(project.subscribe_token)<br>
                        totalOfferingRaw: project.total_offering_token<br>
                        subscribedRaw: project.subscribe_token
                    </div>
                </div>
                
                <div class="mapping-card">
                    <div class="mapping-title">ç‰©ä¸šä¿¡æ¯</div>
                    <div class="mapping-fields">
                        property_location: project.propertyLocation<br>
                        property_state: project.propertyState<br>
                        property_type: project.propertyType<br>
                        property_value: project.propertyValue
                    </div>
                </div>
                
                <div class="mapping-card">
                    <div class="mapping-title">è´·æ¬¾ä¿¡æ¯</div>
                    <div class="mapping-fields">
                        loan_type: project.loanType<br>
                        loan_product: project.loanProduct<br>
                        loan_amount: project.loanAmount<br>
                        loan_term_months: project.loanTermMonths
                    </div>
                </div>
                
                <div class="mapping-card">
                    <div class="mapping-title">è´·æ¬¾æ¯”ç‡</div>
                    <div class="mapping-fields">
                        lvr: project.lvr<br>
                        interest_rate: project.interestRate<br>
                        default_rate: project.defaultRate
                    </div>
                </div>
                
                <div class="mapping-card">
                    <div class="mapping-title">å‰ç«¯æ˜¾ç¤ºå­—æ®µ</div>
                    <div class="mapping-fields">
                        subtitle: loanProduct - propertyType<br>
                        loanAmount: AUD$format(loanAmount)<br>
                        loanTerm: loanTermMonths months<br>
                        targetYield: interestRate
                    </div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ’» å…³é”®ä»£ç æ›´æ–°</h3>
            <div class="code-block">
async loadProjectData() {
  // æŒ‰ç…§ç°æœ‰loadProductsçš„æ˜ å°„æ–¹å¼è¿›è¡Œæ•°æ®æ˜ å°„
  const project = response.data
  const mappedProduct = {
    // åŸºç¡€ä¿¡æ¯
    id: project.id,
    code: project.code,
    name: project.name,
    status: project.status,
    
    // è®¤è´­ä¿¡æ¯
    totalOffering: project.total_offering_token ? `AUD$${project.total_offering_token.toLocaleString()}` : 'AUD$0',
    subscribed: project.subscribe_token ? `AUD$${project.subscribe_token.toLocaleString()}` : 'AUD$0',
    
    // ç‰©ä¸šä¿¡æ¯ï¼ˆæŒ‰ç…§loadProductsæ˜ å°„ï¼‰
    property_location: project.propertyLocation,
    property_type: project.propertyType,
    property_value: project.propertyValue,
    
    // è´·æ¬¾ä¿¡æ¯ï¼ˆæŒ‰ç…§loadProductsæ˜ å°„ï¼‰
    loan_product: project.loanProduct,
    loan_amount: project.loanAmount,
    loan_term_months: project.loanTermMonths,
    
    // å‰ç«¯æ˜¾ç¤ºå­—æ®µï¼ˆæŒ‰ç…§loadProductsæ˜ å°„ï¼‰
    subtitle: `${project.loanProduct} - ${project.propertyType}`,
    loanAmount: project.loanAmount ? `AUD$${project.loanAmount.toLocaleString()}` : 'AUD$0',
    loanTerm: `${project.loanTermMonths} months`,
    targetYield: project.interestRate,
    
    // å…¼å®¹å­—æ®µï¼ˆç”¨äºæ¨¡æ¿æ˜¾ç¤ºï¼‰
    propertyType: project.propertyType,
    propertyLocation: project.propertyLocation,
    loanProduct: project.loanProduct
  }
  
  // æ·»åŠ è®¡ç®—æŒ‡æ ‡ï¼ˆæŒ‰ç…§loadProductsæ˜ å°„ï¼‰
  mappedProduct.metrics = {
    currentElaraPrice: this.calculateTokenPrice(mappedProduct),
    collateralPropertyValue: project.propertyValue ? `AUD$${project.propertyValue.toLocaleString()}` : 'TBA',
    rentalIncome: this.calculateRentalIncome(mappedProduct),
    targetLoanYield: `${project.interestRate}% p.a.`
  }
  
  this.projectData = mappedProduct
}
            </div>
        </div>

        <div class="test-section success">
            <h3>âœ… æ›´æ–°å®Œæˆçš„åŠŸèƒ½</h3>
            <ul>
                <li><strong>æ•°æ®æ˜ å°„ä¸€è‡´æ€§:</strong> loadProjectDataç°åœ¨ä½¿ç”¨ä¸loadProductså®Œå…¨ç›¸åŒçš„å­—æ®µæ˜ å°„é€»è¾‘</li>
                <li><strong>å­—æ®µå‘½åç»Ÿä¸€:</strong> ä½¿ç”¨ç›¸åŒçš„ä¸‹åˆ’çº¿å‘½åè§„èŒƒï¼ˆproperty_location, loan_productç­‰ï¼‰</li>
                <li><strong>å…¼å®¹æ€§æ”¯æŒ:</strong> æ·»åŠ camelCaseå…¼å®¹å­—æ®µç”¨äºæ¨¡æ¿æ˜¾ç¤º</li>
                <li><strong>è®¡ç®—æŒ‡æ ‡ä¸€è‡´:</strong> metricså¯¹è±¡ä½¿ç”¨ç›¸åŒçš„è®¡ç®—é€»è¾‘</li>
                <li><strong>é”™è¯¯å¤„ç†:</strong> ä¿æŒç›¸åŒçš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è¾“å‡º</li>
                <li><strong>è°ƒè¯•æ”¯æŒ:</strong> æ·»åŠ è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—</li>
            </ul>
        </div>

        <div class="test-section warning">
            <h3>ğŸš€ æµ‹è¯•æ­¥éª¤</h3>
            <ol>
                <li>è®¿é—®TradeProjectViewé¡µé¢ï¼ˆå¦‚ï¼š<code>/trade/RWA001</code>ï¼‰</li>
                <li>æ£€æŸ¥é¡¹ç›®ä¿¡æ¯å¡ç‰‡æ˜¯å¦æ­£ç¡®æ˜¾ç¤º</li>
                <li>éªŒè¯å­—æ®µæ˜ å°„æ˜¯å¦æ­£ç¡®ï¼ˆç‰©ä¸šç±»å‹ã€ä½ç½®ã€è´·æ¬¾äº§å“ç­‰ï¼‰</li>
                <li>ç¡®è®¤é¡¹ç›®æŒ‡æ ‡æ•°æ®æ˜¯å¦æ­£ç¡®è®¡ç®—</li>
                <li>æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°çš„è°ƒè¯•æ—¥å¿—</li>
                <li>å¯¹æ¯”loadProductså’ŒloadProjectDataçš„æ•°æ®ç»“æ„</li>
            </ol>
        </div>

        <div class="test-section">
            <h3>ğŸ”— æµ‹è¯•é“¾æ¥</h3>
            <p>ç‚¹å‡»ä»¥ä¸‹é“¾æ¥æµ‹è¯•æ›´æ–°åçš„TradeProjectViewï¼š</p>
            <a href="/trade/RWA001" class="btn btn-success" target="_blank">æµ‹è¯• RWA001</a>
            <a href="/trade/RWA007" class="btn btn-success" target="_blank">æµ‹è¯• RWA007</a>
            <a href="/trade/TEST" class="btn btn-success" target="_blank">æµ‹è¯• TEST</a>
        </div>

        <div class="test-section info">
            <h3>ğŸ“ é¢„æœŸæ•ˆæœ</h3>
            <p>æ›´æ–°åçš„TradeProjectViewåº”è¯¥ï¼š</p>
            <ul>
                <li>âœ… æ­£ç¡®æ˜¾ç¤ºé¡¹ç›®åŸºç¡€ä¿¡æ¯ï¼ˆä»£ç ã€åç§°ã€çŠ¶æ€ï¼‰</li>
                <li>âœ… æ­£ç¡®æ˜ å°„ç‰©ä¸šä¿¡æ¯ï¼ˆç±»å‹ã€ä½ç½®ã€ä»·å€¼ï¼‰</li>
                <li>âœ… æ­£ç¡®æ˜¾ç¤ºè´·æ¬¾ä¿¡æ¯ï¼ˆäº§å“ã€é‡‘é¢ã€æœŸé™ï¼‰</li>
                <li>âœ… æ­£ç¡®è®¡ç®—å¹¶æ˜¾ç¤ºé¡¹ç›®æŒ‡æ ‡ï¼ˆæ”¶ç›Šç‡ã€ä»·æ ¼ã€ç§Ÿé‡‘ç­‰ï¼‰</li>
                <li>âœ… åœ¨æ§åˆ¶å°è¾“å‡ºè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯</li>
                <li>âœ… ä¸loadProductsæ–¹æ³•ä½¿ç”¨ç›¸åŒçš„æ•°æ®ç»“æ„</li>
            </ul>
        </div>
    </div>
</body>
</html>
